{"meta":{"version":1,"warehouse":"2.2.0"},"models":{"Asset":[{"_id":"source/CNAME","path":"CNAME","modified":0,"renderable":0},{"_id":"source/robots.txt","path":"robots.txt","modified":0,"renderable":0},{"_id":"source/images/android-chrome-192x192.png","path":"images/android-chrome-192x192.png","modified":0,"renderable":0},{"_id":"source/images/apple-touch-icon.png","path":"images/apple-touch-icon.png","modified":0,"renderable":0},{"_id":"source/images/android-chrome-512x512.png","path":"images/android-chrome-512x512.png","modified":0,"renderable":0},{"_id":"source/images/browserconfig.xml","path":"images/browserconfig.xml","modified":0,"renderable":0},{"_id":"source/images/favicon-16x16.png","path":"images/favicon-16x16.png","modified":0,"renderable":0},{"_id":"source/images/favicon-32x32.png","path":"images/favicon-32x32.png","modified":0,"renderable":0},{"_id":"source/images/mstile-150x150.png","path":"images/mstile-150x150.png","modified":0,"renderable":0},{"_id":"source/images/safari-pinned-tab.svg","path":"images/safari-pinned-tab.svg","modified":0,"renderable":0},{"_id":"source/images/site.webmanifest","path":"images/site.webmanifest","modified":0,"renderable":0},{"_id":"source/images/wechat-qcode.jpg","path":"images/wechat-qcode.jpg","modified":0,"renderable":0},{"_id":"source/images/wechatpay.png","path":"images/wechatpay.png","modified":0,"renderable":0},{"_id":"source/images/whiteLogo.png","path":"images/whiteLogo.png","modified":0,"renderable":0},{"_id":"source/uploads/qrcode.jpg","path":"uploads/qrcode.jpg","modified":0,"renderable":0},{"_id":"source/images/avatar.jpg","path":"images/avatar.jpg","modified":0,"renderable":0},{"_id":"source/images/favicon.ico","path":"images/favicon.ico","modified":0,"renderable":0},{"_id":"themes/next/source/css/main.styl","path":"css/main.styl","modified":0,"renderable":1},{"_id":"themes/next/source/images/algolia_logo.svg","path":"images/algolia_logo.svg","modified":0,"renderable":1},{"_id":"themes/next/source/images/apple-touch-icon-next.png","path":"images/apple-touch-icon-next.png","modified":0,"renderable":1},{"_id":"themes/next/source/images/avatar.gif","path":"images/avatar.gif","modified":0,"renderable":1},{"_id":"themes/next/source/images/cc-by-nc-nd.svg","path":"images/cc-by-nc-nd.svg","modified":0,"renderable":1},{"_id":"themes/next/source/images/cc-by-nc-sa.svg","path":"images/cc-by-nc-sa.svg","modified":0,"renderable":1},{"_id":"themes/next/source/images/cc-by-nc.svg","path":"images/cc-by-nc.svg","modified":0,"renderable":1},{"_id":"themes/next/source/images/cc-by-nd.svg","path":"images/cc-by-nd.svg","modified":0,"renderable":1},{"_id":"themes/next/source/images/cc-by-sa.svg","path":"images/cc-by-sa.svg","modified":0,"renderable":1},{"_id":"themes/next/source/images/cc-by.svg","path":"images/cc-by.svg","modified":0,"renderable":1},{"_id":"themes/next/source/images/cc-zero.svg","path":"images/cc-zero.svg","modified":0,"renderable":1},{"_id":"themes/next/source/images/favicon-16x16-next.png","path":"images/favicon-16x16-next.png","modified":0,"renderable":1},{"_id":"themes/next/source/images/favicon-32x32-next.png","path":"images/favicon-32x32-next.png","modified":0,"renderable":1},{"_id":"themes/next/source/images/loading.gif","path":"images/loading.gif","modified":0,"renderable":1},{"_id":"themes/next/source/images/logo.svg","path":"images/logo.svg","modified":0,"renderable":1},{"_id":"themes/next/source/images/placeholder.gif","path":"images/placeholder.gif","modified":0,"renderable":1},{"_id":"themes/next/source/images/quote-l.svg","path":"images/quote-l.svg","modified":0,"renderable":1},{"_id":"themes/next/source/images/quote-r.svg","path":"images/quote-r.svg","modified":0,"renderable":1},{"_id":"themes/next/source/images/searchicon.png","path":"images/searchicon.png","modified":0,"renderable":1},{"_id":"themes/next/source/js/src/affix.js","path":"js/src/affix.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/src/exturl.js","path":"js/src/exturl.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/src/algolia-search.js","path":"js/src/algolia-search.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/src/js.cookie.js","path":"js/src/js.cookie.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/src/next-boot.js","path":"js/src/next-boot.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/src/scroll-cookie.js","path":"js/src/scroll-cookie.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/src/motion.js","path":"js/src/motion.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/src/scrollspy.js","path":"js/src/scrollspy.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/src/utils.js","path":"js/src/utils.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/HELP-US-OUT.txt","path":"lib/font-awesome/HELP-US-OUT.txt","modified":0,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/bower.json","path":"lib/font-awesome/bower.json","modified":0,"renderable":1},{"_id":"themes/next/source/lib/velocity/velocity.min.js","path":"lib/velocity/velocity.min.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/velocity/velocity.ui.js","path":"lib/velocity/velocity.ui.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/velocity/velocity.ui.min.js","path":"lib/velocity/velocity.ui.min.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/src/post-details.js","path":"js/src/post-details.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/jquery/index.js","path":"lib/jquery/index.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/src/schemes/muse.js","path":"js/src/schemes/muse.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/src/schemes/pisces.js","path":"js/src/schemes/pisces.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/css/font-awesome.css.map","path":"lib/font-awesome/css/font-awesome.css.map","modified":0,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/css/font-awesome.min.css","path":"lib/font-awesome/css/font-awesome.min.css","modified":0,"renderable":1},{"_id":"themes/next/source/lib/velocity/velocity.js","path":"lib/velocity/velocity.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/css/font-awesome.css","path":"lib/font-awesome/css/font-awesome.css","modified":0,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.woff","path":"lib/font-awesome/fonts/fontawesome-webfont.woff","modified":0,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.eot","path":"lib/font-awesome/fonts/fontawesome-webfont.eot","modified":0,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.woff2","path":"lib/font-awesome/fonts/fontawesome-webfont.woff2","modified":0,"renderable":1}],"Cache":[{"_id":"source/CNAME","hash":"a7f5c29970d21031ddb3d4e17baeae14b9fdcd81","modified":1554032309969},{"_id":"source/robots.txt","hash":"deaa41da798ff6d14f3e958d984184e2f844cd61","modified":1548059906858},{"_id":"themes/next/.all-contributorsrc","hash":"d139a3b623b2e40bbff5c96ad44adf7dbdbc5be1","modified":1553951765487},{"_id":"themes/next/.eslintrc.json","hash":"cc5f297f0322672fe3f684f823bc4659e4a54c41","modified":1553951693515},{"_id":"themes/next/.gitattributes","hash":"44bd4729c74ccb88110804f41746fec07bf487d4","modified":1553951693515},{"_id":"themes/next/.bowerrc","hash":"3228a58ed0ece9f85e1e3136352094080b8dece1","modified":1553951693515},{"_id":"themes/next/.gitignore","hash":"3558a8b174618c7a643aceb13233edd729813f9a","modified":1553951765499},{"_id":"themes/next/.editorconfig","hash":"792fd2bd8174ece1a75d5fd24ab16594886f3a7f","modified":1553951693515},{"_id":"themes/next/.travis.yml","hash":"3d1dc928c4a97933e64379cfde749dedf62f252c","modified":1553951693531},{"_id":"themes/next/.stylintrc","hash":"b28e24704a5d8de08346c45286574c8e76cc109f","modified":1553951693531},{"_id":"themes/next/LICENSE.md","hash":"18144d8ed58c75af66cb419d54f3f63374cd5c5b","modified":1553951693531},{"_id":"themes/next/README.md","hash":"e4ce2d74be2083d530c243b97e61523fa5ba53d0","modified":1553951765499},{"_id":"themes/next/bower.json","hash":"1be57277396806031619b0f625cbeba0224a7cb5","modified":1553951765503},{"_id":"themes/next/_config.yml","hash":"011636dcdc50a2a100437a3be324701f583caf5f","modified":1557539076052},{"_id":"themes/next/crowdin.yml","hash":"e026078448c77dcdd9ef50256bb6635a8f83dca6","modified":1553951693535},{"_id":"themes/next/gulpfile.coffee","hash":"48d2f9fa88a4210308fc41cc7d3f6d53989f71b7","modified":1553951693567},{"_id":"themes/next/package.json","hash":"f3b4ef65214cec9c37acd10ef080526fb1ea14bb","modified":1553951693723},{"_id":"source/404/index.md","hash":"d2cfaaeed018158b719595a90f452f9a35036bca","modified":1554019754102},{"_id":"source/about/index.md","hash":"3d81b0717d9107d4c963c06c070b71c0a7b8d773","modified":1577436117601},{"_id":"source/categories/index.md","hash":"18b0b2d04d81bf7a5e7c20e15aab5862ce42e107","modified":1553992861247},{"_id":"source/images/android-chrome-192x192.png","hash":"f2586e8205f0e329b030b66e781e2ab518f335cd","modified":1554168984187},{"_id":"source/images/android-chrome-192x192.png~","hash":"8c18dc3b881d6e17b0a37867fac008ffc4b20a37","modified":1554168982663},{"_id":"source/images/apple-touch-icon.png","hash":"e2363f483ba652a711d518e1d7800b7df846a1e1","modified":1554169090059},{"_id":"source/images/android-chrome-512x512.png","hash":"35ec8a062e680d2ef7af941b115d2a33d9bd9e0c","modified":1554169014691},{"_id":"source/images/android-chrome-512x512.png~","hash":"d6fe61a884538dbdeb7020c9dcaa87614b27f5d4","modified":1554169013331},{"_id":"source/images/browserconfig.xml","hash":"974aea18bda5a95802c06b80126ab1d96d91d708","modified":1545852596000},{"_id":"source/images/apple-touch-icon.png~","hash":"eb2d2a1a8b45e5166207d09078b1195459160de9","modified":1554169088607},{"_id":"source/images/favicon-16x16.png","hash":"e953c4b1c7c9c4b74f32c2b96f08eb5366929a55","modified":1554168930431},{"_id":"source/images/favicon-16x16.png~","hash":"e3c983d982b8d66d27ffad5ec80031e56bc03a71","modified":1554168929151},{"_id":"source/images/favicon-32x32.png","hash":"c91982594e125d34fe002ba37898de270b249c97","modified":1554168957007},{"_id":"source/images/favicon-32x32.png~","hash":"f075fa88abf29c71b84f170d48f374b6f58a4bcf","modified":1554168955667},{"_id":"source/images/mstile-150x150.png~","hash":"78d7460b9a8801285705f2855f81210b8fb6ffc2","modified":1554169049471},{"_id":"source/images/mstile-150x150.png","hash":"8435a82d919c3f406d782831ae637abfe077bc0b","modified":1554169050799},{"_id":"source/images/favicon.ico~","hash":"f7f66ff3d8646ca1b3eea27ed86ef427942ceaa3","modified":1554169171387},{"_id":"source/images/safari-pinned-tab.svg","hash":"52dc32c799e18b8b2dde8a678f205d26eeefa641","modified":1545852596000},{"_id":"source/images/site.webmanifest","hash":"eb0bb83c103c94ddf978cefed3ca3589a93f1605","modified":1545852596000},{"_id":"source/images/wechat-qcode.jpg","hash":"d47d7b6db0811e15879cbffe7beb6a44889187a4","modified":1554022182599},{"_id":"source/images/wechatpay.png~","hash":"299a7ec53cf424cdfd745c8c559a256c09139481","modified":1554022770560},{"_id":"source/images/wechatpay.png","hash":"eb072cdce73f47b43d6665239e0d0768d7560fbf","modified":1554022771920},{"_id":"source/images/whiteLogo.png","hash":"fc15a11db662f3eec8cecb85e169626f6d965eaf","modified":1553648530730},{"_id":"source/photos/index.md","hash":"d6e2d2952ef8622bd24b1907fcbcec6ffb28e0b2","modified":1554427454906},{"_id":"source/uploads/qrcode.jpg","hash":"d47d7b6db0811e15879cbffe7beb6a44889187a4","modified":1545839502647},{"_id":"themes/next/.github/CONTRIBUTING.md","hash":"5da167f821df7f3aba5d6fc4e3c67672641a4f38","modified":1553951765491},{"_id":"themes/next/.github/CODE_OF_CONDUCT.md","hash":"c149f003d03501565e7688915cd8f2e99fbf8f42","modified":1553951765487},{"_id":"source/tags/index.md","hash":"53e5d4a43fe85ef6b9415d8fe69b01d4a8fc90b0","modified":1545880129036},{"_id":"source/notebook/index.md","hash":"2f6380d62d8664cdc652981901cc55fa1d3fb759","modified":1554521714328},{"_id":"themes/next/.github/PULL_REQUEST_TEMPLATE.md","hash":"492b2c159d871e5b5d4c70d259f36e603afe192d","modified":1553951765495},{"_id":"themes/next/.github/ISSUE_TEMPLATE.md","hash":"00c25366764e6b9ccb40b877c60dc13b2916bbf7","modified":1553951693519},{"_id":"themes/next/.github/stale.yml","hash":"dbdbc897d0d959b1508c14211240bbfcdd1b7edc","modified":1553951765499},{"_id":"themes/next/docs/AGPL3.md","hash":"0d2b8c5fa8a614723be0767cc3bca39c49578036","modified":1553951693539},{"_id":"themes/next/docs/DATA-FILES.md","hash":"8e1962dd3e1b700169b3ae5bba43992f100651ce","modified":1553951693543},{"_id":"themes/next/docs/AUTHORS.md","hash":"7b24be2891167bdedb9284a682c2344ec63e50b5","modified":1553951693539},{"_id":"themes/next/docs/ALGOLIA-SEARCH.md","hash":"141e989844d0b5ae2e09fb162a280715afb39b0d","modified":1553951693539},{"_id":"themes/next/docs/INSTALLATION.md","hash":"2bbdd6c1751b2b42ce9b9335da420c6026a483e9","modified":1553951693543},{"_id":"themes/next/docs/UPDATE-FROM-5.1.X.md","hash":"ad57c168d12ba01cf144a1ea0627b2ffd1847d3e","modified":1553951693547},{"_id":"themes/next/docs/LICENSE.txt","hash":"368bf2c29d70f27d8726dd914f1b3211cae4bbab","modified":1553951693543},{"_id":"themes/next/docs/MATH.md","hash":"e6023505dcccaef0b856102543585a13fc6af0b1","modified":1553951693547},{"_id":"themes/next/docs/LEANCLOUD-COUNTER-SECURITY.md","hash":"212a36d57495990b5f56e46ca8dce1d76c199660","modified":1553951693543},{"_id":"themes/next/languages/id.yml","hash":"1c4868837f5109f1df863b04fe627352c31d404b","modified":1553951765519},{"_id":"themes/next/languages/de.yml","hash":"9e524b2bdfb848504b93a51c5650e76bba5fa9e0","modified":1553951765511},{"_id":"themes/next/languages/en.yml","hash":"bf61fe56bb85bb9b262405e443863d0e08d26bb0","modified":1554521642248},{"_id":"themes/next/languages/default.yml","hash":"bf61fe56bb85bb9b262405e443863d0e08d26bb0","modified":1554521642248},{"_id":"themes/next/languages/fr.yml","hash":"d37a5d82b499a2f082fe9bbf3ad9f11b36b6b837","modified":1553951765515},{"_id":"themes/next/languages/ja.yml","hash":"1dc35e436da6214cdb3c2ff44bc4a06d0be5b9a0","modified":1553951765519},{"_id":"themes/next/languages/it.yml","hash":"b30ff77ad8044e3b021a3b09187cd377dc789fd2","modified":1553951765519},{"_id":"themes/next/languages/ko.yml","hash":"20bfaa7600d35235996c18e5c13dcef89c119626","modified":1553951765519},{"_id":"themes/next/languages/nl.yml","hash":"1c44b3cb2f817808607f3bf6ef47f58ce7599995","modified":1553951765523},{"_id":"themes/next/languages/pt-BR.yml","hash":"08b913a5cf4cc160083069cb4dfb2d66eecd1218","modified":1553951765523},{"_id":"themes/next/languages/pt.yml","hash":"8ddac820e2c17b484b56c0da8881e142b10e221b","modified":1553951765523},{"_id":"themes/next/languages/tr.yml","hash":"c5f0c20743b1dd52ccb256050b1397d023e6bcd9","modified":1553951693579},{"_id":"themes/next/languages/uk.yml","hash":"1eb59e581568da9a81d6e20541b4ada5fc1c55c0","modified":1553951693583},{"_id":"themes/next/languages/ru.yml","hash":"db0644e738d2306ac38567aa183ca3e859a3980f","modified":1553951693579},{"_id":"themes/next/languages/vi.yml","hash":"ba7aff8f88e03f69a0acf7f1b90ee03e077ee88e","modified":1553951765527},{"_id":"themes/next/languages/zh-CN.yml","hash":"beadfb4979ea90614e24962367afc6be30a8b628","modified":1554521660260},{"_id":"themes/next/languages/zh-HK.yml","hash":"7903b96912c605e630fb695534012501b2fad805","modified":1553951693583},{"_id":"themes/next/languages/zh-TW.yml","hash":"6e6d2cd8f4244cb1b349b94904cb4770935acefd","modified":1553951693583},{"_id":"themes/next/layout/_layout.swig","hash":"74701fcf2303d59400587436ab4c244e04df7ad9","modified":1554122056162},{"_id":"themes/next/layout/category.swig","hash":"dda0e6b2139decaf5e865d22ec9d45fdb615a703","modified":1553951765579},{"_id":"themes/next/layout/index.swig","hash":"c2a3896c64e96790edc10426ef586b6186a87f46","modified":1554122051006},{"_id":"themes/next/layout/archive.swig","hash":"7e8f3a41a68e912f2b2aaba905d314306ccaf794","modified":1553951765579},{"_id":"themes/next/layout/page.swig","hash":"d8a6cbf6f611c5d68d5da430cb6dc7010ff2c7e0","modified":1553951765579},{"_id":"themes/next/scripts/merge-configs.js","hash":"33afe97284d34542015d358a720823feeebef120","modified":1553951693735},{"_id":"themes/next/scripts/merge.js","hash":"9130dabe6a674c54b535f322b17d75fe6081472f","modified":1553951693735},{"_id":"themes/next/layout/post.swig","hash":"f74929fd792541916eb25c2addfb35431be071ba","modified":1553951693719},{"_id":"themes/next/layout/schedule.swig","hash":"3268dd3d90d8b0e142cfa1a2ebb23355baeda148","modified":1553951693723},{"_id":"themes/next/layout/tag.swig","hash":"a6be69a90924c9d2f4d90fb4867234859bd2c2e9","modified":1553951765579},{"_id":"themes/next/test/.jshintrc","hash":"19f93d13d1689fe033c82eb2d5f3ce30b6543cc0","modified":1553951694099},{"_id":"themes/next/test/intern.js","hash":"11fa8a4f5c3b4119a179ae0a2584c8187f907a73","modified":1553951694103},{"_id":"themes/next/test/helpers.js","hash":"a1f5de25154c3724ffc24a91ddc576cdbd60864f","modified":1553951694103},{"_id":"source/images/avatar.jpg","hash":"1dcf22f54556832a157703ea0c0a72e149df94af","modified":1554004862156},{"_id":"source/images/favicon.ico","hash":"18ee3c26b177ceb961abd01f2c1ef004c4d53f11","modified":1554169171519},{"_id":"themes/next/source/fonts/.gitkeep","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1553951693987},{"_id":"source/_posts/en/LNMP.md","hash":"0a49424a15b13fb9be5ea747f46ce43e0e380e24","modified":1557798795042},{"_id":"source/_posts/en/dillinger.md","hash":"0adf93d9adfe96ed236c91b3a51e3ece4a5bb348","modified":1556500070656},{"_id":"source/_posts/en/about-config.md","hash":"c73df4c06bdd7480bbf823e44a037ffe0b39c8c2","modified":1556500070656},{"_id":"source/_posts/en/git reference.md","hash":"1437260cdf8249fbda038c99794b59ac220e008d","modified":1556500070656},{"_id":"source/_posts/en/fetch.md","hash":"9b90fa79507e33b32afab6bf51841df9637566ce","modified":1563353796109},{"_id":"source/_posts/en/install node.md","hash":"c26976858a4311ca4f741839bf396507fe631e0e","modified":1577616790000},{"_id":"source/_posts/en/koajs-Analysis.md","hash":"ccf5da07a326010fdbd4fb61582b916992cbc89c","modified":1556502965742},{"_id":"source/_posts/en/ssh reference.md","hash":"60f69f22a525aac06a4c017c5d0477cb2ab489e5","modified":1556500070656},{"_id":"source/_posts/en/redis.md","hash":"22b6aed24f481a3b125e8d1ae6024e833e557f98","modified":1558179646663},{"_id":"source/_posts/en/md reference.md","hash":"55b15b1dc52605ffc6695de934bc61f188484ecc","modified":1557538837006},{"_id":"source/_posts/en/ubuntu-reference.md","hash":"9bb5faca406e38c06b64ea0a711c5cdc253cef84","modified":1556500070656},{"_id":"source/_posts/zh-CN/Python初探.md","hash":"7a7f6d82b0019aa26ed69f0e714ec458c92848d6","modified":1563690684214},{"_id":"source/_posts/zh-CN/TensorFLow1-3文档中文翻译之1-0-0安装.md","hash":"7bba95529ce75478bb50424064a5636a31f16afe","modified":1556500070656},{"_id":"source/_posts/zh-CN/how-to-create-an-operating-system-操作记录.md","hash":"9d80c1d4934c05aa895e7386848d92ed48bdd3ba","modified":1556500070656},{"_id":"source/_posts/zh-CN/laravel环境配置过程记录.md","hash":"3cb2b3f370b02a9f14cfae84f97a5065532b03ea","modified":1556500070656},{"_id":"source/_posts/zh-CN/《在细雨中呼喊》一个积极的悲观主义者.md","hash":"50de5aeb7f3d6019e442304cdf225060a59b00fc","modified":1556500070656},{"_id":"source/_posts/zh-CN/《悬崖》的几处错误.md","hash":"04fb26379e63fda64f8bf0e6fab0cb7cb7e33534","modified":1556500070656},{"_id":"source/_posts/zh-CN/写博客.md","hash":"ffae312ddb4a5d4e59bf7edfeedc41183f807730","modified":1563352464585},{"_id":"source/_posts/zh-CN/《皖南事变》.md","hash":"2c5fb6146c6efa907a2e79286fdcaa7634523823","modified":1556500070656},{"_id":"source/_posts/zh-CN/一年，一度.md","hash":"fc82d8c2faabf0f2312fb498a5abcb88dfdbd0a6","modified":1556500070656},{"_id":"source/_posts/zh-CN/从心所欲，无欲则刚.md","hash":"8ec3975c0650e4129e2610fc0285e2f4ebcf2ceb","modified":1556500070656},{"_id":"source/_posts/zh-CN/多端构建工具使用分析.md","hash":"f1fa4adb709d975be091ed46e2caf57d6f1c619f","modified":1556500070656},{"_id":"source/_posts/zh-CN/凡是过往，皆为序章.md","hash":"7b01e7f98e2bac87cd8aa8bbcba19391641169b3","modified":1556500070656},{"_id":"source/_posts/zh-CN/反向编译wxapkg记录.md","hash":"b7c466b23d738d5b94032a039eb39d7e3fcc2838","modified":1556500070656},{"_id":"source/_posts/zh-CN/安装matlab.md","hash":"930293f37cc7bdb4dd19f4bbbdddc1ad1117db4b","modified":1556500070656},{"_id":"source/_posts/zh-CN/安装pthreads多线程扩展记录.md","hash":"900163d3baeb78e9d2e381b9f89198181c7603b7","modified":1556500070660},{"_id":"source/_posts/zh-CN/建立个人网站.md","hash":"535900ca94020be348443cbfd34f55914cc79e6c","modified":1556500070660},{"_id":"source/_posts/zh-CN/安装双系统记录.md","hash":"b7de1743dcd4070c752b57611cf1f0d9f4726b62","modified":1556500070660},{"_id":"source/_posts/zh-CN/微信小程序资料库需求的实现.md","hash":"d4fc7cebd17f503f9692dd715a51d88640c912bc","modified":1556500070660},{"_id":"source/_posts/zh-CN/微信小程序云开发之云函数外部请求.md","hash":"95e5aa884d9daa1ef2d840319894a196ffd1a1f6","modified":1556502633868},{"_id":"source/_posts/zh-CN/微信订阅号开发记录.md","hash":"18f5fb11b51a060cdd01a09e80d407059c3fc6ad","modified":1556500070660},{"_id":"source/_posts/zh-CN/持续集成.md","hash":"a4de31e4e65c231d544b7ec69ca383f8e170d161","modified":1557901482709},{"_id":"source/_posts/zh-CN/总有一种美好值得期待.md","hash":"992eddf616a240ed46cfae384e59362abcea5fcf","modified":1556500070660},{"_id":"source/_posts/zh-CN/第三方平台API(以易班为例)的使用记录.md","hash":"76a113503b9a8fe75c1e7f2f15b517492ed9f6f1","modified":1556500070660},{"_id":"source/_posts/zh-CN/扫描二维码分析.md","hash":"e9eb9d74bd3cb12dccc62be041aeffab1f6b8e3c","modified":1563353150471},{"_id":"source/_posts/zh-CN/本地“模拟”一台服务器记录.md","hash":"d6adbbc94880689c3072e97601ac0d2658ca24c6","modified":1556500070660},{"_id":"source/_posts/zh-CN/网络代理初探记录.md","hash":"cf6196d50303ecdeff769f70856ad24f4ea353c4","modified":1577607676000},{"_id":"source/_posts/zh-CN/观影《新世界》.md","hash":"2f5783a986469351d0106b71966c53936be1ce2a","modified":1556500070660},{"_id":"source/_posts/zh-CN/观《独行》.md","hash":"70ee6944a0187908b43853612db1bcf4cff8ec47","modified":1556500070660},{"_id":"source/_posts/zh-CN/越是进入一个深度，越是觉得能力撑不起野心。.md","hash":"33a3ea16b10ae71a8905ca177584cd2c6643d80a","modified":1556500070660},{"_id":"source/_posts/zh-CN/面试总结.md","hash":"09351df835aa88840d41843f447153791c1a62ae","modified":1563691838389},{"_id":"source/cdn/images/book.jpg","hash":"561f0e12467a3bd88942799f116dea9561327701","modified":1553591608982},{"_id":"source/cdn/images/fetch_github.png","hash":"594f97af3c6b28e27aaf33c86769bcb12f7ce1d1","modified":1555418920302},{"_id":"source/cdn/images/travis-ci.com.png","hash":"91321ed3eab1e317428870c1168c2f85a6aa62ec","modified":1557731312791},{"_id":"source/cdn/images/travis-ci.com.respositories.png","hash":"963862e20f53127e371a703c0a795025214034df","modified":1557731798365},{"_id":"source/cdn/images/travis-ci.org.png","hash":"dfccd39f9fbaf69f4d52beefd67c9ffa92bed4f3","modified":1557731350587},{"_id":"source/cdn/images/travis-ci.org.respositories.png","hash":"e994df5b269151184f04d74089d096af54772aee","modified":1557731862485},{"_id":"themes/next/.github/ISSUE_TEMPLATE/bug-report.md","hash":"c37a60580c901c79ccb22564b228a46e06207445","modified":1553951765491},{"_id":"themes/next/.github/ISSUE_TEMPLATE/non-english.md","hash":"0b0727ff4d5180ae67f930fb4f8e9488e33eda9f","modified":1553951765495},{"_id":"themes/next/.github/ISSUE_TEMPLATE/custom-issue-template.md","hash":"57e1e06e845193e80c7df4a4454af28352526f7a","modified":1553951765495},{"_id":"themes/next/.github/ISSUE_TEMPLATE/feature-request.md","hash":"07c423cce4157b8e2dbf60907ccbf3f18c4cf98a","modified":1553951765495},{"_id":"themes/next/docs/ru/INSTALLATION.md","hash":"6c5d69e94961c793da156217ecf1179e868d7ba1","modified":1553951693551},{"_id":"themes/next/docs/ru/DATA-FILES.md","hash":"d6d20f60f77a76c77f8e65d0c9adbd79d0274557","modified":1553951693551},{"_id":"themes/next/docs/ru/UPDATE-FROM-5.1.X.md","hash":"b1dd18d9b890b21718883ea1832e7e02a773104a","modified":1553951693555},{"_id":"themes/next/docs/ru/README.md","hash":"c5c01015821a88de16972b8c249d84235a22c1bc","modified":1553951765507},{"_id":"themes/next/docs/zh-CN/CODE_OF_CONDUCT.md","hash":"b218e30df4126b6adc87684775ac4c86ea7f7958","modified":1553951765507},{"_id":"themes/next/docs/zh-CN/INSTALLATION.md","hash":"b19a6e0ae96eb7c756fb5b1ba03934c7f9cbb3c3","modified":1553951693563},{"_id":"themes/next/docs/zh-CN/ALGOLIA-SEARCH.md","hash":"6855402e2ef59aae307e8bd2a990647d3a605eb8","modified":1553951693555},{"_id":"themes/next/docs/zh-CN/DATA-FILES.md","hash":"f3eec572a7d83542e2710a7404082014aaa1a5e7","modified":1553951693563},{"_id":"themes/next/docs/zh-CN/README.md","hash":"2c7a677b1670f42480b884d1a33cc2ca2eecfd69","modified":1553951765511},{"_id":"themes/next/docs/zh-CN/MATH.md","hash":"b76ccbc658024e86639cfa5f8a3817647fc8d651","modified":1553951693567},{"_id":"themes/next/docs/zh-CN/UPDATE-FROM-5.1.X.md","hash":"5da70d7fa0c988a66a469b9795d33d471a4a4433","modified":1553951693567},{"_id":"themes/next/layout/_custom/sidebar.swig","hash":"adc83b19e793491b1c6ea0fd8b46cd9f32e592fc","modified":1553951693587},{"_id":"themes/next/docs/zh-CN/LEANCLOUD-COUNTER-SECURITY.md","hash":"115ffbde2b3ce01ef1f8c2b3833e6f6794650132","modified":1553951693563},{"_id":"themes/next/layout/_custom/head.swig","hash":"9e1b9666efa77f4cf8d8261bcfa445a9ac608e53","modified":1553951693587},{"_id":"themes/next/layout/_custom/header.swig","hash":"adc83b19e793491b1c6ea0fd8b46cd9f32e592fc","modified":1553951693587},{"_id":"themes/next/layout/_macro/passage-end-tag.swig","hash":"9545bafb7f1ed8311d3da7a076cc0f2ecf82db7d","modified":1554083690800},{"_id":"themes/next/layout/_macro/post-collapse.swig","hash":"89b0a0e64637bf5b0cfea0a23642df3d95eedfa4","modified":1553951693595},{"_id":"themes/next/layout/_macro/sidebar.swig","hash":"4b109014bb9b4132010722184234ecfe364e5013","modified":1554124363774},{"_id":"themes/next/layout/_macro/post.swig","hash":"bb55564b6580ad06b16e7208604d6a659576fd72","modified":1554083784680},{"_id":"themes/next/layout/_scripts/exturl.swig","hash":"d359e638a86bd9664101c48e9344f21ec96e6a15","modified":1553951765547},{"_id":"themes/next/layout/_scripts/commons.swig","hash":"d66bc7ec3cc03f60fcc7d555368a5b9b010f7f11","modified":1553951693643},{"_id":"themes/next/layout/_scripts/noscript.swig","hash":"edaff4766e0c05fd5c889d9dd32884d376bef9d9","modified":1553951693647},{"_id":"themes/next/layout/_scripts/next-boot.swig","hash":"82032af75320f496ae40fce5d0781e05eb96453c","modified":1553951765547},{"_id":"themes/next/layout/_scripts/vendors.swig","hash":"83470eb401f78f4683907c48ad6760b90730daa3","modified":1553951765551},{"_id":"themes/next/layout/_scripts/scroll-cookie.swig","hash":"1b250c1b7945cb1029b9e855edb09854f7c8250a","modified":1553951765551},{"_id":"themes/next/layout/_third-party/baidu-push.swig","hash":"4ccf2abbfd070874265b0436a3eff21f7c998dfb","modified":1553951693679},{"_id":"themes/next/layout/_third-party/bookmark.swig","hash":"10b61a8bac671e375916a4d234c120117098a78f","modified":1553951693683},{"_id":"themes/next/layout/_third-party/chatra.swig","hash":"eefb68b69b4b0ed558ee0324ccd711990059b20d","modified":1553951765559},{"_id":"themes/next/layout/_third-party/copy-code.swig","hash":"01ded5e1bad89a6f8d64cd063e3e4e42c20d33bc","modified":1553951765567},{"_id":"themes/next/layout/_third-party/mermaid.swig","hash":"d6e6ddda836bd9e2e8d9767a910c7d3280080e81","modified":1553951765571},{"_id":"themes/next/layout/_third-party/needsharebutton.swig","hash":"2c4a66be4677d3e4dec3f169ac8a769098dad1fe","modified":1553951693703},{"_id":"themes/next/layout/_third-party/quicklink.swig","hash":"5db80e8d7ea3f29e998320f79508f7e14342a33c","modified":1553951765575},{"_id":"themes/next/layout/_third-party/pangu.swig","hash":"c28f9dc96ab735daeb7f599f86470aa5a83c03cf","modified":1553951693707},{"_id":"themes/next/layout/_third-party/rating.swig","hash":"cbe40cb67dad15ade967b0f396c1a95b6871f76a","modified":1553951693707},{"_id":"themes/next/layout/_third-party/pdf.swig","hash":"810a9b2a6059f46c4a2ddb178f1eaa4c5e23750b","modified":1553951765575},{"_id":"themes/next/layout/_third-party/schedule.swig","hash":"2398e5cd0cb466953b6e7a42c2b2caddebf3c348","modified":1553951693711},{"_id":"themes/next/layout/_third-party/tidio.swig","hash":"912368c41de675f458b267a49a99ae3e7e420ebb","modified":1553951765575},{"_id":"themes/next/layout/_partials/footer.swig","hash":"07f88421bda86d9d5ff32d130b1cb1196b99a326","modified":1553951693603},{"_id":"themes/next/layout/_partials/github-banner.swig","hash":"6357537ac0bb114aed4d61bafb39e6690a413697","modified":1553951765535},{"_id":"themes/next/layout/_partials/comments.swig","hash":"5352f96f4544c1520babf1cec7b44ddf2f8057b3","modified":1553951765535},{"_id":"themes/next/scripts/filters/exturl.js","hash":"79ad823ca803cb00e0bfc648aa6c9d59711e0519","modified":1553951693731},{"_id":"themes/next/scripts/helpers/engine.js","hash":"60eb1554456d9d0e5afc4a2d16f1580a0aa02da8","modified":1553951693731},{"_id":"themes/next/scripts/helpers/next-url.js","hash":"799a042bbf497a4c7a2981aa2014ff28fa1bb382","modified":1553951693735},{"_id":"themes/next/layout/_partials/post-edit.swig","hash":"06dac109504812b63766a80ede9ddacbd42d227d","modified":1553951693623},{"_id":"themes/next/layout/_partials/pagination.swig","hash":"dbe321bcf3cf45917cc11a3e3f50d8572bac2c70","modified":1553951693623},{"_id":"themes/next/scripts/tags/button.js","hash":"f3b4f7ae7e58072bbf410d950a99a0b53cbc866d","modified":1553951765583},{"_id":"themes/next/scripts/tags/center-quote.js","hash":"f13430d9d1c9773b390787c2f046bb1f12a79878","modified":1553951693739},{"_id":"themes/next/scripts/tags/exturl.js","hash":"46d05103e9981870d796282491ee4c0de89aba96","modified":1553951765599},{"_id":"themes/next/scripts/tags/full-image.js","hash":"fcb41c1c81560ed49dc4024654388a28ee7d32b0","modified":1553951765599},{"_id":"themes/next/scripts/tags/group-pictures.js","hash":"598220fa92ff3540dcab74f633ba41523daa8364","modified":1553951765603},{"_id":"themes/next/scripts/tags/include-raw.js","hash":"5db59d56f4f4082382bf1c16722e6c383892b0c5","modified":1553951693743},{"_id":"themes/next/scripts/tags/label.js","hash":"fc5b267d903facb7a35001792db28b801cccb1f8","modified":1553951765603},{"_id":"themes/next/scripts/tags/mermaid.js","hash":"983c6c4adea86160ecc0ba2204bc312aa338121d","modified":1553951765603},{"_id":"themes/next/scripts/tags/note.js","hash":"0a02bb4c15aec41f6d5f1271cdb5c65889e265d9","modified":1553951765607},{"_id":"themes/next/scripts/tags/pdf.js","hash":"f780cc72bff91d2720626e7af69eed25e9c12a29","modified":1553951765611},{"_id":"themes/next/scripts/tags/tabs.js","hash":"00ca6340d4fe0ccdae7525373e4729117775bbfa","modified":1553951765611},{"_id":"themes/next/scripts/tags/video.js","hash":"e5ff4c44faee604dd3ea9db6b222828c4750c227","modified":1553951765611},{"_id":"themes/next/source/css/main.styl","hash":"e010ec8ac73268a0f137204c89e0080ab8d59b3d","modified":1553951693983},{"_id":"themes/next/source/images/algolia_logo.svg","hash":"ec119560b382b2624e00144ae01c137186e91621","modified":1553951693987},{"_id":"themes/next/source/images/apple-touch-icon-next.png","hash":"2959dbc97f31c80283e67104fe0854e2369e40aa","modified":1553951693991},{"_id":"themes/next/source/images/avatar.gif","hash":"264082bb3a1af70d5499c7d22b0902cb454b6d12","modified":1553951693991},{"_id":"themes/next/source/images/cc-by-nc-nd.svg","hash":"c6524ece3f8039a5f612feaf865d21ec8a794564","modified":1553951693991},{"_id":"themes/next/source/images/cc-by-nc-sa.svg","hash":"3031be41e8753c70508aa88e84ed8f4f653f157e","modified":1553951693995},{"_id":"themes/next/source/images/cc-by-nc.svg","hash":"8d39b39d88f8501c0d27f8df9aae47136ebc59b7","modified":1553951693995},{"_id":"themes/next/source/images/cc-by-nd.svg","hash":"c563508ce9ced1e66948024ba1153400ac0e0621","modified":1553951693995},{"_id":"themes/next/source/images/cc-by-sa.svg","hash":"aa4742d733c8af8d38d4c183b8adbdcab045872e","modified":1553951693995},{"_id":"themes/next/source/images/cc-by.svg","hash":"28a0a4fe355a974a5e42f68031652b76798d4f7e","modified":1553951693999},{"_id":"themes/next/source/images/cc-zero.svg","hash":"87669bf8ac268a91d027a0a4802c92a1473e9030","modified":1553951693999},{"_id":"themes/next/source/images/favicon-16x16-next.png","hash":"943a0d67a9cdf8c198109b28f9dbd42f761d11c3","modified":1553951694003},{"_id":"themes/next/source/images/favicon-32x32-next.png","hash":"0749d7b24b0d2fae1c8eb7f671ad4646ee1894b1","modified":1553951694003},{"_id":"themes/next/source/images/loading.gif","hash":"5fbd472222feb8a22cf5b8aa5dc5b8e13af88e2b","modified":1553951694003},{"_id":"themes/next/source/images/logo.svg","hash":"d29cacbae1bdc4bbccb542107ee0524fe55ad6de","modified":1553951694003},{"_id":"themes/next/source/images/placeholder.gif","hash":"5fbd472222feb8a22cf5b8aa5dc5b8e13af88e2b","modified":1553951694003},{"_id":"themes/next/source/images/quote-l.svg","hash":"94e870b4c8c48da61d09522196d4dd40e277a98f","modified":1553951694007},{"_id":"themes/next/source/images/quote-r.svg","hash":"e60ae504f9d99b712c793c3740c6b100d057d4ec","modified":1553951694011},{"_id":"themes/next/source/images/searchicon.png","hash":"67727a6a969be0b2659b908518fa6706eed307b8","modified":1553951694011},{"_id":"source/cdn/images/mp.weixin.2.png","hash":"7327fc437e2322f1589e8e4a7df5f48e85b5b10d","modified":1557549012447},{"_id":"source/cdn/images/mp.weixin.cookie.1.png","hash":"ec3c33b2d95c71ba84a641a65491d0ef51c24065","modified":1557541027824},{"_id":"source/cdn/images/mp.weixin.cookie.png","hash":"0d9036927b5d0874db9db9e63a455fff793a81cf","modified":1557538733758},{"_id":"themes/next/docs/zh-CN/CONTRIBUTING.md","hash":"6c39111ab8937015ff3fd27d8d4519118a50daae","modified":1553951765507},{"_id":"themes/next/source/css/_mixins/Mist.styl","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1553951693923},{"_id":"themes/next/source/css/_mixins/Muse.styl","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1553951693923},{"_id":"themes/next/source/css/_mixins/custom.styl","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1553951693927},{"_id":"themes/next/source/css/_variables/Muse.styl","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1553951693979},{"_id":"themes/next/source/css/_variables/custom.styl","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1553951693983},{"_id":"themes/next/layout/_macro/menu/menu-badge.swig","hash":"65c5e585982dae7ae1542cada71858b4ea1f73d6","modified":1553951693591},{"_id":"themes/next/layout/_macro/menu/menu-item.swig","hash":"fb33f499022cd02722f834fcef1a0e193362cfde","modified":1553951693595},{"_id":"themes/next/layout/_scripts/pages/post-details.swig","hash":"c7f2855f19dfdf18aba8c58d55b7489e631ed035","modified":1553951693647},{"_id":"themes/next/layout/_scripts/schemes/muse.swig","hash":"be24f204a515d5211bf3ba98a030e3bf61d4cc16","modified":1553951693655},{"_id":"themes/next/layout/_scripts/schemes/gemini.swig","hash":"ffc8e8836714ea79abeb77b75859634615652877","modified":1553951693651},{"_id":"themes/next/layout/_scripts/schemes/mist.swig","hash":"108b157fbd1ac3baaf19ae87234fa8728ab79556","modified":1553951693651},{"_id":"themes/next/layout/_scripts/schemes/pisces.swig","hash":"94e106755c5fb6f40431b621beeba0bd33877e57","modified":1553951693655},{"_id":"themes/next/layout/_third-party/analytics/application-insights.swig","hash":"798d67e4a736613ab899eabe6529091bbcda7850","modified":1553951693663},{"_id":"themes/next/layout/_third-party/analytics/baidu-analytics.swig","hash":"591b2ccd9713ccb922b9fcf5e278b6de9c5ec30b","modified":1553951693663},{"_id":"themes/next/layout/_third-party/analytics/analytics-with-widget.swig","hash":"a5723950c343d220270bfd27bd30050eda6c3fb3","modified":1553951693663},{"_id":"themes/next/layout/_third-party/analytics/busuanzi-counter.swig","hash":"8eadb929c9e50e58502ccad2dc2657746f8c592a","modified":1553951693667},{"_id":"themes/next/layout/_third-party/analytics/cnzz-analytics.swig","hash":"08cd47ef8572121b7811342d3c9a84a338a18191","modified":1553951693667},{"_id":"themes/next/layout/_third-party/analytics/firestore.swig","hash":"fae69a0e1a1d42f7bb44e594a29857d94594698b","modified":1553951693671},{"_id":"themes/next/layout/_third-party/analytics/facebook-sdk.swig","hash":"050ea01f25cfe492be9bb77b409644d623fdf2dc","modified":1553951693667},{"_id":"themes/next/layout/_third-party/analytics/index.swig","hash":"438c6f5e6665d72f4ea7ee206011d669246f6102","modified":1553951693675},{"_id":"themes/next/layout/_third-party/analytics/growingio.swig","hash":"4a966b7ffe2d80ff1b3dd0fd14b355766dc5c70f","modified":1553951693675},{"_id":"themes/next/layout/_third-party/analytics/google-analytics.swig","hash":"d422beaf35a5d2646feaa098bc3e5adf691c7565","modified":1553951765555},{"_id":"themes/next/layout/_third-party/analytics/lean-analytics.swig","hash":"c754f699c90f6278b9159eff1855c17bc713ee96","modified":1553951693675},{"_id":"themes/next/layout/_third-party/analytics/vkontakte-api.swig","hash":"0dd5b315d1da55dbfc10f51a1f8952f72eba2720","modified":1553951765555},{"_id":"themes/next/layout/_third-party/analytics/tencent-mta.swig","hash":"92e04a2b9e0c3df594bc22235d1894e5ad458dfc","modified":1553951693679},{"_id":"themes/next/layout/_third-party/analytics/tencent-analytics.swig","hash":"f240a50cd9b627620d9a374a29cf95f0c5e99d7c","modified":1553951693679},{"_id":"themes/next/layout/_third-party/comments/changyan.swig","hash":"3533167c4295637b91d90f3bae7c651cd128bb6e","modified":1553951693687},{"_id":"themes/next/layout/_third-party/comments/disqus.swig","hash":"3cfeafefc672d9a7704650ebfb2f9d8668b38d9a","modified":1553951693687},{"_id":"themes/next/layout/_third-party/comments/disqusjs.swig","hash":"c77a2e7ef5f449a445fb4d36b055721fba4a81af","modified":1553951765559},{"_id":"themes/next/layout/_third-party/comments/gitment.swig","hash":"388efc86af7f19c05ad0e26720cd24ee012d20b9","modified":1553951765563},{"_id":"themes/next/layout/_third-party/comments/gitalk.swig","hash":"e8f91c571ceb4b80aafebc4d36b89fb41b1ae040","modified":1553951765563},{"_id":"themes/next/layout/_third-party/comments/index.swig","hash":"2cbaae65a020bbb0e9265364488aff8bf84fa48d","modified":1553951765567},{"_id":"themes/next/layout/_third-party/comments/livere.swig","hash":"5856d5f701e51dfae1fd6fb486cefde67effd555","modified":1553951693695},{"_id":"themes/next/layout/_third-party/comments/valine.swig","hash":"4a908b613518878b9b69576c5dba4a5185f552ab","modified":1553951765567},{"_id":"themes/next/layout/_third-party/math/katex.swig","hash":"c2cb2f384bc30d31cdccf9794a729c03e687b45c","modified":1553951693699},{"_id":"themes/next/layout/_third-party/math/mathjax.swig","hash":"601774d8672577aefbcefac82c94b01f0338da31","modified":1553951765571},{"_id":"themes/next/layout/_third-party/search/algolia-search.swig","hash":"cd86bed852fec6e6933898067122a03755bc17f0","modified":1553951693711},{"_id":"themes/next/layout/_third-party/search/index.swig","hash":"ea94aa85034c6d1b6bb865aecea55c73f8a14501","modified":1553951693715},{"_id":"themes/next/layout/_third-party/search/localsearch.swig","hash":"b3eaab6a269aa3fcbafe24fd06f0c9206dc12716","modified":1553951693715},{"_id":"themes/next/layout/_partials/head/external-fonts.swig","hash":"fc6bafc8c633afadc538c5afa5620ea2a1cdcb84","modified":1553951693607},{"_id":"themes/next/layout/_partials/header/brand.swig","hash":"648bf7eda66629592cb915c4004534b3913cbc22","modified":1553951765543},{"_id":"themes/next/layout/_partials/head/head-unique.swig","hash":"02bb5748e8540b024e7f4008a9e640890b45280f","modified":1553951765539},{"_id":"themes/next/layout/_partials/header/index.swig","hash":"2082f5077551123e695e8afec471c9c44b436acb","modified":1553951693615},{"_id":"themes/next/layout/_third-party/math/index.swig","hash":"a7e304b05a44279d3e4f611908d7faef9dc14d7c","modified":1553951693699},{"_id":"themes/next/layout/_partials/head/head.swig","hash":"36eae78a4d7160a1c5e59ca3f7333f00b43d359b","modified":1553951765539},{"_id":"themes/next/layout/_partials/header/sub-menu.swig","hash":"5adc60100e129c1d0307bdcaa0c7b8e8375a6ea4","modified":1553951693615},{"_id":"themes/next/layout/_partials/header/menu.swig","hash":"71af31fea5913fd30c233e555ef13cf2c9768f72","modified":1553951693615},{"_id":"themes/next/layout/_partials/page/page-header.swig","hash":"2940df694fff28e8bf71b6546b4162f1e38227db","modified":1553951693623},{"_id":"themes/next/layout/_partials/page/breadcrumb.swig","hash":"69722be16ce5eae5c027168f9b2fded4776e1b53","modified":1553951693619},{"_id":"themes/next/layout/_partials/post/post-copyright.swig","hash":"3615db591dd910fb9fa96542734c7ec0ef05019c","modified":1553951693627},{"_id":"themes/next/layout/_partials/post/post-related.swig","hash":"eea95b785c9c36d28e1839619793f66e89773bee","modified":1553951693627},{"_id":"themes/next/layout/_partials/post/reward.swig","hash":"d44f025eb93c99ddf90202d8293ccf80689a00c7","modified":1553951765543},{"_id":"themes/next/layout/_partials/post/wechat-subscriber.swig","hash":"ef11b5be5bfb2f0affe82cf521c002b37fef9819","modified":1553951693627},{"_id":"themes/next/layout/_partials/search/algolia-search.swig","hash":"ba698f49dd3a868c95b240d802f5b1b24ff287e4","modified":1553951693631},{"_id":"themes/next/layout/_partials/search/index.swig","hash":"7d1693416a5dc098f4723a53da2e2d1fc2d6e075","modified":1553951693631},{"_id":"themes/next/layout/_partials/search/localsearch.swig","hash":"957701729b85fb0c5bfcf2fb99c19d54582f91ed","modified":1553951693635},{"_id":"themes/next/layout/_partials/search/swiftype.swig","hash":"a5587bd1f60d35e58618576cec45e662aa44ea1f","modified":1553951693635},{"_id":"themes/next/layout/_partials/share/baidushare.swig","hash":"6f181cc188ecbe5e607fd989756e470d4cb9765d","modified":1553951693639},{"_id":"themes/next/layout/_partials/share/likely.swig","hash":"b45e934d24d76ec6b6a790e92bdb3d56186b0e2a","modified":1553951765547},{"_id":"themes/next/layout/_partials/share/add-this.swig","hash":"15b542f5b06b7532234af367340b9ed9fcebb0ac","modified":1553951693639},{"_id":"themes/next/source/css/_mixins/Gemini.styl","hash":"2aa5b7166a85a8aa34b17792ae4f58a5a96df6cc","modified":1553951693919},{"_id":"themes/next/source/css/_custom/custom.styl","hash":"328d9a9696cc2ccf59c67d3c26000d569f46344c","modified":1553951693915},{"_id":"themes/next/source/css/_mixins/Pisces.styl","hash":"2e8fb29aa92325df39054b5450757858c6cebc41","modified":1553951765803},{"_id":"themes/next/source/css/_mixins/base.styl","hash":"bb744c9264e8e79ae96431a5463f65fe8de5828a","modified":1553951765803},{"_id":"themes/next/source/css/_variables/Gemini.styl","hash":"a8aa41625b94cf17a7f473ed10dcbe683b1db705","modified":1553951693975},{"_id":"themes/next/source/css/_variables/Mist.styl","hash":"be087dcc060e8179f7e7f60ab4feb65817bd3d9f","modified":1553951693975},{"_id":"themes/next/source/css/_variables/Pisces.styl","hash":"fc15e277d1504532a09b7b1bd31f900ad95ec4b8","modified":1553951693979},{"_id":"themes/next/source/js/src/affix.js","hash":"a2aab233d99297435a5274bf512c3c753fe08e80","modified":1553951694015},{"_id":"themes/next/source/js/src/exturl.js","hash":"54825acc8de4793feac415be227b965428f4e97d","modified":1553951694023},{"_id":"themes/next/source/js/src/algolia-search.js","hash":"1f7f10c579e7703d0f6acb8b73f3d78a07d0c623","modified":1553951694015},{"_id":"themes/next/source/js/src/js.cookie.js","hash":"e0afce539f1fb81d59e3c6f0a68d736e2fb45d93","modified":1553951765839},{"_id":"themes/next/source/js/src/next-boot.js","hash":"e0615efab5f81ba0fd39c0527eac31144deac7ce","modified":1553951765843},{"_id":"themes/next/source/js/src/scroll-cookie.js","hash":"d07b3776708d4ae79ed2037c4c7391d5c9b06b19","modified":1553951694043},{"_id":"themes/next/source/js/src/motion.js","hash":"a16bc0b701646bf6653484675f4d5dc0f892d184","modified":1553951765843},{"_id":"themes/next/source/js/src/scrollspy.js","hash":"fa3c92968bcdbcb8d95a1729f7659d9753cbd077","modified":1553951694047},{"_id":"themes/next/source/js/src/utils.js","hash":"703375f367acfbd0596733c34437d1b2681abf72","modified":1553951765843},{"_id":"themes/next/source/lib/font-awesome/.gitignore","hash":"69d152fa46b517141ec3b1114dd6134724494d83","modified":1553951694055},{"_id":"themes/next/source/lib/font-awesome/.bower.json","hash":"a2aaaf12378db56bd10596ba3daae30950eac051","modified":1553951694055},{"_id":"themes/next/source/lib/font-awesome/.npmignore","hash":"dcf470ab3a358103bb896a539cc03caeda10fa8b","modified":1553951694059},{"_id":"themes/next/source/lib/font-awesome/HELP-US-OUT.txt","hash":"4f7bf961f1bed448f6ba99aeb9219fabf930ba96","modified":1553951694059},{"_id":"themes/next/source/lib/font-awesome/bower.json","hash":"279a8a718ab6c930a67c41237f0aac166c1b9440","modified":1553951694059},{"_id":"themes/next/source/lib/velocity/velocity.min.js","hash":"2f1afadc12e4cf59ef3b405308d21baa97e739c6","modified":1553951694095},{"_id":"themes/next/source/lib/velocity/velocity.ui.js","hash":"6a1d101eab3de87527bb54fcc8c7b36b79d8f0df","modified":1553951694095},{"_id":"source/cdn/images/csdn.png","hash":"6598c117cbfb8da6991d6b8bad196f02ebcf2589","modified":1557737481716},{"_id":"themes/next/source/lib/velocity/velocity.ui.min.js","hash":"ed5e534cd680a25d8d14429af824f38a2c7d9908","modified":1553951694095},{"_id":"themes/next/source/js/src/post-details.js","hash":"0dde5e6d4547587662a3256317a9d5d1db507692","modified":1553951694031},{"_id":"themes/next/source/css/_variables/base.styl","hash":"d0e97b205d3320421c380f2eee445457430c8152","modified":1553951693983},{"_id":"themes/next/source/lib/jquery/index.js","hash":"41b4bfbaa96be6d1440db6e78004ade1c134e276","modified":1553951694087},{"_id":"themes/next/source/css/_common/components/back-to-top.styl","hash":"8175b9a275d04718f6caf6dc6ae483035ad71b0c","modified":1553951765623},{"_id":"themes/next/source/css/_common/components/buttons.styl","hash":"b98c65006e2546fbf3870c16fbbcbc009dbaab15","modified":1553951765623},{"_id":"themes/next/source/css/_common/components/comments.styl","hash":"471f1627891aca5c0e1973e09fbcb01e1510d193","modified":1553951693763},{"_id":"themes/next/source/css/_common/components/components.styl","hash":"9d71f34fa13a41b8c8cd2fbdf3fdea608385277c","modified":1553951765627},{"_id":"themes/next/source/css/_common/components/pagination.styl","hash":"ce826aedf42b9eca424a044452f5d193866726a6","modified":1553951765671},{"_id":"themes/next/source/css/_common/components/scrollbar.styl","hash":"d7b8bcf2a6031296c84bb4f4ecfb037af01d2d82","modified":1553951765715},{"_id":"themes/next/source/css/_common/components/rainbow.styl","hash":"ce2aae8f3ed8ceac3a2417e0481044cf69c788aa","modified":1553951765711},{"_id":"themes/next/source/css/_common/outline/outline.styl","hash":"7e51ea64611ab5d678c112b4688d4db4fd2737e2","modified":1553951693903},{"_id":"themes/next/source/css/_common/scaffolding/helpers.styl","hash":"8e0740a9ad349ce5555122325da872923135a698","modified":1553951765795},{"_id":"themes/next/source/css/_common/scaffolding/normalize.styl","hash":"7ffde343bdf10add1f052f3c4308a15180eb4404","modified":1553951765799},{"_id":"themes/next/source/css/_common/scaffolding/mobile.styl","hash":"bb9b753d3cc3a816340bd697512a83e757f907fb","modified":1553951765795},{"_id":"themes/next/source/css/_common/scaffolding/base.styl","hash":"6d900b4159eeb869196a619602578bf4d83a117b","modified":1553951765791},{"_id":"themes/next/source/css/_common/scaffolding/tables.styl","hash":"6b3340cf57725b312830b9ce377c9e087ba59297","modified":1553951765799},{"_id":"themes/next/source/css/_common/scaffolding/scaffolding.styl","hash":"a280a583b7615e939aaddbf778f5c108ef8a2a6c","modified":1553951693911},{"_id":"themes/next/source/css/_common/components/back-to-top-sidebar.styl","hash":"7729491514f8ccdf96777de8f71420e6873c5423","modified":1553951765619},{"_id":"themes/next/source/css/_schemes/Gemini/index.styl","hash":"9a2d298dbdcbfd758518fd74b63897bc80ce15a5","modified":1553951765807},{"_id":"themes/next/source/css/_schemes/Mist/_header.styl","hash":"24230e46fc9fb7b8551f97bb36e9bc1f7423098e","modified":1553951765811},{"_id":"themes/next/source/css/_schemes/Mist/_base.styl","hash":"0bef9f0dc134215bc4d0984ba3a16a1a0b6f87ec","modified":1553951693935},{"_id":"themes/next/source/css/_schemes/Mist/_logo.styl","hash":"38e5df90c8689a71c978fd83ba74af3d4e4e5386","modified":1553951693935},{"_id":"themes/next/source/css/_schemes/Mist/_menu.styl","hash":"75d2d92af070eb10273558b2436972d3f12b361c","modified":1553951765811},{"_id":"themes/next/source/css/_schemes/Mist/_posts-expanded.styl","hash":"fa33213aceed7bf4bf25437ca9c1a00f7734ae65","modified":1553951693939},{"_id":"themes/next/source/css/_schemes/Mist/index.styl","hash":"a96e46a6ae86c423f932bc2bc78b9f7453e4e4e5","modified":1553951765815},{"_id":"themes/next/source/css/_schemes/Muse/_layout.styl","hash":"6565b4a309325596768d0d32e022c80ef23066cb","modified":1553951765819},{"_id":"themes/next/source/css/_schemes/Mist/_search.styl","hash":"7359880e8d85312861fe0871f58b662e627dae0c","modified":1553951765815},{"_id":"themes/next/source/css/_schemes/Muse/_logo.styl","hash":"fc160583f742c94316a0fee05c18468033173534","modified":1553951693955},{"_id":"themes/next/source/css/_schemes/Muse/index.styl","hash":"a0e2030a606c934fb2c5c7373aaae04a1caac4c5","modified":1553951765827},{"_id":"themes/next/source/css/_schemes/Muse/_search.styl","hash":"7359880e8d85312861fe0871f58b662e627dae0c","modified":1553951765823},{"_id":"themes/next/source/css/_schemes/Muse/_menu.styl","hash":"1edf4e69d0ec0dc9cefed6c35d3e803e0da4093d","modified":1553951765823},{"_id":"themes/next/source/css/_schemes/Pisces/_layout.styl","hash":"75737591682a2bafa71db4c03fb79e970ac0e7aa","modified":1553951765831},{"_id":"themes/next/source/css/_schemes/Pisces/_menu.styl","hash":"b6dac5bbf20f090cf4b67d156f030d7170dfb39c","modified":1553951765831},{"_id":"themes/next/source/css/_schemes/Pisces/_brand.styl","hash":"57044a6d19eb418c1c3d28787e82c69efa9e0ca6","modified":1553951765827},{"_id":"themes/next/source/css/_schemes/Pisces/_sidebar.styl","hash":"6400c98a9fd2b9a8502269f33355bd7ab3ff793b","modified":1553951765835},{"_id":"themes/next/source/css/_schemes/Pisces/index.styl","hash":"232aedbd44243b3b80c4503c947060d3269c1afc","modified":1553951765835},{"_id":"themes/next/source/css/_schemes/Pisces/_sub-menu.styl","hash":"b5b936dddb7b4de4720cd1e8428b30a2f06d63fb","modified":1553951693971},{"_id":"themes/next/source/js/src/schemes/muse.js","hash":"e9bfa6b343b67625f58757efce46ccdaac8f308c","modified":1553951694039},{"_id":"themes/next/source/js/src/schemes/pisces.js","hash":"9eb63cba0327d3d11b6cbfcbe40b88e97a8378a3","modified":1553951694043},{"_id":"themes/next/source/lib/font-awesome/css/font-awesome.css.map","hash":"0189d278706509412bac4745f96c83984e1d59f4","modified":1553951694067},{"_id":"themes/next/source/lib/font-awesome/css/font-awesome.min.css","hash":"512c7d79033e3028a9be61b540cf1a6870c896f8","modified":1553951694067},{"_id":"themes/next/source/lib/velocity/velocity.js","hash":"9f08181baea0cc0e906703b7e5df9111b9ef3373","modified":1553951694091},{"_id":"themes/next/source/lib/font-awesome/css/font-awesome.css","hash":"0140952c64e3f2b74ef64e050f2fe86eab6624c8","modified":1553951694063},{"_id":"themes/next/source/css/_common/components/header/header.styl","hash":"6c4990d375b640ee4551e62c48c1cbe4c3d62212","modified":1553951765631},{"_id":"themes/next/source/css/_common/components/header/github-banner.styl","hash":"ca97f0b6990eef947039faede80c56d9c4381ee1","modified":1553951765627},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.woff","hash":"28b782240b3e76db824e12c02754a9731a167527","modified":1553951694079},{"_id":"themes/next/source/css/_common/components/header/headerband.styl","hash":"d27448f199fc2f9980b601bc22b87f08b5d64dd1","modified":1553951693775},{"_id":"themes/next/source/css/_common/components/footer/footer.styl","hash":"4cfeec9434a72d5efc6ca225d3445d084d4590f7","modified":1553951693767},{"_id":"themes/next/source/css/_common/components/header/site-nav.styl","hash":"cc6ee18f47f2e1e06df6fa0eadb37079e580fd11","modified":1553951765643},{"_id":"themes/next/source/css/_common/components/header/menu.styl","hash":"a410ed529afd46ddf4a96ecf0de6599488716887","modified":1553951765635},{"_id":"themes/next/source/css/_common/components/header/site-meta.styl","hash":"c0d9e18a9210fdcaf33e488518b3b288eb58c0a1","modified":1553951693775},{"_id":"themes/next/source/css/_common/components/highlight/diff.styl","hash":"71d8d1cc22a2a7627a6db7240f0c4902a14f9bea","modified":1553951765651},{"_id":"themes/next/source/css/_common/components/pages/archive.styl","hash":"6904fd7ea6455e008d9884558b68254608af9a3c","modified":1553951693791},{"_id":"themes/next/source/css/_common/components/highlight/theme.styl","hash":"b76387934fb6bb75212b23c1a194486892cc495e","modified":1553951693787},{"_id":"themes/next/source/css/_common/components/highlight/highlight.styl","hash":"e9dd8de7d98f1478ac7d351624fffd3d8738c905","modified":1553951765651},{"_id":"themes/next/source/css/_common/components/pages/breadcrumb.styl","hash":"2d142c6f39853916256ad8fc79eb6b85f4001ae8","modified":1553951693791},{"_id":"themes/next/source/css/_common/components/pages/pages.styl","hash":"f1d52954b9a5d1ca8e224382349f525e598dd923","modified":1553951765659},{"_id":"themes/next/source/css/_common/components/pages/schedule.styl","hash":"80addb9b725e329915c05c27b9fadaf56457a9b3","modified":1553951765663},{"_id":"themes/next/source/css/_common/components/pages/categories.styl","hash":"4eff5b252d7b614e500fc7d52c97ce325e57d3ab","modified":1553951693791},{"_id":"themes/next/source/css/_common/components/pages/post-detail.styl","hash":"9bf4362a4d0ae151ada84b219d39fbe5bb8c790e","modified":1553951693795},{"_id":"themes/next/source/css/_common/components/pages/tag-cloud.styl","hash":"61ca40856e5cacd48e0fa9728fde4605c7dd4c94","modified":1553951765667},{"_id":"themes/next/source/css/_common/components/post/post-collapse.styl","hash":"6a75bb1f2435f4e895cbbb5abbddf6e8f7257804","modified":1553951765679},{"_id":"themes/next/source/css/_common/components/post/post-copyright.styl","hash":"2356226157e8068b0e9bbe2f7d0f74e1ab49199b","modified":1553951693807},{"_id":"themes/next/source/css/_common/components/post/post-button.styl","hash":"e72a89e0f421444453e149ba32c77a64bd8e44e8","modified":1553951693807},{"_id":"themes/next/source/css/_common/components/post/post-gallery.styl","hash":"0bf899fab331add63f0c8ead31ca3a3db2ad74d9","modified":1553951693815},{"_id":"themes/next/source/css/_common/components/post/post-meta.styl","hash":"b082d07b13a3d55b4c032fd351dfa9a4fd74edec","modified":1553951765691},{"_id":"themes/next/source/css/_common/components/post/post-expand.styl","hash":"1385862a5c0bd845015d165aadbd1a6add7b72d7","modified":1553951765687},{"_id":"themes/next/source/css/_common/components/post/post-nav.styl","hash":"496f931e3a7e313ba8088fb91bb20789cace72c9","modified":1553951765695},{"_id":"themes/next/source/css/_common/components/post/post-eof.styl","hash":"c961d37190d9bec58a36306c7e716c4e72c4582f","modified":1553951765683},{"_id":"themes/next/source/css/_common/components/post/post-rtl.styl","hash":"017074ef58166e2d69c53bb7590a0e7a8947a1ed","modified":1553951693823},{"_id":"themes/next/source/css/_common/components/post/post-reading_progress.styl","hash":"3f33bb862c2aa993f54987fbb345da067b79b112","modified":1553951765699},{"_id":"themes/next/source/css/_common/components/post/post-reward.styl","hash":"5440013a081201ca791582db98159dce93ea9e75","modified":1553951765699},{"_id":"themes/next/source/css/_common/components/post/post-tags.styl","hash":"a352ae5b1f8857393bf770d2e638bf15f0c9585d","modified":1553951693823},{"_id":"themes/next/source/css/_common/components/post/post-type.styl","hash":"d5c8ffed7f2c701052b7a53abaf5ef437374ea72","modified":1553951765707},{"_id":"themes/next/source/css/_common/components/post/post-widgets.styl","hash":"a6c24393dffbdd94dd5c01cdbec5e180b0bfbbbd","modified":1553951693827},{"_id":"themes/next/source/css/_common/components/post/post-title.styl","hash":"8e058c99dd7d41f0bd34c7c28b6ac9fbb17dcb5e","modified":1553951693823},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-author.styl","hash":"707527c9950a7459355c8abcf4751c0964de0bc1","modified":1553951765723},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-author-links.styl","hash":"9224b566cd2632f64c1a964e2c786cee93b93286","modified":1553951765719},{"_id":"themes/next/source/css/_common/components/post/post.styl","hash":"a3170630d8e085889a4bdc20eb7f09c5a0479c47","modified":1553951765711},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-blogroll.styl","hash":"cc83816614f21c7e1d8d3f867d547ff7c658cec4","modified":1553951765727},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-toc.styl","hash":"8a24b56524a388fbabd408ffc8ba9b56eb9e01ce","modified":1553951765735},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-dimmer.styl","hash":"c2d9c3b6fbfa65544e6b5a55d3cb2149df04a8a9","modified":1553951765731},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-button.styl","hash":"517d541a80d59ad99a3f648be74891e0c7bc72a8","modified":1553951765727},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-nav.styl","hash":"9a3bfc878ca797946815bed23cd6f92b24a16358","modified":1553951693843},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-toggle.styl","hash":"e425433b81da2714d6fa17c138e1fa750ad810ec","modified":1553951765735},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar.styl","hash":"8e5c884fb950937afa350c608545455c87aa6129","modified":1553951765739},{"_id":"themes/next/source/css/_common/components/sidebar/site-state.styl","hash":"967fb3a3c6c851b34ec5df2d945dc266ed63d146","modified":1553951765739},{"_id":"themes/next/source/css/_common/components/tags/blockquote-center.styl","hash":"58ec00eebe68d0eebd2eea435c710063877447df","modified":1553951765743},{"_id":"themes/next/source/css/_common/components/tags/full-image.styl","hash":"6ec8ea7b11a146777b6b8da0f71f0cc1dbd129df","modified":1553951693859},{"_id":"themes/next/source/css/_common/components/tags/group-pictures.styl","hash":"4851b981020c5cbc354a1af9b831a2dcb3cf9d39","modified":1553951693863},{"_id":"themes/next/source/css/_common/components/tags/label.styl","hash":"d7501ae01fc45fa15b00d1bc5233b9fffa20a3c9","modified":1553951765747},{"_id":"themes/next/source/css/_common/components/tags/note.styl","hash":"21b32840d8b3a14b10770153114778304ba6d1b0","modified":1553951765747},{"_id":"themes/next/source/css/_common/components/tags/pdf.styl","hash":"deafbca5bc2e6bbc5923bbb2036ffa2896ce71fc","modified":1553951765751},{"_id":"themes/next/source/css/_common/components/third-party/algolia-search.styl","hash":"fc58498d4f5081fcf6218e9e18c5bf2328275bef","modified":1553951765759},{"_id":"themes/next/source/css/_common/components/tags/tabs.styl","hash":"fcda60fecff1479adaf6521cf629cda2506337a8","modified":1553951765751},{"_id":"themes/next/source/css/_common/components/tags/tags.styl","hash":"cbc0be5a3285b469858ec9ead48e2ea90bd47ae1","modified":1553951765755},{"_id":"themes/next/source/css/_common/components/third-party/gitalk.styl","hash":"ac7753d536341aa824d7bce0332735e838916995","modified":1553951693875},{"_id":"themes/next/source/css/_common/components/third-party/gitment.styl","hash":"f1d9ee1f86a179741f2478f8c70ca11ab578810e","modified":1553951765763},{"_id":"themes/next/source/css/_common/components/third-party/han.styl","hash":"7059e24235b7c57a07f3f8abaa06b0bd6a7eda2f","modified":1553951693879},{"_id":"themes/next/source/css/_common/components/third-party/copy-code.styl","hash":"688ca3eccc26727d050ad098b32b40934719588a","modified":1553951765759},{"_id":"themes/next/source/css/_common/components/third-party/math.styl","hash":"ef66c0a08e4243a25e41408d70ca66682b8dcea1","modified":1553951765767},{"_id":"themes/next/source/css/_common/components/third-party/localsearch.styl","hash":"9fac89c8146eb2675721a26f528d7d0f8be7debe","modified":1553951765763},{"_id":"themes/next/source/css/_common/components/third-party/needsharebutton.styl","hash":"61466e3e5459960b5802a267751a0c8018918b0b","modified":1553951765783},{"_id":"themes/next/source/css/_common/components/third-party/related-posts.styl","hash":"3ae3f3c276d444862033fd3434c632ad0d2f84e6","modified":1553951765783},{"_id":"themes/next/source/css/_schemes/Muse/sidebar/sidebar-blogroll.styl","hash":"817587e46df49e819858c8ecbafa08b53d5ff040","modified":1553951693963},{"_id":"themes/next/source/css/_common/components/third-party/third-party.styl","hash":"03c4fa9573fddd930552784cf484fd2ee7825323","modified":1553951765787},{"_id":"themes/next/source/css/_schemes/Mist/outline/outline.styl","hash":"5dc4859c66305f871e56cba78f64bfe3bf1b5f01","modified":1553951693947},{"_id":"themes/next/source/css/_schemes/Mist/sidebar/sidebar-blogroll.styl","hash":"817587e46df49e819858c8ecbafa08b53d5ff040","modified":1553951693947},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.eot","hash":"d980c2ce873dc43af460d4d572d441304499f400","modified":1553951694071},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.woff2","hash":"d6f48cba7d076fb6f2fd6ba993a75b9dc1ecbf0c","modified":1553951694083},{"_id":"source/_drafts/持续集成.md","hash":"5e4be9e682b449a255a7d3590ab4ce42293b40c6","modified":1563353085601},{"_id":"source/_posts/zh-CN/[译] Node.js 框架：最适合 web 和应用程序开发的 10 个框架.md","hash":"7adc18714451ed9f7b0a9357b9ba651c3d377578","modified":1563690754034},{"_id":"source/_posts/zh-CN/[译] TensorFLow1-3之1-0-0安装.md","hash":"7bba95529ce75478bb50424064a5636a31f16afe","modified":1563689542609},{"_id":"source/_posts/zh-CN/谈谈CSDN.md","hash":"ffae312ddb4a5d4e59bf7edfeedc41183f807730","modified":1563690132341},{"_id":"source/_posts/zh-CN/【译]】Node.js 框架：最适合 web 和应用程序开发的 10 个框架.md","hash":"68f3ddb7b123e6e5cf6c66a1054f30c8dc0be475","modified":1563691937317},{"_id":"source/_posts/zh-CN/【译]】TensorFLow1-3之1-0-0安装.md","hash":"6a82ff35dd7163eeaf3882fbcdb15f48fcc6c89e","modified":1563690904834},{"_id":"source/_drafts/观《康熙王朝》.md","hash":"7c35566b3c46e5af843f74415242fc363a6a505f","modified":1563694939242},{"_id":"source/_drafts/观《野梨树》.md","hash":"357202747623cdf431ab53b9137a8d1ba7272e9e","modified":1563694723069},{"_id":"source/_drafts/读《中国社会各阶层分析》.md","hash":"09ba144d59ae85736fc763e29dd18435b0e6b5ed","modified":1563694114912},{"_id":"source/_posts/zh-CN/Egg 渐进式开发.md","hash":"1f1de2ffe808f2c5859de471d24cbeb250779e1a","modified":1563801651165},{"_id":"public/search.xml","hash":"aa435de9b066874d2e837a92791a4825748c96e3","modified":1577701461461},{"_id":"public/404/index.html","hash":"ceba4920c7c4bda84cc1be20b82969a29fa87359","modified":1577701461603},{"_id":"public/about/index.html","hash":"1ef01b98ebe9dac2de802a4f240f6ec294fe5bfa","modified":1577701461603},{"_id":"public/categories/index.html","hash":"51e03c230dc7e57a57f1689993dfa769a966cb9e","modified":1577701461603},{"_id":"public/photos/index.html","hash":"2b285ab09872de1112024ee550642c48223ee295","modified":1577701461603},{"_id":"public/tags/index.html","hash":"49d89ab6aea6bfe7326cc86e1adc2e371b9f02d6","modified":1577701461603},{"_id":"public/notebook/index.html","hash":"e3334d746e6bc938e79fea6af85481d5c0905b77","modified":1577701461604},{"_id":"public/zh-CN/扫描二维码分析/index.html","hash":"723577d6d477f461ec08d7bc6497ea841ac5ede9","modified":1577701461604},{"_id":"public/en/fetch/index.html","hash":"c505937656b710cade27c5239f644855152bd2c9","modified":1577701461604},{"_id":"public/en/redis/index.html","hash":"c8965751bbf676b249110bb50ff6463a496c20aa","modified":1577701461604},{"_id":"public/en/koajs-Analysis/index.html","hash":"48f276c4b1bff42a73c07afcc7525c4ef66993f6","modified":1577701461606},{"_id":"public/zh-CN/微信小程序云开发之云函数外部请求/index.html","hash":"134a7539069ad46d297b5d5570ad94e1fd78e351","modified":1577701461606},{"_id":"public/zh-CN/多端构建工具使用分析/index.html","hash":"1d6c3d67d0fb550f15b14c0f9f09e01e16c59356","modified":1577701461606},{"_id":"public/zh-CN/微信小程序资料库需求的实现/index.html","hash":"b85b05d9fe6b26e3b4017be19d7fa10efbd89c18","modified":1577701461606},{"_id":"public/en/ubuntu-reference/index.html","hash":"7d8e2d574a3d3546835323dd2f8a6545d3046f67","modified":1577701461607},{"_id":"public/zh-CN/面试总结/index.html","hash":"111b5795a51889ed927a722f8247c5c83f48366e","modified":1577701461607},{"_id":"public/zh-CN/观《独行》/index.html","hash":"6a2f1126f8328d8e21d540fb9658e5d113822ff2","modified":1577701461607},{"_id":"public/zh-CN/反向编译wxapkg记录/index.html","hash":"732cfed914a0f23df3c9b8028b7bc9354c040989","modified":1577701461607},{"_id":"public/en/md reference/index.html","hash":"78c9db20ba936d49f28082409e470f865a27daed","modified":1577701461607},{"_id":"public/en/about-config/index.html","hash":"b2259ba3d5eb4dcccf8294cf7f7061654f42fbe7","modified":1577701461608},{"_id":"public/zh-CN/《悬崖》的几处错误/index.html","hash":"3ec2da774fbccf3cc509d3cbc6264a363ba1def2","modified":1577701461608},{"_id":"public/zh-CN/《皖南事变》/index.html","hash":"1528795f051f0dec0e4cf5cbec46ecc9fa6da439","modified":1577701461608},{"_id":"public/en/dillinger/index.html","hash":"6d47110e1f7cf5a6aad08afa72d99d337e829328","modified":1577701461608},{"_id":"public/zh-CN/how-to-create-an-operating-system-操作记录/index.html","hash":"406d55eccf4b7ff459dc068f224ca322996cff83","modified":1577701461609},{"_id":"public/en/LNMP/index.html","hash":"d35c0a90381e2ccc31f949da423d7928c2e09459","modified":1577701461609},{"_id":"public/en/install node/index.html","hash":"0505ca94e395eb89a0703795b8ae7b7318ddfb2b","modified":1577701461609},{"_id":"public/en/git reference/index.html","hash":"4218c992dccdad1ccf682a81898b820b3a1e12b1","modified":1577701461609},{"_id":"public/en/ssh reference/index.html","hash":"5dee97e365aadb561353882e79ce3d68f07a6e14","modified":1577701461609},{"_id":"public/zh-CN/微信订阅号开发记录/index.html","hash":"e05788ec6ee6541ab4f95d16d4eb8e588a581693","modified":1577701461610},{"_id":"public/zh-CN/laravel环境配置过程记录/index.html","hash":"ee5d2b0d9b5a094bfb7d5808c76b97e98fb85770","modified":1577701461610},{"_id":"public/zh-CN/观影《新世界》/index.html","hash":"a726762bada615bee42872c7164c62241c8b18d3","modified":1577701461610},{"_id":"public/zh-CN/网络代理初探记录/index.html","hash":"6b834fe073f5b9249c042133033b80975d5af9f4","modified":1577701461611},{"_id":"public/zh-CN/安装双系统记录/index.html","hash":"2f0ab934f686d47c6698248d050dcfe1c3c127db","modified":1577701461611},{"_id":"public/zh-CN/《在细雨中呼喊》一个积极的悲观主义者/index.html","hash":"6b95a0658e05042b197de9a7a14fc65eb87083c5","modified":1577701461611},{"_id":"public/zh-CN/凡是过往，皆为序章/index.html","hash":"dfda1191b328ff0f0dae59d825d096b5ac09c3c9","modified":1577701461611},{"_id":"public/zh-CN/越是进入一个深度，越是觉得能力撑不起野心。/index.html","hash":"6f882d6103f71712fd9c0f7fd1f63a93c602b446","modified":1577701461611},{"_id":"public/zh-CN/本地“模拟”一台服务器记录/index.html","hash":"2ed9ba3cc444f2422fec8fc9e5b8dc82b8df1d6b","modified":1577701461611},{"_id":"public/zh-CN/安装pthreads多线程扩展记录/index.html","hash":"4e0515697072cc64297da926737d27851aa6a00c","modified":1577701461611},{"_id":"public/zh-CN/安装matlab/index.html","hash":"5862257f30801f2926435d0b4057abbbb05a1692","modified":1577701461611},{"_id":"public/zh-CN/Python初探/index.html","hash":"6ed4c36c0ff4bb16f678d865e19fef7e0689525f","modified":1577701461612},{"_id":"public/zh-CN/建立个人网站/index.html","hash":"09310cf8da96fedd0a9605b35bd800430acb7d7d","modified":1577701461612},{"_id":"public/zh-CN/从心所欲，无欲则刚/index.html","hash":"75c6e57f3dc72266c71c8c16e86940cdc76896e9","modified":1577701461612},{"_id":"public/zh-CN/第三方平台API(以易班为例)的使用记录/index.html","hash":"c9325d47775b7ddc68c3b8ecd5f63c881b4e8fae","modified":1577701461612},{"_id":"public/zh-CN/总有一种美好值得期待/index.html","hash":"d98ec137a67e3932eafd90809e352c95e0964942","modified":1577701461612},{"_id":"public/categories/config/index.html","hash":"34072dd6f25d318d5e63a00b8b66e1a78c99b870","modified":1577701461615},{"_id":"public/categories/reference/index.html","hash":"041e83b93f2c4c6f6c3d8040c99605df00d4c2b1","modified":1577701461615},{"_id":"public/categories/study/index.html","hash":"d03b662279a6e495648bfaac44cb2ff9c69da01a","modified":1577701461615},{"_id":"public/categories/translate/index.html","hash":"27045eac7fa042f3dbbd3381e79b2de383bedbd4","modified":1577701461615},{"_id":"public/categories/record/index.html","hash":"e7302b4a8ddcc628d3858533f5aa9640817f6627","modified":1577701461615},{"_id":"public/categories/book/index.html","hash":"ac47eb63adaf3a2ea3b5e376b3f45de7f86750fc","modified":1577701461615},{"_id":"public/categories/tv/index.html","hash":"65e77f145c6a7b62e668073242d5c7f708a0355a","modified":1577701461615},{"_id":"public/categories/thoughts/index.html","hash":"2ac7fc3bee771a7babd5804d5c6db737c6f1babc","modified":1577701461615},{"_id":"public/categories/documentary/index.html","hash":"1223808c2b208947b2c38dd466336bc1ec9e8a4c","modified":1577701461616},{"_id":"public/archives/index.html","hash":"171f15adb0764834183156ebc688d7e16889638d","modified":1577701461612},{"_id":"public/archives/page/2/index.html","hash":"a5d756c9b669ecba5b0ea7e772d06af1c3854903","modified":1577701461612},{"_id":"public/archives/page/3/index.html","hash":"249ab0ed40efddae76afa25117b90dfdbc976d0b","modified":1577701461613},{"_id":"public/archives/page/4/index.html","hash":"9fecbe8dfe647b7ddf0f7b6b94cbe8764b7ff9b1","modified":1577701461613},{"_id":"public/archives/page/5/index.html","hash":"0aa3a3c0e288c22feb1529bab52cafa1bcadf972","modified":1577701461613},{"_id":"public/archives/2017/index.html","hash":"4f09899bb05c10d529c65ce8cc74e23f54e23064","modified":1577701461613},{"_id":"public/archives/2017/05/index.html","hash":"14fb9ef6cbb7525115d2e7cd17af344223d6058b","modified":1577701461613},{"_id":"public/archives/2017/06/index.html","hash":"65723774e4994eb1bb9b39db1433956fce4c929f","modified":1577701461613},{"_id":"public/archives/2017/07/index.html","hash":"a4ea02a50ec77674bf4a2e00be30f0ad9a4e8770","modified":1577701461613},{"_id":"public/archives/2017/09/index.html","hash":"c7bca92517086ce47b6b8f38ce7c73a62b7f6d5b","modified":1577701461613},{"_id":"public/archives/2017/10/index.html","hash":"1454e7d07e433b285ec3d99b7ec01c34f59b9e02","modified":1577701461614},{"_id":"public/zh-CN/一年，一度/index.html","hash":"b6609404ac435d49a82e41f6266febd478e803a9","modified":1577701461610},{"_id":"public/archives/2017/11/index.html","hash":"5639bfd4c89f6b0ead753ca00153d06791dbf055","modified":1577701461614},{"_id":"public/archives/2018/index.html","hash":"6eddc1adb33ff1644aad3894d0342276027122c7","modified":1577701461614},{"_id":"public/archives/2018/05/index.html","hash":"1652ee7a3aa8793dc383995d3bbf109b9f926e16","modified":1577701461614},{"_id":"public/archives/2018/12/index.html","hash":"6452c5d38cdfd44b9f300944c5faf329a6244834","modified":1577701461614},{"_id":"public/archives/2019/index.html","hash":"7998da0d3e9b657d5429ee6f21c478f8bd7b2f69","modified":1577701461614},{"_id":"public/archives/2019/page/2/index.html","hash":"d7658836119a1d9b3dd9683c35278c2d0bd9ded2","modified":1577701461614},{"_id":"public/archives/2019/page/3/index.html","hash":"2695ae3c48fa3361432f4e449df308fa0a9f1356","modified":1577701461614},{"_id":"public/archives/2019/01/index.html","hash":"d9dd5f5d987a4e235d215bc1473a2712f2f7d9d6","modified":1577701461614},{"_id":"public/archives/2019/03/index.html","hash":"c8bc2713bcb16669f5f0a60ce601344333276191","modified":1577701461614},{"_id":"public/archives/2019/04/index.html","hash":"e6741e3359f81c6bb33c823355b9f953fce24211","modified":1577701461615},{"_id":"public/archives/2019/05/index.html","hash":"996684aef5a032054af0eb924c858d186f9e598f","modified":1577701461615},{"_id":"public/index.html","hash":"e27fb9286f7e846382481a8f8c036d4d87e5b284","modified":1577701461616},{"_id":"public/page/2/index.html","hash":"c7397f7b489ad2c8c9278a9f95ff045324f7466f","modified":1577701461616},{"_id":"public/page/3/index.html","hash":"61dffa2d9786eb001cd0117b62bb39b878f8c313","modified":1577701461616},{"_id":"public/page/4/index.html","hash":"d0f731baee7c7d2ac80590f9a694215390e76928","modified":1577701461616},{"_id":"public/page/5/index.html","hash":"36f0092f306ffc38dcee42097e3c905f161e1edd","modified":1577701461616},{"_id":"public/tags/markdown/index.html","hash":"250106f0cd59fe2ea9fbf78fd3d8fae84d1e82aa","modified":1577701461616},{"_id":"public/tags/git/index.html","hash":"9c71a734214254187bc3480066d3ce16c440b807","modified":1577701461616},{"_id":"public/tags/node/index.html","hash":"091666cfa0e411b63940526ec5258987a5a3e956","modified":1577701461617},{"_id":"public/lib/blog-encrypt.js","hash":"8825daa2e18bb6166d099ae78e9ff1df62f619d1","modified":1577701461619},{"_id":"public/zh-CN/谈谈CSDN/index.html","hash":"a1a71bc98c81d77e14fbf422d21465e235991bdc","modified":1577701461604},{"_id":"public/zh-CN/Egg 渐进式开发/index.html","hash":"b07d24558a5c5bd5fb87e1ba0a60e637bbe51f74","modified":1577701461609},{"_id":"public/zh-CN/【译]】Node.js 框架：最适合 web 和应用程序开发的 10 个框架/index.html","hash":"b6752e1732b983c7e8808febd2121f1196f557ff","modified":1577701461611},{"_id":"public/zh-CN/【译]】TensorFLow1-3之1-0-0安装/index.html","hash":"f503147de276a5fb5ac411a260897f71cc0bc1e1","modified":1577701461612},{"_id":"public/categories/learn/index.html","hash":"56264864fc7c390f111a793eb210a30e13707db2","modified":1577701461616},{"_id":"public/tags/koa/index.html","hash":"da2ce7b02145222e8d1ce4cee9774031e6972623","modified":1577701461617},{"_id":"public/tags/ssh/index.html","hash":"f7af7ebde3dd2604f9c7643b37d94a8dd27bc30d","modified":1577701461617},{"_id":"public/tags/linux/index.html","hash":"3097f42c012b58b1e81e04fc969b10225c5a5d7b","modified":1577701461617},{"_id":"public/tags/tensorflow/index.html","hash":"64e198b842c9f5b2d77ac1f450452384016c6906","modified":1577701461617},{"_id":"public/tags/随想/index.html","hash":"60c36dff76593ee4f6db4704ca9b7c58e766d198","modified":1577701461617},{"_id":"public/tags/wechat/index.html","hash":"de726dc30fe85d6211efdcb4187a33fc610a18b0","modified":1577701461617},{"_id":"public/tags/matlab/index.html","hash":"3817a2921f4993923ab5742ee1bc2fcf972a4830","modified":1577701461617},{"_id":"public/tags/php/index.html","hash":"db62bfc1f6b6eb9a003dcb9275775520acd16a19","modified":1577701461617},{"_id":"public/tags/微信/index.html","hash":"572a6dcdb0f1a4283dec8acb9ce070975d9f5fd9","modified":1577701461617},{"_id":"public/tags/centos/index.html","hash":"d9a6f438f03442d41618419612f5d4d36b08f780","modified":1577701461618},{"_id":"public/tags/shadowsocks/index.html","hash":"857b536cadb421cfc73651a5acd209e873468095","modified":1577701461618},{"_id":"public/tags/电影/index.html","hash":"a0b5787f7b581997944da1f3bdeba5560009b53f","modified":1577701461618},{"_id":"public/tags/面试/index.html","hash":"dff40b52a1fea8af33f61ef934602e5fc9856ba3","modified":1577701461618},{"_id":"public/tags/nginx/index.html","hash":"f0add48dd03e0bdbf2f0b4c7c8947d0b3d9064c1","modified":1577701461618},{"_id":"public/tags/mysql/index.html","hash":"609a6d9cb14152483dae7bd9512311da7e6ac2e2","modified":1577701461618},{"_id":"public/tags/python/index.html","hash":"f3709d24b1d191132019c9df671c2e76f286a4ce","modified":1577701461618},{"_id":"public/tags/Laravel/index.html","hash":"1d6983232a277808608ab93d27a8a4edbe2ae21a","modified":1577701461618},{"_id":"public/tags/github/index.html","hash":"a50d7de23a53ed0c9ce36e0a3b3ebfab8eaf2535","modified":1577701461618},{"_id":"public/tags/Node-js/index.html","hash":"cbe7ca409e1d81108e1eb115e53709eaa9e22393","modified":1577701461618},{"_id":"public/tags/egg/index.html","hash":"167361d86607c80031bc0ee39cf889cc3593047b","modified":1577701461619},{"_id":"public/css/blog-encrypt.css","hash":"0d74ee9365e8224999f06a625ab8be4b71e50180","modified":1577701461627},{"_id":"public/assets/css/APlayer.min.css","hash":"07372a2ba507388d0fed166d761b1c2c2a659dce","modified":1564234459750},{"_id":"public/assets/js/Meting.min.js","hash":"a0585220b918d78649a7893279e1ec4fb5abe835","modified":1564234459750},{"_id":"public/assets/js/APlayer.min.js","hash":"22caa28ff6b41a16ff40f15d38f1739e22359478","modified":1564234459756},{"_id":"public/lib/crypto-js.js","hash":"3dd73b6f13dc818a3a9c5c7424c1c4a9649b00a2","modified":1564234459802}],"Category":[{"name":"config","_id":"cjvnq7z9m00087jjxnlcmp7uq"},{"name":"reference","_id":"cjvnq7z9w000i7jjxe936yk72"},{"name":"study","_id":"cjvnq7z9z000q7jjxwg2q6zo1"},{"name":"translate","_id":"cjvnq7za600137jjx2kdq1qzu"},{"name":"record","_id":"cjvnq7za9001b7jjx7g6wzl1q"},{"name":"book","_id":"cjvnq7zac001i7jjxpf5eb23a"},{"name":"tv","_id":"cjvnq7zag001o7jjxtkwq38cp"},{"name":"thoughts","_id":"cjvnq7zam00207jjxpoy0cq0l"},{"name":"documentary","_id":"cjvnq7zb1002u7jjxsegcznvf"},{"name":"learn","_id":"cjylkt0qv0001tpjxsa9byoj1"}],"Data":[],"Page":[{"title":"404","date":"1969-12-31T16:00:00.000Z","_content":"\n<script src=\"//qzonestyle.gtimg.cn/qzone/hybrid/app/404/search_children.js\" charset=\"utf-8\" homePageUrl=\"/\" homePageName=\"Back to home\"></script>\n","source":"404/index.md","raw":"---\ntitle: 404\ndate: 1970-01-01 00:00:00\n---\n\n<script src=\"//qzonestyle.gtimg.cn/qzone/hybrid/app/404/search_children.js\" charset=\"utf-8\" homePageUrl=\"/\" homePageName=\"Back to home\"></script>\n","updated":"2019-03-31T08:09:14.102Z","path":"404/index.html","comments":1,"layout":"page","_id":"cjvnq7z7g00007jjxfzu6gk88","content":"<link rel=\"stylesheet\" class=\"aplayer-secondary-style-marker\" href=\"/assets/css/APlayer.min.css\"><script src=\"/assets/js/APlayer.min.js\" class=\"aplayer-secondary-script-marker\"></script><script class=\"meting-secondary-script-marker\" src=\"/assets/js/Meting.min.js\"></script><link rel=\"stylesheet\" type=\"text/css\" href=\"https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css\"><script src=\"//qzonestyle.gtimg.cn/qzone/hybrid/app/404/search_children.js\" charset=\"utf-8\" homepageurl=\"/\" homepagename=\"Back to home\"></script>\n","site":{"data":{}},"excerpt":"","more":"<script src=\"//qzonestyle.gtimg.cn/qzone/hybrid/app/404/search_children.js\" charset=\"utf-8\" homepageurl=\"/\" homepagename=\"Back to home\"></script>\n"},{"title":"About me","date":"2018-12-27T02:17:14.000Z","comments":0,"_content":"### 最近在听\n{% meting \"2526283537\" \"netease\" \"playlist\" \"mutex:false\" \"listmaxheight:340px\" \"preload:none\" \"theme:#FC6423\"%}\n### 最近在读\n- 贾平凹《秦腔》\n\n### 更新日志\n- 2017.3 使用wordpress,由cloudleft(香港)托管，使用gaoyuting.org访问\n - 2017.9 存在恶意后门，遭遇攻击，主机商关停访问，自行删除后未能克服，故下架\n- 2017.11 迁移使用typecho，由京东云托管，使用blog.makergyt.com访问\n - 2017.12 京东云主机到期，暂时下架\n- 2018.12 迁移使用hexo ，由github托管，使用makergyt.github.io访问，映射为blog.makergyt.com\n - 2019.1 发现百度不会收录github pages,考虑迁移至国内coding,但样式无法加载，暂时放弃迁移\n - 2019.4 部署至coding pages,使用memakergyt.coding.me访问，映射为blog-cn.makergyt.com，百度收录\n<div class=\"text-center\">{% btn ../en/about-config, About config of this site, arrow-right fa-fw fa-lg, Next Chapter (Label) %}</div>","source":"about/index.md","raw":"---\ntitle: About me\ndate: 2018-12-27 10:17:14\ncomments: false\n---\n### 最近在听\n{% meting \"2526283537\" \"netease\" \"playlist\" \"mutex:false\" \"listmaxheight:340px\" \"preload:none\" \"theme:#FC6423\"%}\n### 最近在读\n- 贾平凹《秦腔》\n\n### 更新日志\n- 2017.3 使用wordpress,由cloudleft(香港)托管，使用gaoyuting.org访问\n - 2017.9 存在恶意后门，遭遇攻击，主机商关停访问，自行删除后未能克服，故下架\n- 2017.11 迁移使用typecho，由京东云托管，使用blog.makergyt.com访问\n - 2017.12 京东云主机到期，暂时下架\n- 2018.12 迁移使用hexo ，由github托管，使用makergyt.github.io访问，映射为blog.makergyt.com\n - 2019.1 发现百度不会收录github pages,考虑迁移至国内coding,但样式无法加载，暂时放弃迁移\n - 2019.4 部署至coding pages,使用memakergyt.coding.me访问，映射为blog-cn.makergyt.com，百度收录\n<div class=\"text-center\">{% btn ../en/about-config, About config of this site, arrow-right fa-fw fa-lg, Next Chapter (Label) %}</div>","updated":"2019-12-27T08:41:57.601Z","path":"about/index.html","_id":"cjvnq7z7k00017jjxti55aitq","layout":"page","content":"<link rel=\"stylesheet\" class=\"aplayer-secondary-style-marker\" href=\"/assets/css/APlayer.min.css\"><script src=\"/assets/js/APlayer.min.js\" class=\"aplayer-secondary-script-marker\"></script><script class=\"meting-secondary-script-marker\" src=\"/assets/js/Meting.min.js\"></script><link rel=\"stylesheet\" type=\"text/css\" href=\"https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css\"><h3 id=\"最近在听\"><a href=\"#最近在听\" class=\"headerlink\" title=\"最近在听\"></a>最近在听</h3>\n    <div id=\"aplayer-SbhXFdDO\" class=\"aplayer aplayer-tag-marker meting-tag-marker\" data-id=\"2526283537\" data-server=\"netease\" data-type=\"playlist\" data-mode=\"circulation\" data-autoplay=\"false\" data-mutex=\"false\" data-listmaxheight=\"340px\" data-preload=\"none\" data-theme=\"#FC6423\"></div>\n<h3 id=\"最近在读\"><a href=\"#最近在读\" class=\"headerlink\" title=\"最近在读\"></a>最近在读</h3><ul>\n<li>贾平凹《秦腔》</li>\n</ul>\n<h3 id=\"更新日志\"><a href=\"#更新日志\" class=\"headerlink\" title=\"更新日志\"></a>更新日志</h3><ul>\n<li>2017.3 使用wordpress,由cloudleft(香港)托管，使用gaoyuting.org访问<ul>\n<li>2017.9 存在恶意后门，遭遇攻击，主机商关停访问，自行删除后未能克服，故下架</li>\n</ul>\n</li>\n<li>2017.11 迁移使用typecho，由京东云托管，使用blog.makergyt.com访问<ul>\n<li>2017.12 京东云主机到期，暂时下架</li>\n</ul>\n</li>\n<li>2018.12 迁移使用hexo ，由github托管，使用makergyt.github.io访问，映射为blog.makergyt.com<ul>\n<li>2019.1 发现百度不会收录github pages,考虑迁移至国内coding,但样式无法加载，暂时放弃迁移</li>\n<li>2019.4 部署至coding pages,使用memakergyt.coding.me访问，映射为blog-cn.makergyt.com，百度收录<div class=\"text-center\"><a class=\"btn\" href=\"../en/about-config\" title=\"Next Chapter (Label)\"><i class=\"fa fa-arrow-right fa-fw fa-lg\"></i>About config of this site</a></div></li>\n</ul>\n</li>\n</ul>\n","site":{"data":{}},"excerpt":"","more":"<h3 id=\"最近在听\"><a href=\"#最近在听\" class=\"headerlink\" title=\"最近在听\"></a>最近在听</h3>\n    <div id=\"aplayer-SbhXFdDO\" class=\"aplayer aplayer-tag-marker meting-tag-marker\" data-id=\"2526283537\" data-server=\"netease\" data-type=\"playlist\" data-mode=\"circulation\" data-autoplay=\"false\" data-mutex=\"false\" data-listmaxheight=\"340px\" data-preload=\"none\" data-theme=\"#FC6423\"></div>\n<h3 id=\"最近在读\"><a href=\"#最近在读\" class=\"headerlink\" title=\"最近在读\"></a>最近在读</h3><ul>\n<li>贾平凹《秦腔》</li>\n</ul>\n<h3 id=\"更新日志\"><a href=\"#更新日志\" class=\"headerlink\" title=\"更新日志\"></a>更新日志</h3><ul>\n<li>2017.3 使用wordpress,由cloudleft(香港)托管，使用gaoyuting.org访问<ul>\n<li>2017.9 存在恶意后门，遭遇攻击，主机商关停访问，自行删除后未能克服，故下架</li>\n</ul>\n</li>\n<li>2017.11 迁移使用typecho，由京东云托管，使用blog.makergyt.com访问<ul>\n<li>2017.12 京东云主机到期，暂时下架</li>\n</ul>\n</li>\n<li>2018.12 迁移使用hexo ，由github托管，使用makergyt.github.io访问，映射为blog.makergyt.com<ul>\n<li>2019.1 发现百度不会收录github pages,考虑迁移至国内coding,但样式无法加载，暂时放弃迁移</li>\n<li>2019.4 部署至coding pages,使用memakergyt.coding.me访问，映射为blog-cn.makergyt.com，百度收录<div class=\"text-center\"><a class=\"btn\" href=\"../en/about-config\" title=\"Next Chapter (Label)\"><i class=\"fa fa-arrow-right fa-fw fa-lg\"></i>About config of this site</a></div></li>\n</ul>\n</li>\n</ul>\n"},{"title":"categories","date":"2014-12-22T04:39:04.000Z","type":"categories","comments":0,"_content":"","source":"categories/index.md","raw":"---\ntitle: categories\ndate: 2014-12-22 12:39:04\ntype: \"categories\"\ncomments: false\n---\n","updated":"2019-03-31T00:41:01.247Z","path":"categories/index.html","layout":"page","_id":"cjvnq7z7n00027jjxhxyz9g1n","content":"<link rel=\"stylesheet\" class=\"aplayer-secondary-style-marker\" href=\"/assets/css/APlayer.min.css\"><script src=\"/assets/js/APlayer.min.js\" class=\"aplayer-secondary-script-marker\"></script><script class=\"meting-secondary-script-marker\" src=\"/assets/js/Meting.min.js\"></script><link rel=\"stylesheet\" type=\"text/css\" href=\"https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css\">","site":{"data":{}},"excerpt":"","more":""},{"title":"photos","date":"2019-04-01T09:22:37.000Z","type":"photos","comments":0,"_content":"{% tabs Third unique name, %}\n<!-- tab 校园-->\n<!-- endtab -->\n\n<!-- tab 骑行-->\n{% subtabs Sub Tabs %}\n<!-- tab -->\n<!-- endtab -->\n{% endsubtabs %}\n\n<!-- endtab -->\n{% endtabs %}\n\n[更多移步500px](https://500px.com/makergyt)","source":"photos/index.md","raw":"---\ntitle: photos\ndate: 2019-04-01 17:22:37\ntype: photos\ncomments: false\n---\n{% tabs Third unique name, %}\n<!-- tab 校园-->\n<!-- endtab -->\n\n<!-- tab 骑行-->\n{% subtabs Sub Tabs %}\n<!-- tab -->\n<!-- endtab -->\n{% endsubtabs %}\n\n<!-- endtab -->\n{% endtabs %}\n\n[更多移步500px](https://500px.com/makergyt)","updated":"2019-04-05T01:24:14.906Z","path":"photos/index.html","layout":"page","_id":"cjvnq7z7r00037jjxjg67hlfx","content":"<link rel=\"stylesheet\" class=\"aplayer-secondary-style-marker\" href=\"/assets/css/APlayer.min.css\"><script src=\"/assets/js/APlayer.min.js\" class=\"aplayer-secondary-script-marker\"></script><script class=\"meting-secondary-script-marker\" src=\"/assets/js/Meting.min.js\"></script><link rel=\"stylesheet\" type=\"text/css\" href=\"https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css\"><div class=\"tabs\" id=\"third-unique-name\"><ul class=\"nav-tabs\"><li class=\"tab active\"><a href=\"#third-unique-name-1\">校园</a></li><li class=\"tab\"><a href=\"#third-unique-name-2\">骑行</a></li></ul><div class=\"tab-content\"><div class=\"tab-pane active\" id=\"third-unique-name-1\"></div><div class=\"tab-pane\" id=\"third-unique-name-2\"><div class=\"tabs\" id=\"sub-tabs\"><ul class=\"nav-tabs\"><li class=\"tab active\"><a href=\"#sub-tabs-1\">Sub Tabs 1</a></li></ul><div class=\"tab-content\"><div class=\"tab-pane active\" id=\"sub-tabs-1\"></div></div></div></div></div></div>\n<p><a href=\"https://500px.com/makergyt\" target=\"_blank\" rel=\"noopener\">更多移步500px</a></p>\n","site":{"data":{}},"excerpt":"","more":"<div class=\"tabs\" id=\"third-unique-name\"><ul class=\"nav-tabs\"><li class=\"tab active\"><a href=\"#third-unique-name-1\">校园</a></li><li class=\"tab\"><a href=\"#third-unique-name-2\">骑行</a></li></ul><div class=\"tab-content\"><div class=\"tab-pane active\" id=\"third-unique-name-1\"></div><div class=\"tab-pane\" id=\"third-unique-name-2\"><div class=\"tabs\" id=\"sub-tabs\"><ul class=\"nav-tabs\"><li class=\"tab active\"><a href=\"#sub-tabs-1\">Sub Tabs 1</a></li></ul><div class=\"tab-content\"><div class=\"tab-pane active\" id=\"sub-tabs-1\"></div></div></div></div></div></div>\n<p><a href=\"https://500px.com/makergyt\" target=\"_blank\" rel=\"noopener\">更多移步500px</a></p>\n"},{"title":"Tags","date":"2014-12-22T04:39:04.000Z","type":"tags","comments":0,"_content":"","source":"tags/index.md","raw":"---\ntitle: Tags\ndate: 2014-12-22 12:39:04\ntype: \"tags\"\ncomments: false\n---\n","updated":"2018-12-27T03:08:49.036Z","path":"tags/index.html","layout":"page","_id":"cjvnq7z7s00047jjxi72i4155","content":"<link rel=\"stylesheet\" class=\"aplayer-secondary-style-marker\" href=\"/assets/css/APlayer.min.css\"><script src=\"/assets/js/APlayer.min.js\" class=\"aplayer-secondary-script-marker\"></script><script class=\"meting-secondary-script-marker\" src=\"/assets/js/Meting.min.js\"></script><link rel=\"stylesheet\" type=\"text/css\" href=\"https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css\">","site":{"data":{}},"excerpt":"","more":""},{"title":"notebook","date":"2019-04-06T02:09:19.000Z","comments":0,"_content":"","source":"notebook/index.md","raw":"---\ntitle: notebook\ndate: 2019-04-06 10:09:19\ncomments: false\n---\n","updated":"2019-04-06T03:35:14.328Z","path":"notebook/index.html","layout":"page","_id":"cjvnq7z7u00057jjxolnu2q8e","content":"<link rel=\"stylesheet\" class=\"aplayer-secondary-style-marker\" href=\"/assets/css/APlayer.min.css\"><script src=\"/assets/js/APlayer.min.js\" class=\"aplayer-secondary-script-marker\"></script><script class=\"meting-secondary-script-marker\" src=\"/assets/js/Meting.min.js\"></script><link rel=\"stylesheet\" type=\"text/css\" href=\"https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css\">","site":{"data":{}},"excerpt":"","more":""}],"Post":[{"title":"Dillinger Deploy Record","date":"2019-01-17T12:39:40.000Z","_content":"```js\n// package-lock.json \n// line 15310 \n\"phantomjs\": \"~1.9.7\" ->         \"phantomjs\": \"~2.1.16\"\n// line 15380\n\"version\": \"1.9.20\" ->\"version\": \"2.1.16\"\n```\n<!-- more -->\n\n```js\n// app.js line 46 ?\n//May not need to use favicon if using nginx for serving\n//static assets. Just comment it out below.\napp.use(favicon(path.join(__dirname, 'public/favicon.ico')))\n// app.js line 79 ?\n//Let's 301 redirect to simply dillinger.io\n```\nThe above problems have not been solved yet,but the main problem is the inability to modify the template file \"readme.md\" that was initially loaded.The location of this configuration cannot be located at this time.\n\nSo I started generating my own build editor.\nRequirements are summarized as follows:\n\n<center>markdown online</center>\n>- editor\n - [x] real-time preview\n - [x] automatically save\n - [x] math expressions\n advanced:\n - [ ] syntax hint\n - [ ] double bar rolling(change working-mode)\n - [ ] save to cloud such as github repositories\n - [ ] image cdn\n- file\n - [x] import .md file\n - [x] export .md,html(style),PDF\n- hexo admin\n - [x] bind with github,generate and deploy?\n   install the hexo blog and hexo editor at the same host \n- requirements:\n - [x] open source\n - [ ] design for public \n   All files are temporarily stored\n   but also for private use:\n   Bind account and login by authorization\n- reference:\n - [dillinger](https://github.com/joemccann/dillinger)\n - [hexo editor](https://github.com/tajpure/hexo-editor)\n \n \n So it looks like we're going to have to use VPS，so here comes the question:\n \n Why not just deploy hexo directly on top of it when you have VPS?\n \n Does extending so much functionality violate hexo's simplicity?\n \n It's going to look more and more like a CMS,\n \n So if this goes on, what's the point of hexo versus wordpress？\n \n I'm starting to get lost...\n\n \n","source":"_posts/en/dillinger.md","raw":"---\ntitle: Dillinger Deploy Record\ndate: 2019-01-17 20:39:40\ntags: markdown\ncategories: config\n---\n```js\n// package-lock.json \n// line 15310 \n\"phantomjs\": \"~1.9.7\" ->         \"phantomjs\": \"~2.1.16\"\n// line 15380\n\"version\": \"1.9.20\" ->\"version\": \"2.1.16\"\n```\n<!-- more -->\n\n```js\n// app.js line 46 ?\n//May not need to use favicon if using nginx for serving\n//static assets. Just comment it out below.\napp.use(favicon(path.join(__dirname, 'public/favicon.ico')))\n// app.js line 79 ?\n//Let's 301 redirect to simply dillinger.io\n```\nThe above problems have not been solved yet,but the main problem is the inability to modify the template file \"readme.md\" that was initially loaded.The location of this configuration cannot be located at this time.\n\nSo I started generating my own build editor.\nRequirements are summarized as follows:\n\n<center>markdown online</center>\n>- editor\n - [x] real-time preview\n - [x] automatically save\n - [x] math expressions\n advanced:\n - [ ] syntax hint\n - [ ] double bar rolling(change working-mode)\n - [ ] save to cloud such as github repositories\n - [ ] image cdn\n- file\n - [x] import .md file\n - [x] export .md,html(style),PDF\n- hexo admin\n - [x] bind with github,generate and deploy?\n   install the hexo blog and hexo editor at the same host \n- requirements:\n - [x] open source\n - [ ] design for public \n   All files are temporarily stored\n   but also for private use:\n   Bind account and login by authorization\n- reference:\n - [dillinger](https://github.com/joemccann/dillinger)\n - [hexo editor](https://github.com/tajpure/hexo-editor)\n \n \n So it looks like we're going to have to use VPS，so here comes the question:\n \n Why not just deploy hexo directly on top of it when you have VPS?\n \n Does extending so much functionality violate hexo's simplicity?\n \n It's going to look more and more like a CMS,\n \n So if this goes on, what's the point of hexo versus wordpress？\n \n I'm starting to get lost...\n\n \n","slug":"dillinger","published":1,"lang":"en","updated":"2019-04-29T01:07:50.656Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjvnq7z9g00067jjx8u2o6jts","content":"<link rel=\"stylesheet\" class=\"aplayer-secondary-style-marker\" href=\"/assets/css/APlayer.min.css\"><script src=\"/assets/js/APlayer.min.js\" class=\"aplayer-secondary-script-marker\"></script><script class=\"meting-secondary-script-marker\" src=\"/assets/js/Meting.min.js\"></script><link rel=\"stylesheet\" type=\"text/css\" href=\"https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css\"><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// package-lock.json </span></span><br><span class=\"line\"><span class=\"comment\">// line 15310 </span></span><br><span class=\"line\"><span class=\"string\">\"phantomjs\"</span>: <span class=\"string\">\"~1.9.7\"</span> -&gt;         <span class=\"string\">\"phantomjs\"</span>: <span class=\"string\">\"~2.1.16\"</span></span><br><span class=\"line\"><span class=\"comment\">// line 15380</span></span><br><span class=\"line\"><span class=\"string\">\"version\"</span>: <span class=\"string\">\"1.9.20\"</span> -&gt;<span class=\"string\">\"version\"</span>: <span class=\"string\">\"2.1.16\"</span></span><br></pre></td></tr></table></figure>\n<a id=\"more\"></a>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// app.js line 46 ?</span></span><br><span class=\"line\"><span class=\"comment\">//May not need to use favicon if using nginx for serving</span></span><br><span class=\"line\"><span class=\"comment\">//static assets. Just comment it out below.</span></span><br><span class=\"line\">app.use(favicon(path.join(__dirname, <span class=\"string\">'public/favicon.ico'</span>)))</span><br><span class=\"line\"><span class=\"comment\">// app.js line 79 ?</span></span><br><span class=\"line\"><span class=\"comment\">//Let's 301 redirect to simply dillinger.io</span></span><br></pre></td></tr></table></figure>\n<p>The above problems have not been solved yet,but the main problem is the inability to modify the template file “readme.md” that was initially loaded.The location of this configuration cannot be located at this time.</p>\n<p>So I started generating my own build editor.<br>Requirements are summarized as follows:</p>\n<p><center>markdown online</center></p>\n<blockquote>\n<ul>\n<li>editor<ul>\n<li style=\"list-style: none\"><input type=\"checkbox\" checked> real-time preview</li>\n<li style=\"list-style: none\"><input type=\"checkbox\" checked> automatically save</li>\n<li style=\"list-style: none\"><input type=\"checkbox\" checked> math expressions<br>advanced:</li>\n<li style=\"list-style: none\"><input type=\"checkbox\"> syntax hint</li>\n<li style=\"list-style: none\"><input type=\"checkbox\"> double bar rolling(change working-mode)</li>\n<li style=\"list-style: none\"><input type=\"checkbox\"> save to cloud such as github repositories</li>\n<li style=\"list-style: none\"><input type=\"checkbox\"> image cdn</li>\n</ul>\n</li>\n<li>file<ul>\n<li style=\"list-style: none\"><input type=\"checkbox\" checked> import .md file</li>\n<li style=\"list-style: none\"><input type=\"checkbox\" checked> export .md,html(style),PDF</li>\n</ul>\n</li>\n<li>hexo admin<ul>\n<li style=\"list-style: none\"><input type=\"checkbox\" checked> bind with github,generate and deploy?<br>install the hexo blog and hexo editor at the same host </li>\n</ul>\n</li>\n<li>requirements:<ul>\n<li style=\"list-style: none\"><input type=\"checkbox\" checked> open source</li>\n<li style=\"list-style: none\"><input type=\"checkbox\"> design for public<br>All files are temporarily stored<br>but also for private use:<br>Bind account and login by authorization</li>\n</ul>\n</li>\n<li>reference:<ul>\n<li><a href=\"https://github.com/joemccann/dillinger\" target=\"_blank\" rel=\"noopener\">dillinger</a></li>\n<li><a href=\"https://github.com/tajpure/hexo-editor\" target=\"_blank\" rel=\"noopener\">hexo editor</a></li>\n</ul>\n</li>\n</ul>\n</blockquote>\n<p> So it looks like we’re going to have to use VPS，so here comes the question:</p>\n<p> Why not just deploy hexo directly on top of it when you have VPS?</p>\n<p> Does extending so much functionality violate hexo’s simplicity?</p>\n<p> It’s going to look more and more like a CMS,</p>\n<p> So if this goes on, what’s the point of hexo versus wordpress？</p>\n<p> I’m starting to get lost…</p>\n","site":{"data":{}},"excerpt":"<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// package-lock.json </span></span><br><span class=\"line\"><span class=\"comment\">// line 15310 </span></span><br><span class=\"line\"><span class=\"string\">\"phantomjs\"</span>: <span class=\"string\">\"~1.9.7\"</span> -&gt;         <span class=\"string\">\"phantomjs\"</span>: <span class=\"string\">\"~2.1.16\"</span></span><br><span class=\"line\"><span class=\"comment\">// line 15380</span></span><br><span class=\"line\"><span class=\"string\">\"version\"</span>: <span class=\"string\">\"1.9.20\"</span> -&gt;<span class=\"string\">\"version\"</span>: <span class=\"string\">\"2.1.16\"</span></span><br></pre></td></tr></table></figure>","more":"<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// app.js line 46 ?</span></span><br><span class=\"line\"><span class=\"comment\">//May not need to use favicon if using nginx for serving</span></span><br><span class=\"line\"><span class=\"comment\">//static assets. Just comment it out below.</span></span><br><span class=\"line\">app.use(favicon(path.join(__dirname, <span class=\"string\">'public/favicon.ico'</span>)))</span><br><span class=\"line\"><span class=\"comment\">// app.js line 79 ?</span></span><br><span class=\"line\"><span class=\"comment\">//Let's 301 redirect to simply dillinger.io</span></span><br></pre></td></tr></table></figure>\n<p>The above problems have not been solved yet,but the main problem is the inability to modify the template file “readme.md” that was initially loaded.The location of this configuration cannot be located at this time.</p>\n<p>So I started generating my own build editor.<br>Requirements are summarized as follows:</p>\n<p><center>markdown online</center></p>\n<blockquote>\n<ul>\n<li>editor<ul>\n<li style=\"list-style: none\"><input type=\"checkbox\" checked> real-time preview</li>\n<li style=\"list-style: none\"><input type=\"checkbox\" checked> automatically save</li>\n<li style=\"list-style: none\"><input type=\"checkbox\" checked> math expressions<br>advanced:</li>\n<li style=\"list-style: none\"><input type=\"checkbox\"> syntax hint</li>\n<li style=\"list-style: none\"><input type=\"checkbox\"> double bar rolling(change working-mode)</li>\n<li style=\"list-style: none\"><input type=\"checkbox\"> save to cloud such as github repositories</li>\n<li style=\"list-style: none\"><input type=\"checkbox\"> image cdn</li>\n</ul>\n</li>\n<li>file<ul>\n<li style=\"list-style: none\"><input type=\"checkbox\" checked> import .md file</li>\n<li style=\"list-style: none\"><input type=\"checkbox\" checked> export .md,html(style),PDF</li>\n</ul>\n</li>\n<li>hexo admin<ul>\n<li style=\"list-style: none\"><input type=\"checkbox\" checked> bind with github,generate and deploy?<br>install the hexo blog and hexo editor at the same host </li>\n</ul>\n</li>\n<li>requirements:<ul>\n<li style=\"list-style: none\"><input type=\"checkbox\" checked> open source</li>\n<li style=\"list-style: none\"><input type=\"checkbox\"> design for public<br>All files are temporarily stored<br>but also for private use:<br>Bind account and login by authorization</li>\n</ul>\n</li>\n<li>reference:<ul>\n<li><a href=\"https://github.com/joemccann/dillinger\" target=\"_blank\" rel=\"noopener\">dillinger</a></li>\n<li><a href=\"https://github.com/tajpure/hexo-editor\" target=\"_blank\" rel=\"noopener\">hexo editor</a></li>\n</ul>\n</li>\n</ul>\n</blockquote>\n<p> So it looks like we’re going to have to use VPS，so here comes the question:</p>\n<p> Why not just deploy hexo directly on top of it when you have VPS?</p>\n<p> Does extending so much functionality violate hexo’s simplicity?</p>\n<p> It’s going to look more and more like a CMS,</p>\n<p> So if this goes on, what’s the point of hexo versus wordpress？</p>\n<p> I’m starting to get lost…</p>"},{"title":"About the configuration of this website","date":"2019-03-31T12:46:25.000Z","_content":"\n# 1 Init\n<!-- more -->\n## 1.1 Download\n\n### 1.1.1 hexo\n\n```sh\nhexo init makergyt.github.io\ncd makergyt.github.io\ncnpm install\n# package.json\n{\n  \"name\": \"hexo-site\",\n  \"version\": \"0.0.0\",\n  \"private\": true,\n  \"hexo\": {\n    \"version\": \"\"\n  },\n  \"dependencies\": {\n    \"hexo\": \"^3.8.0\",\n    \"hexo-generator-archive\": \"^0.1.5\",\n    \"hexo-generator-category\": \"^0.1.3\",\n    \"hexo-generator-index\": \"^0.2.1\",\n    \"hexo-generator-tag\": \"^0.2.0\",\n    \"hexo-renderer-ejs\": \"^0.3.1\",\n    \"hexo-renderer-stylus\": \"^0.3.3\",\n    \"hexo-renderer-marked\": \"^0.3.2\",\n    \"hexo-server\": \"^0.3.3\"\n  }\n}\n```\n\n### 1.1.2 next\n\n```sh\ncd makergyt.github.io\ngit clone https://github.com/theme-next/hexo-theme-next themes/next\n```\n\n# 2 user-defined\n\n## 2.1 hexo\n\n```yml\n# ./_config.yml\n# Site\nauthor: Gao Yuting\nlanguage:\n  - zh-CN\n  - en\n  \ntimezone: Asia/Shanghai\n# URL\nurl: https://blog.makergyt.com\npermalink: :lang/:title/\npermalink_defaults:\n  lang: zh-CN\nroot: /\n# Deployment\ndeploy:\n  - type: git\n    repo: git@github.com:MakerGYT/makergyt.github.io.git\n    branch: master\n  - type: git\n    repo: git@git.dev.tencent.com:memakergytcom/blog.git\n    branch: master\n# Writing\nnew_post_name: :lang/:title.md\n```\n\n### 2.1.1 deployment\n\n```sh\ncnpm install hexo-deployer-git --save\n# deploy on coding pages `Error`: no styles\n# next/_config.yml\n- type: git\n    - repo: git@git.dev.tencent.com:memakergytcom/blog.git\n    + repo: git@git.dev.tencent.com:memakergytcom/memakergytcom.git\n    # The authorities did not say,project name must be user name when coding pages is used (similar to github pages).This is a bug:\n    - url:memakergytcom.coding.me/blog\n    + url:memakergytcom.coding.me\n    # my url: blog-cn.makergyt.com\n```\n\n### 2.1.2 hexo-qiniu-sync\n```sh\ncnpm install hexo-qiniu-sync --save\n# ./_config.yml\nqiniu:\n  offline: false\n  sync: true\n  bucket:  blog \n  # secret_file: sec/qn.json or C:\n  access_key: \n  secret_key: -7s1GaiE82h-AKUAIqsd9X\n  dirPrefix: static\n  urlPrefix: https://blog-cdn.makergyt.com/static\n  up_host: http://upload.qiniu.com\n  local_dir: cdn\n  update_exist: true\n  image: \n    folder: images\n    extend: \n  js:\n    folder: js\n  css:\n    folder: css\n# md reference.md\n{% qnimg book.jpg title:图片标题 alt:图片说明  extend:?imageView2/2/w/600 %}\n```\n\n### 2.1.2 hexo-reference\n```sh\ncnpm install hexo-reference --save\n# ./_config.yml\nPlugins:\n  - hexo-reference\n```\n## 2.2 next\n\n```yml\n# next/_config.yml\nmenu:\n  home: / || chrome\n  about: /about/ || address-card\n  categories: /categories/ || th\n  archives: /archives/ || archive\nfavicon: # makergyt.github.io/source/images/\n  small: /images/favicon-16x16.png\n  medium: /images/favicon-32x32.png\n  apple_touch_icon: /images/apple-touch-icon.png\n  safari_pinned_tab: /images/safari-pinned-tab.svg\n  ms_browserconfig: /images/browserconfig.xml\n  # need to transparent\nfooter:\n  since: 2018\n  icon:\n    name: heart\n    animated: true\n    color: \"#ff0000\"\n  powered:\n    enable: false\n  beian:\n    enable: true\n    icp: 陕ICP备16017712号-1\ncreative_commons:\n  license: by-nc-sa\n  sidebar: true\n  post: false\n  language: deed.zh\ngithub_banner:\n  enable: true\n  permalink: https://github.com/makergyt\n  title: GitHub\nmobile_layout_economy: true\ncustom_logo:\n  enable: true\n  image: /images/favicon-32x32.png\nfont:\n  enable: true\n  global:\n    family: Monda\nmotion:\n  enable: true\n  transition:\n    post_block: shrinkIn\nseo: true\ncheers: false\nscroll_to_more: true\nsave_scroll: true\ncodeblock:\n  copy_button:\n    enable: true\n    show_result: true\n    style: flat\nhighlight_theme: normal\nwechat_subscriber:\n  enable: true\n  qcode: /images/wechat-qcode.jpg\n  description: scan to see the vaster world\nreward_settings:\n  enable: true\n  animation: false\n  comment: Add chicken leg\nreward:\n  wechat: /images/wechatpay.png\nrelated_posts:\n  enable: true\nsocial:\n  E-Mail: mailto:me@makergyt.com || envelope\n  Weibo: https://weibo.com/u/5165628041 || weibo\n  Twitter: https://twitter.com/makergyt || twitter\n  FB Page: https://www.facebook.com/makergyt || facebook\n  500PX: https://500px.com || 500px\n  Telegram: https://t.me/makergyt || telegram\nsocial_icons:\n  enable: true\n  icons_only: true\nlinks_icon: anchor\nlinks:\n  Main site: https://makergyt.com\nback2top:\n  enable: true\n  sidebar: true\n  scrollpercent: true\ngitalk:\n  enable: true\n  github_id: makergyt\n  repo: makergyt.github.io\n  client_id: 64a9c28ff540acfb8d4b\n  client_secret: 647cb5af47a926a76f6eb1d1001fe8a5230dd0b0\n  admin_user: makergyt\nbaidu_analytics: 3af747eaf2360bbaf46d8aa9f5b62d22\nreading_progress:\n  enable: true\nreading_progress: //cdn.jsdelivr.net/gh/theme-next/\ntheme-next-reading-progress@1.1/reading_progress.min.js\ncanvas_nest: true\ncanvas_nest: //cdn.jsdelivr.net/npm/canvas-nest.js@1.0.1/dist/canvas-nest.min.js\nmath:\n  enable: true\n  per_page: true\n  engine: mathjax\n  mathjax:\n    cdn: //cdn.jsdelivr.net/npm/mathjax@2/MathJax.js?config=TeX-AMS-MML_HTMLorMML\nnote:\n  style: flat\npdf:\n  enable: true\ngoogle_site_verification: XAprdFd37bx8X8i-_S77-8ArPy8hkI5RCtKym1Z52rY\nbing_site_verification: E14AC9D3BA8CE3C20D05F77EE7BC738F\nmermaid:\n  enable: true\n  theme: default\n  cdn: //cdn.jsdelivr.net/npm/mermaid@8.0.0/dist/mermaid.min.js\n```\n\n### 2.2.1 404\n\n```sh\n# source/404/404.md\n---\ntitle: 404\ndate: 1970-01-01 00:00:00\n---\n\n<script src=\"//qzonestyle.gtimg.cn/qzone/hybrid/app/404/search_children.js\" charset=\"utf-8\" homePageUrl=\"/\" homePageName=\"Back to home\"></script>\n\n```\n\n### 2.2.2 Post Wordcount\n\n```sh\ncnpm install hexo-symbols-count-time --save\n# ./_config.yml\nsymbols_count_time:\n  symbols: true\n  time: true\n  total_symbols: false\n  total_time: false\n# next/_config.yml\nsymbols_count_time:\n  separated_meta: true\n  item_text_post: true\n  item_text_total: false\n  awl: 4\n  wpm: 275\n```\n\n### 2.2.3 Local Search\n\n```sh\ncnpm install hexo-generator-searchdb --save\n# ./_config.yml\nsearch:\n  path: search.xml\n  field: post\n  format: html\n  limit: 10000\n# next/_config.yml\nlocal_search:\n  enable: true\nfancybox: true\nfancybox: //cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.js\nfancybox_css: //cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.css\n```\n\n### 2.2.4 Add end\n\n```sh\nvim /themes/next/layout/_macro/passage-end-tag.swig\n<div>\n    {% if not is_index %}\n        <div style=\"text-align:center;color: #ccc;font-size:14px;\">-------------end-------------</div>\n    {% endif %}\n</div>\nvim /themes/next/layout/_macro/post.swig\n# line 333\n<div>\n  {% if not is_index %}\n    {% include 'passage-end-tag.swig' %}\n  {% endif %}\n</div>\n# next/_config.yml\npassage_end_tag:\n  enabled: true\n```\n### 2.2.5 encrypt\n```sh\ncnpm install --save hexo-blog-encrypt\n# ./_config.yml\n# Security\nencrypt:\n    enable: true\n```\n### 2.2.6 music\n#### 2.2.6.1 sidebar\n```sh\nvim /themes/next/layout/_macro/siderbar.swig\n# siderbar.swig line 168\n{% if theme.music.enabled %}\n  <iframe frameborder=\"no\" border=\"0\" marginwidth=\"0\" marginheight=\"0\" width=330 height=86 src=\"{{ theme.music.song }}\"></iframe>\n{% endif %}\n# next/_config.yml\nmusic: \n  enabled: true\n  song: //music.163.com/outchain/player?type=2&id=28692687&auto=0&height=66\n```\n#### 2.2.6.2 page\n```sh\ncnpm install --save hexo-tag-aplayer\n# ./_config.xml\naplayer:\n  meting: true\n# ./about/index.md\n{% meting \"2526283537\" \"netease\" \"playlist\" \"mutex:false\" \"listmaxheight:340px\" \"preload:none\" \"theme:#FC6423\"%}\n```\n# Reference\n\n<small>[1] NexT.Gemini.Documentation[EB/OL].https://theme-next.org/docs/ .2019.</small>","source":"_posts/en/about-config.md","raw":"---\ntitle: About the configuration of this website\ndate: 2019/3/31 20:46:25\ncategories: config\n---\n\n# 1 Init\n<!-- more -->\n## 1.1 Download\n\n### 1.1.1 hexo\n\n```sh\nhexo init makergyt.github.io\ncd makergyt.github.io\ncnpm install\n# package.json\n{\n  \"name\": \"hexo-site\",\n  \"version\": \"0.0.0\",\n  \"private\": true,\n  \"hexo\": {\n    \"version\": \"\"\n  },\n  \"dependencies\": {\n    \"hexo\": \"^3.8.0\",\n    \"hexo-generator-archive\": \"^0.1.5\",\n    \"hexo-generator-category\": \"^0.1.3\",\n    \"hexo-generator-index\": \"^0.2.1\",\n    \"hexo-generator-tag\": \"^0.2.0\",\n    \"hexo-renderer-ejs\": \"^0.3.1\",\n    \"hexo-renderer-stylus\": \"^0.3.3\",\n    \"hexo-renderer-marked\": \"^0.3.2\",\n    \"hexo-server\": \"^0.3.3\"\n  }\n}\n```\n\n### 1.1.2 next\n\n```sh\ncd makergyt.github.io\ngit clone https://github.com/theme-next/hexo-theme-next themes/next\n```\n\n# 2 user-defined\n\n## 2.1 hexo\n\n```yml\n# ./_config.yml\n# Site\nauthor: Gao Yuting\nlanguage:\n  - zh-CN\n  - en\n  \ntimezone: Asia/Shanghai\n# URL\nurl: https://blog.makergyt.com\npermalink: :lang/:title/\npermalink_defaults:\n  lang: zh-CN\nroot: /\n# Deployment\ndeploy:\n  - type: git\n    repo: git@github.com:MakerGYT/makergyt.github.io.git\n    branch: master\n  - type: git\n    repo: git@git.dev.tencent.com:memakergytcom/blog.git\n    branch: master\n# Writing\nnew_post_name: :lang/:title.md\n```\n\n### 2.1.1 deployment\n\n```sh\ncnpm install hexo-deployer-git --save\n# deploy on coding pages `Error`: no styles\n# next/_config.yml\n- type: git\n    - repo: git@git.dev.tencent.com:memakergytcom/blog.git\n    + repo: git@git.dev.tencent.com:memakergytcom/memakergytcom.git\n    # The authorities did not say,project name must be user name when coding pages is used (similar to github pages).This is a bug:\n    - url:memakergytcom.coding.me/blog\n    + url:memakergytcom.coding.me\n    # my url: blog-cn.makergyt.com\n```\n\n### 2.1.2 hexo-qiniu-sync\n```sh\ncnpm install hexo-qiniu-sync --save\n# ./_config.yml\nqiniu:\n  offline: false\n  sync: true\n  bucket:  blog \n  # secret_file: sec/qn.json or C:\n  access_key: \n  secret_key: -7s1GaiE82h-AKUAIqsd9X\n  dirPrefix: static\n  urlPrefix: https://blog-cdn.makergyt.com/static\n  up_host: http://upload.qiniu.com\n  local_dir: cdn\n  update_exist: true\n  image: \n    folder: images\n    extend: \n  js:\n    folder: js\n  css:\n    folder: css\n# md reference.md\n{% qnimg book.jpg title:图片标题 alt:图片说明  extend:?imageView2/2/w/600 %}\n```\n\n### 2.1.2 hexo-reference\n```sh\ncnpm install hexo-reference --save\n# ./_config.yml\nPlugins:\n  - hexo-reference\n```\n## 2.2 next\n\n```yml\n# next/_config.yml\nmenu:\n  home: / || chrome\n  about: /about/ || address-card\n  categories: /categories/ || th\n  archives: /archives/ || archive\nfavicon: # makergyt.github.io/source/images/\n  small: /images/favicon-16x16.png\n  medium: /images/favicon-32x32.png\n  apple_touch_icon: /images/apple-touch-icon.png\n  safari_pinned_tab: /images/safari-pinned-tab.svg\n  ms_browserconfig: /images/browserconfig.xml\n  # need to transparent\nfooter:\n  since: 2018\n  icon:\n    name: heart\n    animated: true\n    color: \"#ff0000\"\n  powered:\n    enable: false\n  beian:\n    enable: true\n    icp: 陕ICP备16017712号-1\ncreative_commons:\n  license: by-nc-sa\n  sidebar: true\n  post: false\n  language: deed.zh\ngithub_banner:\n  enable: true\n  permalink: https://github.com/makergyt\n  title: GitHub\nmobile_layout_economy: true\ncustom_logo:\n  enable: true\n  image: /images/favicon-32x32.png\nfont:\n  enable: true\n  global:\n    family: Monda\nmotion:\n  enable: true\n  transition:\n    post_block: shrinkIn\nseo: true\ncheers: false\nscroll_to_more: true\nsave_scroll: true\ncodeblock:\n  copy_button:\n    enable: true\n    show_result: true\n    style: flat\nhighlight_theme: normal\nwechat_subscriber:\n  enable: true\n  qcode: /images/wechat-qcode.jpg\n  description: scan to see the vaster world\nreward_settings:\n  enable: true\n  animation: false\n  comment: Add chicken leg\nreward:\n  wechat: /images/wechatpay.png\nrelated_posts:\n  enable: true\nsocial:\n  E-Mail: mailto:me@makergyt.com || envelope\n  Weibo: https://weibo.com/u/5165628041 || weibo\n  Twitter: https://twitter.com/makergyt || twitter\n  FB Page: https://www.facebook.com/makergyt || facebook\n  500PX: https://500px.com || 500px\n  Telegram: https://t.me/makergyt || telegram\nsocial_icons:\n  enable: true\n  icons_only: true\nlinks_icon: anchor\nlinks:\n  Main site: https://makergyt.com\nback2top:\n  enable: true\n  sidebar: true\n  scrollpercent: true\ngitalk:\n  enable: true\n  github_id: makergyt\n  repo: makergyt.github.io\n  client_id: 64a9c28ff540acfb8d4b\n  client_secret: 647cb5af47a926a76f6eb1d1001fe8a5230dd0b0\n  admin_user: makergyt\nbaidu_analytics: 3af747eaf2360bbaf46d8aa9f5b62d22\nreading_progress:\n  enable: true\nreading_progress: //cdn.jsdelivr.net/gh/theme-next/\ntheme-next-reading-progress@1.1/reading_progress.min.js\ncanvas_nest: true\ncanvas_nest: //cdn.jsdelivr.net/npm/canvas-nest.js@1.0.1/dist/canvas-nest.min.js\nmath:\n  enable: true\n  per_page: true\n  engine: mathjax\n  mathjax:\n    cdn: //cdn.jsdelivr.net/npm/mathjax@2/MathJax.js?config=TeX-AMS-MML_HTMLorMML\nnote:\n  style: flat\npdf:\n  enable: true\ngoogle_site_verification: XAprdFd37bx8X8i-_S77-8ArPy8hkI5RCtKym1Z52rY\nbing_site_verification: E14AC9D3BA8CE3C20D05F77EE7BC738F\nmermaid:\n  enable: true\n  theme: default\n  cdn: //cdn.jsdelivr.net/npm/mermaid@8.0.0/dist/mermaid.min.js\n```\n\n### 2.2.1 404\n\n```sh\n# source/404/404.md\n---\ntitle: 404\ndate: 1970-01-01 00:00:00\n---\n\n<script src=\"//qzonestyle.gtimg.cn/qzone/hybrid/app/404/search_children.js\" charset=\"utf-8\" homePageUrl=\"/\" homePageName=\"Back to home\"></script>\n\n```\n\n### 2.2.2 Post Wordcount\n\n```sh\ncnpm install hexo-symbols-count-time --save\n# ./_config.yml\nsymbols_count_time:\n  symbols: true\n  time: true\n  total_symbols: false\n  total_time: false\n# next/_config.yml\nsymbols_count_time:\n  separated_meta: true\n  item_text_post: true\n  item_text_total: false\n  awl: 4\n  wpm: 275\n```\n\n### 2.2.3 Local Search\n\n```sh\ncnpm install hexo-generator-searchdb --save\n# ./_config.yml\nsearch:\n  path: search.xml\n  field: post\n  format: html\n  limit: 10000\n# next/_config.yml\nlocal_search:\n  enable: true\nfancybox: true\nfancybox: //cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.js\nfancybox_css: //cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.css\n```\n\n### 2.2.4 Add end\n\n```sh\nvim /themes/next/layout/_macro/passage-end-tag.swig\n<div>\n    {% if not is_index %}\n        <div style=\"text-align:center;color: #ccc;font-size:14px;\">-------------end-------------</div>\n    {% endif %}\n</div>\nvim /themes/next/layout/_macro/post.swig\n# line 333\n<div>\n  {% if not is_index %}\n    {% include 'passage-end-tag.swig' %}\n  {% endif %}\n</div>\n# next/_config.yml\npassage_end_tag:\n  enabled: true\n```\n### 2.2.5 encrypt\n```sh\ncnpm install --save hexo-blog-encrypt\n# ./_config.yml\n# Security\nencrypt:\n    enable: true\n```\n### 2.2.6 music\n#### 2.2.6.1 sidebar\n```sh\nvim /themes/next/layout/_macro/siderbar.swig\n# siderbar.swig line 168\n{% if theme.music.enabled %}\n  <iframe frameborder=\"no\" border=\"0\" marginwidth=\"0\" marginheight=\"0\" width=330 height=86 src=\"{{ theme.music.song }}\"></iframe>\n{% endif %}\n# next/_config.yml\nmusic: \n  enabled: true\n  song: //music.163.com/outchain/player?type=2&id=28692687&auto=0&height=66\n```\n#### 2.2.6.2 page\n```sh\ncnpm install --save hexo-tag-aplayer\n# ./_config.xml\naplayer:\n  meting: true\n# ./about/index.md\n{% meting \"2526283537\" \"netease\" \"playlist\" \"mutex:false\" \"listmaxheight:340px\" \"preload:none\" \"theme:#FC6423\"%}\n```\n# Reference\n\n<small>[1] NexT.Gemini.Documentation[EB/OL].https://theme-next.org/docs/ .2019.</small>","slug":"about-config","published":1,"lang":"en","updated":"2019-04-29T01:07:50.656Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjvnq7z9l00077jjxitq0pswn","content":"<link rel=\"stylesheet\" class=\"aplayer-secondary-style-marker\" href=\"/assets/css/APlayer.min.css\"><script src=\"/assets/js/APlayer.min.js\" class=\"aplayer-secondary-script-marker\"></script><script class=\"meting-secondary-script-marker\" src=\"/assets/js/Meting.min.js\"></script><link rel=\"stylesheet\" type=\"text/css\" href=\"https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css\"><h1 id=\"1-Init\"><a href=\"#1-Init\" class=\"headerlink\" title=\"1 Init\"></a>1 Init</h1><a id=\"more\"></a>\n<h2 id=\"1-1-Download\"><a href=\"#1-1-Download\" class=\"headerlink\" title=\"1.1 Download\"></a>1.1 Download</h2><h3 id=\"1-1-1-hexo\"><a href=\"#1-1-1-hexo\" class=\"headerlink\" title=\"1.1.1 hexo\"></a>1.1.1 hexo</h3><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">hexo init makergyt.github.io</span><br><span class=\"line\"><span class=\"built_in\">cd</span> makergyt.github.io</span><br><span class=\"line\">cnpm install</span><br><span class=\"line\"><span class=\"comment\"># package.json</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"string\">\"name\"</span>: <span class=\"string\">\"hexo-site\"</span>,</span><br><span class=\"line\">  <span class=\"string\">\"version\"</span>: <span class=\"string\">\"0.0.0\"</span>,</span><br><span class=\"line\">  <span class=\"string\">\"private\"</span>: <span class=\"literal\">true</span>,</span><br><span class=\"line\">  <span class=\"string\">\"hexo\"</span>: &#123;</span><br><span class=\"line\">    <span class=\"string\">\"version\"</span>: <span class=\"string\">\"\"</span></span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  <span class=\"string\">\"dependencies\"</span>: &#123;</span><br><span class=\"line\">    <span class=\"string\">\"hexo\"</span>: <span class=\"string\">\"^3.8.0\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"hexo-generator-archive\"</span>: <span class=\"string\">\"^0.1.5\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"hexo-generator-category\"</span>: <span class=\"string\">\"^0.1.3\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"hexo-generator-index\"</span>: <span class=\"string\">\"^0.2.1\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"hexo-generator-tag\"</span>: <span class=\"string\">\"^0.2.0\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"hexo-renderer-ejs\"</span>: <span class=\"string\">\"^0.3.1\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"hexo-renderer-stylus\"</span>: <span class=\"string\">\"^0.3.3\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"hexo-renderer-marked\"</span>: <span class=\"string\">\"^0.3.2\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"hexo-server\"</span>: <span class=\"string\">\"^0.3.3\"</span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"1-1-2-next\"><a href=\"#1-1-2-next\" class=\"headerlink\" title=\"1.1.2 next\"></a>1.1.2 next</h3><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">cd</span> makergyt.github.io</span><br><span class=\"line\">git <span class=\"built_in\">clone</span> https://github.com/theme-next/hexo-theme-next themes/next</span><br></pre></td></tr></table></figure>\n<h1 id=\"2-user-defined\"><a href=\"#2-user-defined\" class=\"headerlink\" title=\"2 user-defined\"></a>2 user-defined</h1><h2 id=\"2-1-hexo\"><a href=\"#2-1-hexo\" class=\"headerlink\" title=\"2.1 hexo\"></a>2.1 hexo</h2><figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># ./_config.yml</span></span><br><span class=\"line\"><span class=\"comment\"># Site</span></span><br><span class=\"line\"><span class=\"attr\">author:</span> <span class=\"string\">Gao</span> <span class=\"string\">Yuting</span></span><br><span class=\"line\"><span class=\"attr\">language:</span></span><br><span class=\"line\"><span class=\"bullet\">  -</span> <span class=\"string\">zh-CN</span></span><br><span class=\"line\"><span class=\"bullet\">  -</span> <span class=\"string\">en</span></span><br><span class=\"line\">  </span><br><span class=\"line\"><span class=\"attr\">timezone:</span> <span class=\"string\">Asia/Shanghai</span></span><br><span class=\"line\"><span class=\"comment\"># URL</span></span><br><span class=\"line\"><span class=\"attr\">url:</span> <span class=\"attr\">https://blog.makergyt.com</span></span><br><span class=\"line\"><span class=\"attr\">permalink:</span> <span class=\"string\">:lang/:title/</span></span><br><span class=\"line\"><span class=\"attr\">permalink_defaults:</span></span><br><span class=\"line\"><span class=\"attr\">  lang:</span> <span class=\"string\">zh-CN</span></span><br><span class=\"line\"><span class=\"attr\">root:</span> <span class=\"string\">/</span></span><br><span class=\"line\"><span class=\"comment\"># Deployment</span></span><br><span class=\"line\"><span class=\"attr\">deploy:</span></span><br><span class=\"line\"><span class=\"attr\">  - type:</span> <span class=\"string\">git</span></span><br><span class=\"line\"><span class=\"attr\">    repo:</span> <span class=\"string\">git@github.com:MakerGYT/makergyt.github.io.git</span></span><br><span class=\"line\"><span class=\"attr\">    branch:</span> <span class=\"string\">master</span></span><br><span class=\"line\"><span class=\"attr\">  - type:</span> <span class=\"string\">git</span></span><br><span class=\"line\"><span class=\"attr\">    repo:</span> <span class=\"string\">git@git.dev.tencent.com:memakergytcom/blog.git</span></span><br><span class=\"line\"><span class=\"attr\">    branch:</span> <span class=\"string\">master</span></span><br><span class=\"line\"><span class=\"comment\"># Writing</span></span><br><span class=\"line\"><span class=\"attr\">new_post_name:</span> <span class=\"string\">:lang/:title.md</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"2-1-1-deployment\"><a href=\"#2-1-1-deployment\" class=\"headerlink\" title=\"2.1.1 deployment\"></a>2.1.1 deployment</h3><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cnpm install hexo-deployer-git --save</span><br><span class=\"line\"><span class=\"comment\"># deploy on coding pages `Error`: no styles</span></span><br><span class=\"line\"><span class=\"comment\"># next/_config.yml</span></span><br><span class=\"line\">- <span class=\"built_in\">type</span>: git</span><br><span class=\"line\">    - repo: git@git.dev.tencent.com:memakergytcom/blog.git</span><br><span class=\"line\">    + repo: git@git.dev.tencent.com:memakergytcom/memakergytcom.git</span><br><span class=\"line\">    <span class=\"comment\"># The authorities did not say,project name must be user name when coding pages is used (similar to github pages).This is a bug:</span></span><br><span class=\"line\">    - url:memakergytcom.coding.me/blog</span><br><span class=\"line\">    + url:memakergytcom.coding.me</span><br><span class=\"line\">    <span class=\"comment\"># my url: blog-cn.makergyt.com</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"2-1-2-hexo-qiniu-sync\"><a href=\"#2-1-2-hexo-qiniu-sync\" class=\"headerlink\" title=\"2.1.2 hexo-qiniu-sync\"></a>2.1.2 hexo-qiniu-sync</h3><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cnpm install hexo-qiniu-sync --save</span><br><span class=\"line\"><span class=\"comment\"># ./_config.yml</span></span><br><span class=\"line\">qiniu:</span><br><span class=\"line\">  offline: <span class=\"literal\">false</span></span><br><span class=\"line\">  sync: <span class=\"literal\">true</span></span><br><span class=\"line\">  bucket:  blog </span><br><span class=\"line\">  <span class=\"comment\"># secret_file: sec/qn.json or C:</span></span><br><span class=\"line\">  access_key: </span><br><span class=\"line\">  secret_key: -7s1GaiE82h-AKUAIqsd9X</span><br><span class=\"line\">  dirPrefix: static</span><br><span class=\"line\">  urlPrefix: https://blog-cdn.makergyt.com/static</span><br><span class=\"line\">  up_host: http://upload.qiniu.com</span><br><span class=\"line\">  local_dir: cdn</span><br><span class=\"line\">  update_exist: <span class=\"literal\">true</span></span><br><span class=\"line\">  image: </span><br><span class=\"line\">    folder: images</span><br><span class=\"line\">    extend: </span><br><span class=\"line\">  js:</span><br><span class=\"line\">    folder: js</span><br><span class=\"line\">  css:</span><br><span class=\"line\">    folder: css</span><br><span class=\"line\"><span class=\"comment\"># md reference.md</span></span><br><span class=\"line\">&#123;% qnimg book.jpg title:图片标题 alt:图片说明  extend:?imageView2/2/w/600 %&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"2-1-2-hexo-reference\"><a href=\"#2-1-2-hexo-reference\" class=\"headerlink\" title=\"2.1.2 hexo-reference\"></a>2.1.2 hexo-reference</h3><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cnpm install hexo-reference --save</span><br><span class=\"line\"><span class=\"comment\"># ./_config.yml</span></span><br><span class=\"line\">Plugins:</span><br><span class=\"line\">  - hexo-reference</span><br></pre></td></tr></table></figure>\n<h2 id=\"2-2-next\"><a href=\"#2-2-next\" class=\"headerlink\" title=\"2.2 next\"></a>2.2 next</h2><figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># next/_config.yml</span></span><br><span class=\"line\"><span class=\"attr\">menu:</span></span><br><span class=\"line\"><span class=\"attr\">  home:</span> <span class=\"string\">/</span> <span class=\"string\">||</span> <span class=\"string\">chrome</span></span><br><span class=\"line\"><span class=\"attr\">  about:</span> <span class=\"string\">/about/</span> <span class=\"string\">||</span> <span class=\"string\">address-card</span></span><br><span class=\"line\"><span class=\"attr\">  categories:</span> <span class=\"string\">/categories/</span> <span class=\"string\">||</span> <span class=\"string\">th</span></span><br><span class=\"line\"><span class=\"attr\">  archives:</span> <span class=\"string\">/archives/</span> <span class=\"string\">||</span> <span class=\"string\">archive</span></span><br><span class=\"line\"><span class=\"attr\">favicon:</span> <span class=\"comment\"># makergyt.github.io/source/images/</span></span><br><span class=\"line\"><span class=\"attr\">  small:</span> <span class=\"string\">/images/favicon-16x16.png</span></span><br><span class=\"line\"><span class=\"attr\">  medium:</span> <span class=\"string\">/images/favicon-32x32.png</span></span><br><span class=\"line\"><span class=\"attr\">  apple_touch_icon:</span> <span class=\"string\">/images/apple-touch-icon.png</span></span><br><span class=\"line\"><span class=\"attr\">  safari_pinned_tab:</span> <span class=\"string\">/images/safari-pinned-tab.svg</span></span><br><span class=\"line\"><span class=\"attr\">  ms_browserconfig:</span> <span class=\"string\">/images/browserconfig.xml</span></span><br><span class=\"line\">  <span class=\"comment\"># need to transparent</span></span><br><span class=\"line\"><span class=\"attr\">footer:</span></span><br><span class=\"line\"><span class=\"attr\">  since:</span> <span class=\"number\">2018</span></span><br><span class=\"line\"><span class=\"attr\">  icon:</span></span><br><span class=\"line\"><span class=\"attr\">    name:</span> <span class=\"string\">heart</span></span><br><span class=\"line\"><span class=\"attr\">    animated:</span> <span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"attr\">    color:</span> <span class=\"string\">\"#ff0000\"</span></span><br><span class=\"line\"><span class=\"attr\">  powered:</span></span><br><span class=\"line\"><span class=\"attr\">    enable:</span> <span class=\"literal\">false</span></span><br><span class=\"line\"><span class=\"attr\">  beian:</span></span><br><span class=\"line\"><span class=\"attr\">    enable:</span> <span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"attr\">    icp:</span> <span class=\"string\">陕ICP备16017712号-1</span></span><br><span class=\"line\"><span class=\"attr\">creative_commons:</span></span><br><span class=\"line\"><span class=\"attr\">  license:</span> <span class=\"string\">by-nc-sa</span></span><br><span class=\"line\"><span class=\"attr\">  sidebar:</span> <span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"attr\">  post:</span> <span class=\"literal\">false</span></span><br><span class=\"line\"><span class=\"attr\">  language:</span> <span class=\"string\">deed.zh</span></span><br><span class=\"line\"><span class=\"attr\">github_banner:</span></span><br><span class=\"line\"><span class=\"attr\">  enable:</span> <span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"attr\">  permalink:</span> <span class=\"attr\">https://github.com/makergyt</span></span><br><span class=\"line\"><span class=\"attr\">  title:</span> <span class=\"string\">GitHub</span></span><br><span class=\"line\"><span class=\"attr\">mobile_layout_economy:</span> <span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"attr\">custom_logo:</span></span><br><span class=\"line\"><span class=\"attr\">  enable:</span> <span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"attr\">  image:</span> <span class=\"string\">/images/favicon-32x32.png</span></span><br><span class=\"line\"><span class=\"attr\">font:</span></span><br><span class=\"line\"><span class=\"attr\">  enable:</span> <span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"attr\">  global:</span></span><br><span class=\"line\"><span class=\"attr\">    family:</span> <span class=\"string\">Monda</span></span><br><span class=\"line\"><span class=\"attr\">motion:</span></span><br><span class=\"line\"><span class=\"attr\">  enable:</span> <span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"attr\">  transition:</span></span><br><span class=\"line\"><span class=\"attr\">    post_block:</span> <span class=\"string\">shrinkIn</span></span><br><span class=\"line\"><span class=\"attr\">seo:</span> <span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"attr\">cheers:</span> <span class=\"literal\">false</span></span><br><span class=\"line\"><span class=\"attr\">scroll_to_more:</span> <span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"attr\">save_scroll:</span> <span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"attr\">codeblock:</span></span><br><span class=\"line\"><span class=\"attr\">  copy_button:</span></span><br><span class=\"line\"><span class=\"attr\">    enable:</span> <span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"attr\">    show_result:</span> <span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"attr\">    style:</span> <span class=\"string\">flat</span></span><br><span class=\"line\"><span class=\"attr\">highlight_theme:</span> <span class=\"string\">normal</span></span><br><span class=\"line\"><span class=\"attr\">wechat_subscriber:</span></span><br><span class=\"line\"><span class=\"attr\">  enable:</span> <span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"attr\">  qcode:</span> <span class=\"string\">/images/wechat-qcode.jpg</span></span><br><span class=\"line\"><span class=\"attr\">  description:</span> <span class=\"string\">scan</span> <span class=\"string\">to</span> <span class=\"string\">see</span> <span class=\"string\">the</span> <span class=\"string\">vaster</span> <span class=\"string\">world</span></span><br><span class=\"line\"><span class=\"attr\">reward_settings:</span></span><br><span class=\"line\"><span class=\"attr\">  enable:</span> <span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"attr\">  animation:</span> <span class=\"literal\">false</span></span><br><span class=\"line\"><span class=\"attr\">  comment:</span> <span class=\"string\">Add</span> <span class=\"string\">chicken</span> <span class=\"string\">leg</span></span><br><span class=\"line\"><span class=\"attr\">reward:</span></span><br><span class=\"line\"><span class=\"attr\">  wechat:</span> <span class=\"string\">/images/wechatpay.png</span></span><br><span class=\"line\"><span class=\"attr\">related_posts:</span></span><br><span class=\"line\"><span class=\"attr\">  enable:</span> <span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"attr\">social:</span></span><br><span class=\"line\"><span class=\"attr\">  E-Mail:</span> <span class=\"attr\">mailto:me@makergyt.com</span> <span class=\"string\">||</span> <span class=\"string\">envelope</span></span><br><span class=\"line\"><span class=\"attr\">  Weibo:</span> <span class=\"attr\">https://weibo.com/u/5165628041</span> <span class=\"string\">||</span> <span class=\"string\">weibo</span></span><br><span class=\"line\"><span class=\"attr\">  Twitter:</span> <span class=\"attr\">https://twitter.com/makergyt</span> <span class=\"string\">||</span> <span class=\"string\">twitter</span></span><br><span class=\"line\">  <span class=\"string\">FB</span> <span class=\"attr\">Page:</span> <span class=\"attr\">https://www.facebook.com/makergyt</span> <span class=\"string\">||</span> <span class=\"string\">facebook</span></span><br><span class=\"line\">  <span class=\"number\">500</span><span class=\"attr\">PX:</span> <span class=\"attr\">https://500px.com</span> <span class=\"string\">||</span> <span class=\"number\">500</span><span class=\"string\">px</span></span><br><span class=\"line\"><span class=\"attr\">  Telegram:</span> <span class=\"attr\">https://t.me/makergyt</span> <span class=\"string\">||</span> <span class=\"string\">telegram</span></span><br><span class=\"line\"><span class=\"attr\">social_icons:</span></span><br><span class=\"line\"><span class=\"attr\">  enable:</span> <span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"attr\">  icons_only:</span> <span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"attr\">links_icon:</span> <span class=\"string\">anchor</span></span><br><span class=\"line\"><span class=\"attr\">links:</span></span><br><span class=\"line\">  <span class=\"string\">Main</span> <span class=\"attr\">site:</span> <span class=\"attr\">https://makergyt.com</span></span><br><span class=\"line\"><span class=\"attr\">back2top:</span></span><br><span class=\"line\"><span class=\"attr\">  enable:</span> <span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"attr\">  sidebar:</span> <span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"attr\">  scrollpercent:</span> <span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"attr\">gitalk:</span></span><br><span class=\"line\"><span class=\"attr\">  enable:</span> <span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"attr\">  github_id:</span> <span class=\"string\">makergyt</span></span><br><span class=\"line\"><span class=\"attr\">  repo:</span> <span class=\"string\">makergyt.github.io</span></span><br><span class=\"line\"><span class=\"attr\">  client_id:</span> <span class=\"number\">64</span><span class=\"string\">a9c28ff540acfb8d4b</span></span><br><span class=\"line\"><span class=\"attr\">  client_secret:</span> <span class=\"number\">647</span><span class=\"string\">cb5af47a926a76f6eb1d1001fe8a5230dd0b0</span></span><br><span class=\"line\"><span class=\"attr\">  admin_user:</span> <span class=\"string\">makergyt</span></span><br><span class=\"line\"><span class=\"attr\">baidu_analytics:</span> <span class=\"number\">3</span><span class=\"string\">af747eaf2360bbaf46d8aa9f5b62d22</span></span><br><span class=\"line\"><span class=\"attr\">reading_progress:</span></span><br><span class=\"line\"><span class=\"attr\">  enable:</span> <span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"attr\">reading_progress:</span> <span class=\"string\">//cdn.jsdelivr.net/gh/theme-next/</span></span><br><span class=\"line\"><span class=\"string\">theme-next-reading-progress@1.1/reading_progress.min.js</span></span><br><span class=\"line\"><span class=\"attr\">canvas_nest:</span> <span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"attr\">canvas_nest:</span> <span class=\"string\">//cdn.jsdelivr.net/npm/canvas-nest.js@1.0.1/dist/canvas-nest.min.js</span></span><br><span class=\"line\"><span class=\"attr\">math:</span></span><br><span class=\"line\"><span class=\"attr\">  enable:</span> <span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"attr\">  per_page:</span> <span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"attr\">  engine:</span> <span class=\"string\">mathjax</span></span><br><span class=\"line\"><span class=\"attr\">  mathjax:</span></span><br><span class=\"line\"><span class=\"attr\">    cdn:</span> <span class=\"string\">//cdn.jsdelivr.net/npm/mathjax@2/MathJax.js?config=TeX-AMS-MML_HTMLorMML</span></span><br><span class=\"line\"><span class=\"attr\">note:</span></span><br><span class=\"line\"><span class=\"attr\">  style:</span> <span class=\"string\">flat</span></span><br><span class=\"line\"><span class=\"attr\">pdf:</span></span><br><span class=\"line\"><span class=\"attr\">  enable:</span> <span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"attr\">google_site_verification:</span> <span class=\"string\">XAprdFd37bx8X8i-_S77-8ArPy8hkI5RCtKym1Z52rY</span></span><br><span class=\"line\"><span class=\"attr\">bing_site_verification:</span> <span class=\"string\">E14AC9D3BA8CE3C20D05F77EE7BC738F</span></span><br><span class=\"line\"><span class=\"attr\">mermaid:</span></span><br><span class=\"line\"><span class=\"attr\">  enable:</span> <span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"attr\">  theme:</span> <span class=\"string\">default</span></span><br><span class=\"line\"><span class=\"attr\">  cdn:</span> <span class=\"string\">//cdn.jsdelivr.net/npm/mermaid@8.0.0/dist/mermaid.min.js</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"2-2-1-404\"><a href=\"#2-2-1-404\" class=\"headerlink\" title=\"2.2.1 404\"></a>2.2.1 404</h3><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># source/404/404.md</span></span><br><span class=\"line\">---</span><br><span class=\"line\">title: 404</span><br><span class=\"line\">date: 1970-01-01 00:00:00</span><br><span class=\"line\">---</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;script src=<span class=\"string\">\"//qzonestyle.gtimg.cn/qzone/hybrid/app/404/search_children.js\"</span> charset=<span class=\"string\">\"utf-8\"</span> homePageUrl=<span class=\"string\">\"/\"</span> homePageName=<span class=\"string\">\"Back to home\"</span>&gt;&lt;/script&gt;</span><br></pre></td></tr></table></figure>\n<h3 id=\"2-2-2-Post-Wordcount\"><a href=\"#2-2-2-Post-Wordcount\" class=\"headerlink\" title=\"2.2.2 Post Wordcount\"></a>2.2.2 Post Wordcount</h3><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cnpm install hexo-symbols-count-time --save</span><br><span class=\"line\"><span class=\"comment\"># ./_config.yml</span></span><br><span class=\"line\">symbols_count_time:</span><br><span class=\"line\">  symbols: <span class=\"literal\">true</span></span><br><span class=\"line\">  time: <span class=\"literal\">true</span></span><br><span class=\"line\">  total_symbols: <span class=\"literal\">false</span></span><br><span class=\"line\">  total_time: <span class=\"literal\">false</span></span><br><span class=\"line\"><span class=\"comment\"># next/_config.yml</span></span><br><span class=\"line\">symbols_count_time:</span><br><span class=\"line\">  separated_meta: <span class=\"literal\">true</span></span><br><span class=\"line\">  item_text_post: <span class=\"literal\">true</span></span><br><span class=\"line\">  item_text_total: <span class=\"literal\">false</span></span><br><span class=\"line\">  awl: 4</span><br><span class=\"line\">  wpm: 275</span><br></pre></td></tr></table></figure>\n<h3 id=\"2-2-3-Local-Search\"><a href=\"#2-2-3-Local-Search\" class=\"headerlink\" title=\"2.2.3 Local Search\"></a>2.2.3 Local Search</h3><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cnpm install hexo-generator-searchdb --save</span><br><span class=\"line\"><span class=\"comment\"># ./_config.yml</span></span><br><span class=\"line\">search:</span><br><span class=\"line\">  path: search.xml</span><br><span class=\"line\">  field: post</span><br><span class=\"line\">  format: html</span><br><span class=\"line\">  <span class=\"built_in\">limit</span>: 10000</span><br><span class=\"line\"><span class=\"comment\"># next/_config.yml</span></span><br><span class=\"line\">local_search:</span><br><span class=\"line\">  <span class=\"built_in\">enable</span>: <span class=\"literal\">true</span></span><br><span class=\"line\">fancybox: <span class=\"literal\">true</span></span><br><span class=\"line\">fancybox: //cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.js</span><br><span class=\"line\">fancybox_css: //cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.css</span><br></pre></td></tr></table></figure>\n<h3 id=\"2-2-4-Add-end\"><a href=\"#2-2-4-Add-end\" class=\"headerlink\" title=\"2.2.4 Add end\"></a>2.2.4 Add end</h3><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vim /themes/next/layout/_macro/passage-end-tag.swig</span><br><span class=\"line\">&lt;div&gt;</span><br><span class=\"line\">    &#123;% <span class=\"keyword\">if</span> not is_index %&#125;</span><br><span class=\"line\">        &lt;div style=<span class=\"string\">\"text-align:center;color: #ccc;font-size:14px;\"</span>&gt;-------------end-------------&lt;/div&gt;</span><br><span class=\"line\">    &#123;% endif %&#125;</span><br><span class=\"line\">&lt;/div&gt;</span><br><span class=\"line\">vim /themes/next/layout/_macro/post.swig</span><br><span class=\"line\"><span class=\"comment\"># line 333</span></span><br><span class=\"line\">&lt;div&gt;</span><br><span class=\"line\">  &#123;% <span class=\"keyword\">if</span> not is_index %&#125;</span><br><span class=\"line\">    &#123;% include <span class=\"string\">'passage-end-tag.swig'</span> %&#125;</span><br><span class=\"line\">  &#123;% endif %&#125;</span><br><span class=\"line\">&lt;/div&gt;</span><br><span class=\"line\"><span class=\"comment\"># next/_config.yml</span></span><br><span class=\"line\">passage_end_tag:</span><br><span class=\"line\">  enabled: <span class=\"literal\">true</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"2-2-5-encrypt\"><a href=\"#2-2-5-encrypt\" class=\"headerlink\" title=\"2.2.5 encrypt\"></a>2.2.5 encrypt</h3><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cnpm install --save hexo-blog-encrypt</span><br><span class=\"line\"><span class=\"comment\"># ./_config.yml</span></span><br><span class=\"line\"><span class=\"comment\"># Security</span></span><br><span class=\"line\">encrypt:</span><br><span class=\"line\">    <span class=\"built_in\">enable</span>: <span class=\"literal\">true</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"2-2-6-music\"><a href=\"#2-2-6-music\" class=\"headerlink\" title=\"2.2.6 music\"></a>2.2.6 music</h3><h4 id=\"2-2-6-1-sidebar\"><a href=\"#2-2-6-1-sidebar\" class=\"headerlink\" title=\"2.2.6.1 sidebar\"></a>2.2.6.1 sidebar</h4><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vim /themes/next/layout/_macro/siderbar.swig</span><br><span class=\"line\"><span class=\"comment\"># siderbar.swig line 168</span></span><br><span class=\"line\">&#123;% <span class=\"keyword\">if</span> theme.music.enabled %&#125;</span><br><span class=\"line\">  &lt;iframe frameborder=<span class=\"string\">\"no\"</span> border=<span class=\"string\">\"0\"</span> marginwidth=<span class=\"string\">\"0\"</span> marginheight=<span class=\"string\">\"0\"</span> width=330 height=86 src=<span class=\"string\">\"&#123;&#123; theme.music.song &#125;&#125;\"</span>&gt;&lt;/iframe&gt;</span><br><span class=\"line\">&#123;% endif %&#125;</span><br><span class=\"line\"><span class=\"comment\"># next/_config.yml</span></span><br><span class=\"line\">music: </span><br><span class=\"line\">  enabled: <span class=\"literal\">true</span></span><br><span class=\"line\">  song: //music.163.com/outchain/player?<span class=\"built_in\">type</span>=2&amp;id=28692687&amp;auto=0&amp;height=66</span><br></pre></td></tr></table></figure>\n<h4 id=\"2-2-6-2-page\"><a href=\"#2-2-6-2-page\" class=\"headerlink\" title=\"2.2.6.2 page\"></a>2.2.6.2 page</h4><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cnpm install --save hexo-tag-aplayer</span><br><span class=\"line\"><span class=\"comment\"># ./_config.xml</span></span><br><span class=\"line\">aplayer:</span><br><span class=\"line\">  meting: <span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"comment\"># ./about/index.md</span></span><br><span class=\"line\">&#123;% meting <span class=\"string\">\"2526283537\"</span> <span class=\"string\">\"netease\"</span> <span class=\"string\">\"playlist\"</span> <span class=\"string\">\"mutex:false\"</span> <span class=\"string\">\"listmaxheight:340px\"</span> <span class=\"string\">\"preload:none\"</span> <span class=\"string\">\"theme:#FC6423\"</span>%&#125;</span><br></pre></td></tr></table></figure>\n<h1 id=\"Reference\"><a href=\"#Reference\" class=\"headerlink\" title=\"Reference\"></a>Reference</h1><p><small>[1] NexT.Gemini.Documentation[EB/OL].<a href=\"https://theme-next.org/docs/\" target=\"_blank\" rel=\"noopener\">https://theme-next.org/docs/</a> .2019.</small></p>\n","site":{"data":{}},"excerpt":"<h1 id=\"1-Init\"><a href=\"#1-Init\" class=\"headerlink\" title=\"1 Init\"></a>1 Init</h1>","more":"<h2 id=\"1-1-Download\"><a href=\"#1-1-Download\" class=\"headerlink\" title=\"1.1 Download\"></a>1.1 Download</h2><h3 id=\"1-1-1-hexo\"><a href=\"#1-1-1-hexo\" class=\"headerlink\" title=\"1.1.1 hexo\"></a>1.1.1 hexo</h3><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">hexo init makergyt.github.io</span><br><span class=\"line\"><span class=\"built_in\">cd</span> makergyt.github.io</span><br><span class=\"line\">cnpm install</span><br><span class=\"line\"><span class=\"comment\"># package.json</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"string\">\"name\"</span>: <span class=\"string\">\"hexo-site\"</span>,</span><br><span class=\"line\">  <span class=\"string\">\"version\"</span>: <span class=\"string\">\"0.0.0\"</span>,</span><br><span class=\"line\">  <span class=\"string\">\"private\"</span>: <span class=\"literal\">true</span>,</span><br><span class=\"line\">  <span class=\"string\">\"hexo\"</span>: &#123;</span><br><span class=\"line\">    <span class=\"string\">\"version\"</span>: <span class=\"string\">\"\"</span></span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  <span class=\"string\">\"dependencies\"</span>: &#123;</span><br><span class=\"line\">    <span class=\"string\">\"hexo\"</span>: <span class=\"string\">\"^3.8.0\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"hexo-generator-archive\"</span>: <span class=\"string\">\"^0.1.5\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"hexo-generator-category\"</span>: <span class=\"string\">\"^0.1.3\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"hexo-generator-index\"</span>: <span class=\"string\">\"^0.2.1\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"hexo-generator-tag\"</span>: <span class=\"string\">\"^0.2.0\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"hexo-renderer-ejs\"</span>: <span class=\"string\">\"^0.3.1\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"hexo-renderer-stylus\"</span>: <span class=\"string\">\"^0.3.3\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"hexo-renderer-marked\"</span>: <span class=\"string\">\"^0.3.2\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"hexo-server\"</span>: <span class=\"string\">\"^0.3.3\"</span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"1-1-2-next\"><a href=\"#1-1-2-next\" class=\"headerlink\" title=\"1.1.2 next\"></a>1.1.2 next</h3><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">cd</span> makergyt.github.io</span><br><span class=\"line\">git <span class=\"built_in\">clone</span> https://github.com/theme-next/hexo-theme-next themes/next</span><br></pre></td></tr></table></figure>\n<h1 id=\"2-user-defined\"><a href=\"#2-user-defined\" class=\"headerlink\" title=\"2 user-defined\"></a>2 user-defined</h1><h2 id=\"2-1-hexo\"><a href=\"#2-1-hexo\" class=\"headerlink\" title=\"2.1 hexo\"></a>2.1 hexo</h2><figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># ./_config.yml</span></span><br><span class=\"line\"><span class=\"comment\"># Site</span></span><br><span class=\"line\"><span class=\"attr\">author:</span> <span class=\"string\">Gao</span> <span class=\"string\">Yuting</span></span><br><span class=\"line\"><span class=\"attr\">language:</span></span><br><span class=\"line\"><span class=\"bullet\">  -</span> <span class=\"string\">zh-CN</span></span><br><span class=\"line\"><span class=\"bullet\">  -</span> <span class=\"string\">en</span></span><br><span class=\"line\">  </span><br><span class=\"line\"><span class=\"attr\">timezone:</span> <span class=\"string\">Asia/Shanghai</span></span><br><span class=\"line\"><span class=\"comment\"># URL</span></span><br><span class=\"line\"><span class=\"attr\">url:</span> <span class=\"attr\">https://blog.makergyt.com</span></span><br><span class=\"line\"><span class=\"attr\">permalink:</span> <span class=\"string\">:lang/:title/</span></span><br><span class=\"line\"><span class=\"attr\">permalink_defaults:</span></span><br><span class=\"line\"><span class=\"attr\">  lang:</span> <span class=\"string\">zh-CN</span></span><br><span class=\"line\"><span class=\"attr\">root:</span> <span class=\"string\">/</span></span><br><span class=\"line\"><span class=\"comment\"># Deployment</span></span><br><span class=\"line\"><span class=\"attr\">deploy:</span></span><br><span class=\"line\"><span class=\"attr\">  - type:</span> <span class=\"string\">git</span></span><br><span class=\"line\"><span class=\"attr\">    repo:</span> <span class=\"string\">git@github.com:MakerGYT/makergyt.github.io.git</span></span><br><span class=\"line\"><span class=\"attr\">    branch:</span> <span class=\"string\">master</span></span><br><span class=\"line\"><span class=\"attr\">  - type:</span> <span class=\"string\">git</span></span><br><span class=\"line\"><span class=\"attr\">    repo:</span> <span class=\"string\">git@git.dev.tencent.com:memakergytcom/blog.git</span></span><br><span class=\"line\"><span class=\"attr\">    branch:</span> <span class=\"string\">master</span></span><br><span class=\"line\"><span class=\"comment\"># Writing</span></span><br><span class=\"line\"><span class=\"attr\">new_post_name:</span> <span class=\"string\">:lang/:title.md</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"2-1-1-deployment\"><a href=\"#2-1-1-deployment\" class=\"headerlink\" title=\"2.1.1 deployment\"></a>2.1.1 deployment</h3><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cnpm install hexo-deployer-git --save</span><br><span class=\"line\"><span class=\"comment\"># deploy on coding pages `Error`: no styles</span></span><br><span class=\"line\"><span class=\"comment\"># next/_config.yml</span></span><br><span class=\"line\">- <span class=\"built_in\">type</span>: git</span><br><span class=\"line\">    - repo: git@git.dev.tencent.com:memakergytcom/blog.git</span><br><span class=\"line\">    + repo: git@git.dev.tencent.com:memakergytcom/memakergytcom.git</span><br><span class=\"line\">    <span class=\"comment\"># The authorities did not say,project name must be user name when coding pages is used (similar to github pages).This is a bug:</span></span><br><span class=\"line\">    - url:memakergytcom.coding.me/blog</span><br><span class=\"line\">    + url:memakergytcom.coding.me</span><br><span class=\"line\">    <span class=\"comment\"># my url: blog-cn.makergyt.com</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"2-1-2-hexo-qiniu-sync\"><a href=\"#2-1-2-hexo-qiniu-sync\" class=\"headerlink\" title=\"2.1.2 hexo-qiniu-sync\"></a>2.1.2 hexo-qiniu-sync</h3><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cnpm install hexo-qiniu-sync --save</span><br><span class=\"line\"><span class=\"comment\"># ./_config.yml</span></span><br><span class=\"line\">qiniu:</span><br><span class=\"line\">  offline: <span class=\"literal\">false</span></span><br><span class=\"line\">  sync: <span class=\"literal\">true</span></span><br><span class=\"line\">  bucket:  blog </span><br><span class=\"line\">  <span class=\"comment\"># secret_file: sec/qn.json or C:</span></span><br><span class=\"line\">  access_key: </span><br><span class=\"line\">  secret_key: -7s1GaiE82h-AKUAIqsd9X</span><br><span class=\"line\">  dirPrefix: static</span><br><span class=\"line\">  urlPrefix: https://blog-cdn.makergyt.com/static</span><br><span class=\"line\">  up_host: http://upload.qiniu.com</span><br><span class=\"line\">  local_dir: cdn</span><br><span class=\"line\">  update_exist: <span class=\"literal\">true</span></span><br><span class=\"line\">  image: </span><br><span class=\"line\">    folder: images</span><br><span class=\"line\">    extend: </span><br><span class=\"line\">  js:</span><br><span class=\"line\">    folder: js</span><br><span class=\"line\">  css:</span><br><span class=\"line\">    folder: css</span><br><span class=\"line\"><span class=\"comment\"># md reference.md</span></span><br><span class=\"line\">&#123;% qnimg book.jpg title:图片标题 alt:图片说明  extend:?imageView2/2/w/600 %&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"2-1-2-hexo-reference\"><a href=\"#2-1-2-hexo-reference\" class=\"headerlink\" title=\"2.1.2 hexo-reference\"></a>2.1.2 hexo-reference</h3><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cnpm install hexo-reference --save</span><br><span class=\"line\"><span class=\"comment\"># ./_config.yml</span></span><br><span class=\"line\">Plugins:</span><br><span class=\"line\">  - hexo-reference</span><br></pre></td></tr></table></figure>\n<h2 id=\"2-2-next\"><a href=\"#2-2-next\" class=\"headerlink\" title=\"2.2 next\"></a>2.2 next</h2><figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># next/_config.yml</span></span><br><span class=\"line\"><span class=\"attr\">menu:</span></span><br><span class=\"line\"><span class=\"attr\">  home:</span> <span class=\"string\">/</span> <span class=\"string\">||</span> <span class=\"string\">chrome</span></span><br><span class=\"line\"><span class=\"attr\">  about:</span> <span class=\"string\">/about/</span> <span class=\"string\">||</span> <span class=\"string\">address-card</span></span><br><span class=\"line\"><span class=\"attr\">  categories:</span> <span class=\"string\">/categories/</span> <span class=\"string\">||</span> <span class=\"string\">th</span></span><br><span class=\"line\"><span class=\"attr\">  archives:</span> <span class=\"string\">/archives/</span> <span class=\"string\">||</span> <span class=\"string\">archive</span></span><br><span class=\"line\"><span class=\"attr\">favicon:</span> <span class=\"comment\"># makergyt.github.io/source/images/</span></span><br><span class=\"line\"><span class=\"attr\">  small:</span> <span class=\"string\">/images/favicon-16x16.png</span></span><br><span class=\"line\"><span class=\"attr\">  medium:</span> <span class=\"string\">/images/favicon-32x32.png</span></span><br><span class=\"line\"><span class=\"attr\">  apple_touch_icon:</span> <span class=\"string\">/images/apple-touch-icon.png</span></span><br><span class=\"line\"><span class=\"attr\">  safari_pinned_tab:</span> <span class=\"string\">/images/safari-pinned-tab.svg</span></span><br><span class=\"line\"><span class=\"attr\">  ms_browserconfig:</span> <span class=\"string\">/images/browserconfig.xml</span></span><br><span class=\"line\">  <span class=\"comment\"># need to transparent</span></span><br><span class=\"line\"><span class=\"attr\">footer:</span></span><br><span class=\"line\"><span class=\"attr\">  since:</span> <span class=\"number\">2018</span></span><br><span class=\"line\"><span class=\"attr\">  icon:</span></span><br><span class=\"line\"><span class=\"attr\">    name:</span> <span class=\"string\">heart</span></span><br><span class=\"line\"><span class=\"attr\">    animated:</span> <span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"attr\">    color:</span> <span class=\"string\">\"#ff0000\"</span></span><br><span class=\"line\"><span class=\"attr\">  powered:</span></span><br><span class=\"line\"><span class=\"attr\">    enable:</span> <span class=\"literal\">false</span></span><br><span class=\"line\"><span class=\"attr\">  beian:</span></span><br><span class=\"line\"><span class=\"attr\">    enable:</span> <span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"attr\">    icp:</span> <span class=\"string\">陕ICP备16017712号-1</span></span><br><span class=\"line\"><span class=\"attr\">creative_commons:</span></span><br><span class=\"line\"><span class=\"attr\">  license:</span> <span class=\"string\">by-nc-sa</span></span><br><span class=\"line\"><span class=\"attr\">  sidebar:</span> <span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"attr\">  post:</span> <span class=\"literal\">false</span></span><br><span class=\"line\"><span class=\"attr\">  language:</span> <span class=\"string\">deed.zh</span></span><br><span class=\"line\"><span class=\"attr\">github_banner:</span></span><br><span class=\"line\"><span class=\"attr\">  enable:</span> <span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"attr\">  permalink:</span> <span class=\"attr\">https://github.com/makergyt</span></span><br><span class=\"line\"><span class=\"attr\">  title:</span> <span class=\"string\">GitHub</span></span><br><span class=\"line\"><span class=\"attr\">mobile_layout_economy:</span> <span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"attr\">custom_logo:</span></span><br><span class=\"line\"><span class=\"attr\">  enable:</span> <span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"attr\">  image:</span> <span class=\"string\">/images/favicon-32x32.png</span></span><br><span class=\"line\"><span class=\"attr\">font:</span></span><br><span class=\"line\"><span class=\"attr\">  enable:</span> <span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"attr\">  global:</span></span><br><span class=\"line\"><span class=\"attr\">    family:</span> <span class=\"string\">Monda</span></span><br><span class=\"line\"><span class=\"attr\">motion:</span></span><br><span class=\"line\"><span class=\"attr\">  enable:</span> <span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"attr\">  transition:</span></span><br><span class=\"line\"><span class=\"attr\">    post_block:</span> <span class=\"string\">shrinkIn</span></span><br><span class=\"line\"><span class=\"attr\">seo:</span> <span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"attr\">cheers:</span> <span class=\"literal\">false</span></span><br><span class=\"line\"><span class=\"attr\">scroll_to_more:</span> <span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"attr\">save_scroll:</span> <span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"attr\">codeblock:</span></span><br><span class=\"line\"><span class=\"attr\">  copy_button:</span></span><br><span class=\"line\"><span class=\"attr\">    enable:</span> <span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"attr\">    show_result:</span> <span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"attr\">    style:</span> <span class=\"string\">flat</span></span><br><span class=\"line\"><span class=\"attr\">highlight_theme:</span> <span class=\"string\">normal</span></span><br><span class=\"line\"><span class=\"attr\">wechat_subscriber:</span></span><br><span class=\"line\"><span class=\"attr\">  enable:</span> <span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"attr\">  qcode:</span> <span class=\"string\">/images/wechat-qcode.jpg</span></span><br><span class=\"line\"><span class=\"attr\">  description:</span> <span class=\"string\">scan</span> <span class=\"string\">to</span> <span class=\"string\">see</span> <span class=\"string\">the</span> <span class=\"string\">vaster</span> <span class=\"string\">world</span></span><br><span class=\"line\"><span class=\"attr\">reward_settings:</span></span><br><span class=\"line\"><span class=\"attr\">  enable:</span> <span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"attr\">  animation:</span> <span class=\"literal\">false</span></span><br><span class=\"line\"><span class=\"attr\">  comment:</span> <span class=\"string\">Add</span> <span class=\"string\">chicken</span> <span class=\"string\">leg</span></span><br><span class=\"line\"><span class=\"attr\">reward:</span></span><br><span class=\"line\"><span class=\"attr\">  wechat:</span> <span class=\"string\">/images/wechatpay.png</span></span><br><span class=\"line\"><span class=\"attr\">related_posts:</span></span><br><span class=\"line\"><span class=\"attr\">  enable:</span> <span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"attr\">social:</span></span><br><span class=\"line\"><span class=\"attr\">  E-Mail:</span> <span class=\"attr\">mailto:me@makergyt.com</span> <span class=\"string\">||</span> <span class=\"string\">envelope</span></span><br><span class=\"line\"><span class=\"attr\">  Weibo:</span> <span class=\"attr\">https://weibo.com/u/5165628041</span> <span class=\"string\">||</span> <span class=\"string\">weibo</span></span><br><span class=\"line\"><span class=\"attr\">  Twitter:</span> <span class=\"attr\">https://twitter.com/makergyt</span> <span class=\"string\">||</span> <span class=\"string\">twitter</span></span><br><span class=\"line\">  <span class=\"string\">FB</span> <span class=\"attr\">Page:</span> <span class=\"attr\">https://www.facebook.com/makergyt</span> <span class=\"string\">||</span> <span class=\"string\">facebook</span></span><br><span class=\"line\">  <span class=\"number\">500</span><span class=\"attr\">PX:</span> <span class=\"attr\">https://500px.com</span> <span class=\"string\">||</span> <span class=\"number\">500</span><span class=\"string\">px</span></span><br><span class=\"line\"><span class=\"attr\">  Telegram:</span> <span class=\"attr\">https://t.me/makergyt</span> <span class=\"string\">||</span> <span class=\"string\">telegram</span></span><br><span class=\"line\"><span class=\"attr\">social_icons:</span></span><br><span class=\"line\"><span class=\"attr\">  enable:</span> <span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"attr\">  icons_only:</span> <span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"attr\">links_icon:</span> <span class=\"string\">anchor</span></span><br><span class=\"line\"><span class=\"attr\">links:</span></span><br><span class=\"line\">  <span class=\"string\">Main</span> <span class=\"attr\">site:</span> <span class=\"attr\">https://makergyt.com</span></span><br><span class=\"line\"><span class=\"attr\">back2top:</span></span><br><span class=\"line\"><span class=\"attr\">  enable:</span> <span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"attr\">  sidebar:</span> <span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"attr\">  scrollpercent:</span> <span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"attr\">gitalk:</span></span><br><span class=\"line\"><span class=\"attr\">  enable:</span> <span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"attr\">  github_id:</span> <span class=\"string\">makergyt</span></span><br><span class=\"line\"><span class=\"attr\">  repo:</span> <span class=\"string\">makergyt.github.io</span></span><br><span class=\"line\"><span class=\"attr\">  client_id:</span> <span class=\"number\">64</span><span class=\"string\">a9c28ff540acfb8d4b</span></span><br><span class=\"line\"><span class=\"attr\">  client_secret:</span> <span class=\"number\">647</span><span class=\"string\">cb5af47a926a76f6eb1d1001fe8a5230dd0b0</span></span><br><span class=\"line\"><span class=\"attr\">  admin_user:</span> <span class=\"string\">makergyt</span></span><br><span class=\"line\"><span class=\"attr\">baidu_analytics:</span> <span class=\"number\">3</span><span class=\"string\">af747eaf2360bbaf46d8aa9f5b62d22</span></span><br><span class=\"line\"><span class=\"attr\">reading_progress:</span></span><br><span class=\"line\"><span class=\"attr\">  enable:</span> <span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"attr\">reading_progress:</span> <span class=\"string\">//cdn.jsdelivr.net/gh/theme-next/</span></span><br><span class=\"line\"><span class=\"string\">theme-next-reading-progress@1.1/reading_progress.min.js</span></span><br><span class=\"line\"><span class=\"attr\">canvas_nest:</span> <span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"attr\">canvas_nest:</span> <span class=\"string\">//cdn.jsdelivr.net/npm/canvas-nest.js@1.0.1/dist/canvas-nest.min.js</span></span><br><span class=\"line\"><span class=\"attr\">math:</span></span><br><span class=\"line\"><span class=\"attr\">  enable:</span> <span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"attr\">  per_page:</span> <span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"attr\">  engine:</span> <span class=\"string\">mathjax</span></span><br><span class=\"line\"><span class=\"attr\">  mathjax:</span></span><br><span class=\"line\"><span class=\"attr\">    cdn:</span> <span class=\"string\">//cdn.jsdelivr.net/npm/mathjax@2/MathJax.js?config=TeX-AMS-MML_HTMLorMML</span></span><br><span class=\"line\"><span class=\"attr\">note:</span></span><br><span class=\"line\"><span class=\"attr\">  style:</span> <span class=\"string\">flat</span></span><br><span class=\"line\"><span class=\"attr\">pdf:</span></span><br><span class=\"line\"><span class=\"attr\">  enable:</span> <span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"attr\">google_site_verification:</span> <span class=\"string\">XAprdFd37bx8X8i-_S77-8ArPy8hkI5RCtKym1Z52rY</span></span><br><span class=\"line\"><span class=\"attr\">bing_site_verification:</span> <span class=\"string\">E14AC9D3BA8CE3C20D05F77EE7BC738F</span></span><br><span class=\"line\"><span class=\"attr\">mermaid:</span></span><br><span class=\"line\"><span class=\"attr\">  enable:</span> <span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"attr\">  theme:</span> <span class=\"string\">default</span></span><br><span class=\"line\"><span class=\"attr\">  cdn:</span> <span class=\"string\">//cdn.jsdelivr.net/npm/mermaid@8.0.0/dist/mermaid.min.js</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"2-2-1-404\"><a href=\"#2-2-1-404\" class=\"headerlink\" title=\"2.2.1 404\"></a>2.2.1 404</h3><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># source/404/404.md</span></span><br><span class=\"line\">---</span><br><span class=\"line\">title: 404</span><br><span class=\"line\">date: 1970-01-01 00:00:00</span><br><span class=\"line\">---</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;script src=<span class=\"string\">\"//qzonestyle.gtimg.cn/qzone/hybrid/app/404/search_children.js\"</span> charset=<span class=\"string\">\"utf-8\"</span> homePageUrl=<span class=\"string\">\"/\"</span> homePageName=<span class=\"string\">\"Back to home\"</span>&gt;&lt;/script&gt;</span><br></pre></td></tr></table></figure>\n<h3 id=\"2-2-2-Post-Wordcount\"><a href=\"#2-2-2-Post-Wordcount\" class=\"headerlink\" title=\"2.2.2 Post Wordcount\"></a>2.2.2 Post Wordcount</h3><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cnpm install hexo-symbols-count-time --save</span><br><span class=\"line\"><span class=\"comment\"># ./_config.yml</span></span><br><span class=\"line\">symbols_count_time:</span><br><span class=\"line\">  symbols: <span class=\"literal\">true</span></span><br><span class=\"line\">  time: <span class=\"literal\">true</span></span><br><span class=\"line\">  total_symbols: <span class=\"literal\">false</span></span><br><span class=\"line\">  total_time: <span class=\"literal\">false</span></span><br><span class=\"line\"><span class=\"comment\"># next/_config.yml</span></span><br><span class=\"line\">symbols_count_time:</span><br><span class=\"line\">  separated_meta: <span class=\"literal\">true</span></span><br><span class=\"line\">  item_text_post: <span class=\"literal\">true</span></span><br><span class=\"line\">  item_text_total: <span class=\"literal\">false</span></span><br><span class=\"line\">  awl: 4</span><br><span class=\"line\">  wpm: 275</span><br></pre></td></tr></table></figure>\n<h3 id=\"2-2-3-Local-Search\"><a href=\"#2-2-3-Local-Search\" class=\"headerlink\" title=\"2.2.3 Local Search\"></a>2.2.3 Local Search</h3><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cnpm install hexo-generator-searchdb --save</span><br><span class=\"line\"><span class=\"comment\"># ./_config.yml</span></span><br><span class=\"line\">search:</span><br><span class=\"line\">  path: search.xml</span><br><span class=\"line\">  field: post</span><br><span class=\"line\">  format: html</span><br><span class=\"line\">  <span class=\"built_in\">limit</span>: 10000</span><br><span class=\"line\"><span class=\"comment\"># next/_config.yml</span></span><br><span class=\"line\">local_search:</span><br><span class=\"line\">  <span class=\"built_in\">enable</span>: <span class=\"literal\">true</span></span><br><span class=\"line\">fancybox: <span class=\"literal\">true</span></span><br><span class=\"line\">fancybox: //cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.js</span><br><span class=\"line\">fancybox_css: //cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.css</span><br></pre></td></tr></table></figure>\n<h3 id=\"2-2-4-Add-end\"><a href=\"#2-2-4-Add-end\" class=\"headerlink\" title=\"2.2.4 Add end\"></a>2.2.4 Add end</h3><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vim /themes/next/layout/_macro/passage-end-tag.swig</span><br><span class=\"line\">&lt;div&gt;</span><br><span class=\"line\">    &#123;% <span class=\"keyword\">if</span> not is_index %&#125;</span><br><span class=\"line\">        &lt;div style=<span class=\"string\">\"text-align:center;color: #ccc;font-size:14px;\"</span>&gt;-------------end-------------&lt;/div&gt;</span><br><span class=\"line\">    &#123;% endif %&#125;</span><br><span class=\"line\">&lt;/div&gt;</span><br><span class=\"line\">vim /themes/next/layout/_macro/post.swig</span><br><span class=\"line\"><span class=\"comment\"># line 333</span></span><br><span class=\"line\">&lt;div&gt;</span><br><span class=\"line\">  &#123;% <span class=\"keyword\">if</span> not is_index %&#125;</span><br><span class=\"line\">    &#123;% include <span class=\"string\">'passage-end-tag.swig'</span> %&#125;</span><br><span class=\"line\">  &#123;% endif %&#125;</span><br><span class=\"line\">&lt;/div&gt;</span><br><span class=\"line\"><span class=\"comment\"># next/_config.yml</span></span><br><span class=\"line\">passage_end_tag:</span><br><span class=\"line\">  enabled: <span class=\"literal\">true</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"2-2-5-encrypt\"><a href=\"#2-2-5-encrypt\" class=\"headerlink\" title=\"2.2.5 encrypt\"></a>2.2.5 encrypt</h3><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cnpm install --save hexo-blog-encrypt</span><br><span class=\"line\"><span class=\"comment\"># ./_config.yml</span></span><br><span class=\"line\"><span class=\"comment\"># Security</span></span><br><span class=\"line\">encrypt:</span><br><span class=\"line\">    <span class=\"built_in\">enable</span>: <span class=\"literal\">true</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"2-2-6-music\"><a href=\"#2-2-6-music\" class=\"headerlink\" title=\"2.2.6 music\"></a>2.2.6 music</h3><h4 id=\"2-2-6-1-sidebar\"><a href=\"#2-2-6-1-sidebar\" class=\"headerlink\" title=\"2.2.6.1 sidebar\"></a>2.2.6.1 sidebar</h4><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vim /themes/next/layout/_macro/siderbar.swig</span><br><span class=\"line\"><span class=\"comment\"># siderbar.swig line 168</span></span><br><span class=\"line\">&#123;% <span class=\"keyword\">if</span> theme.music.enabled %&#125;</span><br><span class=\"line\">  &lt;iframe frameborder=<span class=\"string\">\"no\"</span> border=<span class=\"string\">\"0\"</span> marginwidth=<span class=\"string\">\"0\"</span> marginheight=<span class=\"string\">\"0\"</span> width=330 height=86 src=<span class=\"string\">\"&#123;&#123; theme.music.song &#125;&#125;\"</span>&gt;&lt;/iframe&gt;</span><br><span class=\"line\">&#123;% endif %&#125;</span><br><span class=\"line\"><span class=\"comment\"># next/_config.yml</span></span><br><span class=\"line\">music: </span><br><span class=\"line\">  enabled: <span class=\"literal\">true</span></span><br><span class=\"line\">  song: //music.163.com/outchain/player?<span class=\"built_in\">type</span>=2&amp;id=28692687&amp;auto=0&amp;height=66</span><br></pre></td></tr></table></figure>\n<h4 id=\"2-2-6-2-page\"><a href=\"#2-2-6-2-page\" class=\"headerlink\" title=\"2.2.6.2 page\"></a>2.2.6.2 page</h4><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cnpm install --save hexo-tag-aplayer</span><br><span class=\"line\"><span class=\"comment\"># ./_config.xml</span></span><br><span class=\"line\">aplayer:</span><br><span class=\"line\">  meting: <span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"comment\"># ./about/index.md</span></span><br><span class=\"line\">&#123;% meting <span class=\"string\">\"2526283537\"</span> <span class=\"string\">\"netease\"</span> <span class=\"string\">\"playlist\"</span> <span class=\"string\">\"mutex:false\"</span> <span class=\"string\">\"listmaxheight:340px\"</span> <span class=\"string\">\"preload:none\"</span> <span class=\"string\">\"theme:#FC6423\"</span>%&#125;</span><br></pre></td></tr></table></figure>\n<h1 id=\"Reference\"><a href=\"#Reference\" class=\"headerlink\" title=\"Reference\"></a>Reference</h1><p><small>[1] NexT.Gemini.Documentation[EB/OL].<a href=\"https://theme-next.org/docs/\" target=\"_blank\" rel=\"noopener\">https://theme-next.org/docs/</a> .2019.</small></p>"},{"title":"git reference","date":"2019-01-06T03:22:38.000Z","_content":"\n## upload\n\n\n```bash\ngit init\ngit add .\ngit commit -m \"message\"\ngit remote add origin https://github.com/user/repo.git\ngit push -u origin master\n```\n\n<!-- more -->\n\n## connect github with no password\n```bash\ngit config --global user.name \"makergyt\"\ngit config --global user.email \"me@makergyt.com\"\n# test\ngit config --list\nuser.email=me@makergyt.com\nuser.name=makergyt\n```\n### ssh\n```sh\ngit remote add origin git@github.com:user/repo.git\ncd ~/.ssh\nssh-keygen -t rsa -C \"me@makergyt.com\"\ncat id_rsa.pub # paste to https://github.com/settings/keys\n# test\nssh -T git@github.com\nHi MakerGYT! You've successfully authenticated, but GitHub does not provide shell access\n```\n\n### https\n```sh\ngit remote add origin https://github.com/user/repo.git\ntouch ~/.git-credentials\nvim ~/.git-credentials\nhttps://username:password@github.com\ngit config --global credential.helper store\ncat ~/.gitconfig\n[credential]\n    helper = store\n```\n\n\n## Coding Webhook deploy\n```bash\nssh-keygen -t rsa -C \"me@makergyt.com\" #git公钥\nmkdir /var/www/.ssh\nchown -R www-data:www-data /var/www/.ssh/\nsudo -Hu www-data ssh-keygen -t rsa #部署公钥\ncd /var/www/test\nmkdir hook\nchown -R www-data:www-data /var/www/test/hook\n```\n\n## branch management\n```bash\n# view branch\ngit branch\n*master # default\n# setup local branch\ngit branch local\n# test\n*master\nlocal\n# publish branch\ngit push origin local:local\n# change branch\ngit checkout local\n# merge branch\ngit merge master\n# delete remote branch\ngit push origin :master\n```\n## github floder is grey,can not open\n```bash\n# enter the grey folder\nll -a\n.git # delete the folder\ncd ..\ngit rm -r  --cached folder\ngit add .\ngit commit -m \"remove the cache\"\ngit push origin master\n```\n## force update local branch\n```sh\ngit fetch --all\ngit reset --hard origin/master\ngit fetch\n```\n## proxy\n\n```git\ngit config --global http.proxy\ngit config --global --unset http.proxy\n```\n","source":"_posts/en/git reference.md","raw":"---\ntitle: git reference\ndate: 2019-01-06 11:22:38\ntags: git\ncategories: reference\n---\n\n## upload\n\n\n```bash\ngit init\ngit add .\ngit commit -m \"message\"\ngit remote add origin https://github.com/user/repo.git\ngit push -u origin master\n```\n\n<!-- more -->\n\n## connect github with no password\n```bash\ngit config --global user.name \"makergyt\"\ngit config --global user.email \"me@makergyt.com\"\n# test\ngit config --list\nuser.email=me@makergyt.com\nuser.name=makergyt\n```\n### ssh\n```sh\ngit remote add origin git@github.com:user/repo.git\ncd ~/.ssh\nssh-keygen -t rsa -C \"me@makergyt.com\"\ncat id_rsa.pub # paste to https://github.com/settings/keys\n# test\nssh -T git@github.com\nHi MakerGYT! You've successfully authenticated, but GitHub does not provide shell access\n```\n\n### https\n```sh\ngit remote add origin https://github.com/user/repo.git\ntouch ~/.git-credentials\nvim ~/.git-credentials\nhttps://username:password@github.com\ngit config --global credential.helper store\ncat ~/.gitconfig\n[credential]\n    helper = store\n```\n\n\n## Coding Webhook deploy\n```bash\nssh-keygen -t rsa -C \"me@makergyt.com\" #git公钥\nmkdir /var/www/.ssh\nchown -R www-data:www-data /var/www/.ssh/\nsudo -Hu www-data ssh-keygen -t rsa #部署公钥\ncd /var/www/test\nmkdir hook\nchown -R www-data:www-data /var/www/test/hook\n```\n\n## branch management\n```bash\n# view branch\ngit branch\n*master # default\n# setup local branch\ngit branch local\n# test\n*master\nlocal\n# publish branch\ngit push origin local:local\n# change branch\ngit checkout local\n# merge branch\ngit merge master\n# delete remote branch\ngit push origin :master\n```\n## github floder is grey,can not open\n```bash\n# enter the grey folder\nll -a\n.git # delete the folder\ncd ..\ngit rm -r  --cached folder\ngit add .\ngit commit -m \"remove the cache\"\ngit push origin master\n```\n## force update local branch\n```sh\ngit fetch --all\ngit reset --hard origin/master\ngit fetch\n```\n## proxy\n\n```git\ngit config --global http.proxy\ngit config --global --unset http.proxy\n```\n","slug":"git reference","published":1,"lang":"en","updated":"2019-04-29T01:07:50.656Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjvnq7z9p000a7jjxcbsnk49n","content":"<link rel=\"stylesheet\" class=\"aplayer-secondary-style-marker\" href=\"/assets/css/APlayer.min.css\"><script src=\"/assets/js/APlayer.min.js\" class=\"aplayer-secondary-script-marker\"></script><script class=\"meting-secondary-script-marker\" src=\"/assets/js/Meting.min.js\"></script><link rel=\"stylesheet\" type=\"text/css\" href=\"https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css\"><h2 id=\"upload\"><a href=\"#upload\" class=\"headerlink\" title=\"upload\"></a>upload</h2><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git init</span><br><span class=\"line\">git add .</span><br><span class=\"line\">git commit -m <span class=\"string\">\"message\"</span></span><br><span class=\"line\">git remote add origin https://github.com/user/repo.git</span><br><span class=\"line\">git push -u origin master</span><br></pre></td></tr></table></figure>\n<a id=\"more\"></a>\n<h2 id=\"connect-github-with-no-password\"><a href=\"#connect-github-with-no-password\" class=\"headerlink\" title=\"connect github with no password\"></a>connect github with no password</h2><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git config --global user.name <span class=\"string\">\"makergyt\"</span></span><br><span class=\"line\">git config --global user.email <span class=\"string\">\"me@makergyt.com\"</span></span><br><span class=\"line\"><span class=\"comment\"># test</span></span><br><span class=\"line\">git config --list</span><br><span class=\"line\">user.email=me@makergyt.com</span><br><span class=\"line\">user.name=makergyt</span><br></pre></td></tr></table></figure>\n<h3 id=\"ssh\"><a href=\"#ssh\" class=\"headerlink\" title=\"ssh\"></a>ssh</h3><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git remote add origin git@github.com:user/repo.git</span><br><span class=\"line\"><span class=\"built_in\">cd</span> ~/.ssh</span><br><span class=\"line\">ssh-keygen -t rsa -C <span class=\"string\">\"me@makergyt.com\"</span></span><br><span class=\"line\">cat id_rsa.pub <span class=\"comment\"># paste to https://github.com/settings/keys</span></span><br><span class=\"line\"><span class=\"comment\"># test</span></span><br><span class=\"line\">ssh -T git@github.com</span><br><span class=\"line\">Hi MakerGYT! You<span class=\"string\">'ve successfully authenticated, but GitHub does not provide shell access</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"https\"><a href=\"#https\" class=\"headerlink\" title=\"https\"></a>https</h3><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git remote add origin https://github.com/user/repo.git</span><br><span class=\"line\">touch ~/.git-credentials</span><br><span class=\"line\">vim ~/.git-credentials</span><br><span class=\"line\">https://username:password@github.com</span><br><span class=\"line\">git config --global credential.helper store</span><br><span class=\"line\">cat ~/.gitconfig</span><br><span class=\"line\">[credential]</span><br><span class=\"line\">    helper = store</span><br></pre></td></tr></table></figure>\n<h2 id=\"Coding-Webhook-deploy\"><a href=\"#Coding-Webhook-deploy\" class=\"headerlink\" title=\"Coding Webhook deploy\"></a>Coding Webhook deploy</h2><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ssh-keygen -t rsa -C <span class=\"string\">\"me@makergyt.com\"</span> <span class=\"comment\">#git公钥</span></span><br><span class=\"line\">mkdir /var/www/.ssh</span><br><span class=\"line\">chown -R www-data:www-data /var/www/.ssh/</span><br><span class=\"line\">sudo -Hu www-data ssh-keygen -t rsa <span class=\"comment\">#部署公钥</span></span><br><span class=\"line\"><span class=\"built_in\">cd</span> /var/www/<span class=\"built_in\">test</span></span><br><span class=\"line\">mkdir hook</span><br><span class=\"line\">chown -R www-data:www-data /var/www/<span class=\"built_in\">test</span>/hook</span><br></pre></td></tr></table></figure>\n<h2 id=\"branch-management\"><a href=\"#branch-management\" class=\"headerlink\" title=\"branch management\"></a>branch management</h2><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># view branch</span></span><br><span class=\"line\">git branch</span><br><span class=\"line\">*master <span class=\"comment\"># default</span></span><br><span class=\"line\"><span class=\"comment\"># setup local branch</span></span><br><span class=\"line\">git branch <span class=\"built_in\">local</span></span><br><span class=\"line\"><span class=\"comment\"># test</span></span><br><span class=\"line\">*master</span><br><span class=\"line\"><span class=\"built_in\">local</span></span><br><span class=\"line\"><span class=\"comment\"># publish branch</span></span><br><span class=\"line\">git push origin <span class=\"built_in\">local</span>:<span class=\"built_in\">local</span></span><br><span class=\"line\"><span class=\"comment\"># change branch</span></span><br><span class=\"line\">git checkout <span class=\"built_in\">local</span></span><br><span class=\"line\"><span class=\"comment\"># merge branch</span></span><br><span class=\"line\">git merge master</span><br><span class=\"line\"><span class=\"comment\"># delete remote branch</span></span><br><span class=\"line\">git push origin :master</span><br></pre></td></tr></table></figure>\n<h2 id=\"github-floder-is-grey-can-not-open\"><a href=\"#github-floder-is-grey-can-not-open\" class=\"headerlink\" title=\"github floder is grey,can not open\"></a>github floder is grey,can not open</h2><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># enter the grey folder</span></span><br><span class=\"line\">ll -a</span><br><span class=\"line\">.git <span class=\"comment\"># delete the folder</span></span><br><span class=\"line\"><span class=\"built_in\">cd</span> ..</span><br><span class=\"line\">git rm -r  --cached folder</span><br><span class=\"line\">git add .</span><br><span class=\"line\">git commit -m <span class=\"string\">\"remove the cache\"</span></span><br><span class=\"line\">git push origin master</span><br></pre></td></tr></table></figure>\n<h2 id=\"force-update-local-branch\"><a href=\"#force-update-local-branch\" class=\"headerlink\" title=\"force update local branch\"></a>force update local branch</h2><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git fetch --all</span><br><span class=\"line\">git reset --hard origin/master</span><br><span class=\"line\">git fetch</span><br></pre></td></tr></table></figure>\n<h2 id=\"proxy\"><a href=\"#proxy\" class=\"headerlink\" title=\"proxy\"></a>proxy</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git config --global http.proxy</span><br><span class=\"line\">git config --global --unset http.proxy</span><br></pre></td></tr></table></figure>\n","site":{"data":{}},"excerpt":"<h2 id=\"upload\"><a href=\"#upload\" class=\"headerlink\" title=\"upload\"></a>upload</h2><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git init</span><br><span class=\"line\">git add .</span><br><span class=\"line\">git commit -m <span class=\"string\">\"message\"</span></span><br><span class=\"line\">git remote add origin https://github.com/user/repo.git</span><br><span class=\"line\">git push -u origin master</span><br></pre></td></tr></table></figure>","more":"<h2 id=\"connect-github-with-no-password\"><a href=\"#connect-github-with-no-password\" class=\"headerlink\" title=\"connect github with no password\"></a>connect github with no password</h2><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git config --global user.name <span class=\"string\">\"makergyt\"</span></span><br><span class=\"line\">git config --global user.email <span class=\"string\">\"me@makergyt.com\"</span></span><br><span class=\"line\"><span class=\"comment\"># test</span></span><br><span class=\"line\">git config --list</span><br><span class=\"line\">user.email=me@makergyt.com</span><br><span class=\"line\">user.name=makergyt</span><br></pre></td></tr></table></figure>\n<h3 id=\"ssh\"><a href=\"#ssh\" class=\"headerlink\" title=\"ssh\"></a>ssh</h3><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git remote add origin git@github.com:user/repo.git</span><br><span class=\"line\"><span class=\"built_in\">cd</span> ~/.ssh</span><br><span class=\"line\">ssh-keygen -t rsa -C <span class=\"string\">\"me@makergyt.com\"</span></span><br><span class=\"line\">cat id_rsa.pub <span class=\"comment\"># paste to https://github.com/settings/keys</span></span><br><span class=\"line\"><span class=\"comment\"># test</span></span><br><span class=\"line\">ssh -T git@github.com</span><br><span class=\"line\">Hi MakerGYT! You<span class=\"string\">'ve successfully authenticated, but GitHub does not provide shell access</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"https\"><a href=\"#https\" class=\"headerlink\" title=\"https\"></a>https</h3><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git remote add origin https://github.com/user/repo.git</span><br><span class=\"line\">touch ~/.git-credentials</span><br><span class=\"line\">vim ~/.git-credentials</span><br><span class=\"line\">https://username:password@github.com</span><br><span class=\"line\">git config --global credential.helper store</span><br><span class=\"line\">cat ~/.gitconfig</span><br><span class=\"line\">[credential]</span><br><span class=\"line\">    helper = store</span><br></pre></td></tr></table></figure>\n<h2 id=\"Coding-Webhook-deploy\"><a href=\"#Coding-Webhook-deploy\" class=\"headerlink\" title=\"Coding Webhook deploy\"></a>Coding Webhook deploy</h2><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ssh-keygen -t rsa -C <span class=\"string\">\"me@makergyt.com\"</span> <span class=\"comment\">#git公钥</span></span><br><span class=\"line\">mkdir /var/www/.ssh</span><br><span class=\"line\">chown -R www-data:www-data /var/www/.ssh/</span><br><span class=\"line\">sudo -Hu www-data ssh-keygen -t rsa <span class=\"comment\">#部署公钥</span></span><br><span class=\"line\"><span class=\"built_in\">cd</span> /var/www/<span class=\"built_in\">test</span></span><br><span class=\"line\">mkdir hook</span><br><span class=\"line\">chown -R www-data:www-data /var/www/<span class=\"built_in\">test</span>/hook</span><br></pre></td></tr></table></figure>\n<h2 id=\"branch-management\"><a href=\"#branch-management\" class=\"headerlink\" title=\"branch management\"></a>branch management</h2><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># view branch</span></span><br><span class=\"line\">git branch</span><br><span class=\"line\">*master <span class=\"comment\"># default</span></span><br><span class=\"line\"><span class=\"comment\"># setup local branch</span></span><br><span class=\"line\">git branch <span class=\"built_in\">local</span></span><br><span class=\"line\"><span class=\"comment\"># test</span></span><br><span class=\"line\">*master</span><br><span class=\"line\"><span class=\"built_in\">local</span></span><br><span class=\"line\"><span class=\"comment\"># publish branch</span></span><br><span class=\"line\">git push origin <span class=\"built_in\">local</span>:<span class=\"built_in\">local</span></span><br><span class=\"line\"><span class=\"comment\"># change branch</span></span><br><span class=\"line\">git checkout <span class=\"built_in\">local</span></span><br><span class=\"line\"><span class=\"comment\"># merge branch</span></span><br><span class=\"line\">git merge master</span><br><span class=\"line\"><span class=\"comment\"># delete remote branch</span></span><br><span class=\"line\">git push origin :master</span><br></pre></td></tr></table></figure>\n<h2 id=\"github-floder-is-grey-can-not-open\"><a href=\"#github-floder-is-grey-can-not-open\" class=\"headerlink\" title=\"github floder is grey,can not open\"></a>github floder is grey,can not open</h2><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># enter the grey folder</span></span><br><span class=\"line\">ll -a</span><br><span class=\"line\">.git <span class=\"comment\"># delete the folder</span></span><br><span class=\"line\"><span class=\"built_in\">cd</span> ..</span><br><span class=\"line\">git rm -r  --cached folder</span><br><span class=\"line\">git add .</span><br><span class=\"line\">git commit -m <span class=\"string\">\"remove the cache\"</span></span><br><span class=\"line\">git push origin master</span><br></pre></td></tr></table></figure>\n<h2 id=\"force-update-local-branch\"><a href=\"#force-update-local-branch\" class=\"headerlink\" title=\"force update local branch\"></a>force update local branch</h2><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git fetch --all</span><br><span class=\"line\">git reset --hard origin/master</span><br><span class=\"line\">git fetch</span><br></pre></td></tr></table></figure>\n<h2 id=\"proxy\"><a href=\"#proxy\" class=\"headerlink\" title=\"proxy\"></a>proxy</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git config --global http.proxy</span><br><span class=\"line\">git config --global --unset http.proxy</span><br></pre></td></tr></table></figure>"},{"title":"fetch","date":"2019-05-10T09:01:10.000Z","_content":"# 1 get\nbefore: \n- nodejs\n- cnpm\n- create-react-app\n\n## 1.1 front-end\n```sh\n$ create-react-app react-test\n$ touch src/config.js\n```\n```js\n// src/config.js\nmodule.exports = {\n  basicUrl: \"https://idpjtg-8080-hkyibe.dev.ide.live\"\n}\n```\n```js\n// src/App.js\nimport React, { Component } from 'react';\nimport { basicUrl } from './config';\nclass App extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      error: null,\n      isLoaded: false,\n      items: []\n    };\n  }\n  componentDidMount() {\n    fetch(basicUrl)\n      .then(res => res.json())\n      .then(\n        (result) => {\n          this.setState({\n            result: JSON.stringify(result),\n            isLoaded: true,\n          });\n        },\n        // Note: it's important to handle errors here\n        // instead of a catch() block so that we don't swallow\n        // exceptions from actual bugs in components.\n        (error) => {\n          this.setState({\n            isLoaded: true,\n            error\n          });\n        }\n      )\n  }\n  render() {\n    const { error, isLoaded, result } = this.state;\n    if (error) {\n      return <div>Error: {error.message}</div>;\n    } else if (!isLoaded) {\n      return <div>Loading...</div>;\n    } else {\n      return (\n        <div>{result}</div>\n      );\n    }\n  }\n}\nexport default App;\n```\n## 1.2 back-end\n```sh\n$ mkdir express-test && cd express-test\n$ cnpm init -y\n$ touch index.js\n$ cnpm i express --save\n```\n```js\n// package.json\n\"scripts\": {\n    \"dev\": \"node .\"\n  },\n```\n```js\n// index.js\nconst express = require('express');\nconst app = express()\nvar httpPort = process.env.PORT || 8080;\napp.get('/', function(req, res) {\n  var data = {\n    data: 'test'\n  }\n  res.send(data);\n});\napp.listen(httpPort);\n```\n## 1.3 run\n```sh\n$ curl curl https://idpjtg-8080-hkyibe.dev.ide.live\n{\"data\":\"test\"} // ok\n$ cd react-test\n$ npm run start\n# browser\nError: Failed to fetch\n```\n### 1.3.1 error\n``Access to fetch at 'https://idpjtg-8080-hkyibe.dev.ide.live/' from origin 'https://idpjtg-3000-icqklp.dev.ide.live' has been blocked by CORS policy: No 'Access-Control-Allow-Origin' header is present on the requested resource. If an opaque response serves your needs, set the request's mode to 'no-cors' to fetch the resource with CORS disabled.``\n\n### 1.3.2 check\nuse mock => [data](https://easy-mock.com/mock/5cd54a04bcc93766c5928798/#!method=get)\n>ok \n\nIt is proved that it is may not a front-end problem.\n```js\n// express/index,js\napp.get('/', function(req, res) {\n  ...\n  console.log(req)  \n});\n```\nreload react-test, express-test console\n>IncomingMessage{...}\n\nIt is proved that cross-site requests can be initiated normally, but the returned results are intercepted maybe by browsers.\n\n![](https://mdn.mozillademos.org/files/14295/CORS_principle.png)\n### 1.3.3 fix\n```js\n// express/indx.js\nvar allowCrossDomain = function (req, res, next) {\n res.header('Access-Control-Allow-Origin', '*');\n next();\n};\napp.use(allowCrossDomain);\n```\n>ok\n\nQ: fetch default mode is same-origin?\n# 2 post\n## 2.1 front-end\n```js\n// react-test/src/App.js\n...\ngetFetch() {\n  fetch(basicUrl)\n    .then(res => res.json())\n    .then(\n      (result) => {\n        this.setState({\n          result: JSON.stringify(result),\n        });\n      },\n      (error) => {\n        this.setState({\n          error\n        });\n      }\n    )\n}\npostFetch() {\n  var postData = {\n    data: new Date()\n  }\n  console.log(JSON.stringify(postData));\n  fetch(basicUrl, {\n    method: 'POST',\n    headers: {\n      \"Content-Type\": \"application/json\",\n      // \"Content-Type\": \"application/x-www-form-urlencoded\",\n    },\n    body: JSON.stringify(postData)\n  })\n    .then(res => res.json())\n    .then(\n      (result) => {\n        this.setState({\n          result: JSON.stringify(result),\n        });\n      },\n      (error) => {\n        this.setState({\n          error\n        });\n      }\n    )\n}\nrender() {\n  const { error, result } = this.state;\n  const btn = (\n    <div>\n      <button onClick={() => this.getFetch()}>GET</button>\n      <br />\n      <button onClick={() => this.postFetch()}>POST</button>\n    </div>);\n  var content = (\n    <div></div>\n  );\n  if (error) {\n    content = <div>Error: {error.message}</div>;\n  } else {\n    content = <div>{result}</div>;\n  }\n  return (\n    <div>{btn}{content}</div>\n  );\n}\n...\n```\n## 2.2 back-end\n```js\n// express-test/index.js\nconst bodyParser = require('body-parser');\nvar allowCrossDomain = function (req, res, next) {\n res.header('Access-Control-Allow-Origin', '*');\n res.header('Access-Control-Allow-Headers', 'Content-Type');\n next();\n};\napp.use(allowCrossDomain);\napp.use(bodyParser.json());\napp.post('/', function(req, res) {\n  var backdata = {\n    data: 'test' + req.body.data\n  }\n  res.send(backdata);\n});\n```\nQ: body-parser is not installed?\n# 3 fetch\n## 3.1 interfaces\n## 3.2 cors policy\n## 3.3 fetch polyfill\n# 4 mock\n## 4.1 DXY F2E\n[api mocker](http://api-mocker.com)\n## 4.2 Easy Mock\n[Easy Mock](https://easy-mock.com)\n## 4.3 nuysoft Alibaba Inc.\n[mockjs](http://mockjs.com/)\n# Reference\n<small>\n[1] Mozilla.Fetch API.https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API [EB/OL] 2019.\n[2] Mozilla.HTTP访问控制（CORS）.https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Access_control_CORS [EB/OL] 2019.\n[3] 赵客缦胡缨v吴钩霜雪明.ajax和axios、fetch的区别.https://www.jianshu.com/p/8bc48f8fde75 [EB/OL] 2018.\n</small>\n\n\n\n\n","source":"_posts/en/fetch.md","raw":"---\ntitle: fetch\ndate: 2019-05-10 17:01:10\ntags:\n---\n# 1 get\nbefore: \n- nodejs\n- cnpm\n- create-react-app\n\n## 1.1 front-end\n```sh\n$ create-react-app react-test\n$ touch src/config.js\n```\n```js\n// src/config.js\nmodule.exports = {\n  basicUrl: \"https://idpjtg-8080-hkyibe.dev.ide.live\"\n}\n```\n```js\n// src/App.js\nimport React, { Component } from 'react';\nimport { basicUrl } from './config';\nclass App extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      error: null,\n      isLoaded: false,\n      items: []\n    };\n  }\n  componentDidMount() {\n    fetch(basicUrl)\n      .then(res => res.json())\n      .then(\n        (result) => {\n          this.setState({\n            result: JSON.stringify(result),\n            isLoaded: true,\n          });\n        },\n        // Note: it's important to handle errors here\n        // instead of a catch() block so that we don't swallow\n        // exceptions from actual bugs in components.\n        (error) => {\n          this.setState({\n            isLoaded: true,\n            error\n          });\n        }\n      )\n  }\n  render() {\n    const { error, isLoaded, result } = this.state;\n    if (error) {\n      return <div>Error: {error.message}</div>;\n    } else if (!isLoaded) {\n      return <div>Loading...</div>;\n    } else {\n      return (\n        <div>{result}</div>\n      );\n    }\n  }\n}\nexport default App;\n```\n## 1.2 back-end\n```sh\n$ mkdir express-test && cd express-test\n$ cnpm init -y\n$ touch index.js\n$ cnpm i express --save\n```\n```js\n// package.json\n\"scripts\": {\n    \"dev\": \"node .\"\n  },\n```\n```js\n// index.js\nconst express = require('express');\nconst app = express()\nvar httpPort = process.env.PORT || 8080;\napp.get('/', function(req, res) {\n  var data = {\n    data: 'test'\n  }\n  res.send(data);\n});\napp.listen(httpPort);\n```\n## 1.3 run\n```sh\n$ curl curl https://idpjtg-8080-hkyibe.dev.ide.live\n{\"data\":\"test\"} // ok\n$ cd react-test\n$ npm run start\n# browser\nError: Failed to fetch\n```\n### 1.3.1 error\n``Access to fetch at 'https://idpjtg-8080-hkyibe.dev.ide.live/' from origin 'https://idpjtg-3000-icqklp.dev.ide.live' has been blocked by CORS policy: No 'Access-Control-Allow-Origin' header is present on the requested resource. If an opaque response serves your needs, set the request's mode to 'no-cors' to fetch the resource with CORS disabled.``\n\n### 1.3.2 check\nuse mock => [data](https://easy-mock.com/mock/5cd54a04bcc93766c5928798/#!method=get)\n>ok \n\nIt is proved that it is may not a front-end problem.\n```js\n// express/index,js\napp.get('/', function(req, res) {\n  ...\n  console.log(req)  \n});\n```\nreload react-test, express-test console\n>IncomingMessage{...}\n\nIt is proved that cross-site requests can be initiated normally, but the returned results are intercepted maybe by browsers.\n\n![](https://mdn.mozillademos.org/files/14295/CORS_principle.png)\n### 1.3.3 fix\n```js\n// express/indx.js\nvar allowCrossDomain = function (req, res, next) {\n res.header('Access-Control-Allow-Origin', '*');\n next();\n};\napp.use(allowCrossDomain);\n```\n>ok\n\nQ: fetch default mode is same-origin?\n# 2 post\n## 2.1 front-end\n```js\n// react-test/src/App.js\n...\ngetFetch() {\n  fetch(basicUrl)\n    .then(res => res.json())\n    .then(\n      (result) => {\n        this.setState({\n          result: JSON.stringify(result),\n        });\n      },\n      (error) => {\n        this.setState({\n          error\n        });\n      }\n    )\n}\npostFetch() {\n  var postData = {\n    data: new Date()\n  }\n  console.log(JSON.stringify(postData));\n  fetch(basicUrl, {\n    method: 'POST',\n    headers: {\n      \"Content-Type\": \"application/json\",\n      // \"Content-Type\": \"application/x-www-form-urlencoded\",\n    },\n    body: JSON.stringify(postData)\n  })\n    .then(res => res.json())\n    .then(\n      (result) => {\n        this.setState({\n          result: JSON.stringify(result),\n        });\n      },\n      (error) => {\n        this.setState({\n          error\n        });\n      }\n    )\n}\nrender() {\n  const { error, result } = this.state;\n  const btn = (\n    <div>\n      <button onClick={() => this.getFetch()}>GET</button>\n      <br />\n      <button onClick={() => this.postFetch()}>POST</button>\n    </div>);\n  var content = (\n    <div></div>\n  );\n  if (error) {\n    content = <div>Error: {error.message}</div>;\n  } else {\n    content = <div>{result}</div>;\n  }\n  return (\n    <div>{btn}{content}</div>\n  );\n}\n...\n```\n## 2.2 back-end\n```js\n// express-test/index.js\nconst bodyParser = require('body-parser');\nvar allowCrossDomain = function (req, res, next) {\n res.header('Access-Control-Allow-Origin', '*');\n res.header('Access-Control-Allow-Headers', 'Content-Type');\n next();\n};\napp.use(allowCrossDomain);\napp.use(bodyParser.json());\napp.post('/', function(req, res) {\n  var backdata = {\n    data: 'test' + req.body.data\n  }\n  res.send(backdata);\n});\n```\nQ: body-parser is not installed?\n# 3 fetch\n## 3.1 interfaces\n## 3.2 cors policy\n## 3.3 fetch polyfill\n# 4 mock\n## 4.1 DXY F2E\n[api mocker](http://api-mocker.com)\n## 4.2 Easy Mock\n[Easy Mock](https://easy-mock.com)\n## 4.3 nuysoft Alibaba Inc.\n[mockjs](http://mockjs.com/)\n# Reference\n<small>\n[1] Mozilla.Fetch API.https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API [EB/OL] 2019.\n[2] Mozilla.HTTP访问控制（CORS）.https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Access_control_CORS [EB/OL] 2019.\n[3] 赵客缦胡缨v吴钩霜雪明.ajax和axios、fetch的区别.https://www.jianshu.com/p/8bc48f8fde75 [EB/OL] 2018.\n</small>\n\n\n\n\n","slug":"fetch","published":1,"lang":"en","updated":"2019-07-17T08:56:36.109Z","_id":"cjvnq7z9q000b7jjxx8k3m6am","comments":1,"layout":"post","photos":[],"link":"","content":"<link rel=\"stylesheet\" class=\"aplayer-secondary-style-marker\" href=\"/assets/css/APlayer.min.css\"><script src=\"/assets/js/APlayer.min.js\" class=\"aplayer-secondary-script-marker\"></script><script class=\"meting-secondary-script-marker\" src=\"/assets/js/Meting.min.js\"></script><link rel=\"stylesheet\" type=\"text/css\" href=\"https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css\"><h1 id=\"1-get\"><a href=\"#1-get\" class=\"headerlink\" title=\"1 get\"></a>1 get</h1><p>before: </p>\n<ul>\n<li>nodejs</li>\n<li>cnpm</li>\n<li>create-react-app</li>\n</ul>\n<h2 id=\"1-1-front-end\"><a href=\"#1-1-front-end\" class=\"headerlink\" title=\"1.1 front-end\"></a>1.1 front-end</h2><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ create-react-app react-test</span><br><span class=\"line\">$ touch src/config.js</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// src/config.js</span></span><br><span class=\"line\"><span class=\"built_in\">module</span>.exports = &#123;</span><br><span class=\"line\">  basicUrl: <span class=\"string\">\"https://idpjtg-8080-hkyibe.dev.ide.live\"</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// src/App.js</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> React, &#123; Component &#125; <span class=\"keyword\">from</span> <span class=\"string\">'react'</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; basicUrl &#125; <span class=\"keyword\">from</span> <span class=\"string\">'./config'</span>;</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">App</span> <span class=\"keyword\">extends</span> <span class=\"title\">Component</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">constructor</span>(props) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">super</span>(props);</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.state = &#123;</span><br><span class=\"line\">      error: <span class=\"literal\">null</span>,</span><br><span class=\"line\">      isLoaded: <span class=\"literal\">false</span>,</span><br><span class=\"line\">      items: []</span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  componentDidMount() &#123;</span><br><span class=\"line\">    fetch(basicUrl)</span><br><span class=\"line\">      .then(<span class=\"function\"><span class=\"params\">res</span> =&gt;</span> res.json())</span><br><span class=\"line\">      .then(</span><br><span class=\"line\">        (result) =&gt; &#123;</span><br><span class=\"line\">          <span class=\"keyword\">this</span>.setState(&#123;</span><br><span class=\"line\">            result: <span class=\"built_in\">JSON</span>.stringify(result),</span><br><span class=\"line\">            isLoaded: <span class=\"literal\">true</span>,</span><br><span class=\"line\">          &#125;);</span><br><span class=\"line\">        &#125;,</span><br><span class=\"line\">        <span class=\"comment\">// Note: it's important to handle errors here</span></span><br><span class=\"line\">        <span class=\"comment\">// instead of a catch() block so that we don't swallow</span></span><br><span class=\"line\">        <span class=\"comment\">// exceptions from actual bugs in components.</span></span><br><span class=\"line\">        (error) =&gt; &#123;</span><br><span class=\"line\">          <span class=\"keyword\">this</span>.setState(&#123;</span><br><span class=\"line\">            isLoaded: <span class=\"literal\">true</span>,</span><br><span class=\"line\">            error</span><br><span class=\"line\">          &#125;);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">      )</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  render() &#123;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> &#123; error, isLoaded, result &#125; = <span class=\"keyword\">this</span>.state;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (error) &#123;</span><br><span class=\"line\">      <span class=\"keyword\">return</span> &lt;div&gt;Error: &#123;error.message&#125;&lt;/div&gt;;</span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (!isLoaded) &#123;</span><br><span class=\"line\">      <span class=\"keyword\">return</span> &lt;div&gt;Loading...&lt;/div&gt;;</span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">      <span class=\"keyword\">return</span> (</span><br><span class=\"line\">        &lt;div&gt;&#123;result&#125;&lt;<span class=\"regexp\">/div&gt;</span></span><br><span class=\"line\"><span class=\"regexp\">      );</span></span><br><span class=\"line\"><span class=\"regexp\">    &#125;</span></span><br><span class=\"line\"><span class=\"regexp\">  &#125;</span></span><br><span class=\"line\"><span class=\"regexp\">&#125;</span></span><br><span class=\"line\"><span class=\"regexp\">export default App;</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"1-2-back-end\"><a href=\"#1-2-back-end\" class=\"headerlink\" title=\"1.2 back-end\"></a>1.2 back-end</h2><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ mkdir express-test &amp;&amp; <span class=\"built_in\">cd</span> express-test</span><br><span class=\"line\">$ cnpm init -y</span><br><span class=\"line\">$ touch index.js</span><br><span class=\"line\">$ cnpm i express --save</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// package.json</span></span><br><span class=\"line\"><span class=\"string\">\"scripts\"</span>: &#123;</span><br><span class=\"line\">    <span class=\"string\">\"dev\"</span>: <span class=\"string\">\"node .\"</span></span><br><span class=\"line\">  &#125;,</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// index.js</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> express = <span class=\"built_in\">require</span>(<span class=\"string\">'express'</span>);</span><br><span class=\"line\"><span class=\"keyword\">const</span> app = express()</span><br><span class=\"line\"><span class=\"keyword\">var</span> httpPort = process.env.PORT || <span class=\"number\">8080</span>;</span><br><span class=\"line\">app.get(<span class=\"string\">'/'</span>, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">req, res</span>) </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">var</span> data = &#123;</span><br><span class=\"line\">    data: <span class=\"string\">'test'</span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  res.send(data);</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\">app.listen(httpPort);</span><br></pre></td></tr></table></figure>\n<h2 id=\"1-3-run\"><a href=\"#1-3-run\" class=\"headerlink\" title=\"1.3 run\"></a>1.3 run</h2><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ curl curl https://idpjtg-8080-hkyibe.dev.ide.live</span><br><span class=\"line\">&#123;<span class=\"string\">\"data\"</span>:<span class=\"string\">\"test\"</span>&#125; // ok</span><br><span class=\"line\">$ <span class=\"built_in\">cd</span> react-test</span><br><span class=\"line\">$ npm run start</span><br><span class=\"line\"><span class=\"comment\"># browser</span></span><br><span class=\"line\">Error: Failed to fetch</span><br></pre></td></tr></table></figure>\n<h3 id=\"1-3-1-error\"><a href=\"#1-3-1-error\" class=\"headerlink\" title=\"1.3.1 error\"></a>1.3.1 error</h3><p><code>Access to fetch at &#39;https://idpjtg-8080-hkyibe.dev.ide.live/&#39; from origin &#39;https://idpjtg-3000-icqklp.dev.ide.live&#39; has been blocked by CORS policy: No &#39;Access-Control-Allow-Origin&#39; header is present on the requested resource. If an opaque response serves your needs, set the request&#39;s mode to &#39;no-cors&#39; to fetch the resource with CORS disabled.</code></p>\n<h3 id=\"1-3-2-check\"><a href=\"#1-3-2-check\" class=\"headerlink\" title=\"1.3.2 check\"></a>1.3.2 check</h3><p>use mock =&gt; <a href=\"https://easy-mock.com/mock/5cd54a04bcc93766c5928798/#!method=get\" target=\"_blank\" rel=\"noopener\">data</a></p>\n<blockquote>\n<p>ok </p>\n</blockquote>\n<p>It is proved that it is may not a front-end problem.<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// express/index,js</span></span><br><span class=\"line\">app.get(<span class=\"string\">'/'</span>, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">req, res</span>) </span>&#123;</span><br><span class=\"line\">  ...</span><br><span class=\"line\">  <span class=\"built_in\">console</span>.log(req)  </span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure></p>\n<p>reload react-test, express-test console</p>\n<blockquote>\n<p>IncomingMessage{…}</p>\n</blockquote>\n<p>It is proved that cross-site requests can be initiated normally, but the returned results are intercepted maybe by browsers.</p>\n<p><img src=\"https://mdn.mozillademos.org/files/14295/CORS_principle.png\" alt></p>\n<h3 id=\"1-3-3-fix\"><a href=\"#1-3-3-fix\" class=\"headerlink\" title=\"1.3.3 fix\"></a>1.3.3 fix</h3><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// express/indx.js</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> allowCrossDomain = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">req, res, next</span>) </span>&#123;</span><br><span class=\"line\"> res.header(<span class=\"string\">'Access-Control-Allow-Origin'</span>, <span class=\"string\">'*'</span>);</span><br><span class=\"line\"> next();</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\">app.use(allowCrossDomain);</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>ok</p>\n</blockquote>\n<p>Q: fetch default mode is same-origin?</p>\n<h1 id=\"2-post\"><a href=\"#2-post\" class=\"headerlink\" title=\"2 post\"></a>2 post</h1><h2 id=\"2-1-front-end\"><a href=\"#2-1-front-end\" class=\"headerlink\" title=\"2.1 front-end\"></a>2.1 front-end</h2><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// react-test/src/App.js</span></span><br><span class=\"line\">...</span><br><span class=\"line\">getFetch() &#123;</span><br><span class=\"line\">  fetch(basicUrl)</span><br><span class=\"line\">    .then(<span class=\"function\"><span class=\"params\">res</span> =&gt;</span> res.json())</span><br><span class=\"line\">    .then(</span><br><span class=\"line\">      (result) =&gt; &#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.setState(&#123;</span><br><span class=\"line\">          result: <span class=\"built_in\">JSON</span>.stringify(result),</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">      &#125;,</span><br><span class=\"line\">      (error) =&gt; &#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.setState(&#123;</span><br><span class=\"line\">          error</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    )</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">postFetch() &#123;</span><br><span class=\"line\">  <span class=\"keyword\">var</span> postData = &#123;</span><br><span class=\"line\">    data: <span class=\"keyword\">new</span> <span class=\"built_in\">Date</span>()</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"built_in\">console</span>.log(<span class=\"built_in\">JSON</span>.stringify(postData));</span><br><span class=\"line\">  fetch(basicUrl, &#123;</span><br><span class=\"line\">    method: <span class=\"string\">'POST'</span>,</span><br><span class=\"line\">    headers: &#123;</span><br><span class=\"line\">      <span class=\"string\">\"Content-Type\"</span>: <span class=\"string\">\"application/json\"</span>,</span><br><span class=\"line\">      <span class=\"comment\">// \"Content-Type\": \"application/x-www-form-urlencoded\",</span></span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    body: <span class=\"built_in\">JSON</span>.stringify(postData)</span><br><span class=\"line\">  &#125;)</span><br><span class=\"line\">    .then(<span class=\"function\"><span class=\"params\">res</span> =&gt;</span> res.json())</span><br><span class=\"line\">    .then(</span><br><span class=\"line\">      (result) =&gt; &#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.setState(&#123;</span><br><span class=\"line\">          result: <span class=\"built_in\">JSON</span>.stringify(result),</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">      &#125;,</span><br><span class=\"line\">      (error) =&gt; &#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.setState(&#123;</span><br><span class=\"line\">          error</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    )</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">render() &#123;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> &#123; error, result &#125; = <span class=\"keyword\">this</span>.state;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> btn = (</span><br><span class=\"line\">    &lt;div&gt;</span><br><span class=\"line\">      &lt;button onClick=&#123;() =&gt; <span class=\"keyword\">this</span>.getFetch()&#125;&gt;GET&lt;<span class=\"regexp\">/button&gt;</span></span><br><span class=\"line\"><span class=\"regexp\">      &lt;br /</span>&gt;</span><br><span class=\"line\">      &lt;button onClick=&#123;() =&gt; <span class=\"keyword\">this</span>.postFetch()&#125;&gt;POST&lt;<span class=\"regexp\">/button&gt;</span></span><br><span class=\"line\"><span class=\"regexp\">    &lt;/</span>div&gt;);</span><br><span class=\"line\">  <span class=\"keyword\">var</span> content = (</span><br><span class=\"line\">    &lt;div&gt;&lt;/div&gt;</span><br><span class=\"line\">  );</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (error) &#123;</span><br><span class=\"line\">    content = &lt;div&gt;Error: &#123;error.message&#125;&lt;/div&gt;;</span><br><span class=\"line\">  &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">    content = &lt;div&gt;&#123;result&#125;&lt;/div&gt;;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> (</span><br><span class=\"line\">    &lt;div&gt;&#123;btn&#125;&#123;content&#125;&lt;<span class=\"regexp\">/div&gt;</span></span><br><span class=\"line\"><span class=\"regexp\">  );</span></span><br><span class=\"line\"><span class=\"regexp\">&#125;</span></span><br><span class=\"line\"><span class=\"regexp\">...</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"2-2-back-end\"><a href=\"#2-2-back-end\" class=\"headerlink\" title=\"2.2 back-end\"></a>2.2 back-end</h2><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// express-test/index.js</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> bodyParser = <span class=\"built_in\">require</span>(<span class=\"string\">'body-parser'</span>);</span><br><span class=\"line\"><span class=\"keyword\">var</span> allowCrossDomain = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">req, res, next</span>) </span>&#123;</span><br><span class=\"line\"> res.header(<span class=\"string\">'Access-Control-Allow-Origin'</span>, <span class=\"string\">'*'</span>);</span><br><span class=\"line\"> res.header(<span class=\"string\">'Access-Control-Allow-Headers'</span>, <span class=\"string\">'Content-Type'</span>);</span><br><span class=\"line\"> next();</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\">app.use(allowCrossDomain);</span><br><span class=\"line\">app.use(bodyParser.json());</span><br><span class=\"line\">app.post(<span class=\"string\">'/'</span>, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">req, res</span>) </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">var</span> backdata = &#123;</span><br><span class=\"line\">    data: <span class=\"string\">'test'</span> + req.body.data</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  res.send(backdata);</span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure>\n<p>Q: body-parser is not installed?</p>\n<h1 id=\"3-fetch\"><a href=\"#3-fetch\" class=\"headerlink\" title=\"3 fetch\"></a>3 fetch</h1><h2 id=\"3-1-interfaces\"><a href=\"#3-1-interfaces\" class=\"headerlink\" title=\"3.1 interfaces\"></a>3.1 interfaces</h2><h2 id=\"3-2-cors-policy\"><a href=\"#3-2-cors-policy\" class=\"headerlink\" title=\"3.2 cors policy\"></a>3.2 cors policy</h2><h2 id=\"3-3-fetch-polyfill\"><a href=\"#3-3-fetch-polyfill\" class=\"headerlink\" title=\"3.3 fetch polyfill\"></a>3.3 fetch polyfill</h2><h1 id=\"4-mock\"><a href=\"#4-mock\" class=\"headerlink\" title=\"4 mock\"></a>4 mock</h1><h2 id=\"4-1-DXY-F2E\"><a href=\"#4-1-DXY-F2E\" class=\"headerlink\" title=\"4.1 DXY F2E\"></a>4.1 DXY F2E</h2><p><a href=\"http://api-mocker.com\" target=\"_blank\" rel=\"noopener\">api mocker</a></p>\n<h2 id=\"4-2-Easy-Mock\"><a href=\"#4-2-Easy-Mock\" class=\"headerlink\" title=\"4.2 Easy Mock\"></a>4.2 Easy Mock</h2><p><a href=\"https://easy-mock.com\" target=\"_blank\" rel=\"noopener\">Easy Mock</a></p>\n<h2 id=\"4-3-nuysoft-Alibaba-Inc\"><a href=\"#4-3-nuysoft-Alibaba-Inc\" class=\"headerlink\" title=\"4.3 nuysoft Alibaba Inc.\"></a>4.3 nuysoft Alibaba Inc.</h2><p><a href=\"http://mockjs.com/\" target=\"_blank\" rel=\"noopener\">mockjs</a></p>\n<h1 id=\"Reference\"><a href=\"#Reference\" class=\"headerlink\" title=\"Reference\"></a>Reference</h1><p><small><br>[1] Mozilla.Fetch API.<a href=\"https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API\" target=\"_blank\" rel=\"noopener\">https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API</a> [EB/OL] 2019.<br>[2] Mozilla.HTTP访问控制（CORS）.<a href=\"https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Access_control_CORS\" target=\"_blank\" rel=\"noopener\">https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Access_control_CORS</a> [EB/OL] 2019.<br>[3] 赵客缦胡缨v吴钩霜雪明.ajax和axios、fetch的区别.<a href=\"https://www.jianshu.com/p/8bc48f8fde75\" target=\"_blank\" rel=\"noopener\">https://www.jianshu.com/p/8bc48f8fde75</a> [EB/OL] 2018.<br></small></p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"1-get\"><a href=\"#1-get\" class=\"headerlink\" title=\"1 get\"></a>1 get</h1><p>before: </p>\n<ul>\n<li>nodejs</li>\n<li>cnpm</li>\n<li>create-react-app</li>\n</ul>\n<h2 id=\"1-1-front-end\"><a href=\"#1-1-front-end\" class=\"headerlink\" title=\"1.1 front-end\"></a>1.1 front-end</h2><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ create-react-app react-test</span><br><span class=\"line\">$ touch src/config.js</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// src/config.js</span></span><br><span class=\"line\"><span class=\"built_in\">module</span>.exports = &#123;</span><br><span class=\"line\">  basicUrl: <span class=\"string\">\"https://idpjtg-8080-hkyibe.dev.ide.live\"</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// src/App.js</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> React, &#123; Component &#125; <span class=\"keyword\">from</span> <span class=\"string\">'react'</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; basicUrl &#125; <span class=\"keyword\">from</span> <span class=\"string\">'./config'</span>;</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">App</span> <span class=\"keyword\">extends</span> <span class=\"title\">Component</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">constructor</span>(props) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">super</span>(props);</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.state = &#123;</span><br><span class=\"line\">      error: <span class=\"literal\">null</span>,</span><br><span class=\"line\">      isLoaded: <span class=\"literal\">false</span>,</span><br><span class=\"line\">      items: []</span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  componentDidMount() &#123;</span><br><span class=\"line\">    fetch(basicUrl)</span><br><span class=\"line\">      .then(<span class=\"function\"><span class=\"params\">res</span> =&gt;</span> res.json())</span><br><span class=\"line\">      .then(</span><br><span class=\"line\">        (result) =&gt; &#123;</span><br><span class=\"line\">          <span class=\"keyword\">this</span>.setState(&#123;</span><br><span class=\"line\">            result: <span class=\"built_in\">JSON</span>.stringify(result),</span><br><span class=\"line\">            isLoaded: <span class=\"literal\">true</span>,</span><br><span class=\"line\">          &#125;);</span><br><span class=\"line\">        &#125;,</span><br><span class=\"line\">        <span class=\"comment\">// Note: it's important to handle errors here</span></span><br><span class=\"line\">        <span class=\"comment\">// instead of a catch() block so that we don't swallow</span></span><br><span class=\"line\">        <span class=\"comment\">// exceptions from actual bugs in components.</span></span><br><span class=\"line\">        (error) =&gt; &#123;</span><br><span class=\"line\">          <span class=\"keyword\">this</span>.setState(&#123;</span><br><span class=\"line\">            isLoaded: <span class=\"literal\">true</span>,</span><br><span class=\"line\">            error</span><br><span class=\"line\">          &#125;);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">      )</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  render() &#123;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> &#123; error, isLoaded, result &#125; = <span class=\"keyword\">this</span>.state;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (error) &#123;</span><br><span class=\"line\">      <span class=\"keyword\">return</span> &lt;div&gt;Error: &#123;error.message&#125;&lt;/div&gt;;</span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (!isLoaded) &#123;</span><br><span class=\"line\">      <span class=\"keyword\">return</span> &lt;div&gt;Loading...&lt;/div&gt;;</span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">      <span class=\"keyword\">return</span> (</span><br><span class=\"line\">        &lt;div&gt;&#123;result&#125;&lt;<span class=\"regexp\">/div&gt;</span></span><br><span class=\"line\"><span class=\"regexp\">      );</span></span><br><span class=\"line\"><span class=\"regexp\">    &#125;</span></span><br><span class=\"line\"><span class=\"regexp\">  &#125;</span></span><br><span class=\"line\"><span class=\"regexp\">&#125;</span></span><br><span class=\"line\"><span class=\"regexp\">export default App;</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"1-2-back-end\"><a href=\"#1-2-back-end\" class=\"headerlink\" title=\"1.2 back-end\"></a>1.2 back-end</h2><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ mkdir express-test &amp;&amp; <span class=\"built_in\">cd</span> express-test</span><br><span class=\"line\">$ cnpm init -y</span><br><span class=\"line\">$ touch index.js</span><br><span class=\"line\">$ cnpm i express --save</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// package.json</span></span><br><span class=\"line\"><span class=\"string\">\"scripts\"</span>: &#123;</span><br><span class=\"line\">    <span class=\"string\">\"dev\"</span>: <span class=\"string\">\"node .\"</span></span><br><span class=\"line\">  &#125;,</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// index.js</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> express = <span class=\"built_in\">require</span>(<span class=\"string\">'express'</span>);</span><br><span class=\"line\"><span class=\"keyword\">const</span> app = express()</span><br><span class=\"line\"><span class=\"keyword\">var</span> httpPort = process.env.PORT || <span class=\"number\">8080</span>;</span><br><span class=\"line\">app.get(<span class=\"string\">'/'</span>, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">req, res</span>) </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">var</span> data = &#123;</span><br><span class=\"line\">    data: <span class=\"string\">'test'</span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  res.send(data);</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\">app.listen(httpPort);</span><br></pre></td></tr></table></figure>\n<h2 id=\"1-3-run\"><a href=\"#1-3-run\" class=\"headerlink\" title=\"1.3 run\"></a>1.3 run</h2><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ curl curl https://idpjtg-8080-hkyibe.dev.ide.live</span><br><span class=\"line\">&#123;<span class=\"string\">\"data\"</span>:<span class=\"string\">\"test\"</span>&#125; // ok</span><br><span class=\"line\">$ <span class=\"built_in\">cd</span> react-test</span><br><span class=\"line\">$ npm run start</span><br><span class=\"line\"><span class=\"comment\"># browser</span></span><br><span class=\"line\">Error: Failed to fetch</span><br></pre></td></tr></table></figure>\n<h3 id=\"1-3-1-error\"><a href=\"#1-3-1-error\" class=\"headerlink\" title=\"1.3.1 error\"></a>1.3.1 error</h3><p><code>Access to fetch at &#39;https://idpjtg-8080-hkyibe.dev.ide.live/&#39; from origin &#39;https://idpjtg-3000-icqklp.dev.ide.live&#39; has been blocked by CORS policy: No &#39;Access-Control-Allow-Origin&#39; header is present on the requested resource. If an opaque response serves your needs, set the request&#39;s mode to &#39;no-cors&#39; to fetch the resource with CORS disabled.</code></p>\n<h3 id=\"1-3-2-check\"><a href=\"#1-3-2-check\" class=\"headerlink\" title=\"1.3.2 check\"></a>1.3.2 check</h3><p>use mock =&gt; <a href=\"https://easy-mock.com/mock/5cd54a04bcc93766c5928798/#!method=get\" target=\"_blank\" rel=\"noopener\">data</a></p>\n<blockquote>\n<p>ok </p>\n</blockquote>\n<p>It is proved that it is may not a front-end problem.<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// express/index,js</span></span><br><span class=\"line\">app.get(<span class=\"string\">'/'</span>, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">req, res</span>) </span>&#123;</span><br><span class=\"line\">  ...</span><br><span class=\"line\">  <span class=\"built_in\">console</span>.log(req)  </span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure></p>\n<p>reload react-test, express-test console</p>\n<blockquote>\n<p>IncomingMessage{…}</p>\n</blockquote>\n<p>It is proved that cross-site requests can be initiated normally, but the returned results are intercepted maybe by browsers.</p>\n<p><img src=\"https://mdn.mozillademos.org/files/14295/CORS_principle.png\" alt></p>\n<h3 id=\"1-3-3-fix\"><a href=\"#1-3-3-fix\" class=\"headerlink\" title=\"1.3.3 fix\"></a>1.3.3 fix</h3><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// express/indx.js</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> allowCrossDomain = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">req, res, next</span>) </span>&#123;</span><br><span class=\"line\"> res.header(<span class=\"string\">'Access-Control-Allow-Origin'</span>, <span class=\"string\">'*'</span>);</span><br><span class=\"line\"> next();</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\">app.use(allowCrossDomain);</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>ok</p>\n</blockquote>\n<p>Q: fetch default mode is same-origin?</p>\n<h1 id=\"2-post\"><a href=\"#2-post\" class=\"headerlink\" title=\"2 post\"></a>2 post</h1><h2 id=\"2-1-front-end\"><a href=\"#2-1-front-end\" class=\"headerlink\" title=\"2.1 front-end\"></a>2.1 front-end</h2><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// react-test/src/App.js</span></span><br><span class=\"line\">...</span><br><span class=\"line\">getFetch() &#123;</span><br><span class=\"line\">  fetch(basicUrl)</span><br><span class=\"line\">    .then(<span class=\"function\"><span class=\"params\">res</span> =&gt;</span> res.json())</span><br><span class=\"line\">    .then(</span><br><span class=\"line\">      (result) =&gt; &#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.setState(&#123;</span><br><span class=\"line\">          result: <span class=\"built_in\">JSON</span>.stringify(result),</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">      &#125;,</span><br><span class=\"line\">      (error) =&gt; &#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.setState(&#123;</span><br><span class=\"line\">          error</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    )</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">postFetch() &#123;</span><br><span class=\"line\">  <span class=\"keyword\">var</span> postData = &#123;</span><br><span class=\"line\">    data: <span class=\"keyword\">new</span> <span class=\"built_in\">Date</span>()</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"built_in\">console</span>.log(<span class=\"built_in\">JSON</span>.stringify(postData));</span><br><span class=\"line\">  fetch(basicUrl, &#123;</span><br><span class=\"line\">    method: <span class=\"string\">'POST'</span>,</span><br><span class=\"line\">    headers: &#123;</span><br><span class=\"line\">      <span class=\"string\">\"Content-Type\"</span>: <span class=\"string\">\"application/json\"</span>,</span><br><span class=\"line\">      <span class=\"comment\">// \"Content-Type\": \"application/x-www-form-urlencoded\",</span></span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    body: <span class=\"built_in\">JSON</span>.stringify(postData)</span><br><span class=\"line\">  &#125;)</span><br><span class=\"line\">    .then(<span class=\"function\"><span class=\"params\">res</span> =&gt;</span> res.json())</span><br><span class=\"line\">    .then(</span><br><span class=\"line\">      (result) =&gt; &#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.setState(&#123;</span><br><span class=\"line\">          result: <span class=\"built_in\">JSON</span>.stringify(result),</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">      &#125;,</span><br><span class=\"line\">      (error) =&gt; &#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.setState(&#123;</span><br><span class=\"line\">          error</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    )</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">render() &#123;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> &#123; error, result &#125; = <span class=\"keyword\">this</span>.state;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> btn = (</span><br><span class=\"line\">    &lt;div&gt;</span><br><span class=\"line\">      &lt;button onClick=&#123;() =&gt; <span class=\"keyword\">this</span>.getFetch()&#125;&gt;GET&lt;<span class=\"regexp\">/button&gt;</span></span><br><span class=\"line\"><span class=\"regexp\">      &lt;br /</span>&gt;</span><br><span class=\"line\">      &lt;button onClick=&#123;() =&gt; <span class=\"keyword\">this</span>.postFetch()&#125;&gt;POST&lt;<span class=\"regexp\">/button&gt;</span></span><br><span class=\"line\"><span class=\"regexp\">    &lt;/</span>div&gt;);</span><br><span class=\"line\">  <span class=\"keyword\">var</span> content = (</span><br><span class=\"line\">    &lt;div&gt;&lt;/div&gt;</span><br><span class=\"line\">  );</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (error) &#123;</span><br><span class=\"line\">    content = &lt;div&gt;Error: &#123;error.message&#125;&lt;/div&gt;;</span><br><span class=\"line\">  &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">    content = &lt;div&gt;&#123;result&#125;&lt;/div&gt;;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> (</span><br><span class=\"line\">    &lt;div&gt;&#123;btn&#125;&#123;content&#125;&lt;<span class=\"regexp\">/div&gt;</span></span><br><span class=\"line\"><span class=\"regexp\">  );</span></span><br><span class=\"line\"><span class=\"regexp\">&#125;</span></span><br><span class=\"line\"><span class=\"regexp\">...</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"2-2-back-end\"><a href=\"#2-2-back-end\" class=\"headerlink\" title=\"2.2 back-end\"></a>2.2 back-end</h2><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// express-test/index.js</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> bodyParser = <span class=\"built_in\">require</span>(<span class=\"string\">'body-parser'</span>);</span><br><span class=\"line\"><span class=\"keyword\">var</span> allowCrossDomain = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">req, res, next</span>) </span>&#123;</span><br><span class=\"line\"> res.header(<span class=\"string\">'Access-Control-Allow-Origin'</span>, <span class=\"string\">'*'</span>);</span><br><span class=\"line\"> res.header(<span class=\"string\">'Access-Control-Allow-Headers'</span>, <span class=\"string\">'Content-Type'</span>);</span><br><span class=\"line\"> next();</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\">app.use(allowCrossDomain);</span><br><span class=\"line\">app.use(bodyParser.json());</span><br><span class=\"line\">app.post(<span class=\"string\">'/'</span>, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">req, res</span>) </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">var</span> backdata = &#123;</span><br><span class=\"line\">    data: <span class=\"string\">'test'</span> + req.body.data</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  res.send(backdata);</span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure>\n<p>Q: body-parser is not installed?</p>\n<h1 id=\"3-fetch\"><a href=\"#3-fetch\" class=\"headerlink\" title=\"3 fetch\"></a>3 fetch</h1><h2 id=\"3-1-interfaces\"><a href=\"#3-1-interfaces\" class=\"headerlink\" title=\"3.1 interfaces\"></a>3.1 interfaces</h2><h2 id=\"3-2-cors-policy\"><a href=\"#3-2-cors-policy\" class=\"headerlink\" title=\"3.2 cors policy\"></a>3.2 cors policy</h2><h2 id=\"3-3-fetch-polyfill\"><a href=\"#3-3-fetch-polyfill\" class=\"headerlink\" title=\"3.3 fetch polyfill\"></a>3.3 fetch polyfill</h2><h1 id=\"4-mock\"><a href=\"#4-mock\" class=\"headerlink\" title=\"4 mock\"></a>4 mock</h1><h2 id=\"4-1-DXY-F2E\"><a href=\"#4-1-DXY-F2E\" class=\"headerlink\" title=\"4.1 DXY F2E\"></a>4.1 DXY F2E</h2><p><a href=\"http://api-mocker.com\" target=\"_blank\" rel=\"noopener\">api mocker</a></p>\n<h2 id=\"4-2-Easy-Mock\"><a href=\"#4-2-Easy-Mock\" class=\"headerlink\" title=\"4.2 Easy Mock\"></a>4.2 Easy Mock</h2><p><a href=\"https://easy-mock.com\" target=\"_blank\" rel=\"noopener\">Easy Mock</a></p>\n<h2 id=\"4-3-nuysoft-Alibaba-Inc\"><a href=\"#4-3-nuysoft-Alibaba-Inc\" class=\"headerlink\" title=\"4.3 nuysoft Alibaba Inc.\"></a>4.3 nuysoft Alibaba Inc.</h2><p><a href=\"http://mockjs.com/\" target=\"_blank\" rel=\"noopener\">mockjs</a></p>\n<h1 id=\"Reference\"><a href=\"#Reference\" class=\"headerlink\" title=\"Reference\"></a>Reference</h1><p><small><br>[1] Mozilla.Fetch API.<a href=\"https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API\" target=\"_blank\" rel=\"noopener\">https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API</a> [EB/OL] 2019.<br>[2] Mozilla.HTTP访问控制（CORS）.<a href=\"https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Access_control_CORS\" target=\"_blank\" rel=\"noopener\">https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Access_control_CORS</a> [EB/OL] 2019.<br>[3] 赵客缦胡缨v吴钩霜雪明.ajax和axios、fetch的区别.<a href=\"https://www.jianshu.com/p/8bc48f8fde75\" target=\"_blank\" rel=\"noopener\">https://www.jianshu.com/p/8bc48f8fde75</a> [EB/OL] 2018.<br></small></p>\n"},{"title":"install node","date":"2019-01-06T15:35:38.000Z","_content":"# 1 Install Node.js via binary archive on Linux64\n\n| system | [ubuntu 16.04](http://releases.ubuntu.com/16.04/ubuntu-16.04.5-desktop-amd64.iso.torrent?_ga=2.96882006.834203655.1547825063-1630968062.1547825063)([vagrant box](https://app.vagrantup.com/ubuntu/boxes/xenial64)) |\n|--|--|\n| version | [Linux Binaries (x64) v10.15.0(LTS)](https://nodejs.org/dist/v10.15.0/node-v10.15.0-linux-x64.tar.xz) |\n<!-- more -->\n## 1.1 Unzip the binary archive\n```sh\n VERSION=v10.15.0\n DISTRO=linux-x64\n sudo mkdir /usr/local/lib/nodejs\n wget https://nodejs.org/dist/$VERSION/node-$VERSION-$DISTRO.tar.xz\n sudo tar -xJvf node-$VERSION-$DISTRO.tar.xz -C /usr/local/lib/nodejs\n sudo mv /usr/local/lib/nodejs/node-$VERSION-$DISTRO /usr/local/lib/nodejs/node-$VERSION\n```\n## 1.2 Set the environment variable\n```sh\nexport NODEJS_HOME=/usr/local/lib/nodejs/node-$VERSION/bin\nexport PATH=$NODEJS_HOME:$PATH\n# Refresh profile\n. ~/.profile\n```\n## 1.3 Test installation\n```sh\nnode -v\nnpm version\nnpx -v\n```\n## 1.4 Create a sudo link\n```sh\nsudo ln -s /usr/local/lib/nodejs/node-$VERSION/bin/node /usr/bin/node\nsudo ln -s /usr/local/lib/nodejs/node-$VERSION/bin/npm /usr/bin/npm\nsudo ln -s /usr/local/lib/nodejs/node-$VERSION/bin/npx /usr/bin/npx\n```\n\n# 2 Installing Node.js via package manager\n\n| system |ubuntu 18.04|\n|--|--|\n| version |v10.18.0(LTS) |\n## 2.1 curl\n\n```sh\ncurl -sL https://deb.nodesource.com/setup_10.x | sudo -E bash -\nsudo apt-get install -y nodejs\n```\n## 2.2 Manual installation\n```sh\n# Remove the old PPA if previously used Chris Lea's Node.js PPA.\nsudo add-apt-repository -y -r ppa:chris-lea/node.js\nsudo rm -f /etc/apt/sources.list.d/chris-lea-node_js-*.list\nsudo rm -f /etc/apt/sources.list.d/chris-lea-node_js-*.list.save\n# Add the NodeSource package signing key\ncurl -sSL https://deb.nodesource.com/gpgkey/nodesource.gpg.key | sudo apt-key add -\n>gpg: no valid OpenPGP data # cross wall ok\n# Add the desired NodeSource repository\nVERSION=node_10.x\nDISTRO=\"$(lsb_release -s -c)\"\necho \"deb https://deb.nodesource.com/$VERSION $DISTRO main\" | sudo tee /etc/apt/sources.list.d/nodesource.list\necho \"deb-src https://deb.nodesource.com/$VERSION $DISTRO main\" | sudo tee -a /etc/apt/sources.list.d/nodesource.list\n# Update package lists and install Node.js\nsudo apt-get update\nsudo apt-get install nodejs\n```\n# 3 源\n## 3.1 淘宝 NPM 镜像\n```sh\n# install cnpm cli\nnpm install -g cnpm --registry=https://registry.npm.taobao.org\ncnpm version\n```\nCNPM command fails after shutdown and restart，so\n```sh\nalias cnpm=\"npm --registry=https://registry.npm.taobao.org \\\n--cache=$HOME/.npm/.cache/cnpm \\\n--disturl=https://npm.taobao.org/dist \\\n--userconfig=$HOME/.cnpmrc\"\n# OK\n```\n![](https://cloud.githubusercontent.com/assets/543405/21505401/fd0b6220-cca1-11e6-86ed-599cc81bb03b.png)\n## 3.2 nrm\n```sh\nsudo npm install -g nrm\nnrm ls\nnrm use taobao\n```\n# 4 Change version \n```sh\ncnpm install n -g\nsudo n stable\n```\n# 5 Install yarn\n\n| system |ubuntu 18.04|\n|--|--|\n| version |v1.21.1(stable) |\n```sh\n# configure the repository:\ncurl -sS https://dl.yarnpkg.com/debian/pubkey.gpg | sudo apt-key add -\necho \"deb https://dl.yarnpkg.com/debian/ stable main\" | sudo tee /etc/apt/sources.list.d/yarn.list\nsudo apt update && sudo apt install yarn\n```\n# Reference\n\n<small>[1] nodesource.Node.js Binary Distributions[EB/OL].https://github.com/nodesource/distributions/blob/master/README.md .2019.</small>\n<small>[2] nodejs. How to install Node.js via binary archive on Linux?[EB/OL]. https://github.com/nodejs/help/wiki/Installation .2018.</small>\n<small>[3] taobao. 淘宝 NPM 镜像使用说明[EB/OL]. https://npm.taobao.org/ .2014-2016</small>\n<small>[4] tj. n – Interactively Manage Your Node.js Versions[EB/OL]. https://www.npmjs.com/package/n .2018.</small>    https://www.yarnpkg.com/en/docs/install#debian-stable\n<small>[5] Yarn.Installation[EB/OL]. https://www.yarnpkg.com/en/docs/install#debian-stable.2018.</small>","source":"_posts/en/install node.md","raw":"---\ntitle: install node\ndate: 2019-01-06 23:35:38\ntags:\n - node\ncategories: config\n---\n# 1 Install Node.js via binary archive on Linux64\n\n| system | [ubuntu 16.04](http://releases.ubuntu.com/16.04/ubuntu-16.04.5-desktop-amd64.iso.torrent?_ga=2.96882006.834203655.1547825063-1630968062.1547825063)([vagrant box](https://app.vagrantup.com/ubuntu/boxes/xenial64)) |\n|--|--|\n| version | [Linux Binaries (x64) v10.15.0(LTS)](https://nodejs.org/dist/v10.15.0/node-v10.15.0-linux-x64.tar.xz) |\n<!-- more -->\n## 1.1 Unzip the binary archive\n```sh\n VERSION=v10.15.0\n DISTRO=linux-x64\n sudo mkdir /usr/local/lib/nodejs\n wget https://nodejs.org/dist/$VERSION/node-$VERSION-$DISTRO.tar.xz\n sudo tar -xJvf node-$VERSION-$DISTRO.tar.xz -C /usr/local/lib/nodejs\n sudo mv /usr/local/lib/nodejs/node-$VERSION-$DISTRO /usr/local/lib/nodejs/node-$VERSION\n```\n## 1.2 Set the environment variable\n```sh\nexport NODEJS_HOME=/usr/local/lib/nodejs/node-$VERSION/bin\nexport PATH=$NODEJS_HOME:$PATH\n# Refresh profile\n. ~/.profile\n```\n## 1.3 Test installation\n```sh\nnode -v\nnpm version\nnpx -v\n```\n## 1.4 Create a sudo link\n```sh\nsudo ln -s /usr/local/lib/nodejs/node-$VERSION/bin/node /usr/bin/node\nsudo ln -s /usr/local/lib/nodejs/node-$VERSION/bin/npm /usr/bin/npm\nsudo ln -s /usr/local/lib/nodejs/node-$VERSION/bin/npx /usr/bin/npx\n```\n\n# 2 Installing Node.js via package manager\n\n| system |ubuntu 18.04|\n|--|--|\n| version |v10.18.0(LTS) |\n## 2.1 curl\n\n```sh\ncurl -sL https://deb.nodesource.com/setup_10.x | sudo -E bash -\nsudo apt-get install -y nodejs\n```\n## 2.2 Manual installation\n```sh\n# Remove the old PPA if previously used Chris Lea's Node.js PPA.\nsudo add-apt-repository -y -r ppa:chris-lea/node.js\nsudo rm -f /etc/apt/sources.list.d/chris-lea-node_js-*.list\nsudo rm -f /etc/apt/sources.list.d/chris-lea-node_js-*.list.save\n# Add the NodeSource package signing key\ncurl -sSL https://deb.nodesource.com/gpgkey/nodesource.gpg.key | sudo apt-key add -\n>gpg: no valid OpenPGP data # cross wall ok\n# Add the desired NodeSource repository\nVERSION=node_10.x\nDISTRO=\"$(lsb_release -s -c)\"\necho \"deb https://deb.nodesource.com/$VERSION $DISTRO main\" | sudo tee /etc/apt/sources.list.d/nodesource.list\necho \"deb-src https://deb.nodesource.com/$VERSION $DISTRO main\" | sudo tee -a /etc/apt/sources.list.d/nodesource.list\n# Update package lists and install Node.js\nsudo apt-get update\nsudo apt-get install nodejs\n```\n# 3 源\n## 3.1 淘宝 NPM 镜像\n```sh\n# install cnpm cli\nnpm install -g cnpm --registry=https://registry.npm.taobao.org\ncnpm version\n```\nCNPM command fails after shutdown and restart，so\n```sh\nalias cnpm=\"npm --registry=https://registry.npm.taobao.org \\\n--cache=$HOME/.npm/.cache/cnpm \\\n--disturl=https://npm.taobao.org/dist \\\n--userconfig=$HOME/.cnpmrc\"\n# OK\n```\n![](https://cloud.githubusercontent.com/assets/543405/21505401/fd0b6220-cca1-11e6-86ed-599cc81bb03b.png)\n## 3.2 nrm\n```sh\nsudo npm install -g nrm\nnrm ls\nnrm use taobao\n```\n# 4 Change version \n```sh\ncnpm install n -g\nsudo n stable\n```\n# 5 Install yarn\n\n| system |ubuntu 18.04|\n|--|--|\n| version |v1.21.1(stable) |\n```sh\n# configure the repository:\ncurl -sS https://dl.yarnpkg.com/debian/pubkey.gpg | sudo apt-key add -\necho \"deb https://dl.yarnpkg.com/debian/ stable main\" | sudo tee /etc/apt/sources.list.d/yarn.list\nsudo apt update && sudo apt install yarn\n```\n# Reference\n\n<small>[1] nodesource.Node.js Binary Distributions[EB/OL].https://github.com/nodesource/distributions/blob/master/README.md .2019.</small>\n<small>[2] nodejs. How to install Node.js via binary archive on Linux?[EB/OL]. https://github.com/nodejs/help/wiki/Installation .2018.</small>\n<small>[3] taobao. 淘宝 NPM 镜像使用说明[EB/OL]. https://npm.taobao.org/ .2014-2016</small>\n<small>[4] tj. n – Interactively Manage Your Node.js Versions[EB/OL]. https://www.npmjs.com/package/n .2018.</small>    https://www.yarnpkg.com/en/docs/install#debian-stable\n<small>[5] Yarn.Installation[EB/OL]. https://www.yarnpkg.com/en/docs/install#debian-stable.2018.</small>","slug":"install node","published":1,"lang":"en","updated":"2019-12-29T10:53:10.000Z","_id":"cjvnq7z9r000c7jjxig9cxpox","comments":1,"layout":"post","photos":[],"link":"","content":"<link rel=\"stylesheet\" class=\"aplayer-secondary-style-marker\" href=\"/assets/css/APlayer.min.css\"><script src=\"/assets/js/APlayer.min.js\" class=\"aplayer-secondary-script-marker\"></script><script class=\"meting-secondary-script-marker\" src=\"/assets/js/Meting.min.js\"></script><link rel=\"stylesheet\" type=\"text/css\" href=\"https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css\"><h1 id=\"1-Install-Node-js-via-binary-archive-on-Linux64\"><a href=\"#1-Install-Node-js-via-binary-archive-on-Linux64\" class=\"headerlink\" title=\"1 Install Node.js via binary archive on Linux64\"></a>1 Install Node.js via binary archive on Linux64</h1><table>\n<thead>\n<tr>\n<th>system</th>\n<th><a href=\"http://releases.ubuntu.com/16.04/ubuntu-16.04.5-desktop-amd64.iso.torrent?_ga=2.96882006.834203655.1547825063-1630968062.1547825063\" target=\"_blank\" rel=\"noopener\">ubuntu 16.04</a>(<a href=\"https://app.vagrantup.com/ubuntu/boxes/xenial64\" target=\"_blank\" rel=\"noopener\">vagrant box</a>)</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>version</td>\n<td><a href=\"https://nodejs.org/dist/v10.15.0/node-v10.15.0-linux-x64.tar.xz\" target=\"_blank\" rel=\"noopener\">Linux Binaries (x64) v10.15.0(LTS)</a></td>\n</tr>\n</tbody>\n</table>\n<a id=\"more\"></a>\n<h2 id=\"1-1-Unzip-the-binary-archive\"><a href=\"#1-1-Unzip-the-binary-archive\" class=\"headerlink\" title=\"1.1 Unzip the binary archive\"></a>1.1 Unzip the binary archive</h2><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">VERSION=v10.15.0</span><br><span class=\"line\">DISTRO=linux-x64</span><br><span class=\"line\">sudo mkdir /usr/<span class=\"built_in\">local</span>/lib/nodejs</span><br><span class=\"line\">wget https://nodejs.org/dist/<span class=\"variable\">$VERSION</span>/node-<span class=\"variable\">$VERSION</span>-<span class=\"variable\">$DISTRO</span>.tar.xz</span><br><span class=\"line\">sudo tar -xJvf node-<span class=\"variable\">$VERSION</span>-<span class=\"variable\">$DISTRO</span>.tar.xz -C /usr/<span class=\"built_in\">local</span>/lib/nodejs</span><br><span class=\"line\">sudo mv /usr/<span class=\"built_in\">local</span>/lib/nodejs/node-<span class=\"variable\">$VERSION</span>-<span class=\"variable\">$DISTRO</span> /usr/<span class=\"built_in\">local</span>/lib/nodejs/node-<span class=\"variable\">$VERSION</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"1-2-Set-the-environment-variable\"><a href=\"#1-2-Set-the-environment-variable\" class=\"headerlink\" title=\"1.2 Set the environment variable\"></a>1.2 Set the environment variable</h2><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">export</span> NODEJS_HOME=/usr/<span class=\"built_in\">local</span>/lib/nodejs/node-<span class=\"variable\">$VERSION</span>/bin</span><br><span class=\"line\"><span class=\"built_in\">export</span> PATH=<span class=\"variable\">$NODEJS_HOME</span>:<span class=\"variable\">$PATH</span></span><br><span class=\"line\"><span class=\"comment\"># Refresh profile</span></span><br><span class=\"line\">. ~/.profile</span><br></pre></td></tr></table></figure>\n<h2 id=\"1-3-Test-installation\"><a href=\"#1-3-Test-installation\" class=\"headerlink\" title=\"1.3 Test installation\"></a>1.3 Test installation</h2><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">node -v</span><br><span class=\"line\">npm version</span><br><span class=\"line\">npx -v</span><br></pre></td></tr></table></figure>\n<h2 id=\"1-4-Create-a-sudo-link\"><a href=\"#1-4-Create-a-sudo-link\" class=\"headerlink\" title=\"1.4 Create a sudo link\"></a>1.4 Create a sudo link</h2><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo ln -s /usr/<span class=\"built_in\">local</span>/lib/nodejs/node-<span class=\"variable\">$VERSION</span>/bin/node /usr/bin/node</span><br><span class=\"line\">sudo ln -s /usr/<span class=\"built_in\">local</span>/lib/nodejs/node-<span class=\"variable\">$VERSION</span>/bin/npm /usr/bin/npm</span><br><span class=\"line\">sudo ln -s /usr/<span class=\"built_in\">local</span>/lib/nodejs/node-<span class=\"variable\">$VERSION</span>/bin/npx /usr/bin/npx</span><br></pre></td></tr></table></figure>\n<h1 id=\"2-Installing-Node-js-via-package-manager\"><a href=\"#2-Installing-Node-js-via-package-manager\" class=\"headerlink\" title=\"2 Installing Node.js via package manager\"></a>2 Installing Node.js via package manager</h1><table>\n<thead>\n<tr>\n<th>system</th>\n<th>ubuntu 18.04</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>version</td>\n<td>v10.18.0(LTS)</td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"2-1-curl\"><a href=\"#2-1-curl\" class=\"headerlink\" title=\"2.1 curl\"></a>2.1 curl</h2><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">curl -sL https://deb.nodesource.com/setup_10.x | sudo -E bash -</span><br><span class=\"line\">sudo apt-get install -y nodejs</span><br></pre></td></tr></table></figure>\n<h2 id=\"2-2-Manual-installation\"><a href=\"#2-2-Manual-installation\" class=\"headerlink\" title=\"2.2 Manual installation\"></a>2.2 Manual installation</h2><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># Remove the old PPA if previously used Chris Lea's Node.js PPA.</span></span><br><span class=\"line\">sudo add-apt-repository -y -r ppa:chris-lea/node.js</span><br><span class=\"line\">sudo rm -f /etc/apt/sources.list.d/chris-lea-node_js-*.list</span><br><span class=\"line\">sudo rm -f /etc/apt/sources.list.d/chris-lea-node_js-*.list.save</span><br><span class=\"line\"><span class=\"comment\"># Add the NodeSource package signing key</span></span><br><span class=\"line\">curl -sSL https://deb.nodesource.com/gpgkey/nodesource.gpg.key | sudo apt-key add -</span><br><span class=\"line\">&gt;gpg: no valid OpenPGP data <span class=\"comment\"># cross wall ok</span></span><br><span class=\"line\"><span class=\"comment\"># Add the desired NodeSource repository</span></span><br><span class=\"line\">VERSION=node_10.x</span><br><span class=\"line\">DISTRO=<span class=\"string\">\"<span class=\"variable\">$(lsb_release -s -c)</span>\"</span></span><br><span class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">\"deb https://deb.nodesource.com/<span class=\"variable\">$VERSION</span> <span class=\"variable\">$DISTRO</span> main\"</span> | sudo tee /etc/apt/sources.list.d/nodesource.list</span><br><span class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">\"deb-src https://deb.nodesource.com/<span class=\"variable\">$VERSION</span> <span class=\"variable\">$DISTRO</span> main\"</span> | sudo tee -a /etc/apt/sources.list.d/nodesource.list</span><br><span class=\"line\"><span class=\"comment\"># Update package lists and install Node.js</span></span><br><span class=\"line\">sudo apt-get update</span><br><span class=\"line\">sudo apt-get install nodejs</span><br></pre></td></tr></table></figure>\n<h1 id=\"3-源\"><a href=\"#3-源\" class=\"headerlink\" title=\"3 源\"></a>3 源</h1><h2 id=\"3-1-淘宝-NPM-镜像\"><a href=\"#3-1-淘宝-NPM-镜像\" class=\"headerlink\" title=\"3.1 淘宝 NPM 镜像\"></a>3.1 淘宝 NPM 镜像</h2><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># install cnpm cli</span></span><br><span class=\"line\">npm install -g cnpm --registry=https://registry.npm.taobao.org</span><br><span class=\"line\">cnpm version</span><br></pre></td></tr></table></figure>\n<p>CNPM command fails after shutdown and restart，so<br><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">alias</span> cnpm=<span class=\"string\">\"npm --registry=https://registry.npm.taobao.org \\</span></span><br><span class=\"line\"><span class=\"string\">--cache=<span class=\"variable\">$HOME</span>/.npm/.cache/cnpm \\</span></span><br><span class=\"line\"><span class=\"string\">--disturl=https://npm.taobao.org/dist \\</span></span><br><span class=\"line\"><span class=\"string\">--userconfig=<span class=\"variable\">$HOME</span>/.cnpmrc\"</span></span><br><span class=\"line\"><span class=\"comment\"># OK</span></span><br></pre></td></tr></table></figure></p>\n<p><img src=\"https://cloud.githubusercontent.com/assets/543405/21505401/fd0b6220-cca1-11e6-86ed-599cc81bb03b.png\" alt></p>\n<h2 id=\"3-2-nrm\"><a href=\"#3-2-nrm\" class=\"headerlink\" title=\"3.2 nrm\"></a>3.2 nrm</h2><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo npm install -g nrm</span><br><span class=\"line\">nrm ls</span><br><span class=\"line\">nrm use taobao</span><br></pre></td></tr></table></figure>\n<h1 id=\"4-Change-version\"><a href=\"#4-Change-version\" class=\"headerlink\" title=\"4 Change version\"></a>4 Change version</h1><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cnpm install n -g</span><br><span class=\"line\">sudo n stable</span><br></pre></td></tr></table></figure>\n<h1 id=\"5-Install-yarn\"><a href=\"#5-Install-yarn\" class=\"headerlink\" title=\"5 Install yarn\"></a>5 Install yarn</h1><table>\n<thead>\n<tr>\n<th>system</th>\n<th>ubuntu 18.04</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>version</td>\n<td>v1.21.1(stable)</td>\n</tr>\n</tbody>\n</table>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># configure the repository:</span></span><br><span class=\"line\">curl -sS https://dl.yarnpkg.com/debian/pubkey.gpg | sudo apt-key add -</span><br><span class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">\"deb https://dl.yarnpkg.com/debian/ stable main\"</span> | sudo tee /etc/apt/sources.list.d/yarn.list</span><br><span class=\"line\">sudo apt update &amp;&amp; sudo apt install yarn</span><br></pre></td></tr></table></figure>\n<h1 id=\"Reference\"><a href=\"#Reference\" class=\"headerlink\" title=\"Reference\"></a>Reference</h1><p><small>[1] nodesource.Node.js Binary Distributions[EB/OL].<a href=\"https://github.com/nodesource/distributions/blob/master/README.md\" target=\"_blank\" rel=\"noopener\">https://github.com/nodesource/distributions/blob/master/README.md</a> .2019.</small><br><small>[2] nodejs. How to install Node.js via binary archive on Linux?[EB/OL]. <a href=\"https://github.com/nodejs/help/wiki/Installation\" target=\"_blank\" rel=\"noopener\">https://github.com/nodejs/help/wiki/Installation</a> .2018.</small><br><small>[3] taobao. 淘宝 NPM 镜像使用说明[EB/OL]. <a href=\"https://npm.taobao.org/\" target=\"_blank\" rel=\"noopener\">https://npm.taobao.org/</a> .2014-2016</small><br><small>[4] tj. n – Interactively Manage Your Node.js Versions[EB/OL]. <a href=\"https://www.npmjs.com/package/n\" target=\"_blank\" rel=\"noopener\">https://www.npmjs.com/package/n</a> .2018.</small>    <a href=\"https://www.yarnpkg.com/en/docs/install#debian-stable\" target=\"_blank\" rel=\"noopener\">https://www.yarnpkg.com/en/docs/install#debian-stable</a><br><small>[5] Yarn.Installation[EB/OL]. <a href=\"https://www.yarnpkg.com/en/docs/install#debian-stable.2018\" target=\"_blank\" rel=\"noopener\">https://www.yarnpkg.com/en/docs/install#debian-stable.2018</a>.</small></p>\n","site":{"data":{}},"excerpt":"<h1 id=\"1-Install-Node-js-via-binary-archive-on-Linux64\"><a href=\"#1-Install-Node-js-via-binary-archive-on-Linux64\" class=\"headerlink\" title=\"1 Install Node.js via binary archive on Linux64\"></a>1 Install Node.js via binary archive on Linux64</h1><table>\n<thead>\n<tr>\n<th>system</th>\n<th><a href=\"http://releases.ubuntu.com/16.04/ubuntu-16.04.5-desktop-amd64.iso.torrent?_ga=2.96882006.834203655.1547825063-1630968062.1547825063\" target=\"_blank\" rel=\"noopener\">ubuntu 16.04</a>(<a href=\"https://app.vagrantup.com/ubuntu/boxes/xenial64\" target=\"_blank\" rel=\"noopener\">vagrant box</a>)</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>version</td>\n<td><a href=\"https://nodejs.org/dist/v10.15.0/node-v10.15.0-linux-x64.tar.xz\" target=\"_blank\" rel=\"noopener\">Linux Binaries (x64) v10.15.0(LTS)</a></td>\n</tr>\n</tbody>\n</table>","more":"<h2 id=\"1-1-Unzip-the-binary-archive\"><a href=\"#1-1-Unzip-the-binary-archive\" class=\"headerlink\" title=\"1.1 Unzip the binary archive\"></a>1.1 Unzip the binary archive</h2><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">VERSION=v10.15.0</span><br><span class=\"line\">DISTRO=linux-x64</span><br><span class=\"line\">sudo mkdir /usr/<span class=\"built_in\">local</span>/lib/nodejs</span><br><span class=\"line\">wget https://nodejs.org/dist/<span class=\"variable\">$VERSION</span>/node-<span class=\"variable\">$VERSION</span>-<span class=\"variable\">$DISTRO</span>.tar.xz</span><br><span class=\"line\">sudo tar -xJvf node-<span class=\"variable\">$VERSION</span>-<span class=\"variable\">$DISTRO</span>.tar.xz -C /usr/<span class=\"built_in\">local</span>/lib/nodejs</span><br><span class=\"line\">sudo mv /usr/<span class=\"built_in\">local</span>/lib/nodejs/node-<span class=\"variable\">$VERSION</span>-<span class=\"variable\">$DISTRO</span> /usr/<span class=\"built_in\">local</span>/lib/nodejs/node-<span class=\"variable\">$VERSION</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"1-2-Set-the-environment-variable\"><a href=\"#1-2-Set-the-environment-variable\" class=\"headerlink\" title=\"1.2 Set the environment variable\"></a>1.2 Set the environment variable</h2><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">export</span> NODEJS_HOME=/usr/<span class=\"built_in\">local</span>/lib/nodejs/node-<span class=\"variable\">$VERSION</span>/bin</span><br><span class=\"line\"><span class=\"built_in\">export</span> PATH=<span class=\"variable\">$NODEJS_HOME</span>:<span class=\"variable\">$PATH</span></span><br><span class=\"line\"><span class=\"comment\"># Refresh profile</span></span><br><span class=\"line\">. ~/.profile</span><br></pre></td></tr></table></figure>\n<h2 id=\"1-3-Test-installation\"><a href=\"#1-3-Test-installation\" class=\"headerlink\" title=\"1.3 Test installation\"></a>1.3 Test installation</h2><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">node -v</span><br><span class=\"line\">npm version</span><br><span class=\"line\">npx -v</span><br></pre></td></tr></table></figure>\n<h2 id=\"1-4-Create-a-sudo-link\"><a href=\"#1-4-Create-a-sudo-link\" class=\"headerlink\" title=\"1.4 Create a sudo link\"></a>1.4 Create a sudo link</h2><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo ln -s /usr/<span class=\"built_in\">local</span>/lib/nodejs/node-<span class=\"variable\">$VERSION</span>/bin/node /usr/bin/node</span><br><span class=\"line\">sudo ln -s /usr/<span class=\"built_in\">local</span>/lib/nodejs/node-<span class=\"variable\">$VERSION</span>/bin/npm /usr/bin/npm</span><br><span class=\"line\">sudo ln -s /usr/<span class=\"built_in\">local</span>/lib/nodejs/node-<span class=\"variable\">$VERSION</span>/bin/npx /usr/bin/npx</span><br></pre></td></tr></table></figure>\n<h1 id=\"2-Installing-Node-js-via-package-manager\"><a href=\"#2-Installing-Node-js-via-package-manager\" class=\"headerlink\" title=\"2 Installing Node.js via package manager\"></a>2 Installing Node.js via package manager</h1><table>\n<thead>\n<tr>\n<th>system</th>\n<th>ubuntu 18.04</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>version</td>\n<td>v10.18.0(LTS)</td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"2-1-curl\"><a href=\"#2-1-curl\" class=\"headerlink\" title=\"2.1 curl\"></a>2.1 curl</h2><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">curl -sL https://deb.nodesource.com/setup_10.x | sudo -E bash -</span><br><span class=\"line\">sudo apt-get install -y nodejs</span><br></pre></td></tr></table></figure>\n<h2 id=\"2-2-Manual-installation\"><a href=\"#2-2-Manual-installation\" class=\"headerlink\" title=\"2.2 Manual installation\"></a>2.2 Manual installation</h2><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># Remove the old PPA if previously used Chris Lea's Node.js PPA.</span></span><br><span class=\"line\">sudo add-apt-repository -y -r ppa:chris-lea/node.js</span><br><span class=\"line\">sudo rm -f /etc/apt/sources.list.d/chris-lea-node_js-*.list</span><br><span class=\"line\">sudo rm -f /etc/apt/sources.list.d/chris-lea-node_js-*.list.save</span><br><span class=\"line\"><span class=\"comment\"># Add the NodeSource package signing key</span></span><br><span class=\"line\">curl -sSL https://deb.nodesource.com/gpgkey/nodesource.gpg.key | sudo apt-key add -</span><br><span class=\"line\">&gt;gpg: no valid OpenPGP data <span class=\"comment\"># cross wall ok</span></span><br><span class=\"line\"><span class=\"comment\"># Add the desired NodeSource repository</span></span><br><span class=\"line\">VERSION=node_10.x</span><br><span class=\"line\">DISTRO=<span class=\"string\">\"<span class=\"variable\">$(lsb_release -s -c)</span>\"</span></span><br><span class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">\"deb https://deb.nodesource.com/<span class=\"variable\">$VERSION</span> <span class=\"variable\">$DISTRO</span> main\"</span> | sudo tee /etc/apt/sources.list.d/nodesource.list</span><br><span class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">\"deb-src https://deb.nodesource.com/<span class=\"variable\">$VERSION</span> <span class=\"variable\">$DISTRO</span> main\"</span> | sudo tee -a /etc/apt/sources.list.d/nodesource.list</span><br><span class=\"line\"><span class=\"comment\"># Update package lists and install Node.js</span></span><br><span class=\"line\">sudo apt-get update</span><br><span class=\"line\">sudo apt-get install nodejs</span><br></pre></td></tr></table></figure>\n<h1 id=\"3-源\"><a href=\"#3-源\" class=\"headerlink\" title=\"3 源\"></a>3 源</h1><h2 id=\"3-1-淘宝-NPM-镜像\"><a href=\"#3-1-淘宝-NPM-镜像\" class=\"headerlink\" title=\"3.1 淘宝 NPM 镜像\"></a>3.1 淘宝 NPM 镜像</h2><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># install cnpm cli</span></span><br><span class=\"line\">npm install -g cnpm --registry=https://registry.npm.taobao.org</span><br><span class=\"line\">cnpm version</span><br></pre></td></tr></table></figure>\n<p>CNPM command fails after shutdown and restart，so<br><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">alias</span> cnpm=<span class=\"string\">\"npm --registry=https://registry.npm.taobao.org \\</span></span><br><span class=\"line\"><span class=\"string\">--cache=<span class=\"variable\">$HOME</span>/.npm/.cache/cnpm \\</span></span><br><span class=\"line\"><span class=\"string\">--disturl=https://npm.taobao.org/dist \\</span></span><br><span class=\"line\"><span class=\"string\">--userconfig=<span class=\"variable\">$HOME</span>/.cnpmrc\"</span></span><br><span class=\"line\"><span class=\"comment\"># OK</span></span><br></pre></td></tr></table></figure></p>\n<p><img src=\"https://cloud.githubusercontent.com/assets/543405/21505401/fd0b6220-cca1-11e6-86ed-599cc81bb03b.png\" alt></p>\n<h2 id=\"3-2-nrm\"><a href=\"#3-2-nrm\" class=\"headerlink\" title=\"3.2 nrm\"></a>3.2 nrm</h2><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo npm install -g nrm</span><br><span class=\"line\">nrm ls</span><br><span class=\"line\">nrm use taobao</span><br></pre></td></tr></table></figure>\n<h1 id=\"4-Change-version\"><a href=\"#4-Change-version\" class=\"headerlink\" title=\"4 Change version\"></a>4 Change version</h1><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cnpm install n -g</span><br><span class=\"line\">sudo n stable</span><br></pre></td></tr></table></figure>\n<h1 id=\"5-Install-yarn\"><a href=\"#5-Install-yarn\" class=\"headerlink\" title=\"5 Install yarn\"></a>5 Install yarn</h1><table>\n<thead>\n<tr>\n<th>system</th>\n<th>ubuntu 18.04</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>version</td>\n<td>v1.21.1(stable)</td>\n</tr>\n</tbody>\n</table>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># configure the repository:</span></span><br><span class=\"line\">curl -sS https://dl.yarnpkg.com/debian/pubkey.gpg | sudo apt-key add -</span><br><span class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">\"deb https://dl.yarnpkg.com/debian/ stable main\"</span> | sudo tee /etc/apt/sources.list.d/yarn.list</span><br><span class=\"line\">sudo apt update &amp;&amp; sudo apt install yarn</span><br></pre></td></tr></table></figure>\n<h1 id=\"Reference\"><a href=\"#Reference\" class=\"headerlink\" title=\"Reference\"></a>Reference</h1><p><small>[1] nodesource.Node.js Binary Distributions[EB/OL].<a href=\"https://github.com/nodesource/distributions/blob/master/README.md\" target=\"_blank\" rel=\"noopener\">https://github.com/nodesource/distributions/blob/master/README.md</a> .2019.</small><br><small>[2] nodejs. How to install Node.js via binary archive on Linux?[EB/OL]. <a href=\"https://github.com/nodejs/help/wiki/Installation\" target=\"_blank\" rel=\"noopener\">https://github.com/nodejs/help/wiki/Installation</a> .2018.</small><br><small>[3] taobao. 淘宝 NPM 镜像使用说明[EB/OL]. <a href=\"https://npm.taobao.org/\" target=\"_blank\" rel=\"noopener\">https://npm.taobao.org/</a> .2014-2016</small><br><small>[4] tj. n – Interactively Manage Your Node.js Versions[EB/OL]. <a href=\"https://www.npmjs.com/package/n\" target=\"_blank\" rel=\"noopener\">https://www.npmjs.com/package/n</a> .2018.</small>    <a href=\"https://www.yarnpkg.com/en/docs/install#debian-stable\" target=\"_blank\" rel=\"noopener\">https://www.yarnpkg.com/en/docs/install#debian-stable</a><br><small>[5] Yarn.Installation[EB/OL]. <a href=\"https://www.yarnpkg.com/en/docs/install#debian-stable.2018\" target=\"_blank\" rel=\"noopener\">https://www.yarnpkg.com/en/docs/install#debian-stable.2018</a>.</small></p>"},{"title":"koajs Analysis","lang":"en","date":"2019-04-29T01:25:03.000Z","_content":"# 1. start\n## 1.1 simple http server\n```js\n// app.js\nconst http = require('http');\nhttp.createServer(function (req, res) {\n  res.end('hello world');\n}).listen(3000);\n```\n\n<!-- more -->\n\n## 1.2 express\n```js\n// app.js\nconst express = require('express');\nconst app = express();\napp.get('/',function(req, res) {\n    res.send('hello express')\n});\napp.listen(3000);\n```\n## 1.3 koa\n```js\ncnpm i koa --save\n// app.js\nconst Koa = require('koa');\nconst app = new Koa(); //koa2 1\napp.use(ctx=>{\n  ctx.body = 'hello Koa';\n}); // 2\napp.listen(3000); // 3\n```\n## 1.4 Differences and connections\nexpress and koa are both based on http,module of node.\n# 2 Source Analysis\n## 2.1 Core logic\n1. Intercept the request for processing\n2. Middleware ecological\n\n## 2.2 Dependencies\n```sh\nmkdir koa-init && cd koa-init\ncnpm i koa --save\n```\nnode_modules\n```js\nnode_modules\n├── koa\n├── koa-compose\n├── koa-convert\n└── koa-is-json\n// koa/package.json\n\"koa-compose\": \"^4.1.0\",\n\"koa-convert\": \"^1.2.0\",\n\"koa-is-json\": \"^1.0.0\",\n```\n## 2.3 Contruct\nThere are only four files as the name implies. \n```js\nkoa\n├── lib\n│   ├── application.js \n│   ├── context.js\n│   ├── request.js\n│   └── response.js\n```\n### 2.3.1 application.js\n#### 2.3.1.1 Operations\n1. init\n\n```js\n// app.js\nconst app = new Koa()\n// package.json{\"main\":lib/application.js}\nconstructor() {\n  ...\n  this.middleware = [];\n  this.context = Object.create(context);\n  this.request = Object.create(request);\n  this.response = Object.create(response);\n  ...\n  }\n```\n2. call middleware\n\n```js\n// app.js\napp.use(ctx=>{\n  ...\n})\n// application.js\n/**\n * @param {Function} fn\n * @api use\n */\nuse(fn) {\n  ...\n  this.middleware.push(fn); // core,push 'fn' to middleware array\n  return this;\n}\n```\n3. listen\n\n```js\n// app.js\napp.listen(3000);\n// application.js\n/**\n * Shorthand for:\n *    http.createServer(app.callback()).listen(...)\n * @param {Mixed} ...\n * @return {Server}\n */\nlisten(...args) {\n  ...\n  const server = http.createServer(this.callback());\n  return server.listen(...args);\n}\n```\n#### 2.3.1.2 callback\n```js\n// application.js\ncallback() {\n  const fn = compose(this.middleware); // 1\n  ...\n  const handleRequest = (req, res) => {\n    const ctx = this.createContext(req, res); // 2\n    return this.handleRequest(ctx, fn); //3\n  };\n\n  return handleRequest;\n}\n```\n1. koa-compose\n\n```js\n/**\n * Compose `middleware` returning\n * a fully valid middleware comprised\n * of all those which are passed.\n * \n * @param {Array} middleware\n * @return {Function}\n */\nfunction compose (middleware) {\n  ...\n  /**\n   * @param {Object} context\n   * @return {Promise}\n   * @api public\n   */\n  return function (context, next) {\n    ...\n    function dispatch (i) {\n      ...\n      try {\n        return Promise.resolve(fn(context, dispatch.bind(null, i + 1))); // core recursive calls\n      } catch (err) {\n        return Promise.reject(err)\n      }\n    }\n  }\n}\n```\n2. createContext\n\n```js\n// application.js\ncreateContext(req, res) {\n  const context = Object.create(this.context);\n  const request = context.request = Object.create(this.request);\n  const response = context.response = Object.create(this.response);\n  ...\n}\n```\n3. handleRequest\n\n```js\n// application.js\nhandleRequest(ctx, fnMiddleware) {\n  ...\n  return fnMiddleware(ctx).then(handleResponse).catch(onerror);\n}\n```\nThese objects are already created in the constructor,why?\n#### 2.3.1.3 Call relationship\n![](https://blog-cdn.makergyt.com/application.jpg)\n\n### 2.3.2 context.js\n```js\n// context.js\n/**\n * Response delegation.\n */\ndelegate(proto, 'response')\n/**\n * Request delegation.\n */\ndelegate(proto, 'request')\n```\n### 2.3.3 request.js & response.js\nEncapsulate common base methods\n# 3 Middleware\n## 3.1 Model\n![The onion model](https://user-gold-cdn.xitu.io/2018/11/12/16706e6c0db63bd6?imageView2/0/w/1280/h/960/format/webp/ignore-error/1)\n## 3.2 Unknown\n- ``DEBUG=koa* node --harmony``\n- await & async & yield\n- callback & promise\n- `harmony` params\n- generator function & regular function\n\n## 3.3 generator & regular\n```js\nvar hello = function(name) {\n  return 'hello'  + name;\n}\nconsole.log(hello('James'));\n```\n```js\nvar hello = function *(name) {\n  return 'hello'  + name;\n}\nvar gen = hello('James');\nconsole.log(gen.next());\n```\npause\n```js\nvar hello = function(name) {\n  yield 'Your name is ' + name;\n  return 'hello'  + name;// terminate execution,done: false\n}\n```\nrestart\n```js\nconsole.log(gen.next()); // done: false\nconsole.log(gen.next()); // done: true\n```\n# Reference\n<small>\n[1] koajs.Guide. https://github.com/koajs/koa/blob/master/docs/guide.md [EB/OL] 2018\n[2] koJames Moore.Koajs QuickStart Guide. https://www.knowthen.com/episode-3-koajs-quickstart-guide [EB/OL] 2014\n[3] 贾顺名.koa源码阅读[0]. https://segmentfault.com/a/1190000015724787 [EB/OL] 2018\n</small>","source":"_posts/en/koajs-Analysis.md","raw":"---\ntitle: koajs Analysis\nlang: en\ndate: 2019-04-29 09:25:03\ntags:\n - node\n - koa\ncategories:\n - study\n---\n# 1. start\n## 1.1 simple http server\n```js\n// app.js\nconst http = require('http');\nhttp.createServer(function (req, res) {\n  res.end('hello world');\n}).listen(3000);\n```\n\n<!-- more -->\n\n## 1.2 express\n```js\n// app.js\nconst express = require('express');\nconst app = express();\napp.get('/',function(req, res) {\n    res.send('hello express')\n});\napp.listen(3000);\n```\n## 1.3 koa\n```js\ncnpm i koa --save\n// app.js\nconst Koa = require('koa');\nconst app = new Koa(); //koa2 1\napp.use(ctx=>{\n  ctx.body = 'hello Koa';\n}); // 2\napp.listen(3000); // 3\n```\n## 1.4 Differences and connections\nexpress and koa are both based on http,module of node.\n# 2 Source Analysis\n## 2.1 Core logic\n1. Intercept the request for processing\n2. Middleware ecological\n\n## 2.2 Dependencies\n```sh\nmkdir koa-init && cd koa-init\ncnpm i koa --save\n```\nnode_modules\n```js\nnode_modules\n├── koa\n├── koa-compose\n├── koa-convert\n└── koa-is-json\n// koa/package.json\n\"koa-compose\": \"^4.1.0\",\n\"koa-convert\": \"^1.2.0\",\n\"koa-is-json\": \"^1.0.0\",\n```\n## 2.3 Contruct\nThere are only four files as the name implies. \n```js\nkoa\n├── lib\n│   ├── application.js \n│   ├── context.js\n│   ├── request.js\n│   └── response.js\n```\n### 2.3.1 application.js\n#### 2.3.1.1 Operations\n1. init\n\n```js\n// app.js\nconst app = new Koa()\n// package.json{\"main\":lib/application.js}\nconstructor() {\n  ...\n  this.middleware = [];\n  this.context = Object.create(context);\n  this.request = Object.create(request);\n  this.response = Object.create(response);\n  ...\n  }\n```\n2. call middleware\n\n```js\n// app.js\napp.use(ctx=>{\n  ...\n})\n// application.js\n/**\n * @param {Function} fn\n * @api use\n */\nuse(fn) {\n  ...\n  this.middleware.push(fn); // core,push 'fn' to middleware array\n  return this;\n}\n```\n3. listen\n\n```js\n// app.js\napp.listen(3000);\n// application.js\n/**\n * Shorthand for:\n *    http.createServer(app.callback()).listen(...)\n * @param {Mixed} ...\n * @return {Server}\n */\nlisten(...args) {\n  ...\n  const server = http.createServer(this.callback());\n  return server.listen(...args);\n}\n```\n#### 2.3.1.2 callback\n```js\n// application.js\ncallback() {\n  const fn = compose(this.middleware); // 1\n  ...\n  const handleRequest = (req, res) => {\n    const ctx = this.createContext(req, res); // 2\n    return this.handleRequest(ctx, fn); //3\n  };\n\n  return handleRequest;\n}\n```\n1. koa-compose\n\n```js\n/**\n * Compose `middleware` returning\n * a fully valid middleware comprised\n * of all those which are passed.\n * \n * @param {Array} middleware\n * @return {Function}\n */\nfunction compose (middleware) {\n  ...\n  /**\n   * @param {Object} context\n   * @return {Promise}\n   * @api public\n   */\n  return function (context, next) {\n    ...\n    function dispatch (i) {\n      ...\n      try {\n        return Promise.resolve(fn(context, dispatch.bind(null, i + 1))); // core recursive calls\n      } catch (err) {\n        return Promise.reject(err)\n      }\n    }\n  }\n}\n```\n2. createContext\n\n```js\n// application.js\ncreateContext(req, res) {\n  const context = Object.create(this.context);\n  const request = context.request = Object.create(this.request);\n  const response = context.response = Object.create(this.response);\n  ...\n}\n```\n3. handleRequest\n\n```js\n// application.js\nhandleRequest(ctx, fnMiddleware) {\n  ...\n  return fnMiddleware(ctx).then(handleResponse).catch(onerror);\n}\n```\nThese objects are already created in the constructor,why?\n#### 2.3.1.3 Call relationship\n![](https://blog-cdn.makergyt.com/application.jpg)\n\n### 2.3.2 context.js\n```js\n// context.js\n/**\n * Response delegation.\n */\ndelegate(proto, 'response')\n/**\n * Request delegation.\n */\ndelegate(proto, 'request')\n```\n### 2.3.3 request.js & response.js\nEncapsulate common base methods\n# 3 Middleware\n## 3.1 Model\n![The onion model](https://user-gold-cdn.xitu.io/2018/11/12/16706e6c0db63bd6?imageView2/0/w/1280/h/960/format/webp/ignore-error/1)\n## 3.2 Unknown\n- ``DEBUG=koa* node --harmony``\n- await & async & yield\n- callback & promise\n- `harmony` params\n- generator function & regular function\n\n## 3.3 generator & regular\n```js\nvar hello = function(name) {\n  return 'hello'  + name;\n}\nconsole.log(hello('James'));\n```\n```js\nvar hello = function *(name) {\n  return 'hello'  + name;\n}\nvar gen = hello('James');\nconsole.log(gen.next());\n```\npause\n```js\nvar hello = function(name) {\n  yield 'Your name is ' + name;\n  return 'hello'  + name;// terminate execution,done: false\n}\n```\nrestart\n```js\nconsole.log(gen.next()); // done: false\nconsole.log(gen.next()); // done: true\n```\n# Reference\n<small>\n[1] koajs.Guide. https://github.com/koajs/koa/blob/master/docs/guide.md [EB/OL] 2018\n[2] koJames Moore.Koajs QuickStart Guide. https://www.knowthen.com/episode-3-koajs-quickstart-guide [EB/OL] 2014\n[3] 贾顺名.koa源码阅读[0]. https://segmentfault.com/a/1190000015724787 [EB/OL] 2018\n</small>","slug":"koajs-Analysis","published":1,"updated":"2019-04-29T01:56:05.742Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjvnq7z9u000g7jjxxhy4qom1","content":"<link rel=\"stylesheet\" class=\"aplayer-secondary-style-marker\" href=\"/assets/css/APlayer.min.css\"><script src=\"/assets/js/APlayer.min.js\" class=\"aplayer-secondary-script-marker\"></script><script class=\"meting-secondary-script-marker\" src=\"/assets/js/Meting.min.js\"></script><link rel=\"stylesheet\" type=\"text/css\" href=\"https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css\"><h1 id=\"1-start\"><a href=\"#1-start\" class=\"headerlink\" title=\"1. start\"></a>1. start</h1><h2 id=\"1-1-simple-http-server\"><a href=\"#1-1-simple-http-server\" class=\"headerlink\" title=\"1.1 simple http server\"></a>1.1 simple http server</h2><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// app.js</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> http = <span class=\"built_in\">require</span>(<span class=\"string\">'http'</span>);</span><br><span class=\"line\">http.createServer(<span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">req, res</span>) </span>&#123;</span><br><span class=\"line\">  res.end(<span class=\"string\">'hello world'</span>);</span><br><span class=\"line\">&#125;).listen(<span class=\"number\">3000</span>);</span><br></pre></td></tr></table></figure>\n<a id=\"more\"></a>\n<h2 id=\"1-2-express\"><a href=\"#1-2-express\" class=\"headerlink\" title=\"1.2 express\"></a>1.2 express</h2><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// app.js</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> express = <span class=\"built_in\">require</span>(<span class=\"string\">'express'</span>);</span><br><span class=\"line\"><span class=\"keyword\">const</span> app = express();</span><br><span class=\"line\">app.get(<span class=\"string\">'/'</span>,<span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">req, res</span>) </span>&#123;</span><br><span class=\"line\">    res.send(<span class=\"string\">'hello express'</span>)</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\">app.listen(<span class=\"number\">3000</span>);</span><br></pre></td></tr></table></figure>\n<h2 id=\"1-3-koa\"><a href=\"#1-3-koa\" class=\"headerlink\" title=\"1.3 koa\"></a>1.3 koa</h2><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cnpm i koa --save</span><br><span class=\"line\"><span class=\"comment\">// app.js</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> Koa = <span class=\"built_in\">require</span>(<span class=\"string\">'koa'</span>);</span><br><span class=\"line\"><span class=\"keyword\">const</span> app = <span class=\"keyword\">new</span> Koa(); <span class=\"comment\">//koa2 1</span></span><br><span class=\"line\">app.use(<span class=\"function\"><span class=\"params\">ctx</span>=&gt;</span>&#123;</span><br><span class=\"line\">  ctx.body = <span class=\"string\">'hello Koa'</span>;</span><br><span class=\"line\">&#125;); <span class=\"comment\">// 2</span></span><br><span class=\"line\">app.listen(<span class=\"number\">3000</span>); <span class=\"comment\">// 3</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"1-4-Differences-and-connections\"><a href=\"#1-4-Differences-and-connections\" class=\"headerlink\" title=\"1.4 Differences and connections\"></a>1.4 Differences and connections</h2><p>express and koa are both based on http,module of node.</p>\n<h1 id=\"2-Source-Analysis\"><a href=\"#2-Source-Analysis\" class=\"headerlink\" title=\"2 Source Analysis\"></a>2 Source Analysis</h1><h2 id=\"2-1-Core-logic\"><a href=\"#2-1-Core-logic\" class=\"headerlink\" title=\"2.1 Core logic\"></a>2.1 Core logic</h2><ol>\n<li>Intercept the request for processing</li>\n<li>Middleware ecological</li>\n</ol>\n<h2 id=\"2-2-Dependencies\"><a href=\"#2-2-Dependencies\" class=\"headerlink\" title=\"2.2 Dependencies\"></a>2.2 Dependencies</h2><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mkdir koa-init &amp;&amp; <span class=\"built_in\">cd</span> koa-init</span><br><span class=\"line\">cnpm i koa --save</span><br></pre></td></tr></table></figure>\n<p>node_modules<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">node_modules</span><br><span class=\"line\">├── koa</span><br><span class=\"line\">├── koa-compose</span><br><span class=\"line\">├── koa-convert</span><br><span class=\"line\">└── koa-is-json</span><br><span class=\"line\"><span class=\"comment\">// koa/package.json</span></span><br><span class=\"line\"><span class=\"string\">\"koa-compose\"</span>: <span class=\"string\">\"^4.1.0\"</span>,</span><br><span class=\"line\"><span class=\"string\">\"koa-convert\"</span>: <span class=\"string\">\"^1.2.0\"</span>,</span><br><span class=\"line\"><span class=\"string\">\"koa-is-json\"</span>: <span class=\"string\">\"^1.0.0\"</span>,</span><br></pre></td></tr></table></figure></p>\n<h2 id=\"2-3-Contruct\"><a href=\"#2-3-Contruct\" class=\"headerlink\" title=\"2.3 Contruct\"></a>2.3 Contruct</h2><p>There are only four files as the name implies.<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">koa</span><br><span class=\"line\">├── lib</span><br><span class=\"line\">│   ├── application.js </span><br><span class=\"line\">│   ├── context.js</span><br><span class=\"line\">│   ├── request.js</span><br><span class=\"line\">│   └── response.js</span><br></pre></td></tr></table></figure></p>\n<h3 id=\"2-3-1-application-js\"><a href=\"#2-3-1-application-js\" class=\"headerlink\" title=\"2.3.1 application.js\"></a>2.3.1 application.js</h3><h4 id=\"2-3-1-1-Operations\"><a href=\"#2-3-1-1-Operations\" class=\"headerlink\" title=\"2.3.1.1 Operations\"></a>2.3.1.1 Operations</h4><ol>\n<li>init</li>\n</ol>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// app.js</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> app = <span class=\"keyword\">new</span> Koa()</span><br><span class=\"line\"><span class=\"comment\">// package.json&#123;\"main\":lib/application.js&#125;</span></span><br><span class=\"line\"><span class=\"keyword\">constructor</span>() &#123;</span><br><span class=\"line\">  ...</span><br><span class=\"line\">  <span class=\"keyword\">this</span>.middleware = [];</span><br><span class=\"line\">  <span class=\"keyword\">this</span>.context = <span class=\"built_in\">Object</span>.create(context);</span><br><span class=\"line\">  <span class=\"keyword\">this</span>.request = <span class=\"built_in\">Object</span>.create(request);</span><br><span class=\"line\">  <span class=\"keyword\">this</span>.response = <span class=\"built_in\">Object</span>.create(response);</span><br><span class=\"line\">  ...</span><br><span class=\"line\">  &#125;</span><br></pre></td></tr></table></figure>\n<ol start=\"2\">\n<li>call middleware</li>\n</ol>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// app.js</span></span><br><span class=\"line\">app.use(<span class=\"function\"><span class=\"params\">ctx</span>=&gt;</span>&#123;</span><br><span class=\"line\">  ...</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"comment\">// application.js</span></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * @param &#123;Function&#125; fn</span></span><br><span class=\"line\"><span class=\"comment\"> * @api use</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">use(fn) &#123;</span><br><span class=\"line\">  ...</span><br><span class=\"line\">  <span class=\"keyword\">this</span>.middleware.push(fn); <span class=\"comment\">// core,push 'fn' to middleware array</span></span><br><span class=\"line\">  <span class=\"keyword\">return</span> <span class=\"keyword\">this</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<ol start=\"3\">\n<li>listen</li>\n</ol>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// app.js</span></span><br><span class=\"line\">app.listen(<span class=\"number\">3000</span>);</span><br><span class=\"line\"><span class=\"comment\">// application.js</span></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * Shorthand for:</span></span><br><span class=\"line\"><span class=\"comment\"> *    http.createServer(app.callback()).listen(...)</span></span><br><span class=\"line\"><span class=\"comment\"> * @param &#123;Mixed&#125; ...</span></span><br><span class=\"line\"><span class=\"comment\"> * @return &#123;Server&#125;</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">listen(...args) &#123;</span><br><span class=\"line\">  ...</span><br><span class=\"line\">  <span class=\"keyword\">const</span> server = http.createServer(<span class=\"keyword\">this</span>.callback());</span><br><span class=\"line\">  <span class=\"keyword\">return</span> server.listen(...args);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h4 id=\"2-3-1-2-callback\"><a href=\"#2-3-1-2-callback\" class=\"headerlink\" title=\"2.3.1.2 callback\"></a>2.3.1.2 callback</h4><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// application.js</span></span><br><span class=\"line\">callback() &#123;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> fn = compose(<span class=\"keyword\">this</span>.middleware); <span class=\"comment\">// 1</span></span><br><span class=\"line\">  ...</span><br><span class=\"line\">  <span class=\"keyword\">const</span> handleRequest = <span class=\"function\">(<span class=\"params\">req, res</span>) =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> ctx = <span class=\"keyword\">this</span>.createContext(req, res); <span class=\"comment\">// 2</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">this</span>.handleRequest(ctx, fn); <span class=\"comment\">//3</span></span><br><span class=\"line\">  &#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">return</span> handleRequest;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<ol>\n<li>koa-compose</li>\n</ol>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * Compose `middleware` returning</span></span><br><span class=\"line\"><span class=\"comment\"> * a fully valid middleware comprised</span></span><br><span class=\"line\"><span class=\"comment\"> * of all those which are passed.</span></span><br><span class=\"line\"><span class=\"comment\"> * </span></span><br><span class=\"line\"><span class=\"comment\"> * @param &#123;Array&#125; middleware</span></span><br><span class=\"line\"><span class=\"comment\"> * @return &#123;Function&#125;</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">compose</span> (<span class=\"params\">middleware</span>) </span>&#123;</span><br><span class=\"line\">  ...</span><br><span class=\"line\">  <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">   * @param &#123;Object&#125; context</span></span><br><span class=\"line\"><span class=\"comment\">   * @return &#123;Promise&#125;</span></span><br><span class=\"line\"><span class=\"comment\">   * @api public</span></span><br><span class=\"line\"><span class=\"comment\">   */</span></span><br><span class=\"line\">  <span class=\"keyword\">return</span> <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">context, next</span>) </span>&#123;</span><br><span class=\"line\">    ...</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">dispatch</span> (<span class=\"params\">i</span>) </span>&#123;</span><br><span class=\"line\">      ...</span><br><span class=\"line\">      <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"built_in\">Promise</span>.resolve(fn(context, dispatch.bind(<span class=\"literal\">null</span>, i + <span class=\"number\">1</span>))); <span class=\"comment\">// core recursive calls</span></span><br><span class=\"line\">      &#125; <span class=\"keyword\">catch</span> (err) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"built_in\">Promise</span>.reject(err)</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<ol start=\"2\">\n<li>createContext</li>\n</ol>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// application.js</span></span><br><span class=\"line\">createContext(req, res) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> context = <span class=\"built_in\">Object</span>.create(<span class=\"keyword\">this</span>.context);</span><br><span class=\"line\">  <span class=\"keyword\">const</span> request = context.request = <span class=\"built_in\">Object</span>.create(<span class=\"keyword\">this</span>.request);</span><br><span class=\"line\">  <span class=\"keyword\">const</span> response = context.response = <span class=\"built_in\">Object</span>.create(<span class=\"keyword\">this</span>.response);</span><br><span class=\"line\">  ...</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<ol start=\"3\">\n<li>handleRequest</li>\n</ol>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// application.js</span></span><br><span class=\"line\">handleRequest(ctx, fnMiddleware) &#123;</span><br><span class=\"line\">  ...</span><br><span class=\"line\">  <span class=\"keyword\">return</span> fnMiddleware(ctx).then(handleResponse).catch(onerror);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>These objects are already created in the constructor,why?</p>\n<h4 id=\"2-3-1-3-Call-relationship\"><a href=\"#2-3-1-3-Call-relationship\" class=\"headerlink\" title=\"2.3.1.3 Call relationship\"></a>2.3.1.3 Call relationship</h4><p><img src=\"https://blog-cdn.makergyt.com/application.jpg\" alt></p>\n<h3 id=\"2-3-2-context-js\"><a href=\"#2-3-2-context-js\" class=\"headerlink\" title=\"2.3.2 context.js\"></a>2.3.2 context.js</h3><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// context.js</span></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * Response delegation.</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">delegate(proto, <span class=\"string\">'response'</span>)</span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * Request delegation.</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">delegate(proto, <span class=\"string\">'request'</span>)</span><br></pre></td></tr></table></figure>\n<h3 id=\"2-3-3-request-js-amp-response-js\"><a href=\"#2-3-3-request-js-amp-response-js\" class=\"headerlink\" title=\"2.3.3 request.js &amp; response.js\"></a>2.3.3 request.js &amp; response.js</h3><p>Encapsulate common base methods</p>\n<h1 id=\"3-Middleware\"><a href=\"#3-Middleware\" class=\"headerlink\" title=\"3 Middleware\"></a>3 Middleware</h1><h2 id=\"3-1-Model\"><a href=\"#3-1-Model\" class=\"headerlink\" title=\"3.1 Model\"></a>3.1 Model</h2><p><img src=\"https://user-gold-cdn.xitu.io/2018/11/12/16706e6c0db63bd6?imageView2/0/w/1280/h/960/format/webp/ignore-error/1\" alt=\"The onion model\"></p>\n<h2 id=\"3-2-Unknown\"><a href=\"#3-2-Unknown\" class=\"headerlink\" title=\"3.2 Unknown\"></a>3.2 Unknown</h2><ul>\n<li><code>DEBUG=koa* node --harmony</code></li>\n<li>await &amp; async &amp; yield</li>\n<li>callback &amp; promise</li>\n<li><code>harmony</code> params</li>\n<li>generator function &amp; regular function</li>\n</ul>\n<h2 id=\"3-3-generator-amp-regular\"><a href=\"#3-3-generator-amp-regular\" class=\"headerlink\" title=\"3.3 generator &amp; regular\"></a>3.3 generator &amp; regular</h2><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> hello = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">name</span>) </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> <span class=\"string\">'hello'</span>  + name;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(hello(<span class=\"string\">'James'</span>));</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> hello = <span class=\"function\"><span class=\"keyword\">function</span> *(<span class=\"params\">name</span>) </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> <span class=\"string\">'hello'</span>  + name;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">var</span> gen = hello(<span class=\"string\">'James'</span>);</span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(gen.next());</span><br></pre></td></tr></table></figure>\n<p>pause<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> hello = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">name</span>) </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">yield</span> <span class=\"string\">'Your name is '</span> + name;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> <span class=\"string\">'hello'</span>  + name;<span class=\"comment\">// terminate execution,done: false</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p>restart<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">console</span>.log(gen.next()); <span class=\"comment\">// done: false</span></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(gen.next()); <span class=\"comment\">// done: true</span></span><br></pre></td></tr></table></figure></p>\n<h1 id=\"Reference\"><a href=\"#Reference\" class=\"headerlink\" title=\"Reference\"></a>Reference</h1><p><small><br>[1] koajs.Guide. <a href=\"https://github.com/koajs/koa/blob/master/docs/guide.md\" target=\"_blank\" rel=\"noopener\">https://github.com/koajs/koa/blob/master/docs/guide.md</a> [EB/OL] 2018<br>[2] koJames Moore.Koajs QuickStart Guide. <a href=\"https://www.knowthen.com/episode-3-koajs-quickstart-guide\" target=\"_blank\" rel=\"noopener\">https://www.knowthen.com/episode-3-koajs-quickstart-guide</a> [EB/OL] 2014<br>[3] 贾顺名.koa源码阅读[0]. <a href=\"https://segmentfault.com/a/1190000015724787\" target=\"_blank\" rel=\"noopener\">https://segmentfault.com/a/1190000015724787</a> [EB/OL] 2018<br></small></p>\n","site":{"data":{}},"excerpt":"<h1 id=\"1-start\"><a href=\"#1-start\" class=\"headerlink\" title=\"1. start\"></a>1. start</h1><h2 id=\"1-1-simple-http-server\"><a href=\"#1-1-simple-http-server\" class=\"headerlink\" title=\"1.1 simple http server\"></a>1.1 simple http server</h2><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// app.js</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> http = <span class=\"built_in\">require</span>(<span class=\"string\">'http'</span>);</span><br><span class=\"line\">http.createServer(<span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">req, res</span>) </span>&#123;</span><br><span class=\"line\">  res.end(<span class=\"string\">'hello world'</span>);</span><br><span class=\"line\">&#125;).listen(<span class=\"number\">3000</span>);</span><br></pre></td></tr></table></figure>","more":"<h2 id=\"1-2-express\"><a href=\"#1-2-express\" class=\"headerlink\" title=\"1.2 express\"></a>1.2 express</h2><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// app.js</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> express = <span class=\"built_in\">require</span>(<span class=\"string\">'express'</span>);</span><br><span class=\"line\"><span class=\"keyword\">const</span> app = express();</span><br><span class=\"line\">app.get(<span class=\"string\">'/'</span>,<span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">req, res</span>) </span>&#123;</span><br><span class=\"line\">    res.send(<span class=\"string\">'hello express'</span>)</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\">app.listen(<span class=\"number\">3000</span>);</span><br></pre></td></tr></table></figure>\n<h2 id=\"1-3-koa\"><a href=\"#1-3-koa\" class=\"headerlink\" title=\"1.3 koa\"></a>1.3 koa</h2><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cnpm i koa --save</span><br><span class=\"line\"><span class=\"comment\">// app.js</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> Koa = <span class=\"built_in\">require</span>(<span class=\"string\">'koa'</span>);</span><br><span class=\"line\"><span class=\"keyword\">const</span> app = <span class=\"keyword\">new</span> Koa(); <span class=\"comment\">//koa2 1</span></span><br><span class=\"line\">app.use(<span class=\"function\"><span class=\"params\">ctx</span>=&gt;</span>&#123;</span><br><span class=\"line\">  ctx.body = <span class=\"string\">'hello Koa'</span>;</span><br><span class=\"line\">&#125;); <span class=\"comment\">// 2</span></span><br><span class=\"line\">app.listen(<span class=\"number\">3000</span>); <span class=\"comment\">// 3</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"1-4-Differences-and-connections\"><a href=\"#1-4-Differences-and-connections\" class=\"headerlink\" title=\"1.4 Differences and connections\"></a>1.4 Differences and connections</h2><p>express and koa are both based on http,module of node.</p>\n<h1 id=\"2-Source-Analysis\"><a href=\"#2-Source-Analysis\" class=\"headerlink\" title=\"2 Source Analysis\"></a>2 Source Analysis</h1><h2 id=\"2-1-Core-logic\"><a href=\"#2-1-Core-logic\" class=\"headerlink\" title=\"2.1 Core logic\"></a>2.1 Core logic</h2><ol>\n<li>Intercept the request for processing</li>\n<li>Middleware ecological</li>\n</ol>\n<h2 id=\"2-2-Dependencies\"><a href=\"#2-2-Dependencies\" class=\"headerlink\" title=\"2.2 Dependencies\"></a>2.2 Dependencies</h2><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mkdir koa-init &amp;&amp; <span class=\"built_in\">cd</span> koa-init</span><br><span class=\"line\">cnpm i koa --save</span><br></pre></td></tr></table></figure>\n<p>node_modules<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">node_modules</span><br><span class=\"line\">├── koa</span><br><span class=\"line\">├── koa-compose</span><br><span class=\"line\">├── koa-convert</span><br><span class=\"line\">└── koa-is-json</span><br><span class=\"line\"><span class=\"comment\">// koa/package.json</span></span><br><span class=\"line\"><span class=\"string\">\"koa-compose\"</span>: <span class=\"string\">\"^4.1.0\"</span>,</span><br><span class=\"line\"><span class=\"string\">\"koa-convert\"</span>: <span class=\"string\">\"^1.2.0\"</span>,</span><br><span class=\"line\"><span class=\"string\">\"koa-is-json\"</span>: <span class=\"string\">\"^1.0.0\"</span>,</span><br></pre></td></tr></table></figure></p>\n<h2 id=\"2-3-Contruct\"><a href=\"#2-3-Contruct\" class=\"headerlink\" title=\"2.3 Contruct\"></a>2.3 Contruct</h2><p>There are only four files as the name implies.<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">koa</span><br><span class=\"line\">├── lib</span><br><span class=\"line\">│   ├── application.js </span><br><span class=\"line\">│   ├── context.js</span><br><span class=\"line\">│   ├── request.js</span><br><span class=\"line\">│   └── response.js</span><br></pre></td></tr></table></figure></p>\n<h3 id=\"2-3-1-application-js\"><a href=\"#2-3-1-application-js\" class=\"headerlink\" title=\"2.3.1 application.js\"></a>2.3.1 application.js</h3><h4 id=\"2-3-1-1-Operations\"><a href=\"#2-3-1-1-Operations\" class=\"headerlink\" title=\"2.3.1.1 Operations\"></a>2.3.1.1 Operations</h4><ol>\n<li>init</li>\n</ol>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// app.js</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> app = <span class=\"keyword\">new</span> Koa()</span><br><span class=\"line\"><span class=\"comment\">// package.json&#123;\"main\":lib/application.js&#125;</span></span><br><span class=\"line\"><span class=\"keyword\">constructor</span>() &#123;</span><br><span class=\"line\">  ...</span><br><span class=\"line\">  <span class=\"keyword\">this</span>.middleware = [];</span><br><span class=\"line\">  <span class=\"keyword\">this</span>.context = <span class=\"built_in\">Object</span>.create(context);</span><br><span class=\"line\">  <span class=\"keyword\">this</span>.request = <span class=\"built_in\">Object</span>.create(request);</span><br><span class=\"line\">  <span class=\"keyword\">this</span>.response = <span class=\"built_in\">Object</span>.create(response);</span><br><span class=\"line\">  ...</span><br><span class=\"line\">  &#125;</span><br></pre></td></tr></table></figure>\n<ol start=\"2\">\n<li>call middleware</li>\n</ol>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// app.js</span></span><br><span class=\"line\">app.use(<span class=\"function\"><span class=\"params\">ctx</span>=&gt;</span>&#123;</span><br><span class=\"line\">  ...</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"comment\">// application.js</span></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * @param &#123;Function&#125; fn</span></span><br><span class=\"line\"><span class=\"comment\"> * @api use</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">use(fn) &#123;</span><br><span class=\"line\">  ...</span><br><span class=\"line\">  <span class=\"keyword\">this</span>.middleware.push(fn); <span class=\"comment\">// core,push 'fn' to middleware array</span></span><br><span class=\"line\">  <span class=\"keyword\">return</span> <span class=\"keyword\">this</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<ol start=\"3\">\n<li>listen</li>\n</ol>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// app.js</span></span><br><span class=\"line\">app.listen(<span class=\"number\">3000</span>);</span><br><span class=\"line\"><span class=\"comment\">// application.js</span></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * Shorthand for:</span></span><br><span class=\"line\"><span class=\"comment\"> *    http.createServer(app.callback()).listen(...)</span></span><br><span class=\"line\"><span class=\"comment\"> * @param &#123;Mixed&#125; ...</span></span><br><span class=\"line\"><span class=\"comment\"> * @return &#123;Server&#125;</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">listen(...args) &#123;</span><br><span class=\"line\">  ...</span><br><span class=\"line\">  <span class=\"keyword\">const</span> server = http.createServer(<span class=\"keyword\">this</span>.callback());</span><br><span class=\"line\">  <span class=\"keyword\">return</span> server.listen(...args);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h4 id=\"2-3-1-2-callback\"><a href=\"#2-3-1-2-callback\" class=\"headerlink\" title=\"2.3.1.2 callback\"></a>2.3.1.2 callback</h4><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// application.js</span></span><br><span class=\"line\">callback() &#123;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> fn = compose(<span class=\"keyword\">this</span>.middleware); <span class=\"comment\">// 1</span></span><br><span class=\"line\">  ...</span><br><span class=\"line\">  <span class=\"keyword\">const</span> handleRequest = <span class=\"function\">(<span class=\"params\">req, res</span>) =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> ctx = <span class=\"keyword\">this</span>.createContext(req, res); <span class=\"comment\">// 2</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">this</span>.handleRequest(ctx, fn); <span class=\"comment\">//3</span></span><br><span class=\"line\">  &#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">return</span> handleRequest;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<ol>\n<li>koa-compose</li>\n</ol>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * Compose `middleware` returning</span></span><br><span class=\"line\"><span class=\"comment\"> * a fully valid middleware comprised</span></span><br><span class=\"line\"><span class=\"comment\"> * of all those which are passed.</span></span><br><span class=\"line\"><span class=\"comment\"> * </span></span><br><span class=\"line\"><span class=\"comment\"> * @param &#123;Array&#125; middleware</span></span><br><span class=\"line\"><span class=\"comment\"> * @return &#123;Function&#125;</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">compose</span> (<span class=\"params\">middleware</span>) </span>&#123;</span><br><span class=\"line\">  ...</span><br><span class=\"line\">  <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">   * @param &#123;Object&#125; context</span></span><br><span class=\"line\"><span class=\"comment\">   * @return &#123;Promise&#125;</span></span><br><span class=\"line\"><span class=\"comment\">   * @api public</span></span><br><span class=\"line\"><span class=\"comment\">   */</span></span><br><span class=\"line\">  <span class=\"keyword\">return</span> <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">context, next</span>) </span>&#123;</span><br><span class=\"line\">    ...</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">dispatch</span> (<span class=\"params\">i</span>) </span>&#123;</span><br><span class=\"line\">      ...</span><br><span class=\"line\">      <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"built_in\">Promise</span>.resolve(fn(context, dispatch.bind(<span class=\"literal\">null</span>, i + <span class=\"number\">1</span>))); <span class=\"comment\">// core recursive calls</span></span><br><span class=\"line\">      &#125; <span class=\"keyword\">catch</span> (err) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"built_in\">Promise</span>.reject(err)</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<ol start=\"2\">\n<li>createContext</li>\n</ol>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// application.js</span></span><br><span class=\"line\">createContext(req, res) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> context = <span class=\"built_in\">Object</span>.create(<span class=\"keyword\">this</span>.context);</span><br><span class=\"line\">  <span class=\"keyword\">const</span> request = context.request = <span class=\"built_in\">Object</span>.create(<span class=\"keyword\">this</span>.request);</span><br><span class=\"line\">  <span class=\"keyword\">const</span> response = context.response = <span class=\"built_in\">Object</span>.create(<span class=\"keyword\">this</span>.response);</span><br><span class=\"line\">  ...</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<ol start=\"3\">\n<li>handleRequest</li>\n</ol>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// application.js</span></span><br><span class=\"line\">handleRequest(ctx, fnMiddleware) &#123;</span><br><span class=\"line\">  ...</span><br><span class=\"line\">  <span class=\"keyword\">return</span> fnMiddleware(ctx).then(handleResponse).catch(onerror);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>These objects are already created in the constructor,why?</p>\n<h4 id=\"2-3-1-3-Call-relationship\"><a href=\"#2-3-1-3-Call-relationship\" class=\"headerlink\" title=\"2.3.1.3 Call relationship\"></a>2.3.1.3 Call relationship</h4><p><img src=\"https://blog-cdn.makergyt.com/application.jpg\" alt></p>\n<h3 id=\"2-3-2-context-js\"><a href=\"#2-3-2-context-js\" class=\"headerlink\" title=\"2.3.2 context.js\"></a>2.3.2 context.js</h3><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// context.js</span></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * Response delegation.</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">delegate(proto, <span class=\"string\">'response'</span>)</span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * Request delegation.</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">delegate(proto, <span class=\"string\">'request'</span>)</span><br></pre></td></tr></table></figure>\n<h3 id=\"2-3-3-request-js-amp-response-js\"><a href=\"#2-3-3-request-js-amp-response-js\" class=\"headerlink\" title=\"2.3.3 request.js &amp; response.js\"></a>2.3.3 request.js &amp; response.js</h3><p>Encapsulate common base methods</p>\n<h1 id=\"3-Middleware\"><a href=\"#3-Middleware\" class=\"headerlink\" title=\"3 Middleware\"></a>3 Middleware</h1><h2 id=\"3-1-Model\"><a href=\"#3-1-Model\" class=\"headerlink\" title=\"3.1 Model\"></a>3.1 Model</h2><p><img src=\"https://user-gold-cdn.xitu.io/2018/11/12/16706e6c0db63bd6?imageView2/0/w/1280/h/960/format/webp/ignore-error/1\" alt=\"The onion model\"></p>\n<h2 id=\"3-2-Unknown\"><a href=\"#3-2-Unknown\" class=\"headerlink\" title=\"3.2 Unknown\"></a>3.2 Unknown</h2><ul>\n<li><code>DEBUG=koa* node --harmony</code></li>\n<li>await &amp; async &amp; yield</li>\n<li>callback &amp; promise</li>\n<li><code>harmony</code> params</li>\n<li>generator function &amp; regular function</li>\n</ul>\n<h2 id=\"3-3-generator-amp-regular\"><a href=\"#3-3-generator-amp-regular\" class=\"headerlink\" title=\"3.3 generator &amp; regular\"></a>3.3 generator &amp; regular</h2><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> hello = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">name</span>) </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> <span class=\"string\">'hello'</span>  + name;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(hello(<span class=\"string\">'James'</span>));</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> hello = <span class=\"function\"><span class=\"keyword\">function</span> *(<span class=\"params\">name</span>) </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> <span class=\"string\">'hello'</span>  + name;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">var</span> gen = hello(<span class=\"string\">'James'</span>);</span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(gen.next());</span><br></pre></td></tr></table></figure>\n<p>pause<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> hello = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">name</span>) </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">yield</span> <span class=\"string\">'Your name is '</span> + name;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> <span class=\"string\">'hello'</span>  + name;<span class=\"comment\">// terminate execution,done: false</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p>restart<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">console</span>.log(gen.next()); <span class=\"comment\">// done: false</span></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(gen.next()); <span class=\"comment\">// done: true</span></span><br></pre></td></tr></table></figure></p>\n<h1 id=\"Reference\"><a href=\"#Reference\" class=\"headerlink\" title=\"Reference\"></a>Reference</h1><p><small><br>[1] koajs.Guide. <a href=\"https://github.com/koajs/koa/blob/master/docs/guide.md\" target=\"_blank\" rel=\"noopener\">https://github.com/koajs/koa/blob/master/docs/guide.md</a> [EB/OL] 2018<br>[2] koJames Moore.Koajs QuickStart Guide. <a href=\"https://www.knowthen.com/episode-3-koajs-quickstart-guide\" target=\"_blank\" rel=\"noopener\">https://www.knowthen.com/episode-3-koajs-quickstart-guide</a> [EB/OL] 2014<br>[3] 贾顺名.koa源码阅读[0]. <a href=\"https://segmentfault.com/a/1190000015724787\" target=\"_blank\" rel=\"noopener\">https://segmentfault.com/a/1190000015724787</a> [EB/OL] 2018<br></small></p>"},{"title":"ssh reference","date":"2019-01-06T03:16:25.000Z","comments":0,"_content":"# 1 key\n```\nssh -i xxx.pem root@ip\n```\n\n# 2 ssh\n\n<!-- more -->\n\n## 2.1 local\n```\nssh-keygen -t rsa\ncd ~/.ssh\nscp id_rsa.pub root@ip:~/.ssh/id_rsa.pub\n```\n## 2.2 server\n```\ncd ~/.ssh\ncat id_rsa.pub >> authorized_keys\nrm id_rsa.pub\n```\n## 2.3 test\n```\nssh root@ip\n```\n","source":"_posts/en/ssh reference.md","raw":"---\ntitle: ssh reference\ndate: 2019-01-06 11:16:25\ntags: ssh\ncategories: reference\ncomments: false\n---\n# 1 key\n```\nssh -i xxx.pem root@ip\n```\n\n# 2 ssh\n\n<!-- more -->\n\n## 2.1 local\n```\nssh-keygen -t rsa\ncd ~/.ssh\nscp id_rsa.pub root@ip:~/.ssh/id_rsa.pub\n```\n## 2.2 server\n```\ncd ~/.ssh\ncat id_rsa.pub >> authorized_keys\nrm id_rsa.pub\n```\n## 2.3 test\n```\nssh root@ip\n```\n","slug":"ssh reference","published":1,"lang":"en","updated":"2019-04-29T01:07:50.656Z","layout":"post","photos":[],"link":"","_id":"cjvnq7z9v000h7jjxrt7dzw3j","content":"<link rel=\"stylesheet\" class=\"aplayer-secondary-style-marker\" href=\"/assets/css/APlayer.min.css\"><script src=\"/assets/js/APlayer.min.js\" class=\"aplayer-secondary-script-marker\"></script><script class=\"meting-secondary-script-marker\" src=\"/assets/js/Meting.min.js\"></script><link rel=\"stylesheet\" type=\"text/css\" href=\"https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css\"><h1 id=\"1-key\"><a href=\"#1-key\" class=\"headerlink\" title=\"1 key\"></a>1 key</h1><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ssh -i xxx.pem root@ip</span><br></pre></td></tr></table></figure>\n<h1 id=\"2-ssh\"><a href=\"#2-ssh\" class=\"headerlink\" title=\"2 ssh\"></a>2 ssh</h1><a id=\"more\"></a>\n<h2 id=\"2-1-local\"><a href=\"#2-1-local\" class=\"headerlink\" title=\"2.1 local\"></a>2.1 local</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ssh-keygen -t rsa</span><br><span class=\"line\">cd ~/.ssh</span><br><span class=\"line\">scp id_rsa.pub root@ip:~/.ssh/id_rsa.pub</span><br></pre></td></tr></table></figure>\n<h2 id=\"2-2-server\"><a href=\"#2-2-server\" class=\"headerlink\" title=\"2.2 server\"></a>2.2 server</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cd ~/.ssh</span><br><span class=\"line\">cat id_rsa.pub &gt;&gt; authorized_keys</span><br><span class=\"line\">rm id_rsa.pub</span><br></pre></td></tr></table></figure>\n<h2 id=\"2-3-test\"><a href=\"#2-3-test\" class=\"headerlink\" title=\"2.3 test\"></a>2.3 test</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ssh root@ip</span><br></pre></td></tr></table></figure>\n","site":{"data":{}},"excerpt":"<h1 id=\"1-key\"><a href=\"#1-key\" class=\"headerlink\" title=\"1 key\"></a>1 key</h1><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ssh -i xxx.pem root@ip</span><br></pre></td></tr></table></figure>\n<h1 id=\"2-ssh\"><a href=\"#2-ssh\" class=\"headerlink\" title=\"2 ssh\"></a>2 ssh</h1>","more":"<h2 id=\"2-1-local\"><a href=\"#2-1-local\" class=\"headerlink\" title=\"2.1 local\"></a>2.1 local</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ssh-keygen -t rsa</span><br><span class=\"line\">cd ~/.ssh</span><br><span class=\"line\">scp id_rsa.pub root@ip:~/.ssh/id_rsa.pub</span><br></pre></td></tr></table></figure>\n<h2 id=\"2-2-server\"><a href=\"#2-2-server\" class=\"headerlink\" title=\"2.2 server\"></a>2.2 server</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cd ~/.ssh</span><br><span class=\"line\">cat id_rsa.pub &gt;&gt; authorized_keys</span><br><span class=\"line\">rm id_rsa.pub</span><br></pre></td></tr></table></figure>\n<h2 id=\"2-3-test\"><a href=\"#2-3-test\" class=\"headerlink\" title=\"2.3 test\"></a>2.3 test</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ssh root@ip</span><br></pre></td></tr></table></figure>"},{"title":"redis","lang":"en","date":"2019-05-10T03:10:28.000Z","_content":"#  install\n```sh\nwget http://download.redis.io/redis-stable.tar.gz\ntar xvzf redis-stable.tar.gz\ncd redis-stable\nmake\nmake test\n```\n``You need tcl 8.5 or newer in order to run the Redis test``\n```sh\nsudo apt-get update\nsudo apt-get install tcl8.5-dev\n```\ntest\n```sh\n[exception]: Executing test client: couldn't execute \"grep\": not enough memory.\n```\n## start\ndefault port: 6379\n```sh\n./src/redis-server\n./src/redis-cli \n```\nor\n```sh\nsudo cp src/redis-server /usr/local/bin/\nsudo cp src/redis-cli /usr/local/bin/\nredis-server\nredis-cli\n// or just \nmake install\n```\n# Remote ","source":"_posts/en/redis.md","raw":"---\ntitle: redis\nlang: en\ndate: 2019-05-10 11:10:28\ntags:\n---\n#  install\n```sh\nwget http://download.redis.io/redis-stable.tar.gz\ntar xvzf redis-stable.tar.gz\ncd redis-stable\nmake\nmake test\n```\n``You need tcl 8.5 or newer in order to run the Redis test``\n```sh\nsudo apt-get update\nsudo apt-get install tcl8.5-dev\n```\ntest\n```sh\n[exception]: Executing test client: couldn't execute \"grep\": not enough memory.\n```\n## start\ndefault port: 6379\n```sh\n./src/redis-server\n./src/redis-cli \n```\nor\n```sh\nsudo cp src/redis-server /usr/local/bin/\nsudo cp src/redis-cli /usr/local/bin/\nredis-server\nredis-cli\n// or just \nmake install\n```\n# Remote ","slug":"redis","published":1,"updated":"2019-05-18T11:40:46.663Z","_id":"cjvnq7z9x000l7jjxzod6b0kd","comments":1,"layout":"post","photos":[],"link":"","content":"<link rel=\"stylesheet\" class=\"aplayer-secondary-style-marker\" href=\"/assets/css/APlayer.min.css\"><script src=\"/assets/js/APlayer.min.js\" class=\"aplayer-secondary-script-marker\"></script><script class=\"meting-secondary-script-marker\" src=\"/assets/js/Meting.min.js\"></script><link rel=\"stylesheet\" type=\"text/css\" href=\"https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css\"><h1 id=\"install\"><a href=\"#install\" class=\"headerlink\" title=\"install\"></a>install</h1><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">wget http://download.redis.io/redis-stable.tar.gz</span><br><span class=\"line\">tar xvzf redis-stable.tar.gz</span><br><span class=\"line\"><span class=\"built_in\">cd</span> redis-stable</span><br><span class=\"line\">make</span><br><span class=\"line\">make <span class=\"built_in\">test</span></span><br></pre></td></tr></table></figure>\n<p><code>You need tcl 8.5 or newer in order to run the Redis test</code><br><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo apt-get update</span><br><span class=\"line\">sudo apt-get install tcl8.5-dev</span><br></pre></td></tr></table></figure></p>\n<p>test<br><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[exception]: Executing <span class=\"built_in\">test</span> client: couldn<span class=\"string\">'t execute \"grep\": not enough memory.</span></span><br></pre></td></tr></table></figure></p>\n<h2 id=\"start\"><a href=\"#start\" class=\"headerlink\" title=\"start\"></a>start</h2><p>default port: 6379<br><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">./src/redis-server</span><br><span class=\"line\">./src/redis-cli</span><br></pre></td></tr></table></figure></p>\n<p>or<br><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo cp src/redis-server /usr/<span class=\"built_in\">local</span>/bin/</span><br><span class=\"line\">sudo cp src/redis-cli /usr/<span class=\"built_in\">local</span>/bin/</span><br><span class=\"line\">redis-server</span><br><span class=\"line\">redis-cli</span><br><span class=\"line\">// or just </span><br><span class=\"line\">make install</span><br></pre></td></tr></table></figure></p>\n<h1 id=\"Remote\"><a href=\"#Remote\" class=\"headerlink\" title=\"Remote\"></a>Remote</h1>","site":{"data":{}},"excerpt":"","more":"<h1 id=\"install\"><a href=\"#install\" class=\"headerlink\" title=\"install\"></a>install</h1><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">wget http://download.redis.io/redis-stable.tar.gz</span><br><span class=\"line\">tar xvzf redis-stable.tar.gz</span><br><span class=\"line\"><span class=\"built_in\">cd</span> redis-stable</span><br><span class=\"line\">make</span><br><span class=\"line\">make <span class=\"built_in\">test</span></span><br></pre></td></tr></table></figure>\n<p><code>You need tcl 8.5 or newer in order to run the Redis test</code><br><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo apt-get update</span><br><span class=\"line\">sudo apt-get install tcl8.5-dev</span><br></pre></td></tr></table></figure></p>\n<p>test<br><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[exception]: Executing <span class=\"built_in\">test</span> client: couldn<span class=\"string\">'t execute \"grep\": not enough memory.</span></span><br></pre></td></tr></table></figure></p>\n<h2 id=\"start\"><a href=\"#start\" class=\"headerlink\" title=\"start\"></a>start</h2><p>default port: 6379<br><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">./src/redis-server</span><br><span class=\"line\">./src/redis-cli</span><br></pre></td></tr></table></figure></p>\n<p>or<br><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo cp src/redis-server /usr/<span class=\"built_in\">local</span>/bin/</span><br><span class=\"line\">sudo cp src/redis-cli /usr/<span class=\"built_in\">local</span>/bin/</span><br><span class=\"line\">redis-server</span><br><span class=\"line\">redis-cli</span><br><span class=\"line\">// or just </span><br><span class=\"line\">make install</span><br></pre></td></tr></table></figure></p>\n<h1 id=\"Remote\"><a href=\"#Remote\" class=\"headerlink\" title=\"Remote\"></a>Remote</h1>"},{"title":"markdown reference","date":"2019-03-31T12:46:25.000Z","comments":0,"mathjax":true,"_content":"\n### math\n\n$$x+1\\over\\sqrt{1-x^2} \\tag{i}\\label{eq_tag}$$\n\n<!-- more -->\n\n$$\\begin{align}\n-4 + 5x &= 2+y \\nonumber  \\\\\n w+2 &= -1+w \\\\\n ab &= cb\n\\end{align}$$\n\n$$\\begin{equation}\n\\begin{aligned}\na &= b + c \\\\\n  &= d + e + f + g \\\\\n  &= h + i\n\\end{aligned}\n\\end{equation}\\label{eq2}$$\n\n$$\\begin{equation}\ne=mc^2\n\\end{equation}\\label{eq1}$$\n\n### reference\n\n<small>[1] samypesse.how-to-create-an-operating-system[EB/OL].https://samypesse.gitbooks.io/how-to-create-an-operating-system .2015.</small> \n\n### Centered Quote\n\n{% cq %}Elegant in code, simple in core{% endcq %}\n\n### note\n\n{% note default %}\n#### Default Header\nWelcome to [Hexo!](https://hexo.io)\n{% endnote %}\n\n{% note primary %}\n#### Primary Header\n**Welcome** to [Hexo!](https://hexo.io)\n{% endnote %}\n\n{% note info %}\n### Info Header\n**Welcome** to [Hexo!](https://hexo.io)\n{% endnote %}\n\n{% note warning %}\n#### Warning Header\n**Welcome** to [Hexo!](https://hexo.io)\n{% endnote %}\n\n{% note danger %}\n#### Danger Header\n**Welcome** to [Hexo!](https://hexo.io)\n{% endnote %}\n\n{% note info no-icon %}\n#### No icon note\nNote **without** icon: `note info no-icon`\n{% code %}\ncode block in note tag\ncode block in note tag\ncode block in note tag\n{% endcode %}\n{% endnote %}\n\n{% note success %}\n#### Success Header\n**Welcome** to [Hexo!](https://hexo.io)\n{% endnote %}\n\n### Tab\n\n{% tabs First unique name %}\n<!-- tab Solution 1-->\n**This is Tab 1.**\n<!-- endtab -->\n\n<!-- tab @amazon-->\n{% code %}\ncode tag\ncode tag\ncode tag\n{% endcode %}\n<!-- endtab -->\n\n<!-- tab -->\n{% note default %}\nNote default tag.\n{% endnote %}\n<!-- endtab -->\n{% endtabs %}\n\n### Video\n{% youtube Kt7u5kr_P5o %}\n\n### Group picture\n\n{% grouppicture 5-2 %}\n  ![](https://d33wubrfki0l68.cloudfront.net/e2ecd9e90ca2a56af8d7be434b7fdc39cbd454c9/da9b7/images/docs/github.png)\n  ![](https://d33wubrfki0l68.cloudfront.net/e2ecd9e90ca2a56af8d7be434b7fdc39cbd454c9/da9b7/images/docs/github.png)\n  ![](https://d33wubrfki0l68.cloudfront.net/e2ecd9e90ca2a56af8d7be434b7fdc39cbd454c9/da9b7/images/docs/github.png)\n{% endgrouppicture %}\n\n### PDF\n\n{% pdf https://alicdn.makergyt.com/blog/document.pdf %}\n\n### mermaid\n\n{% mermaid graph TD %}\nA[Christmas] -->|Get money| B(Go shopping)\nB --> C{Let me thinksssss<br/>ssssssssssssssssssssss<br/>sssssssssssssssssssssssssss}\nC -->|One| D[Laptop]\nC -->|Two| E[iPhone]\nC -->|Three| F[Car]\n{% endmermaid %}\n\n{% mermaid gantt %}\ndateFormat  YYYY-MM-DD\naxisFormat  %d/%m\ntitle Adding GANTT diagram to mermaid\n\nsection A section\nCompleted task            :done,    des1, 2014-01-06,2014-01-08\nActive task               :active,  des2, 2014-01-09, 3d\nFuture task               :         des3, after des2, 5d\nFuture task2               :         des4, after des3, 5d\n\nsection Critical tasks\nCompleted task in the critical line :crit, done, 2014-01-06,24h\nImplement parser and jison          :crit, done, after des1, 2d\nCreate tests for parser             :crit, active, 3d\nFuture task in critical line        :crit, 5d\nCreate tests for renderer           :2d\nAdd to mermaid                      :1d\n\nsection Documentation\nDescribe gantt syntax               :active, a1, after des1, 3d\nAdd gantt diagram to demo page      :after a1  , 20h\nAdd another diagram to demo page    :doc1, after a1  , 48h\n\nsection Last section\nDescribe gantt syntax               :after doc1, 3d\nAdd gantt diagram to demo page      : 20h\nAdd another diagram to demo page    : 48h\n{% endmermaid %}\n\n{% mermaid gitGraph: %}\noptions\n{\n    \"nodeSpacing\": 150,\n    \"nodeRadius\": 10\n}\nend\ncommit\nbranch newbranch\ncheckout newbranch\ncommit\ncommit\ncheckout master\ncommit\ncommit\nmerge newbranch\n{% endmermaid %}\n\n{% qnimg book.jpg title:图片标题 alt:图片说明  extend:?imageView2/2/w/600 %}\n\nbasic footnote[^1]\nhere is an inline footnote[^2](inline footnote)\nand another one[^3]\nand another one[^4]\n\n[^1]: basic footnote content\n[^3]: paragraph\nfootnote\ncontent\n[^4]: footnote content with some [markdown](https://en.wikipedia.org/wiki/Markdown)\n\n{% pdf https://blog-cdn.makergyt.com/progit.pdf %}","source":"_posts/en/md reference.md","raw":"---\ntitle: markdown reference\ndate: 2019/3/31 20:46:25\ncategories: reference\ntags: markdown\ncomments: false\nmathjax: true\n---\n\n### math\n\n$$x+1\\over\\sqrt{1-x^2} \\tag{i}\\label{eq_tag}$$\n\n<!-- more -->\n\n$$\\begin{align}\n-4 + 5x &= 2+y \\nonumber  \\\\\n w+2 &= -1+w \\\\\n ab &= cb\n\\end{align}$$\n\n$$\\begin{equation}\n\\begin{aligned}\na &= b + c \\\\\n  &= d + e + f + g \\\\\n  &= h + i\n\\end{aligned}\n\\end{equation}\\label{eq2}$$\n\n$$\\begin{equation}\ne=mc^2\n\\end{equation}\\label{eq1}$$\n\n### reference\n\n<small>[1] samypesse.how-to-create-an-operating-system[EB/OL].https://samypesse.gitbooks.io/how-to-create-an-operating-system .2015.</small> \n\n### Centered Quote\n\n{% cq %}Elegant in code, simple in core{% endcq %}\n\n### note\n\n{% note default %}\n#### Default Header\nWelcome to [Hexo!](https://hexo.io)\n{% endnote %}\n\n{% note primary %}\n#### Primary Header\n**Welcome** to [Hexo!](https://hexo.io)\n{% endnote %}\n\n{% note info %}\n### Info Header\n**Welcome** to [Hexo!](https://hexo.io)\n{% endnote %}\n\n{% note warning %}\n#### Warning Header\n**Welcome** to [Hexo!](https://hexo.io)\n{% endnote %}\n\n{% note danger %}\n#### Danger Header\n**Welcome** to [Hexo!](https://hexo.io)\n{% endnote %}\n\n{% note info no-icon %}\n#### No icon note\nNote **without** icon: `note info no-icon`\n{% code %}\ncode block in note tag\ncode block in note tag\ncode block in note tag\n{% endcode %}\n{% endnote %}\n\n{% note success %}\n#### Success Header\n**Welcome** to [Hexo!](https://hexo.io)\n{% endnote %}\n\n### Tab\n\n{% tabs First unique name %}\n<!-- tab Solution 1-->\n**This is Tab 1.**\n<!-- endtab -->\n\n<!-- tab @amazon-->\n{% code %}\ncode tag\ncode tag\ncode tag\n{% endcode %}\n<!-- endtab -->\n\n<!-- tab -->\n{% note default %}\nNote default tag.\n{% endnote %}\n<!-- endtab -->\n{% endtabs %}\n\n### Video\n{% youtube Kt7u5kr_P5o %}\n\n### Group picture\n\n{% grouppicture 5-2 %}\n  ![](https://d33wubrfki0l68.cloudfront.net/e2ecd9e90ca2a56af8d7be434b7fdc39cbd454c9/da9b7/images/docs/github.png)\n  ![](https://d33wubrfki0l68.cloudfront.net/e2ecd9e90ca2a56af8d7be434b7fdc39cbd454c9/da9b7/images/docs/github.png)\n  ![](https://d33wubrfki0l68.cloudfront.net/e2ecd9e90ca2a56af8d7be434b7fdc39cbd454c9/da9b7/images/docs/github.png)\n{% endgrouppicture %}\n\n### PDF\n\n{% pdf https://alicdn.makergyt.com/blog/document.pdf %}\n\n### mermaid\n\n{% mermaid graph TD %}\nA[Christmas] -->|Get money| B(Go shopping)\nB --> C{Let me thinksssss<br/>ssssssssssssssssssssss<br/>sssssssssssssssssssssssssss}\nC -->|One| D[Laptop]\nC -->|Two| E[iPhone]\nC -->|Three| F[Car]\n{% endmermaid %}\n\n{% mermaid gantt %}\ndateFormat  YYYY-MM-DD\naxisFormat  %d/%m\ntitle Adding GANTT diagram to mermaid\n\nsection A section\nCompleted task            :done,    des1, 2014-01-06,2014-01-08\nActive task               :active,  des2, 2014-01-09, 3d\nFuture task               :         des3, after des2, 5d\nFuture task2               :         des4, after des3, 5d\n\nsection Critical tasks\nCompleted task in the critical line :crit, done, 2014-01-06,24h\nImplement parser and jison          :crit, done, after des1, 2d\nCreate tests for parser             :crit, active, 3d\nFuture task in critical line        :crit, 5d\nCreate tests for renderer           :2d\nAdd to mermaid                      :1d\n\nsection Documentation\nDescribe gantt syntax               :active, a1, after des1, 3d\nAdd gantt diagram to demo page      :after a1  , 20h\nAdd another diagram to demo page    :doc1, after a1  , 48h\n\nsection Last section\nDescribe gantt syntax               :after doc1, 3d\nAdd gantt diagram to demo page      : 20h\nAdd another diagram to demo page    : 48h\n{% endmermaid %}\n\n{% mermaid gitGraph: %}\noptions\n{\n    \"nodeSpacing\": 150,\n    \"nodeRadius\": 10\n}\nend\ncommit\nbranch newbranch\ncheckout newbranch\ncommit\ncommit\ncheckout master\ncommit\ncommit\nmerge newbranch\n{% endmermaid %}\n\n{% qnimg book.jpg title:图片标题 alt:图片说明  extend:?imageView2/2/w/600 %}\n\nbasic footnote[^1]\nhere is an inline footnote[^2](inline footnote)\nand another one[^3]\nand another one[^4]\n\n[^1]: basic footnote content\n[^3]: paragraph\nfootnote\ncontent\n[^4]: footnote content with some [markdown](https://en.wikipedia.org/wiki/Markdown)\n\n{% pdf https://blog-cdn.makergyt.com/progit.pdf %}","slug":"md reference","published":1,"lang":"en","updated":"2019-05-11T01:40:37.006Z","layout":"post","photos":[],"link":"","_id":"cjvnq7z9y000o7jjxy9fiodyr","content":"<link rel=\"stylesheet\" class=\"aplayer-secondary-style-marker\" href=\"/assets/css/APlayer.min.css\"><script src=\"/assets/js/APlayer.min.js\" class=\"aplayer-secondary-script-marker\"></script><script class=\"meting-secondary-script-marker\" src=\"/assets/js/Meting.min.js\"></script><link rel=\"stylesheet\" type=\"text/css\" href=\"https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css\"><h3 id=\"math\"><a href=\"#math\" class=\"headerlink\" title=\"math\"></a>math</h3><p>$$x+1\\over\\sqrt{1-x^2} \\tag{i}\\label{eq_tag}$$</p>\n<a id=\"more\"></a>\n<p>$$\\begin{align}<br>-4 + 5x &amp;= 2+y \\nonumber  \\<br> w+2 &amp;= -1+w \\<br> ab &amp;= cb<br>\\end{align}$$</p>\n<p>$$\\begin{equation}<br>\\begin{aligned}<br>a &amp;= b + c \\<br>  &amp;= d + e + f + g \\<br>  &amp;= h + i<br>\\end{aligned}<br>\\end{equation}\\label{eq2}$$</p>\n<p>$$\\begin{equation}<br>e=mc^2<br>\\end{equation}\\label{eq1}$$</p>\n<h3 id=\"reference\"><a href=\"#reference\" class=\"headerlink\" title=\"reference\"></a>reference</h3><p><small>[1] samypesse.how-to-create-an-operating-system[EB/OL].<a href=\"https://samypesse.gitbooks.io/how-to-create-an-operating-system\" target=\"_blank\" rel=\"noopener\">https://samypesse.gitbooks.io/how-to-create-an-operating-system</a> .2015.</small> </p>\n<h3 id=\"Centered-Quote\"><a href=\"#Centered-Quote\" class=\"headerlink\" title=\"Centered Quote\"></a>Centered Quote</h3><blockquote class=\"blockquote-center\"><p>Elegant in code, simple in core</p>\n</blockquote>\n<h3 id=\"note\"><a href=\"#note\" class=\"headerlink\" title=\"note\"></a>note</h3><div class=\"note default\">\n            <h4 id=\"Default-Header\"><a href=\"#Default-Header\" class=\"headerlink\" title=\"Default Header\"></a>Default Header</h4><p>Welcome to <a href=\"https://hexo.io\" target=\"_blank\" rel=\"noopener\">Hexo!</a></p>\n          </div>\n<div class=\"note primary\">\n            <h4 id=\"Primary-Header\"><a href=\"#Primary-Header\" class=\"headerlink\" title=\"Primary Header\"></a>Primary Header</h4><p><strong>Welcome</strong> to <a href=\"https://hexo.io\" target=\"_blank\" rel=\"noopener\">Hexo!</a></p>\n          </div>\n<div class=\"note info\">\n            <h3 id=\"Info-Header\"><a href=\"#Info-Header\" class=\"headerlink\" title=\"Info Header\"></a>Info Header</h3><p><strong>Welcome</strong> to <a href=\"https://hexo.io\" target=\"_blank\" rel=\"noopener\">Hexo!</a></p>\n          </div>\n<div class=\"note warning\">\n            <h4 id=\"Warning-Header\"><a href=\"#Warning-Header\" class=\"headerlink\" title=\"Warning Header\"></a>Warning Header</h4><p><strong>Welcome</strong> to <a href=\"https://hexo.io\" target=\"_blank\" rel=\"noopener\">Hexo!</a></p>\n          </div>\n<div class=\"note danger\">\n            <h4 id=\"Danger-Header\"><a href=\"#Danger-Header\" class=\"headerlink\" title=\"Danger Header\"></a>Danger Header</h4><p><strong>Welcome</strong> to <a href=\"https://hexo.io\" target=\"_blank\" rel=\"noopener\">Hexo!</a></p>\n          </div>\n<div class=\"note info no-icon\">\n            <h4 id=\"No-icon-note\"><a href=\"#No-icon-note\" class=\"headerlink\" title=\"No icon note\"></a>No icon note</h4><p>Note <strong>without</strong> icon: <code>note info no-icon</code></p><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">code block in note tag</span><br><span class=\"line\">code block in note tag</span><br><span class=\"line\">code block in note tag</span><br></pre></td></tr></table></figure>\n          </div>\n<div class=\"note success\">\n            <h4 id=\"Success-Header\"><a href=\"#Success-Header\" class=\"headerlink\" title=\"Success Header\"></a>Success Header</h4><p><strong>Welcome</strong> to <a href=\"https://hexo.io\" target=\"_blank\" rel=\"noopener\">Hexo!</a></p>\n          </div>\n<h3 id=\"Tab\"><a href=\"#Tab\" class=\"headerlink\" title=\"Tab\"></a>Tab</h3><div class=\"tabs\" id=\"first-unique-name\"><ul class=\"nav-tabs\"><li class=\"tab active\"><a href=\"#first-unique-name-1\">Solution 1</a></li><li class=\"tab\"><a href=\"#first-unique-name-2\"><i class=\"fa fa-amazon\" style=\"text-align: center;\"></i></a></li><li class=\"tab\"><a href=\"#first-unique-name-3\">First unique name 3</a></li></ul><div class=\"tab-content\"><div class=\"tab-pane active\" id=\"first-unique-name-1\"><p><strong>This is Tab 1.</strong></p></div><div class=\"tab-pane\" id=\"first-unique-name-2\"><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">code tag</span><br><span class=\"line\">code tag</span><br><span class=\"line\">code tag</span><br></pre></td></tr></table></figure></div><div class=\"tab-pane\" id=\"first-unique-name-3\"><div class=\"note default\"><br>            <p>Note default tag.</p><br>          </div></div></div></div>\n<h3 id=\"Video\"><a href=\"#Video\" class=\"headerlink\" title=\"Video\"></a>Video</h3><div class=\"video-container\"><iframe src=\"//www.youtube.com/embed/Kt7u5kr_P5o\" frameborder=\"0\" allowfullscreen></iframe></div>\n<h3 id=\"Group-picture\"><a href=\"#Group-picture\" class=\"headerlink\" title=\"Group picture\"></a>Group picture</h3><div class=\"group-picture\"><div class=\"group-picture-container\"><div class=\"group-picture-row\"><div class=\"group-picture-column\" style=\"width: 50%;\"><img src=\"https://d33wubrfki0l68.cloudfront.net/e2ecd9e90ca2a56af8d7be434b7fdc39cbd454c9/da9b7/images/docs/github.png\" alt></div><div class=\"group-picture-column\" style=\"width: 50%;\"><img src=\"https://d33wubrfki0l68.cloudfront.net/e2ecd9e90ca2a56af8d7be434b7fdc39cbd454c9/da9b7/images/docs/github.png\" alt></div></div><div class=\"group-picture-row\"><div class=\"group-picture-column\" style=\"width: 100%;\"><img src=\"https://d33wubrfki0l68.cloudfront.net/e2ecd9e90ca2a56af8d7be434b7fdc39cbd454c9/da9b7/images/docs/github.png\" alt></div></div><div class=\"group-picture-row\"></div></div></div>\n<h3 id=\"PDF\"><a href=\"#PDF\" class=\"headerlink\" title=\"PDF\"></a>PDF</h3><div class=\"pdf\" target=\"https://alicdn.makergyt.com/blog/document.pdf\" height></div>\n<h3 id=\"mermaid\"><a href=\"#mermaid\" class=\"headerlink\" title=\"mermaid\"></a>mermaid</h3><pre class=\"mermaid\" style=\"text-align: center;\">\n            graph TD\n            A[Christmas] -->|Get money| B(Go shopping)\nB --> C{Let me thinksssss<br>ssssssssssssssssssssss<br>sssssssssssssssssssssssssss}\nC -->|One| D[Laptop]\nC -->|Two| E[iPhone]\nC -->|Three| F[Car]\n          </pre>\n<pre class=\"mermaid\" style=\"text-align: center;\">\n            gantt\n            dateFormat  YYYY-MM-DD\naxisFormat  %d/%m\ntitle Adding GANTT diagram to mermaid\n\nsection A section\nCompleted task            :done,    des1, 2014-01-06,2014-01-08\nActive task               :active,  des2, 2014-01-09, 3d\nFuture task               :         des3, after des2, 5d\nFuture task2               :         des4, after des3, 5d\n\nsection Critical tasks\nCompleted task in the critical line :crit, done, 2014-01-06,24h\nImplement parser and jison          :crit, done, after des1, 2d\nCreate tests for parser             :crit, active, 3d\nFuture task in critical line        :crit, 5d\nCreate tests for renderer           :2d\nAdd to mermaid                      :1d\n\nsection Documentation\nDescribe gantt syntax               :active, a1, after des1, 3d\nAdd gantt diagram to demo page      :after a1  , 20h\nAdd another diagram to demo page    :doc1, after a1  , 48h\n\nsection Last section\nDescribe gantt syntax               :after doc1, 3d\nAdd gantt diagram to demo page      : 20h\nAdd another diagram to demo page    : 48h\n          </pre>\n<pre class=\"mermaid\" style=\"text-align: center;\">\n            gitGraph:\n            options\n{\n    \"nodeSpacing\": 150,\n    \"nodeRadius\": 10\n}\nend\ncommit\nbranch newbranch\ncheckout newbranch\ncommit\ncommit\ncheckout master\ncommit\ncommit\nmerge newbranch\n          </pre>\n<img title=\"图片标题\" alt=\"图片说明\" src=\"https://blog-cdn.makergyt.com/static/images/book.jpg?imageView2/2/w/600\">\n<p>basic footnote<sup id=\"fnref:1\"><a href=\"#fn:1\" rel=\"footnote\"><span class=\"hint--top hint--error hint--medium hint--rounded hint--bounce\" aria-label=\"basic footnote content\n\">[1]</span></a></sup><br>here is an inline footnote<sup id=\"fnref:2\"><a href=\"#fn:2\" rel=\"footnote\"><span class=\"hint--top hint--error hint--medium hint--rounded hint--bounce\" aria-label=\"inline footnote\">[2]</span></a></sup><br>and another one<sup id=\"fnref:3\"><a href=\"#fn:3\" rel=\"footnote\"><span class=\"hint--top hint--error hint--medium hint--rounded hint--bounce\" aria-label=\"paragraph\nfootnote\ncontent\n\">[3]</span></a></sup><br>and another one<sup id=\"fnref:4\"><a href=\"#fn:4\" rel=\"footnote\"><span class=\"hint--top hint--error hint--medium hint--rounded hint--bounce\" aria-label=\"footnote content with some [markdown](https://en.wikipedia.org/wiki/Markdown)\">[4]</span></a></sup></p>\n<p><div class=\"pdf\" target=\"https://blog-cdn.makergyt.com/progit.pdf\" height></div><div id=\"footnotes\"><hr><div id=\"footnotelist\"><ol style=\"list-style: none; padding-left: 0; margin-left: 40px\"><li id=\"fn:1\"><span style=\"display: inline-block; vertical-align: top; padding-right: 10px; margin-left: -40px\">1.</span><span style=\"display: inline-block; vertical-align: top; margin-left: 10px;\">basic footnote content<a href=\"#fnref:1\" rev=\"footnote\"> ↩</a></span></li><li id=\"fn:2\"><span style=\"display: inline-block; vertical-align: top; padding-right: 10px; margin-left: -40px\">2.</span><span style=\"display: inline-block; vertical-align: top; margin-left: 10px;\">inline footnote<a href=\"#fnref:2\" rev=\"footnote\"> ↩</a></span></li><li id=\"fn:3\"><span style=\"display: inline-block; vertical-align: top; padding-right: 10px; margin-left: -40px\">3.</span><span style=\"display: inline-block; vertical-align: top; margin-left: 10px;\">paragraph<br>footnote<br>content<a href=\"#fnref:3\" rev=\"footnote\"> ↩</a></span></li><li id=\"fn:4\"><span style=\"display: inline-block; vertical-align: top; padding-right: 10px; margin-left: -40px\">4.</span><span style=\"display: inline-block; vertical-align: top; margin-left: 10px;\">footnote content with some <a href=\"https://en.wikipedia.org/wiki/Markdown\" target=\"_blank\" rel=\"noopener\">markdown</a><a href=\"#fnref:4\" rev=\"footnote\"> ↩</a></span></li></ol></div></div></p>\n","site":{"data":{}},"excerpt":"<h3 id=\"math\"><a href=\"#math\" class=\"headerlink\" title=\"math\"></a>math</h3><p>$$x+1\\over\\sqrt{1-x^2} \\tag{i}\\label{eq_tag}$$</p>","more":"<p>$$\\begin{align}<br>-4 + 5x &amp;= 2+y \\nonumber  \\<br> w+2 &amp;= -1+w \\<br> ab &amp;= cb<br>\\end{align}$$</p>\n<p>$$\\begin{equation}<br>\\begin{aligned}<br>a &amp;= b + c \\<br>  &amp;= d + e + f + g \\<br>  &amp;= h + i<br>\\end{aligned}<br>\\end{equation}\\label{eq2}$$</p>\n<p>$$\\begin{equation}<br>e=mc^2<br>\\end{equation}\\label{eq1}$$</p>\n<h3 id=\"reference\"><a href=\"#reference\" class=\"headerlink\" title=\"reference\"></a>reference</h3><p><small>[1] samypesse.how-to-create-an-operating-system[EB/OL].<a href=\"https://samypesse.gitbooks.io/how-to-create-an-operating-system\" target=\"_blank\" rel=\"noopener\">https://samypesse.gitbooks.io/how-to-create-an-operating-system</a> .2015.</small> </p>\n<h3 id=\"Centered-Quote\"><a href=\"#Centered-Quote\" class=\"headerlink\" title=\"Centered Quote\"></a>Centered Quote</h3><blockquote class=\"blockquote-center\"><p>Elegant in code, simple in core</p>\n</blockquote>\n<h3 id=\"note\"><a href=\"#note\" class=\"headerlink\" title=\"note\"></a>note</h3><div class=\"note default\">\n            <h4 id=\"Default-Header\"><a href=\"#Default-Header\" class=\"headerlink\" title=\"Default Header\"></a>Default Header</h4><p>Welcome to <a href=\"https://hexo.io\" target=\"_blank\" rel=\"noopener\">Hexo!</a></p>\n          </div>\n<div class=\"note primary\">\n            <h4 id=\"Primary-Header\"><a href=\"#Primary-Header\" class=\"headerlink\" title=\"Primary Header\"></a>Primary Header</h4><p><strong>Welcome</strong> to <a href=\"https://hexo.io\" target=\"_blank\" rel=\"noopener\">Hexo!</a></p>\n          </div>\n<div class=\"note info\">\n            <h3 id=\"Info-Header\"><a href=\"#Info-Header\" class=\"headerlink\" title=\"Info Header\"></a>Info Header</h3><p><strong>Welcome</strong> to <a href=\"https://hexo.io\" target=\"_blank\" rel=\"noopener\">Hexo!</a></p>\n          </div>\n<div class=\"note warning\">\n            <h4 id=\"Warning-Header\"><a href=\"#Warning-Header\" class=\"headerlink\" title=\"Warning Header\"></a>Warning Header</h4><p><strong>Welcome</strong> to <a href=\"https://hexo.io\" target=\"_blank\" rel=\"noopener\">Hexo!</a></p>\n          </div>\n<div class=\"note danger\">\n            <h4 id=\"Danger-Header\"><a href=\"#Danger-Header\" class=\"headerlink\" title=\"Danger Header\"></a>Danger Header</h4><p><strong>Welcome</strong> to <a href=\"https://hexo.io\" target=\"_blank\" rel=\"noopener\">Hexo!</a></p>\n          </div>\n<div class=\"note info no-icon\">\n            <h4 id=\"No-icon-note\"><a href=\"#No-icon-note\" class=\"headerlink\" title=\"No icon note\"></a>No icon note</h4><p>Note <strong>without</strong> icon: <code>note info no-icon</code></p><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">code block in note tag</span><br><span class=\"line\">code block in note tag</span><br><span class=\"line\">code block in note tag</span><br></pre></td></tr></table></figure>\n          </div>\n<div class=\"note success\">\n            <h4 id=\"Success-Header\"><a href=\"#Success-Header\" class=\"headerlink\" title=\"Success Header\"></a>Success Header</h4><p><strong>Welcome</strong> to <a href=\"https://hexo.io\" target=\"_blank\" rel=\"noopener\">Hexo!</a></p>\n          </div>\n<h3 id=\"Tab\"><a href=\"#Tab\" class=\"headerlink\" title=\"Tab\"></a>Tab</h3><div class=\"tabs\" id=\"first-unique-name\"><ul class=\"nav-tabs\"><li class=\"tab active\"><a href=\"#first-unique-name-1\">Solution 1</a></li><li class=\"tab\"><a href=\"#first-unique-name-2\"><i class=\"fa fa-amazon\" style=\"text-align: center;\"></i></a></li><li class=\"tab\"><a href=\"#first-unique-name-3\">First unique name 3</a></li></ul><div class=\"tab-content\"><div class=\"tab-pane active\" id=\"first-unique-name-1\"><p><strong>This is Tab 1.</strong></p></div><div class=\"tab-pane\" id=\"first-unique-name-2\"><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">code tag</span><br><span class=\"line\">code tag</span><br><span class=\"line\">code tag</span><br></pre></td></tr></table></figure></div><div class=\"tab-pane\" id=\"first-unique-name-3\"><div class=\"note default\"><br>            <p>Note default tag.</p><br>          </div></div></div></div>\n<h3 id=\"Video\"><a href=\"#Video\" class=\"headerlink\" title=\"Video\"></a>Video</h3><div class=\"video-container\"><iframe src=\"//www.youtube.com/embed/Kt7u5kr_P5o\" frameborder=\"0\" allowfullscreen></iframe></div>\n<h3 id=\"Group-picture\"><a href=\"#Group-picture\" class=\"headerlink\" title=\"Group picture\"></a>Group picture</h3><div class=\"group-picture\"><div class=\"group-picture-container\"><div class=\"group-picture-row\"><div class=\"group-picture-column\" style=\"width: 50%;\"><img src=\"https://d33wubrfki0l68.cloudfront.net/e2ecd9e90ca2a56af8d7be434b7fdc39cbd454c9/da9b7/images/docs/github.png\" alt></div><div class=\"group-picture-column\" style=\"width: 50%;\"><img src=\"https://d33wubrfki0l68.cloudfront.net/e2ecd9e90ca2a56af8d7be434b7fdc39cbd454c9/da9b7/images/docs/github.png\" alt></div></div><div class=\"group-picture-row\"><div class=\"group-picture-column\" style=\"width: 100%;\"><img src=\"https://d33wubrfki0l68.cloudfront.net/e2ecd9e90ca2a56af8d7be434b7fdc39cbd454c9/da9b7/images/docs/github.png\" alt></div></div><div class=\"group-picture-row\"></div></div></div>\n<h3 id=\"PDF\"><a href=\"#PDF\" class=\"headerlink\" title=\"PDF\"></a>PDF</h3><div class=\"pdf\" target=\"https://alicdn.makergyt.com/blog/document.pdf\" height></div>\n<h3 id=\"mermaid\"><a href=\"#mermaid\" class=\"headerlink\" title=\"mermaid\"></a>mermaid</h3><pre class=\"mermaid\" style=\"text-align: center;\">\n            graph TD\n            A[Christmas] -->|Get money| B(Go shopping)\nB --> C{Let me thinksssss<br>ssssssssssssssssssssss<br>sssssssssssssssssssssssssss}\nC -->|One| D[Laptop]\nC -->|Two| E[iPhone]\nC -->|Three| F[Car]\n          </pre>\n<pre class=\"mermaid\" style=\"text-align: center;\">\n            gantt\n            dateFormat  YYYY-MM-DD\naxisFormat  %d/%m\ntitle Adding GANTT diagram to mermaid\n\nsection A section\nCompleted task            :done,    des1, 2014-01-06,2014-01-08\nActive task               :active,  des2, 2014-01-09, 3d\nFuture task               :         des3, after des2, 5d\nFuture task2               :         des4, after des3, 5d\n\nsection Critical tasks\nCompleted task in the critical line :crit, done, 2014-01-06,24h\nImplement parser and jison          :crit, done, after des1, 2d\nCreate tests for parser             :crit, active, 3d\nFuture task in critical line        :crit, 5d\nCreate tests for renderer           :2d\nAdd to mermaid                      :1d\n\nsection Documentation\nDescribe gantt syntax               :active, a1, after des1, 3d\nAdd gantt diagram to demo page      :after a1  , 20h\nAdd another diagram to demo page    :doc1, after a1  , 48h\n\nsection Last section\nDescribe gantt syntax               :after doc1, 3d\nAdd gantt diagram to demo page      : 20h\nAdd another diagram to demo page    : 48h\n          </pre>\n<pre class=\"mermaid\" style=\"text-align: center;\">\n            gitGraph:\n            options\n{\n    \"nodeSpacing\": 150,\n    \"nodeRadius\": 10\n}\nend\ncommit\nbranch newbranch\ncheckout newbranch\ncommit\ncommit\ncheckout master\ncommit\ncommit\nmerge newbranch\n          </pre>\n<img title=\"图片标题\" alt=\"图片说明\" src=\"https://blog-cdn.makergyt.com/static/images/book.jpg?imageView2/2/w/600\">\n<p>basic footnote<sup id=\"fnref:1\"><a href=\"#fn:1\" rel=\"footnote\"><span class=\"hint--top hint--error hint--medium hint--rounded hint--bounce\" aria-label=\"basic footnote content\n\">[1]</span></a></sup><br>here is an inline footnote<sup id=\"fnref:2\"><a href=\"#fn:2\" rel=\"footnote\"><span class=\"hint--top hint--error hint--medium hint--rounded hint--bounce\" aria-label=\"inline footnote\">[2]</span></a></sup><br>and another one<sup id=\"fnref:3\"><a href=\"#fn:3\" rel=\"footnote\"><span class=\"hint--top hint--error hint--medium hint--rounded hint--bounce\" aria-label=\"paragraph\nfootnote\ncontent\n\">[3]</span></a></sup><br>and another one<sup id=\"fnref:4\"><a href=\"#fn:4\" rel=\"footnote\"><span class=\"hint--top hint--error hint--medium hint--rounded hint--bounce\" aria-label=\"footnote content with some [markdown](https://en.wikipedia.org/wiki/Markdown)\">[4]</span></a></sup></p>\n<p><div class=\"pdf\" target=\"https://blog-cdn.makergyt.com/progit.pdf\" height></div><div id=\"footnotes\"><hr><div id=\"footnotelist\"><ol style=\"list-style: none; padding-left: 0; margin-left: 40px\"><li id=\"fn:1\"><span style=\"display: inline-block; vertical-align: top; padding-right: 10px; margin-left: -40px\">1.</span><span style=\"display: inline-block; vertical-align: top; margin-left: 10px;\">basic footnote content<a href=\"#fnref:1\" rev=\"footnote\"> ↩</a></span></li><li id=\"fn:2\"><span style=\"display: inline-block; vertical-align: top; padding-right: 10px; margin-left: -40px\">2.</span><span style=\"display: inline-block; vertical-align: top; margin-left: 10px;\">inline footnote<a href=\"#fnref:2\" rev=\"footnote\"> ↩</a></span></li><li id=\"fn:3\"><span style=\"display: inline-block; vertical-align: top; padding-right: 10px; margin-left: -40px\">3.</span><span style=\"display: inline-block; vertical-align: top; margin-left: 10px;\">paragraph<br>footnote<br>content<a href=\"#fnref:3\" rev=\"footnote\"> ↩</a></span></li><li id=\"fn:4\"><span style=\"display: inline-block; vertical-align: top; padding-right: 10px; margin-left: -40px\">4.</span><span style=\"display: inline-block; vertical-align: top; margin-left: 10px;\">footnote content with some <a href=\"https://en.wikipedia.org/wiki/Markdown\" target=\"_blank\" rel=\"noopener\">markdown</a><a href=\"#fnref:4\" rev=\"footnote\"> ↩</a></span></li></ol></div></div></p>"},{"title":"ubuntu reference","lang":"en","date":"2019-04-05T01:41:28.000Z","_content":"``This requires installing packages from unauthenticated sources.``\n","source":"_posts/en/ubuntu-reference.md","raw":"---\ntitle: ubuntu reference\nlang: en\ndate: 2019-04-05 09:41:28\ntags:\n  - linux\ncategories: reference\n---\n``This requires installing packages from unauthenticated sources.``\n","slug":"ubuntu-reference","published":1,"updated":"2019-04-29T01:07:50.656Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjvnq7za0000s7jjxc5dz9ged","content":"<link rel=\"stylesheet\" class=\"aplayer-secondary-style-marker\" href=\"/assets/css/APlayer.min.css\"><script src=\"/assets/js/APlayer.min.js\" class=\"aplayer-secondary-script-marker\"></script><script class=\"meting-secondary-script-marker\" src=\"/assets/js/Meting.min.js\"></script><link rel=\"stylesheet\" type=\"text/css\" href=\"https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css\"><p><code>This requires installing packages from unauthenticated sources.</code></p>\n","site":{"data":{}},"excerpt":"","more":"<p><code>This requires installing packages from unauthenticated sources.</code></p>\n"},{"title":"how-to-create-an-operating-system 操作问题记录","date":"2019-01-08T09:49:57.000Z","_content":">本地系统环境：ubuntu 16.04\n软件环境：vagrant 2.2.2,vitual box 6.0\n# the box url is invalid\n<!-- more -->\n查找类似的box:\nhttps://app.vagrantup.com/boxes/search?utf8=%E2%9C%93&sort=downloads&provider=&q=lucid32\n```sh\nvagrant init mrgcastle/ubuntu-lucid32 \\\n  --box-version 1.0.0.0\nvagrant login #need to create a account at vagrantup.com\n```\n登录错误提示无法解析127.0.0.1:8118,此URL是由于本地使用了ss代理,故暂时关闭privoxy并且在/etc/profile中取消代理，重启生效\n```\nsudo vim Vagrantfile\n# append\n$script = %Q{\n    sudo apt-get update\n    sudo apt-get install nasm make build-essential grub qemu zip -y\n  }\nconfig.vm.provision :shell, :inline => $script\n```\n# \"-y\"  error ,force to yes\n初始化脚本未执行，故开机后依次手动执行\n```sh\nsudo apt-get update\n```\nError ``http://security.ubuntu.com lucid-security/main Packages\n  404  Not Found [IP: 91.189.91.23 80]``\nWarning ``Failed to fetch http://us.archive.ubuntu.com/ubuntu/dists/lucid/restricted/binary-i386/Packages.gz  404  Not Found [IP: 91.189.91.23 80]``\n\n## mannul install unzip (latest)\n```\nsudo apt-get install zip\n```\n``Failed to fetch http://security.ubuntu.com/ubuntu/pool/main/u/unzip/unzip_6.0-1ubuntu1_i386.deb``\nopen the url:http://security.ubuntu.com/ubuntu/pool/main/u/unzip/,find the oldest version orresponding to architecture\n```\ndpkg --print-architecture \ni386\nwget http://security.ubuntu.com/ubuntu/pool/main/u/unzip/unzip_6.0-21ubuntu1_i386.deb\ndpkg -i unzip_6.0-21ubuntu1_i386.deb\n```\n``file `unzip_6.0-21ubuntu1_i386.deb' contains ununderstood data member data.tar.xz     , giving up``\n```\nwget http://security.ubuntu.com/ubuntu/pool/main/u/unzip/unzip_6.0-4ubuntu1_i386.deb\ndpkg -i unzip_6.0-4ubuntu1_i386.deb\n```\n## install zip\n```\nwget http://us.archive.ubuntu.com/ubuntu/pool/main/z/zip/zip_3.0-4_i386.deb\nsudo dpkg -i zip_3.0-4_i386.deb\nzip -v\n```\n## install nasm,(make,build-essential is already installed)\ngrub,qemu:``Errors were encountered while processing``\n## modify apt-get\n以上寻找版本手动安装没有根本解决问题，问题在于采用的默认apt源上地址已经没有此版本的所有资源包，故需先找到现在的托管地址，于是沿着上述手动地址\n```\nsudo cp /etc/apt/sources.list /etc/apt/sources.list_backup\nsudo vim /etc/apt/sources.list\n:%s/http:\\/\\/security.ubuntu.com\\/ubuntu/http:\\/\\/old-releases.ubuntu.com\\/ubuntu/g\n:%s/http:\\/\\/us.archive.ubuntu.com\\/ubuntu/http:\\/\\/old-releases.ubuntu.com\\/ubuntu/g\nsudo apt-get update\nsudo apt-get install grub\n```\n``grub: Conflicts: grub-pc but 1.98-1ubuntu13 is to be installed``\n``grub-installer: Depends: cdebconf-udeb but it is not installable``\n``grub-pc: Conflicts: grub (< 0.97-54) but 0.97-29ubuntu60.10.04.2 is to be installed``\n```\nsudo apt-get -f install\nsudo apt-get autoremove\ngrub --version\nsudo apt-get install qemu\nqemu --version\n```\n# bootdisk/* no such file or directory\n此文件夹是启动文件，需要在其github上下载，由于在虚拟机内部使用git clone无法连接（暂未找出原因）故设置同步文件夹后从本地git\n```sh\n#config the Vagrantfile:\nconfig.vm.synced_folder \"/home/jerry/unix\", \"/home/vagrant\"\n# vagrant --provision reload\ncd unix\ngit clone https://github.com/SamyPesse/How-to-Make-a-Computer-Operating-System.git\ncd How-to-Make-a-Computer-Operating-System/src/sdk \n```\n# 系统挂载后无法操作无法退出\n只显示加载过程正确，以及hello world例程，由于作者未写完，未能展示操作系统可操作性和基本运行调度的实现效果。\n\n# Reference\n\n<small>[1] samypesse.how-to-create-an-operating-system[EB/OL].https://samypesse.gitbooks.io/how-to-create-an-operating-system .2015.</small>","source":"_posts/zh-CN/how-to-create-an-operating-system-操作记录.md","raw":"---\ntitle: how-to-create-an-operating-system 操作问题记录\ndate: 2019-01-08 17:49:57\ntags: \n - linux\ncategories: record\n---\n>本地系统环境：ubuntu 16.04\n软件环境：vagrant 2.2.2,vitual box 6.0\n# the box url is invalid\n<!-- more -->\n查找类似的box:\nhttps://app.vagrantup.com/boxes/search?utf8=%E2%9C%93&sort=downloads&provider=&q=lucid32\n```sh\nvagrant init mrgcastle/ubuntu-lucid32 \\\n  --box-version 1.0.0.0\nvagrant login #need to create a account at vagrantup.com\n```\n登录错误提示无法解析127.0.0.1:8118,此URL是由于本地使用了ss代理,故暂时关闭privoxy并且在/etc/profile中取消代理，重启生效\n```\nsudo vim Vagrantfile\n# append\n$script = %Q{\n    sudo apt-get update\n    sudo apt-get install nasm make build-essential grub qemu zip -y\n  }\nconfig.vm.provision :shell, :inline => $script\n```\n# \"-y\"  error ,force to yes\n初始化脚本未执行，故开机后依次手动执行\n```sh\nsudo apt-get update\n```\nError ``http://security.ubuntu.com lucid-security/main Packages\n  404  Not Found [IP: 91.189.91.23 80]``\nWarning ``Failed to fetch http://us.archive.ubuntu.com/ubuntu/dists/lucid/restricted/binary-i386/Packages.gz  404  Not Found [IP: 91.189.91.23 80]``\n\n## mannul install unzip (latest)\n```\nsudo apt-get install zip\n```\n``Failed to fetch http://security.ubuntu.com/ubuntu/pool/main/u/unzip/unzip_6.0-1ubuntu1_i386.deb``\nopen the url:http://security.ubuntu.com/ubuntu/pool/main/u/unzip/,find the oldest version orresponding to architecture\n```\ndpkg --print-architecture \ni386\nwget http://security.ubuntu.com/ubuntu/pool/main/u/unzip/unzip_6.0-21ubuntu1_i386.deb\ndpkg -i unzip_6.0-21ubuntu1_i386.deb\n```\n``file `unzip_6.0-21ubuntu1_i386.deb' contains ununderstood data member data.tar.xz     , giving up``\n```\nwget http://security.ubuntu.com/ubuntu/pool/main/u/unzip/unzip_6.0-4ubuntu1_i386.deb\ndpkg -i unzip_6.0-4ubuntu1_i386.deb\n```\n## install zip\n```\nwget http://us.archive.ubuntu.com/ubuntu/pool/main/z/zip/zip_3.0-4_i386.deb\nsudo dpkg -i zip_3.0-4_i386.deb\nzip -v\n```\n## install nasm,(make,build-essential is already installed)\ngrub,qemu:``Errors were encountered while processing``\n## modify apt-get\n以上寻找版本手动安装没有根本解决问题，问题在于采用的默认apt源上地址已经没有此版本的所有资源包，故需先找到现在的托管地址，于是沿着上述手动地址\n```\nsudo cp /etc/apt/sources.list /etc/apt/sources.list_backup\nsudo vim /etc/apt/sources.list\n:%s/http:\\/\\/security.ubuntu.com\\/ubuntu/http:\\/\\/old-releases.ubuntu.com\\/ubuntu/g\n:%s/http:\\/\\/us.archive.ubuntu.com\\/ubuntu/http:\\/\\/old-releases.ubuntu.com\\/ubuntu/g\nsudo apt-get update\nsudo apt-get install grub\n```\n``grub: Conflicts: grub-pc but 1.98-1ubuntu13 is to be installed``\n``grub-installer: Depends: cdebconf-udeb but it is not installable``\n``grub-pc: Conflicts: grub (< 0.97-54) but 0.97-29ubuntu60.10.04.2 is to be installed``\n```\nsudo apt-get -f install\nsudo apt-get autoremove\ngrub --version\nsudo apt-get install qemu\nqemu --version\n```\n# bootdisk/* no such file or directory\n此文件夹是启动文件，需要在其github上下载，由于在虚拟机内部使用git clone无法连接（暂未找出原因）故设置同步文件夹后从本地git\n```sh\n#config the Vagrantfile:\nconfig.vm.synced_folder \"/home/jerry/unix\", \"/home/vagrant\"\n# vagrant --provision reload\ncd unix\ngit clone https://github.com/SamyPesse/How-to-Make-a-Computer-Operating-System.git\ncd How-to-Make-a-Computer-Operating-System/src/sdk \n```\n# 系统挂载后无法操作无法退出\n只显示加载过程正确，以及hello world例程，由于作者未写完，未能展示操作系统可操作性和基本运行调度的实现效果。\n\n# Reference\n\n<small>[1] samypesse.how-to-create-an-operating-system[EB/OL].https://samypesse.gitbooks.io/how-to-create-an-operating-system .2015.</small>","slug":"how-to-create-an-operating-system-操作记录","published":1,"lang":"zh-CN","updated":"2019-04-29T01:07:50.656Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjvnq7za3000z7jjx13n1mssd","content":"<link rel=\"stylesheet\" class=\"aplayer-secondary-style-marker\" href=\"/assets/css/APlayer.min.css\"><script src=\"/assets/js/APlayer.min.js\" class=\"aplayer-secondary-script-marker\"></script><script class=\"meting-secondary-script-marker\" src=\"/assets/js/Meting.min.js\"></script><link rel=\"stylesheet\" type=\"text/css\" href=\"https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css\"><blockquote>\n<p>本地系统环境：ubuntu 16.04<br>软件环境：vagrant 2.2.2,vitual box 6.0</p>\n</blockquote>\n<h1 id=\"the-box-url-is-invalid\"><a href=\"#the-box-url-is-invalid\" class=\"headerlink\" title=\"the box url is invalid\"></a>the box url is invalid</h1><a id=\"more\"></a>\n<p>查找类似的box:<br><a href=\"https://app.vagrantup.com/boxes/search?utf8=%E2%9C%93&amp;sort=downloads&amp;provider=&amp;q=lucid32\" target=\"_blank\" rel=\"noopener\">https://app.vagrantup.com/boxes/search?utf8=%E2%9C%93&amp;sort=downloads&amp;provider=&amp;q=lucid32</a><br><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vagrant init mrgcastle/ubuntu-lucid32 \\</span><br><span class=\"line\">  --box-version 1.0.0.0</span><br><span class=\"line\">vagrant login <span class=\"comment\">#need to create a account at vagrantup.com</span></span><br></pre></td></tr></table></figure></p>\n<p>登录错误提示无法解析127.0.0.1:8118,此URL是由于本地使用了ss代理,故暂时关闭privoxy并且在/etc/profile中取消代理，重启生效<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo vim Vagrantfile</span><br><span class=\"line\"># append</span><br><span class=\"line\">$script = %Q&#123;</span><br><span class=\"line\">    sudo apt-get update</span><br><span class=\"line\">    sudo apt-get install nasm make build-essential grub qemu zip -y</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">config.vm.provision :shell, :inline =&gt; $script</span><br></pre></td></tr></table></figure></p>\n<h1 id=\"“-y”-error-force-to-yes\"><a href=\"#“-y”-error-force-to-yes\" class=\"headerlink\" title=\"“-y”  error ,force to yes\"></a>“-y”  error ,force to yes</h1><p>初始化脚本未执行，故开机后依次手动执行<br><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo apt-get update</span><br></pre></td></tr></table></figure></p>\n<p>Error <code>http://security.ubuntu.com lucid-security/main Packages\n  404  Not Found [IP: 91.189.91.23 80]</code><br>Warning <code>Failed to fetch http://us.archive.ubuntu.com/ubuntu/dists/lucid/restricted/binary-i386/Packages.gz  404  Not Found [IP: 91.189.91.23 80]</code></p>\n<h2 id=\"mannul-install-unzip-latest\"><a href=\"#mannul-install-unzip-latest\" class=\"headerlink\" title=\"mannul install unzip (latest)\"></a>mannul install unzip (latest)</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo apt-get install zip</span><br></pre></td></tr></table></figure>\n<p><code>Failed to fetch http://security.ubuntu.com/ubuntu/pool/main/u/unzip/unzip_6.0-1ubuntu1_i386.deb</code><br>open the url:<a href=\"http://security.ubuntu.com/ubuntu/pool/main/u/unzip/,find\" target=\"_blank\" rel=\"noopener\">http://security.ubuntu.com/ubuntu/pool/main/u/unzip/,find</a> the oldest version orresponding to architecture<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">dpkg --print-architecture </span><br><span class=\"line\">i386</span><br><span class=\"line\">wget http://security.ubuntu.com/ubuntu/pool/main/u/unzip/unzip_6.0-21ubuntu1_i386.deb</span><br><span class=\"line\">dpkg -i unzip_6.0-21ubuntu1_i386.deb</span><br></pre></td></tr></table></figure></p>\n<p><code>file `unzip_6.0-21ubuntu1_i386.deb&#39; contains ununderstood data member data.tar.xz     , giving up</code><br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">wget http://security.ubuntu.com/ubuntu/pool/main/u/unzip/unzip_6.0-4ubuntu1_i386.deb</span><br><span class=\"line\">dpkg -i unzip_6.0-4ubuntu1_i386.deb</span><br></pre></td></tr></table></figure></p>\n<h2 id=\"install-zip\"><a href=\"#install-zip\" class=\"headerlink\" title=\"install zip\"></a>install zip</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">wget http://us.archive.ubuntu.com/ubuntu/pool/main/z/zip/zip_3.0-4_i386.deb</span><br><span class=\"line\">sudo dpkg -i zip_3.0-4_i386.deb</span><br><span class=\"line\">zip -v</span><br></pre></td></tr></table></figure>\n<h2 id=\"install-nasm-make-build-essential-is-already-installed\"><a href=\"#install-nasm-make-build-essential-is-already-installed\" class=\"headerlink\" title=\"install nasm,(make,build-essential is already installed)\"></a>install nasm,(make,build-essential is already installed)</h2><p>grub,qemu:<code>Errors were encountered while processing</code></p>\n<h2 id=\"modify-apt-get\"><a href=\"#modify-apt-get\" class=\"headerlink\" title=\"modify apt-get\"></a>modify apt-get</h2><p>以上寻找版本手动安装没有根本解决问题，问题在于采用的默认apt源上地址已经没有此版本的所有资源包，故需先找到现在的托管地址，于是沿着上述手动地址<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo cp /etc/apt/sources.list /etc/apt/sources.list_backup</span><br><span class=\"line\">sudo vim /etc/apt/sources.list</span><br><span class=\"line\">:%s/http:\\/\\/security.ubuntu.com\\/ubuntu/http:\\/\\/old-releases.ubuntu.com\\/ubuntu/g</span><br><span class=\"line\">:%s/http:\\/\\/us.archive.ubuntu.com\\/ubuntu/http:\\/\\/old-releases.ubuntu.com\\/ubuntu/g</span><br><span class=\"line\">sudo apt-get update</span><br><span class=\"line\">sudo apt-get install grub</span><br></pre></td></tr></table></figure></p>\n<p><code>grub: Conflicts: grub-pc but 1.98-1ubuntu13 is to be installed</code><br><code>grub-installer: Depends: cdebconf-udeb but it is not installable</code><br><code>grub-pc: Conflicts: grub (&lt; 0.97-54) but 0.97-29ubuntu60.10.04.2 is to be installed</code><br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo apt-get -f install</span><br><span class=\"line\">sudo apt-get autoremove</span><br><span class=\"line\">grub --version</span><br><span class=\"line\">sudo apt-get install qemu</span><br><span class=\"line\">qemu --version</span><br></pre></td></tr></table></figure></p>\n<h1 id=\"bootdisk-no-such-file-or-directory\"><a href=\"#bootdisk-no-such-file-or-directory\" class=\"headerlink\" title=\"bootdisk/* no such file or directory\"></a>bootdisk/* no such file or directory</h1><p>此文件夹是启动文件，需要在其github上下载，由于在虚拟机内部使用git clone无法连接（暂未找出原因）故设置同步文件夹后从本地git<br><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#config the Vagrantfile:</span></span><br><span class=\"line\">config.vm.synced_folder <span class=\"string\">\"/home/jerry/unix\"</span>, <span class=\"string\">\"/home/vagrant\"</span></span><br><span class=\"line\"><span class=\"comment\"># vagrant --provision reload</span></span><br><span class=\"line\"><span class=\"built_in\">cd</span> unix</span><br><span class=\"line\">git <span class=\"built_in\">clone</span> https://github.com/SamyPesse/How-to-Make<span class=\"_\">-a</span>-Computer-Operating-System.git</span><br><span class=\"line\"><span class=\"built_in\">cd</span> How-to-Make<span class=\"_\">-a</span>-Computer-Operating-System/src/sdk</span><br></pre></td></tr></table></figure></p>\n<h1 id=\"系统挂载后无法操作无法退出\"><a href=\"#系统挂载后无法操作无法退出\" class=\"headerlink\" title=\"系统挂载后无法操作无法退出\"></a>系统挂载后无法操作无法退出</h1><p>只显示加载过程正确，以及hello world例程，由于作者未写完，未能展示操作系统可操作性和基本运行调度的实现效果。</p>\n<h1 id=\"Reference\"><a href=\"#Reference\" class=\"headerlink\" title=\"Reference\"></a>Reference</h1><p><small>[1] samypesse.how-to-create-an-operating-system[EB/OL].<a href=\"https://samypesse.gitbooks.io/how-to-create-an-operating-system\" target=\"_blank\" rel=\"noopener\">https://samypesse.gitbooks.io/how-to-create-an-operating-system</a> .2015.</small></p>\n","site":{"data":{}},"excerpt":"<blockquote>\n<p>本地系统环境：ubuntu 16.04<br>软件环境：vagrant 2.2.2,vitual box 6.0</p>\n</blockquote>\n<h1 id=\"the-box-url-is-invalid\"><a href=\"#the-box-url-is-invalid\" class=\"headerlink\" title=\"the box url is invalid\"></a>the box url is invalid</h1>","more":"<p>查找类似的box:<br><a href=\"https://app.vagrantup.com/boxes/search?utf8=%E2%9C%93&amp;sort=downloads&amp;provider=&amp;q=lucid32\" target=\"_blank\" rel=\"noopener\">https://app.vagrantup.com/boxes/search?utf8=%E2%9C%93&amp;sort=downloads&amp;provider=&amp;q=lucid32</a><br><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vagrant init mrgcastle/ubuntu-lucid32 \\</span><br><span class=\"line\">  --box-version 1.0.0.0</span><br><span class=\"line\">vagrant login <span class=\"comment\">#need to create a account at vagrantup.com</span></span><br></pre></td></tr></table></figure></p>\n<p>登录错误提示无法解析127.0.0.1:8118,此URL是由于本地使用了ss代理,故暂时关闭privoxy并且在/etc/profile中取消代理，重启生效<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo vim Vagrantfile</span><br><span class=\"line\"># append</span><br><span class=\"line\">$script = %Q&#123;</span><br><span class=\"line\">    sudo apt-get update</span><br><span class=\"line\">    sudo apt-get install nasm make build-essential grub qemu zip -y</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">config.vm.provision :shell, :inline =&gt; $script</span><br></pre></td></tr></table></figure></p>\n<h1 id=\"“-y”-error-force-to-yes\"><a href=\"#“-y”-error-force-to-yes\" class=\"headerlink\" title=\"“-y”  error ,force to yes\"></a>“-y”  error ,force to yes</h1><p>初始化脚本未执行，故开机后依次手动执行<br><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo apt-get update</span><br></pre></td></tr></table></figure></p>\n<p>Error <code>http://security.ubuntu.com lucid-security/main Packages\n  404  Not Found [IP: 91.189.91.23 80]</code><br>Warning <code>Failed to fetch http://us.archive.ubuntu.com/ubuntu/dists/lucid/restricted/binary-i386/Packages.gz  404  Not Found [IP: 91.189.91.23 80]</code></p>\n<h2 id=\"mannul-install-unzip-latest\"><a href=\"#mannul-install-unzip-latest\" class=\"headerlink\" title=\"mannul install unzip (latest)\"></a>mannul install unzip (latest)</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo apt-get install zip</span><br></pre></td></tr></table></figure>\n<p><code>Failed to fetch http://security.ubuntu.com/ubuntu/pool/main/u/unzip/unzip_6.0-1ubuntu1_i386.deb</code><br>open the url:<a href=\"http://security.ubuntu.com/ubuntu/pool/main/u/unzip/,find\" target=\"_blank\" rel=\"noopener\">http://security.ubuntu.com/ubuntu/pool/main/u/unzip/,find</a> the oldest version orresponding to architecture<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">dpkg --print-architecture </span><br><span class=\"line\">i386</span><br><span class=\"line\">wget http://security.ubuntu.com/ubuntu/pool/main/u/unzip/unzip_6.0-21ubuntu1_i386.deb</span><br><span class=\"line\">dpkg -i unzip_6.0-21ubuntu1_i386.deb</span><br></pre></td></tr></table></figure></p>\n<p><code>file `unzip_6.0-21ubuntu1_i386.deb&#39; contains ununderstood data member data.tar.xz     , giving up</code><br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">wget http://security.ubuntu.com/ubuntu/pool/main/u/unzip/unzip_6.0-4ubuntu1_i386.deb</span><br><span class=\"line\">dpkg -i unzip_6.0-4ubuntu1_i386.deb</span><br></pre></td></tr></table></figure></p>\n<h2 id=\"install-zip\"><a href=\"#install-zip\" class=\"headerlink\" title=\"install zip\"></a>install zip</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">wget http://us.archive.ubuntu.com/ubuntu/pool/main/z/zip/zip_3.0-4_i386.deb</span><br><span class=\"line\">sudo dpkg -i zip_3.0-4_i386.deb</span><br><span class=\"line\">zip -v</span><br></pre></td></tr></table></figure>\n<h2 id=\"install-nasm-make-build-essential-is-already-installed\"><a href=\"#install-nasm-make-build-essential-is-already-installed\" class=\"headerlink\" title=\"install nasm,(make,build-essential is already installed)\"></a>install nasm,(make,build-essential is already installed)</h2><p>grub,qemu:<code>Errors were encountered while processing</code></p>\n<h2 id=\"modify-apt-get\"><a href=\"#modify-apt-get\" class=\"headerlink\" title=\"modify apt-get\"></a>modify apt-get</h2><p>以上寻找版本手动安装没有根本解决问题，问题在于采用的默认apt源上地址已经没有此版本的所有资源包，故需先找到现在的托管地址，于是沿着上述手动地址<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo cp /etc/apt/sources.list /etc/apt/sources.list_backup</span><br><span class=\"line\">sudo vim /etc/apt/sources.list</span><br><span class=\"line\">:%s/http:\\/\\/security.ubuntu.com\\/ubuntu/http:\\/\\/old-releases.ubuntu.com\\/ubuntu/g</span><br><span class=\"line\">:%s/http:\\/\\/us.archive.ubuntu.com\\/ubuntu/http:\\/\\/old-releases.ubuntu.com\\/ubuntu/g</span><br><span class=\"line\">sudo apt-get update</span><br><span class=\"line\">sudo apt-get install grub</span><br></pre></td></tr></table></figure></p>\n<p><code>grub: Conflicts: grub-pc but 1.98-1ubuntu13 is to be installed</code><br><code>grub-installer: Depends: cdebconf-udeb but it is not installable</code><br><code>grub-pc: Conflicts: grub (&lt; 0.97-54) but 0.97-29ubuntu60.10.04.2 is to be installed</code><br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo apt-get -f install</span><br><span class=\"line\">sudo apt-get autoremove</span><br><span class=\"line\">grub --version</span><br><span class=\"line\">sudo apt-get install qemu</span><br><span class=\"line\">qemu --version</span><br></pre></td></tr></table></figure></p>\n<h1 id=\"bootdisk-no-such-file-or-directory\"><a href=\"#bootdisk-no-such-file-or-directory\" class=\"headerlink\" title=\"bootdisk/* no such file or directory\"></a>bootdisk/* no such file or directory</h1><p>此文件夹是启动文件，需要在其github上下载，由于在虚拟机内部使用git clone无法连接（暂未找出原因）故设置同步文件夹后从本地git<br><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#config the Vagrantfile:</span></span><br><span class=\"line\">config.vm.synced_folder <span class=\"string\">\"/home/jerry/unix\"</span>, <span class=\"string\">\"/home/vagrant\"</span></span><br><span class=\"line\"><span class=\"comment\"># vagrant --provision reload</span></span><br><span class=\"line\"><span class=\"built_in\">cd</span> unix</span><br><span class=\"line\">git <span class=\"built_in\">clone</span> https://github.com/SamyPesse/How-to-Make<span class=\"_\">-a</span>-Computer-Operating-System.git</span><br><span class=\"line\"><span class=\"built_in\">cd</span> How-to-Make<span class=\"_\">-a</span>-Computer-Operating-System/src/sdk</span><br></pre></td></tr></table></figure></p>\n<h1 id=\"系统挂载后无法操作无法退出\"><a href=\"#系统挂载后无法操作无法退出\" class=\"headerlink\" title=\"系统挂载后无法操作无法退出\"></a>系统挂载后无法操作无法退出</h1><p>只显示加载过程正确，以及hello world例程，由于作者未写完，未能展示操作系统可操作性和基本运行调度的实现效果。</p>\n<h1 id=\"Reference\"><a href=\"#Reference\" class=\"headerlink\" title=\"Reference\"></a>Reference</h1><p><small>[1] samypesse.how-to-create-an-operating-system[EB/OL].<a href=\"https://samypesse.gitbooks.io/how-to-create-an-operating-system\" target=\"_blank\" rel=\"noopener\">https://samypesse.gitbooks.io/how-to-create-an-operating-system</a> .2015.</small></p>"},{"title":"《在细雨中呼喊》一个积极的悲观主义者","date":"2018-05-08T13:43:18.000Z","_content":"\n> 当我虚构的人物越来越真实时，我忍不住会去怀疑自己真正的现实是否在被虚构\n\n<!-- more -->\n\n主流价值观教育我们，人是无法选择自己的出身过去的，但可以努力创造和改变自己的未来，然而余华说\n\n> 当人们无法选择自己的未来时，就会珍惜自己选择过去的权利。回忆的动人之处就在于可以重新选择，可以将那些毫无关联的往事重新组合起来，从而获得了全新的过去，而且还可以不断地更换自己的组合，以求获得不一样的经历。当一个人独自坐在公园的长椅上。在日落时让嘴角露出一丝微笑，他孤独的形象似乎值得同情，然而谁又能体会到他此时的美妙旅程？他正坐在回忆的马车里，他的生活重新开始了，而且这一次的生活是他自己精心挑选的。\n\n从乡土中来，最后回归乡土。余华的作品往往是“细小的”，这细小之处在于它着眼于一个小众的灵魂人物，一个偏僻的小视野；但也是“宏大的”，这宏大之处在于故事跌宕起伏，甚至于荡气回肠。他并没有强说这种情节的普遍性，但就不经意就看到了一些广度。《活着》是这样，《许三观卖血记》也是如此。总的来说，总有一种仿佛“医院”的氛围，有人呻吟，有人力图救治，但大部分人已经麻木，忍受着苦难并习以为常。\n\n正如张晓龙谈到，中国人面临的问题比存在感还低一个层次，是“生存感”。但中国有这一的一个群体，他们既有生存感的压力，又有存在感的渴望。当然，我对他用屌丝来概括这样一类人不置可否。这种表达在贾樟柯《天注定》中也极为强烈，如果说曾经可以用时代变革映射下的个体位置来解释，那么现在将余华、贾樟柯、张晓龙对个体的表述对照起来审视，就不能简单用时代来笼统地阐释。\n**未完待续**\n","source":"_posts/zh-CN/《在细雨中呼喊》一个积极的悲观主义者.md","raw":"---\ntitle: 《在细雨中呼喊》一个积极的悲观主义者\ndate: 2018-05-08 21:43:18\ntags:\n\ncategories: book\n---\n\n> 当我虚构的人物越来越真实时，我忍不住会去怀疑自己真正的现实是否在被虚构\n\n<!-- more -->\n\n主流价值观教育我们，人是无法选择自己的出身过去的，但可以努力创造和改变自己的未来，然而余华说\n\n> 当人们无法选择自己的未来时，就会珍惜自己选择过去的权利。回忆的动人之处就在于可以重新选择，可以将那些毫无关联的往事重新组合起来，从而获得了全新的过去，而且还可以不断地更换自己的组合，以求获得不一样的经历。当一个人独自坐在公园的长椅上。在日落时让嘴角露出一丝微笑，他孤独的形象似乎值得同情，然而谁又能体会到他此时的美妙旅程？他正坐在回忆的马车里，他的生活重新开始了，而且这一次的生活是他自己精心挑选的。\n\n从乡土中来，最后回归乡土。余华的作品往往是“细小的”，这细小之处在于它着眼于一个小众的灵魂人物，一个偏僻的小视野；但也是“宏大的”，这宏大之处在于故事跌宕起伏，甚至于荡气回肠。他并没有强说这种情节的普遍性，但就不经意就看到了一些广度。《活着》是这样，《许三观卖血记》也是如此。总的来说，总有一种仿佛“医院”的氛围，有人呻吟，有人力图救治，但大部分人已经麻木，忍受着苦难并习以为常。\n\n正如张晓龙谈到，中国人面临的问题比存在感还低一个层次，是“生存感”。但中国有这一的一个群体，他们既有生存感的压力，又有存在感的渴望。当然，我对他用屌丝来概括这样一类人不置可否。这种表达在贾樟柯《天注定》中也极为强烈，如果说曾经可以用时代变革映射下的个体位置来解释，那么现在将余华、贾樟柯、张晓龙对个体的表述对照起来审视，就不能简单用时代来笼统地阐释。\n**未完待续**\n","slug":"《在细雨中呼喊》一个积极的悲观主义者","published":1,"lang":"zh-CN","updated":"2019-04-29T01:07:50.656Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjvnq7za500117jjxe51lnp6q","content":"<link rel=\"stylesheet\" class=\"aplayer-secondary-style-marker\" href=\"/assets/css/APlayer.min.css\"><script src=\"/assets/js/APlayer.min.js\" class=\"aplayer-secondary-script-marker\"></script><script class=\"meting-secondary-script-marker\" src=\"/assets/js/Meting.min.js\"></script><link rel=\"stylesheet\" type=\"text/css\" href=\"https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css\"><blockquote>\n<p>当我虚构的人物越来越真实时，我忍不住会去怀疑自己真正的现实是否在被虚构</p>\n</blockquote>\n<a id=\"more\"></a>\n<p>主流价值观教育我们，人是无法选择自己的出身过去的，但可以努力创造和改变自己的未来，然而余华说</p>\n<blockquote>\n<p>当人们无法选择自己的未来时，就会珍惜自己选择过去的权利。回忆的动人之处就在于可以重新选择，可以将那些毫无关联的往事重新组合起来，从而获得了全新的过去，而且还可以不断地更换自己的组合，以求获得不一样的经历。当一个人独自坐在公园的长椅上。在日落时让嘴角露出一丝微笑，他孤独的形象似乎值得同情，然而谁又能体会到他此时的美妙旅程？他正坐在回忆的马车里，他的生活重新开始了，而且这一次的生活是他自己精心挑选的。</p>\n</blockquote>\n<p>从乡土中来，最后回归乡土。余华的作品往往是“细小的”，这细小之处在于它着眼于一个小众的灵魂人物，一个偏僻的小视野；但也是“宏大的”，这宏大之处在于故事跌宕起伏，甚至于荡气回肠。他并没有强说这种情节的普遍性，但就不经意就看到了一些广度。《活着》是这样，《许三观卖血记》也是如此。总的来说，总有一种仿佛“医院”的氛围，有人呻吟，有人力图救治，但大部分人已经麻木，忍受着苦难并习以为常。</p>\n<p>正如张晓龙谈到，中国人面临的问题比存在感还低一个层次，是“生存感”。但中国有这一的一个群体，他们既有生存感的压力，又有存在感的渴望。当然，我对他用屌丝来概括这样一类人不置可否。这种表达在贾樟柯《天注定》中也极为强烈，如果说曾经可以用时代变革映射下的个体位置来解释，那么现在将余华、贾樟柯、张晓龙对个体的表述对照起来审视，就不能简单用时代来笼统地阐释。<br><strong>未完待续</strong></p>\n","site":{"data":{}},"excerpt":"<blockquote>\n<p>当我虚构的人物越来越真实时，我忍不住会去怀疑自己真正的现实是否在被虚构</p>\n</blockquote>","more":"<p>主流价值观教育我们，人是无法选择自己的出身过去的，但可以努力创造和改变自己的未来，然而余华说</p>\n<blockquote>\n<p>当人们无法选择自己的未来时，就会珍惜自己选择过去的权利。回忆的动人之处就在于可以重新选择，可以将那些毫无关联的往事重新组合起来，从而获得了全新的过去，而且还可以不断地更换自己的组合，以求获得不一样的经历。当一个人独自坐在公园的长椅上。在日落时让嘴角露出一丝微笑，他孤独的形象似乎值得同情，然而谁又能体会到他此时的美妙旅程？他正坐在回忆的马车里，他的生活重新开始了，而且这一次的生活是他自己精心挑选的。</p>\n</blockquote>\n<p>从乡土中来，最后回归乡土。余华的作品往往是“细小的”，这细小之处在于它着眼于一个小众的灵魂人物，一个偏僻的小视野；但也是“宏大的”，这宏大之处在于故事跌宕起伏，甚至于荡气回肠。他并没有强说这种情节的普遍性，但就不经意就看到了一些广度。《活着》是这样，《许三观卖血记》也是如此。总的来说，总有一种仿佛“医院”的氛围，有人呻吟，有人力图救治，但大部分人已经麻木，忍受着苦难并习以为常。</p>\n<p>正如张晓龙谈到，中国人面临的问题比存在感还低一个层次，是“生存感”。但中国有这一的一个群体，他们既有生存感的压力，又有存在感的渴望。当然，我对他用屌丝来概括这样一类人不置可否。这种表达在贾樟柯《天注定》中也极为强烈，如果说曾经可以用时代变革映射下的个体位置来解释，那么现在将余华、贾樟柯、张晓龙对个体的表述对照起来审视，就不能简单用时代来笼统地阐释。<br><strong>未完待续</strong></p>"},{"title":"《悬崖》的几处错误","date":"2019-03-24T10:10:53.000Z","_content":"\n1. 老魏说，日本人还有一年就完了\n\n<!-- more -->\n\n2. 高科长搜周乙的家时\n   ![](https://alicdn.makergyt.com/blog/%E6%82%AC%E5%B4%96.jpg)\n\n**未完**\n","source":"_posts/zh-CN/《悬崖》的几处错误.md","raw":"---\ntitle: 《悬崖》的几处错误\ndate: 2019-03-24 18:10:53\ntags:\ncategories: tv\n---\n\n1. 老魏说，日本人还有一年就完了\n\n<!-- more -->\n\n2. 高科长搜周乙的家时\n   ![](https://alicdn.makergyt.com/blog/%E6%82%AC%E5%B4%96.jpg)\n\n**未完**\n","slug":"《悬崖》的几处错误","published":1,"lang":"zh-CN","updated":"2019-04-29T01:07:50.656Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjvnq7za700157jjxv5ojnavh","content":"<link rel=\"stylesheet\" class=\"aplayer-secondary-style-marker\" href=\"/assets/css/APlayer.min.css\"><script src=\"/assets/js/APlayer.min.js\" class=\"aplayer-secondary-script-marker\"></script><script class=\"meting-secondary-script-marker\" src=\"/assets/js/Meting.min.js\"></script><link rel=\"stylesheet\" type=\"text/css\" href=\"https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css\"><ol>\n<li>老魏说，日本人还有一年就完了</li>\n</ol>\n<a id=\"more\"></a>\n<ol start=\"2\">\n<li>高科长搜周乙的家时<br><img src=\"https://alicdn.makergyt.com/blog/%E6%82%AC%E5%B4%96.jpg\" alt></li>\n</ol>\n<p><strong>未完</strong></p>\n","site":{"data":{}},"excerpt":"<ol>\n<li>老魏说，日本人还有一年就完了</li>\n</ol>","more":"<ol start=\"2\">\n<li>高科长搜周乙的家时<br><img src=\"https://alicdn.makergyt.com/blog/%E6%82%AC%E5%B4%96.jpg\" alt></li>\n</ol>\n<p><strong>未完</strong></p>"},{"title":"《皖南事变》","date":"2019-03-07T06:58:14.000Z","_content":"从书的文字来说，毕竟是文学体裁的小说，就不能用纪实的角度去了解与辨明。\n<!-- more -->\n\n但自认为作者对这两者的关系掌控的不是很好，在关键过程即将长驱直入叙述时，或又横生出景致环境的描写，或又穿插曾经的过往小事。当然，在表现一些人物的情绪或是思维变化时，这样的插入是常用的文学手法，然而阅读的直觉却是——并没有因此大放异彩，甚至于有拼凑文字之嫌。不过，瑕不掩瑜，作者极尽可能的在一些关键性的场合凸显人物的性格，在黑与白、是与非方面，没有绝对的去评判，而是辩证的站在不同角度去引导读者思考。正如书中在项英同林志超总结时，\n> 这种繁琐的总结会把实质性的错误掩盖在似是而非的材料堆里，让人摸不着头脑、抓不住要领，打乱架，和稀泥。花时间耗精力，弄出一篇官样文章来，对于指导实践毫无意义，总结不断搞，错误不断犯。\n\n就史实而言，本书必定会有一些脱离与拓展，况且“关于皖南事变中的是非功过、利害得失，长期以来，史学家们争论不休，向无定论。”，因而更愿意也仅仅从小说层面来探讨这段历史。曾经由于了解浅薄，一直有一个疑问，皖南事变作为抗日时期国民党反共高潮的产物，作为受害的一方为什么没有去大做文章来揭露，一些历史书往往一笔带过甚至并不提及。实事求是的说，这的确不是一件值得宣传的事件，于是萌发某种猜想。本书的描述逐渐地印证了这种猜想。\n产生几个问题\n> 红军长征为什么委派项英继续领导南方的游击作战,项英与一同留下的排挤在外的瞿秋白关系是怎样的\n> 被冠以“中国人民解放军军事家”称号的叶挺，书中所说可能局限于北伐，如何评价他的军事能力","source":"_posts/zh-CN/《皖南事变》.md","raw":"---\ntitle: 《皖南事变》\ndate: 2019-03-07 14:58:14\ntags:\ncategories: book\n---\n从书的文字来说，毕竟是文学体裁的小说，就不能用纪实的角度去了解与辨明。\n<!-- more -->\n\n但自认为作者对这两者的关系掌控的不是很好，在关键过程即将长驱直入叙述时，或又横生出景致环境的描写，或又穿插曾经的过往小事。当然，在表现一些人物的情绪或是思维变化时，这样的插入是常用的文学手法，然而阅读的直觉却是——并没有因此大放异彩，甚至于有拼凑文字之嫌。不过，瑕不掩瑜，作者极尽可能的在一些关键性的场合凸显人物的性格，在黑与白、是与非方面，没有绝对的去评判，而是辩证的站在不同角度去引导读者思考。正如书中在项英同林志超总结时，\n> 这种繁琐的总结会把实质性的错误掩盖在似是而非的材料堆里，让人摸不着头脑、抓不住要领，打乱架，和稀泥。花时间耗精力，弄出一篇官样文章来，对于指导实践毫无意义，总结不断搞，错误不断犯。\n\n就史实而言，本书必定会有一些脱离与拓展，况且“关于皖南事变中的是非功过、利害得失，长期以来，史学家们争论不休，向无定论。”，因而更愿意也仅仅从小说层面来探讨这段历史。曾经由于了解浅薄，一直有一个疑问，皖南事变作为抗日时期国民党反共高潮的产物，作为受害的一方为什么没有去大做文章来揭露，一些历史书往往一笔带过甚至并不提及。实事求是的说，这的确不是一件值得宣传的事件，于是萌发某种猜想。本书的描述逐渐地印证了这种猜想。\n产生几个问题\n> 红军长征为什么委派项英继续领导南方的游击作战,项英与一同留下的排挤在外的瞿秋白关系是怎样的\n> 被冠以“中国人民解放军军事家”称号的叶挺，书中所说可能局限于北伐，如何评价他的军事能力","slug":"《皖南事变》","published":1,"lang":"zh-CN","updated":"2019-04-29T01:07:50.656Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjvnq7za9001c7jjx9arxv6sv","content":"<link rel=\"stylesheet\" class=\"aplayer-secondary-style-marker\" href=\"/assets/css/APlayer.min.css\"><script src=\"/assets/js/APlayer.min.js\" class=\"aplayer-secondary-script-marker\"></script><script class=\"meting-secondary-script-marker\" src=\"/assets/js/Meting.min.js\"></script><link rel=\"stylesheet\" type=\"text/css\" href=\"https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css\"><p>从书的文字来说，毕竟是文学体裁的小说，就不能用纪实的角度去了解与辨明。<br><a id=\"more\"></a></p>\n<p>但自认为作者对这两者的关系掌控的不是很好，在关键过程即将长驱直入叙述时，或又横生出景致环境的描写，或又穿插曾经的过往小事。当然，在表现一些人物的情绪或是思维变化时，这样的插入是常用的文学手法，然而阅读的直觉却是——并没有因此大放异彩，甚至于有拼凑文字之嫌。不过，瑕不掩瑜，作者极尽可能的在一些关键性的场合凸显人物的性格，在黑与白、是与非方面，没有绝对的去评判，而是辩证的站在不同角度去引导读者思考。正如书中在项英同林志超总结时，</p>\n<blockquote>\n<p>这种繁琐的总结会把实质性的错误掩盖在似是而非的材料堆里，让人摸不着头脑、抓不住要领，打乱架，和稀泥。花时间耗精力，弄出一篇官样文章来，对于指导实践毫无意义，总结不断搞，错误不断犯。</p>\n</blockquote>\n<p>就史实而言，本书必定会有一些脱离与拓展，况且“关于皖南事变中的是非功过、利害得失，长期以来，史学家们争论不休，向无定论。”，因而更愿意也仅仅从小说层面来探讨这段历史。曾经由于了解浅薄，一直有一个疑问，皖南事变作为抗日时期国民党反共高潮的产物，作为受害的一方为什么没有去大做文章来揭露，一些历史书往往一笔带过甚至并不提及。实事求是的说，这的确不是一件值得宣传的事件，于是萌发某种猜想。本书的描述逐渐地印证了这种猜想。<br>产生几个问题</p>\n<blockquote>\n<p>红军长征为什么委派项英继续领导南方的游击作战,项英与一同留下的排挤在外的瞿秋白关系是怎样的<br>被冠以“中国人民解放军军事家”称号的叶挺，书中所说可能局限于北伐，如何评价他的军事能力</p>\n</blockquote>\n","site":{"data":{}},"excerpt":"<p>从书的文字来说，毕竟是文学体裁的小说，就不能用纪实的角度去了解与辨明。<br>","more":"</p>\n<p>但自认为作者对这两者的关系掌控的不是很好，在关键过程即将长驱直入叙述时，或又横生出景致环境的描写，或又穿插曾经的过往小事。当然，在表现一些人物的情绪或是思维变化时，这样的插入是常用的文学手法，然而阅读的直觉却是——并没有因此大放异彩，甚至于有拼凑文字之嫌。不过，瑕不掩瑜，作者极尽可能的在一些关键性的场合凸显人物的性格，在黑与白、是与非方面，没有绝对的去评判，而是辩证的站在不同角度去引导读者思考。正如书中在项英同林志超总结时，</p>\n<blockquote>\n<p>这种繁琐的总结会把实质性的错误掩盖在似是而非的材料堆里，让人摸不着头脑、抓不住要领，打乱架，和稀泥。花时间耗精力，弄出一篇官样文章来，对于指导实践毫无意义，总结不断搞，错误不断犯。</p>\n</blockquote>\n<p>就史实而言，本书必定会有一些脱离与拓展，况且“关于皖南事变中的是非功过、利害得失，长期以来，史学家们争论不休，向无定论。”，因而更愿意也仅仅从小说层面来探讨这段历史。曾经由于了解浅薄，一直有一个疑问，皖南事变作为抗日时期国民党反共高潮的产物，作为受害的一方为什么没有去大做文章来揭露，一些历史书往往一笔带过甚至并不提及。实事求是的说，这的确不是一件值得宣传的事件，于是萌发某种猜想。本书的描述逐渐地印证了这种猜想。<br>产生几个问题</p>\n<blockquote>\n<p>红军长征为什么委派项英继续领导南方的游击作战,项英与一同留下的排挤在外的瞿秋白关系是怎样的<br>被冠以“中国人民解放军军事家”称号的叶挺，书中所说可能局限于北伐，如何评价他的军事能力</p>\n</blockquote>"},{"title":"一年，一度","date":"2018-12-31T22:09:24.000Z","_content":"\n{% meting \"574919767\" \"netease\" \"song\" \"mutex:false\" \"listmaxheight:340px\" \"preload:none\" \"theme:#FC6423\"%}\n<center>\n时间不会等你，\n到了这个点，\n总被簇拥起一种该翻篇的感觉，\n回忆与展望，\n常常在忙碌的一段时间里，\n无法解释所作所为，所思所想。\n顺心的文字堆砌美好，\n晦涩的反思积聚抗辩。\n\n从时间整体来看，\n不过只是普通的一个节点，\n不论附加什么样重大的节日属性，\n依然要继续生活。\n\n时间的步伐有三种，\n过去永远静立不动，最令人怀念；\n现在像箭一样飞逝，总担心抓不住；\n未来姗姗来迟，既期待又紧张。\n\n如今的人大多数不再也没有机会去经历大风大浪，\n都生而平凡而渴望不凡,\n想要成功但没有成功只是努力去成功，\n平平凡凡，羡慕着可以大起大落；\n庸庸碌碌，期待着那个有朝一日。\n\n这样的阶段充满戾气，只是对幻想充满激情，\n在比较中磨损锋芒，在论调里身陷囹圄。\n舆情汹涌的背后常常是个体无力感的集中爆发，\n不可否认成为其中的助推者，\n宣泄之后，各回各家\n我们都曾在这样无关痛痒的鸡毛蒜皮里，\n乐此不疲地，绵延不绝地，消耗时间。\n沉浸在这样微妙的“胜利”里，\n从没想过，在不知不觉之间，\n已经被别人一骑绝尘。\n\n过去一直在走，没想过停也不敢停，\n急于突出重围，改头换面。\n大考来临，\n快即是慢，\n慢即是快。\n\n常常无法定义，\n究竟是一个积极的悲观主义者，\n亦或是现实的理想主义者。\n人，的确是一系列矛盾的综合体，\n也是一种情绪化的存在，\n自我产生，自我救赎。\n\n陷入抉择的背后，\n其实已经别无选择而心有不甘，\n自由的获取绝非不计成本，\n而是不会囿于成本的限制放弃美好的追求\n\n从今天起，\n我决定做一个纯粹的人。\n不喂马，不劈柴，\n纯纯粹粹地为每一分苟活。\n</center>","source":"_posts/zh-CN/一年，一度.md","raw":"---\ntitle: 一年，一度\ndate: 2019-01-01 06:09:24\ntags:\ncategories: thoughts\n---\n\n{% meting \"574919767\" \"netease\" \"song\" \"mutex:false\" \"listmaxheight:340px\" \"preload:none\" \"theme:#FC6423\"%}\n<center>\n时间不会等你，\n到了这个点，\n总被簇拥起一种该翻篇的感觉，\n回忆与展望，\n常常在忙碌的一段时间里，\n无法解释所作所为，所思所想。\n顺心的文字堆砌美好，\n晦涩的反思积聚抗辩。\n\n从时间整体来看，\n不过只是普通的一个节点，\n不论附加什么样重大的节日属性，\n依然要继续生活。\n\n时间的步伐有三种，\n过去永远静立不动，最令人怀念；\n现在像箭一样飞逝，总担心抓不住；\n未来姗姗来迟，既期待又紧张。\n\n如今的人大多数不再也没有机会去经历大风大浪，\n都生而平凡而渴望不凡,\n想要成功但没有成功只是努力去成功，\n平平凡凡，羡慕着可以大起大落；\n庸庸碌碌，期待着那个有朝一日。\n\n这样的阶段充满戾气，只是对幻想充满激情，\n在比较中磨损锋芒，在论调里身陷囹圄。\n舆情汹涌的背后常常是个体无力感的集中爆发，\n不可否认成为其中的助推者，\n宣泄之后，各回各家\n我们都曾在这样无关痛痒的鸡毛蒜皮里，\n乐此不疲地，绵延不绝地，消耗时间。\n沉浸在这样微妙的“胜利”里，\n从没想过，在不知不觉之间，\n已经被别人一骑绝尘。\n\n过去一直在走，没想过停也不敢停，\n急于突出重围，改头换面。\n大考来临，\n快即是慢，\n慢即是快。\n\n常常无法定义，\n究竟是一个积极的悲观主义者，\n亦或是现实的理想主义者。\n人，的确是一系列矛盾的综合体，\n也是一种情绪化的存在，\n自我产生，自我救赎。\n\n陷入抉择的背后，\n其实已经别无选择而心有不甘，\n自由的获取绝非不计成本，\n而是不会囿于成本的限制放弃美好的追求\n\n从今天起，\n我决定做一个纯粹的人。\n不喂马，不劈柴，\n纯纯粹粹地为每一分苟活。\n</center>","slug":"一年，一度","published":1,"lang":"zh-CN","updated":"2019-04-29T01:07:50.656Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjvnq7zaa001f7jjx9fhmuvxd","content":"<link rel=\"stylesheet\" class=\"aplayer-secondary-style-marker\" href=\"/assets/css/APlayer.min.css\"><script src=\"/assets/js/APlayer.min.js\" class=\"aplayer-secondary-script-marker\"></script><script class=\"meting-secondary-script-marker\" src=\"/assets/js/Meting.min.js\"></script><link rel=\"stylesheet\" type=\"text/css\" href=\"https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css\">\n    <div id=\"aplayer-ecDXekAY\" class=\"aplayer aplayer-tag-marker meting-tag-marker\" data-id=\"574919767\" data-server=\"netease\" data-type=\"song\" data-mode=\"circulation\" data-autoplay=\"false\" data-mutex=\"false\" data-listmaxheight=\"340px\" data-preload=\"none\" data-theme=\"#FC6423\"></div>\n<center><br>时间不会等你，<br>到了这个点，<br>总被簇拥起一种该翻篇的感觉，<br>回忆与展望，<br>常常在忙碌的一段时间里，<br>无法解释所作所为，所思所想。<br>顺心的文字堆砌美好，<br>晦涩的反思积聚抗辩。<br><br>从时间整体来看，<br>不过只是普通的一个节点，<br>不论附加什么样重大的节日属性，<br>依然要继续生活。<br><br>时间的步伐有三种，<br>过去永远静立不动，最令人怀念；<br>现在像箭一样飞逝，总担心抓不住；<br>未来姗姗来迟，既期待又紧张。<br><br>如今的人大多数不再也没有机会去经历大风大浪，<br>都生而平凡而渴望不凡,<br>想要成功但没有成功只是努力去成功，<br>平平凡凡，羡慕着可以大起大落；<br>庸庸碌碌，期待着那个有朝一日。<br><br>这样的阶段充满戾气，只是对幻想充满激情，<br>在比较中磨损锋芒，在论调里身陷囹圄。<br>舆情汹涌的背后常常是个体无力感的集中爆发，<br>不可否认成为其中的助推者，<br>宣泄之后，各回各家<br>我们都曾在这样无关痛痒的鸡毛蒜皮里，<br>乐此不疲地，绵延不绝地，消耗时间。<br>沉浸在这样微妙的“胜利”里，<br>从没想过，在不知不觉之间，<br>已经被别人一骑绝尘。<br><br>过去一直在走，没想过停也不敢停，<br>急于突出重围，改头换面。<br>大考来临，<br>快即是慢，<br>慢即是快。<br><br>常常无法定义，<br>究竟是一个积极的悲观主义者，<br>亦或是现实的理想主义者。<br>人，的确是一系列矛盾的综合体，<br>也是一种情绪化的存在，<br>自我产生，自我救赎。<br><br>陷入抉择的背后，<br>其实已经别无选择而心有不甘，<br>自由的获取绝非不计成本，<br>而是不会囿于成本的限制放弃美好的追求<br><br>从今天起，<br>我决定做一个纯粹的人。<br>不喂马，不劈柴，<br>纯纯粹粹地为每一分苟活。<br></center>","site":{"data":{}},"excerpt":"","more":"\n    <div id=\"aplayer-ecDXekAY\" class=\"aplayer aplayer-tag-marker meting-tag-marker\" data-id=\"574919767\" data-server=\"netease\" data-type=\"song\" data-mode=\"circulation\" data-autoplay=\"false\" data-mutex=\"false\" data-listmaxheight=\"340px\" data-preload=\"none\" data-theme=\"#FC6423\"></div>\n<center><br>时间不会等你，<br>到了这个点，<br>总被簇拥起一种该翻篇的感觉，<br>回忆与展望，<br>常常在忙碌的一段时间里，<br>无法解释所作所为，所思所想。<br>顺心的文字堆砌美好，<br>晦涩的反思积聚抗辩。<br><br>从时间整体来看，<br>不过只是普通的一个节点，<br>不论附加什么样重大的节日属性，<br>依然要继续生活。<br><br>时间的步伐有三种，<br>过去永远静立不动，最令人怀念；<br>现在像箭一样飞逝，总担心抓不住；<br>未来姗姗来迟，既期待又紧张。<br><br>如今的人大多数不再也没有机会去经历大风大浪，<br>都生而平凡而渴望不凡,<br>想要成功但没有成功只是努力去成功，<br>平平凡凡，羡慕着可以大起大落；<br>庸庸碌碌，期待着那个有朝一日。<br><br>这样的阶段充满戾气，只是对幻想充满激情，<br>在比较中磨损锋芒，在论调里身陷囹圄。<br>舆情汹涌的背后常常是个体无力感的集中爆发，<br>不可否认成为其中的助推者，<br>宣泄之后，各回各家<br>我们都曾在这样无关痛痒的鸡毛蒜皮里，<br>乐此不疲地，绵延不绝地，消耗时间。<br>沉浸在这样微妙的“胜利”里，<br>从没想过，在不知不觉之间，<br>已经被别人一骑绝尘。<br><br>过去一直在走，没想过停也不敢停，<br>急于突出重围，改头换面。<br>大考来临，<br>快即是慢，<br>慢即是快。<br><br>常常无法定义，<br>究竟是一个积极的悲观主义者，<br>亦或是现实的理想主义者。<br>人，的确是一系列矛盾的综合体，<br>也是一种情绪化的存在，<br>自我产生，自我救赎。<br><br>陷入抉择的背后，<br>其实已经别无选择而心有不甘，<br>自由的获取绝非不计成本，<br>而是不会囿于成本的限制放弃美好的追求<br><br>从今天起，<br>我决定做一个纯粹的人。<br>不喂马，不劈柴，<br>纯纯粹粹地为每一分苟活。<br></center>"},{"title":"从心所欲，无欲则刚","date":"2017-07-24T06:28:49.000Z","_content":"\n> 并不能决定生活的走向，只是让一切显得价值观正确。\n\n<img class=\"wp-image-129\" src=\"http://gaoyuting.org/wp-content/uploads/2017/07/765446205-300x225.jpg\" alt=\"\" width=\"600\" height=\"450\" /> 临走前，半年就这样日月交替着\n\n<!-- more -->\n从来不相信感性的判断，而当经常性地理性思考后，直觉居然变得是那么准确，很想写下理论的认知，却也不由得被感觉、体验驱使认知……曾经认为这种经验是一种学不到的财富，而现在甚至觉得它有时候其实是有害的，本来只是想写写比赛，不知怎么牵扯出这么多思绪。痛定思痛，时间与精力就那么点，又何必浪费在操蛋的人身上。\n\n王小波说，人的一切痛苦，都是出于对自己无能的愤恨。从来就不踏实，永远也不甘心。似乎没有后路，于是跑来跑去，抓着那一根根稻草。\n\n> 我不断往上爬，不是为了被世界看到，而是想看见整个世界；\n> 我这么努力，就是为了让自己成功的速度，超过父母老去的速度。——咪蒙\n\n当发现自己不是世界中心的时候，那是第一次长大。毒鸡汤中最棒的一句是，努力不一定成功，但是不努力一定会很舒服的。有的人可以很“文艺”地说自己的梦想很简单，工作几年就去休养生息。曾经刚开始认识这个世界的时候，也曾憧憬过桃花源记的痴梦，对，现在的我认为，的确是痴人说梦。当下的你在这样的梦想面前，幼稚而自私。但凡有点担当的，就会发现在这个世界怎么样生存不是你自己说了算的，你的努力也绝非只是代表着个人的奋斗。\n\n当发现即使再怎么努力，有些事情终究还是令人无能为力的时候，那是我第二次长大。\n这两年，东奔西跑的，也撞了很多墙，墙或许依然在那里毫发无损，现在的我却也由衷地感谢它们。参加了这些无关痛痒的比赛，真切体验着过程比结果更重要。思考方式在不断成熟，即便可能跟有些人再怎么讲也说不通，我并不认为它是错的。庄子说，夏虫不可以语冰，井蛙不可以语海。这时候，真想用四川话怼一句，龟儿子，你懂个锤子。\n\n这两年，干过苦力，体验过40度的高温下瞪着三轮像个乌龟一样往前爬的感觉，体验过底层劳动者被人蔑视的感觉，虽然当时的我尽力压制怒气，声明我也是个学生，请你尊重我!也曾被楼上的人称呼“叔叔”，当我抬头看去，她的头猛地缩了回去。那时候竟然感觉到一种累到掏空后的舒畅。也曾被老板指着鼻子批评，但也享受过极好的待遇，校园性与社会性身份的交替，的确是一种很别致的体验。\n这两年，他也没别的什么话，只是问，还有钱吗？而我一直在努力用自己的方式解答，自认为在月底吃土的同龄人中树立起了一种成熟的优越感。其实我们所努力的，不过是若干年后，也会保持这种优越感，不为生活所累，也能带给他们小康。\n\n这两年，走走看看，也听了一些跟水平并不对等的讲座，无非是为了别成了那只被温水煮了的青蛙。在台下坐过，也拿过话筒，被人礼貌节性（象征性）地“怂恿”着代表发言，名字第一次出现在活动安排上的感觉也是挺好的。台上的讲者总会传达出一种态度，即使世界很操蛋，依然坚定地热爱并改变生活。\n\n当明知道有些事情可能会无能为力，但还是会尽力争取的时候，这是我第三次长大。虽然在时间的维度上，并没有扩展出价值对等的广度，思维太快，而嘴巴永远跟不上趟，错过了很多机会很多人。但我知道，这一切已经可以结束。\n\n半年时间，检验了一件事，\n你是砍柴的，他是放羊的，你和他聊了一天，他的羊吃饱了，你的柴呢？\n现在，没有软肋，没有欲望，没有痛点，\n无欲则刚。\n\n刚才骑车过马路时，一个女生突然快跑差点相撞，被推到边上。当时还在恼火，随后一辆大车飞奔地闯了红灯。生活就是这么简单而复杂，感谢有这样的际遇，让我还有机会继续敲下这段文字，算了，不写了，把墨水留给未知。\n\n*本文采用https://makergyt.com/md 构建*\n\n","source":"_posts/zh-CN/从心所欲，无欲则刚.md","raw":"---\ntitle: 从心所欲，无欲则刚\ndate: 2017-07-24 14:28:49\ntags:\n\t- 随想\n---\n\n> 并不能决定生活的走向，只是让一切显得价值观正确。\n\n<img class=\"wp-image-129\" src=\"http://gaoyuting.org/wp-content/uploads/2017/07/765446205-300x225.jpg\" alt=\"\" width=\"600\" height=\"450\" /> 临走前，半年就这样日月交替着\n\n<!-- more -->\n从来不相信感性的判断，而当经常性地理性思考后，直觉居然变得是那么准确，很想写下理论的认知，却也不由得被感觉、体验驱使认知……曾经认为这种经验是一种学不到的财富，而现在甚至觉得它有时候其实是有害的，本来只是想写写比赛，不知怎么牵扯出这么多思绪。痛定思痛，时间与精力就那么点，又何必浪费在操蛋的人身上。\n\n王小波说，人的一切痛苦，都是出于对自己无能的愤恨。从来就不踏实，永远也不甘心。似乎没有后路，于是跑来跑去，抓着那一根根稻草。\n\n> 我不断往上爬，不是为了被世界看到，而是想看见整个世界；\n> 我这么努力，就是为了让自己成功的速度，超过父母老去的速度。——咪蒙\n\n当发现自己不是世界中心的时候，那是第一次长大。毒鸡汤中最棒的一句是，努力不一定成功，但是不努力一定会很舒服的。有的人可以很“文艺”地说自己的梦想很简单，工作几年就去休养生息。曾经刚开始认识这个世界的时候，也曾憧憬过桃花源记的痴梦，对，现在的我认为，的确是痴人说梦。当下的你在这样的梦想面前，幼稚而自私。但凡有点担当的，就会发现在这个世界怎么样生存不是你自己说了算的，你的努力也绝非只是代表着个人的奋斗。\n\n当发现即使再怎么努力，有些事情终究还是令人无能为力的时候，那是我第二次长大。\n这两年，东奔西跑的，也撞了很多墙，墙或许依然在那里毫发无损，现在的我却也由衷地感谢它们。参加了这些无关痛痒的比赛，真切体验着过程比结果更重要。思考方式在不断成熟，即便可能跟有些人再怎么讲也说不通，我并不认为它是错的。庄子说，夏虫不可以语冰，井蛙不可以语海。这时候，真想用四川话怼一句，龟儿子，你懂个锤子。\n\n这两年，干过苦力，体验过40度的高温下瞪着三轮像个乌龟一样往前爬的感觉，体验过底层劳动者被人蔑视的感觉，虽然当时的我尽力压制怒气，声明我也是个学生，请你尊重我!也曾被楼上的人称呼“叔叔”，当我抬头看去，她的头猛地缩了回去。那时候竟然感觉到一种累到掏空后的舒畅。也曾被老板指着鼻子批评，但也享受过极好的待遇，校园性与社会性身份的交替，的确是一种很别致的体验。\n这两年，他也没别的什么话，只是问，还有钱吗？而我一直在努力用自己的方式解答，自认为在月底吃土的同龄人中树立起了一种成熟的优越感。其实我们所努力的，不过是若干年后，也会保持这种优越感，不为生活所累，也能带给他们小康。\n\n这两年，走走看看，也听了一些跟水平并不对等的讲座，无非是为了别成了那只被温水煮了的青蛙。在台下坐过，也拿过话筒，被人礼貌节性（象征性）地“怂恿”着代表发言，名字第一次出现在活动安排上的感觉也是挺好的。台上的讲者总会传达出一种态度，即使世界很操蛋，依然坚定地热爱并改变生活。\n\n当明知道有些事情可能会无能为力，但还是会尽力争取的时候，这是我第三次长大。虽然在时间的维度上，并没有扩展出价值对等的广度，思维太快，而嘴巴永远跟不上趟，错过了很多机会很多人。但我知道，这一切已经可以结束。\n\n半年时间，检验了一件事，\n你是砍柴的，他是放羊的，你和他聊了一天，他的羊吃饱了，你的柴呢？\n现在，没有软肋，没有欲望，没有痛点，\n无欲则刚。\n\n刚才骑车过马路时，一个女生突然快跑差点相撞，被推到边上。当时还在恼火，随后一辆大车飞奔地闯了红灯。生活就是这么简单而复杂，感谢有这样的际遇，让我还有机会继续敲下这段文字，算了，不写了，把墨水留给未知。\n\n*本文采用https://makergyt.com/md 构建*\n\n","slug":"从心所欲，无欲则刚","published":1,"lang":"zh-CN","updated":"2019-04-29T01:07:50.656Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjvnq7zac001h7jjxczrpkvbv","content":"<link rel=\"stylesheet\" class=\"aplayer-secondary-style-marker\" href=\"/assets/css/APlayer.min.css\"><script src=\"/assets/js/APlayer.min.js\" class=\"aplayer-secondary-script-marker\"></script><script class=\"meting-secondary-script-marker\" src=\"/assets/js/Meting.min.js\"></script><link rel=\"stylesheet\" type=\"text/css\" href=\"https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css\"><blockquote>\n<p>并不能决定生活的走向，只是让一切显得价值观正确。</p>\n</blockquote>\n<p><img class=\"wp-image-129\" src=\"http://gaoyuting.org/wp-content/uploads/2017/07/765446205-300x225.jpg\" alt width=\"600\" height=\"450\"> 临走前，半年就这样日月交替着</p>\n<a id=\"more\"></a>\n<p>从来不相信感性的判断，而当经常性地理性思考后，直觉居然变得是那么准确，很想写下理论的认知，却也不由得被感觉、体验驱使认知……曾经认为这种经验是一种学不到的财富，而现在甚至觉得它有时候其实是有害的，本来只是想写写比赛，不知怎么牵扯出这么多思绪。痛定思痛，时间与精力就那么点，又何必浪费在操蛋的人身上。</p>\n<p>王小波说，人的一切痛苦，都是出于对自己无能的愤恨。从来就不踏实，永远也不甘心。似乎没有后路，于是跑来跑去，抓着那一根根稻草。</p>\n<blockquote>\n<p>我不断往上爬，不是为了被世界看到，而是想看见整个世界；<br>我这么努力，就是为了让自己成功的速度，超过父母老去的速度。——咪蒙</p>\n</blockquote>\n<p>当发现自己不是世界中心的时候，那是第一次长大。毒鸡汤中最棒的一句是，努力不一定成功，但是不努力一定会很舒服的。有的人可以很“文艺”地说自己的梦想很简单，工作几年就去休养生息。曾经刚开始认识这个世界的时候，也曾憧憬过桃花源记的痴梦，对，现在的我认为，的确是痴人说梦。当下的你在这样的梦想面前，幼稚而自私。但凡有点担当的，就会发现在这个世界怎么样生存不是你自己说了算的，你的努力也绝非只是代表着个人的奋斗。</p>\n<p>当发现即使再怎么努力，有些事情终究还是令人无能为力的时候，那是我第二次长大。<br>这两年，东奔西跑的，也撞了很多墙，墙或许依然在那里毫发无损，现在的我却也由衷地感谢它们。参加了这些无关痛痒的比赛，真切体验着过程比结果更重要。思考方式在不断成熟，即便可能跟有些人再怎么讲也说不通，我并不认为它是错的。庄子说，夏虫不可以语冰，井蛙不可以语海。这时候，真想用四川话怼一句，龟儿子，你懂个锤子。</p>\n<p>这两年，干过苦力，体验过40度的高温下瞪着三轮像个乌龟一样往前爬的感觉，体验过底层劳动者被人蔑视的感觉，虽然当时的我尽力压制怒气，声明我也是个学生，请你尊重我!也曾被楼上的人称呼“叔叔”，当我抬头看去，她的头猛地缩了回去。那时候竟然感觉到一种累到掏空后的舒畅。也曾被老板指着鼻子批评，但也享受过极好的待遇，校园性与社会性身份的交替，的确是一种很别致的体验。<br>这两年，他也没别的什么话，只是问，还有钱吗？而我一直在努力用自己的方式解答，自认为在月底吃土的同龄人中树立起了一种成熟的优越感。其实我们所努力的，不过是若干年后，也会保持这种优越感，不为生活所累，也能带给他们小康。</p>\n<p>这两年，走走看看，也听了一些跟水平并不对等的讲座，无非是为了别成了那只被温水煮了的青蛙。在台下坐过，也拿过话筒，被人礼貌节性（象征性）地“怂恿”着代表发言，名字第一次出现在活动安排上的感觉也是挺好的。台上的讲者总会传达出一种态度，即使世界很操蛋，依然坚定地热爱并改变生活。</p>\n<p>当明知道有些事情可能会无能为力，但还是会尽力争取的时候，这是我第三次长大。虽然在时间的维度上，并没有扩展出价值对等的广度，思维太快，而嘴巴永远跟不上趟，错过了很多机会很多人。但我知道，这一切已经可以结束。</p>\n<p>半年时间，检验了一件事，<br>你是砍柴的，他是放羊的，你和他聊了一天，他的羊吃饱了，你的柴呢？<br>现在，没有软肋，没有欲望，没有痛点，<br>无欲则刚。</p>\n<p>刚才骑车过马路时，一个女生突然快跑差点相撞，被推到边上。当时还在恼火，随后一辆大车飞奔地闯了红灯。生活就是这么简单而复杂，感谢有这样的际遇，让我还有机会继续敲下这段文字，算了，不写了，把墨水留给未知。</p>\n<p><em>本文采用<a href=\"https://makergyt.com/md\" target=\"_blank\" rel=\"noopener\">https://makergyt.com/md</a> 构建</em></p>\n","site":{"data":{}},"excerpt":"<blockquote>\n<p>并不能决定生活的走向，只是让一切显得价值观正确。</p>\n</blockquote>\n<p><img class=\"wp-image-129\" src=\"http://gaoyuting.org/wp-content/uploads/2017/07/765446205-300x225.jpg\" alt width=\"600\" height=\"450\"> 临走前，半年就这样日月交替着</p>","more":"<p>从来不相信感性的判断，而当经常性地理性思考后，直觉居然变得是那么准确，很想写下理论的认知，却也不由得被感觉、体验驱使认知……曾经认为这种经验是一种学不到的财富，而现在甚至觉得它有时候其实是有害的，本来只是想写写比赛，不知怎么牵扯出这么多思绪。痛定思痛，时间与精力就那么点，又何必浪费在操蛋的人身上。</p>\n<p>王小波说，人的一切痛苦，都是出于对自己无能的愤恨。从来就不踏实，永远也不甘心。似乎没有后路，于是跑来跑去，抓着那一根根稻草。</p>\n<blockquote>\n<p>我不断往上爬，不是为了被世界看到，而是想看见整个世界；<br>我这么努力，就是为了让自己成功的速度，超过父母老去的速度。——咪蒙</p>\n</blockquote>\n<p>当发现自己不是世界中心的时候，那是第一次长大。毒鸡汤中最棒的一句是，努力不一定成功，但是不努力一定会很舒服的。有的人可以很“文艺”地说自己的梦想很简单，工作几年就去休养生息。曾经刚开始认识这个世界的时候，也曾憧憬过桃花源记的痴梦，对，现在的我认为，的确是痴人说梦。当下的你在这样的梦想面前，幼稚而自私。但凡有点担当的，就会发现在这个世界怎么样生存不是你自己说了算的，你的努力也绝非只是代表着个人的奋斗。</p>\n<p>当发现即使再怎么努力，有些事情终究还是令人无能为力的时候，那是我第二次长大。<br>这两年，东奔西跑的，也撞了很多墙，墙或许依然在那里毫发无损，现在的我却也由衷地感谢它们。参加了这些无关痛痒的比赛，真切体验着过程比结果更重要。思考方式在不断成熟，即便可能跟有些人再怎么讲也说不通，我并不认为它是错的。庄子说，夏虫不可以语冰，井蛙不可以语海。这时候，真想用四川话怼一句，龟儿子，你懂个锤子。</p>\n<p>这两年，干过苦力，体验过40度的高温下瞪着三轮像个乌龟一样往前爬的感觉，体验过底层劳动者被人蔑视的感觉，虽然当时的我尽力压制怒气，声明我也是个学生，请你尊重我!也曾被楼上的人称呼“叔叔”，当我抬头看去，她的头猛地缩了回去。那时候竟然感觉到一种累到掏空后的舒畅。也曾被老板指着鼻子批评，但也享受过极好的待遇，校园性与社会性身份的交替，的确是一种很别致的体验。<br>这两年，他也没别的什么话，只是问，还有钱吗？而我一直在努力用自己的方式解答，自认为在月底吃土的同龄人中树立起了一种成熟的优越感。其实我们所努力的，不过是若干年后，也会保持这种优越感，不为生活所累，也能带给他们小康。</p>\n<p>这两年，走走看看，也听了一些跟水平并不对等的讲座，无非是为了别成了那只被温水煮了的青蛙。在台下坐过，也拿过话筒，被人礼貌节性（象征性）地“怂恿”着代表发言，名字第一次出现在活动安排上的感觉也是挺好的。台上的讲者总会传达出一种态度，即使世界很操蛋，依然坚定地热爱并改变生活。</p>\n<p>当明知道有些事情可能会无能为力，但还是会尽力争取的时候，这是我第三次长大。虽然在时间的维度上，并没有扩展出价值对等的广度，思维太快，而嘴巴永远跟不上趟，错过了很多机会很多人。但我知道，这一切已经可以结束。</p>\n<p>半年时间，检验了一件事，<br>你是砍柴的，他是放羊的，你和他聊了一天，他的羊吃饱了，你的柴呢？<br>现在，没有软肋，没有欲望，没有痛点，<br>无欲则刚。</p>\n<p>刚才骑车过马路时，一个女生突然快跑差点相撞，被推到边上。当时还在恼火，随后一辆大车飞奔地闯了红灯。生活就是这么简单而复杂，感谢有这样的际遇，让我还有机会继续敲下这段文字，算了，不写了，把墨水留给未知。</p>\n<p><em>本文采用<a href=\"https://makergyt.com/md\" target=\"_blank\" rel=\"noopener\">https://makergyt.com/md</a> 构建</em></p>"},{"title":"多端构建工具使用分析","date":"2019-04-15T08:47:43.000Z","_content":"# taro\n环境：ubuntu\n- 构建极慢，每次都重新构建\n- 对热重载支持不足，保存后报错component不存在，又需要重新构建，官方命令不加--watch时不会监听文件变化，然而并非如此\n- 对第三方样式支持不开放\n\n# cmljs\n# uniapp\n\n","source":"_posts/zh-CN/多端构建工具使用分析.md","raw":"---\ntitle: 多端构建工具使用分析\ndate: 2019-04-15 16:47:43\ntags:\n---\n# taro\n环境：ubuntu\n- 构建极慢，每次都重新构建\n- 对热重载支持不足，保存后报错component不存在，又需要重新构建，官方命令不加--watch时不会监听文件变化，然而并非如此\n- 对第三方样式支持不开放\n\n# cmljs\n# uniapp\n\n","slug":"多端构建工具使用分析","published":1,"lang":"zh-CN","updated":"2019-04-29T01:07:50.656Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjvnq7zad001k7jjxb6qn46p2","content":"<link rel=\"stylesheet\" class=\"aplayer-secondary-style-marker\" href=\"/assets/css/APlayer.min.css\"><script src=\"/assets/js/APlayer.min.js\" class=\"aplayer-secondary-script-marker\"></script><script class=\"meting-secondary-script-marker\" src=\"/assets/js/Meting.min.js\"></script><link rel=\"stylesheet\" type=\"text/css\" href=\"https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css\"><h1 id=\"taro\"><a href=\"#taro\" class=\"headerlink\" title=\"taro\"></a>taro</h1><p>环境：ubuntu</p>\n<ul>\n<li>构建极慢，每次都重新构建</li>\n<li>对热重载支持不足，保存后报错component不存在，又需要重新构建，官方命令不加–watch时不会监听文件变化，然而并非如此</li>\n<li>对第三方样式支持不开放</li>\n</ul>\n<h1 id=\"cmljs\"><a href=\"#cmljs\" class=\"headerlink\" title=\"cmljs\"></a>cmljs</h1><h1 id=\"uniapp\"><a href=\"#uniapp\" class=\"headerlink\" title=\"uniapp\"></a>uniapp</h1>","site":{"data":{}},"excerpt":"","more":"<h1 id=\"taro\"><a href=\"#taro\" class=\"headerlink\" title=\"taro\"></a>taro</h1><p>环境：ubuntu</p>\n<ul>\n<li>构建极慢，每次都重新构建</li>\n<li>对热重载支持不足，保存后报错component不存在，又需要重新构建，官方命令不加–watch时不会监听文件变化，然而并非如此</li>\n<li>对第三方样式支持不开放</li>\n</ul>\n<h1 id=\"cmljs\"><a href=\"#cmljs\" class=\"headerlink\" title=\"cmljs\"></a>cmljs</h1><h1 id=\"uniapp\"><a href=\"#uniapp\" class=\"headerlink\" title=\"uniapp\"></a>uniapp</h1>"},{"title":"凡是过往，皆为序章","date":"2018-05-01T04:14:02.000Z","_content":"\n{% cq %}因过竹院逢僧话，偷得浮生半日闲。{% endcq %}\n\n<!-- more -->\n\n> 有一个夜晚，我烧毁了所有的记忆，从此我的梦就透明了，有一个早晨我扔掉了所有的昨天，从此我的脚步就轻盈了。 \n\nN32°49′32.60″，E109°21′48.60″\n\n","source":"_posts/zh-CN/凡是过往，皆为序章.md","raw":"---\ntitle: 凡是过往，皆为序章\ndate: 2018-05-01 12:14:02\ntags:\ncategories: thoughts\n---\n\n{% cq %}因过竹院逢僧话，偷得浮生半日闲。{% endcq %}\n\n<!-- more -->\n\n> 有一个夜晚，我烧毁了所有的记忆，从此我的梦就透明了，有一个早晨我扔掉了所有的昨天，从此我的脚步就轻盈了。 \n\nN32°49′32.60″，E109°21′48.60″\n\n","slug":"凡是过往，皆为序章","published":1,"lang":"zh-CN","updated":"2019-04-29T01:07:50.656Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjvnq7zaf001m7jjxutkct1v5","content":"<link rel=\"stylesheet\" class=\"aplayer-secondary-style-marker\" href=\"/assets/css/APlayer.min.css\"><script src=\"/assets/js/APlayer.min.js\" class=\"aplayer-secondary-script-marker\"></script><script class=\"meting-secondary-script-marker\" src=\"/assets/js/Meting.min.js\"></script><link rel=\"stylesheet\" type=\"text/css\" href=\"https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css\"><blockquote class=\"blockquote-center\"><p>因过竹院逢僧话，偷得浮生半日闲。</p>\n</blockquote>\n<a id=\"more\"></a>\n<blockquote>\n<p>有一个夜晚，我烧毁了所有的记忆，从此我的梦就透明了，有一个早晨我扔掉了所有的昨天，从此我的脚步就轻盈了。 </p>\n</blockquote>\n<p>N32°49′32.60″，E109°21′48.60″</p>\n","site":{"data":{}},"excerpt":"<blockquote class=\"blockquote-center\"><p>因过竹院逢僧话，偷得浮生半日闲。</p>\n</blockquote>","more":"<blockquote>\n<p>有一个夜晚，我烧毁了所有的记忆，从此我的梦就透明了，有一个早晨我扔掉了所有的昨天，从此我的脚步就轻盈了。 </p>\n</blockquote>\n<p>N32°49′32.60″，E109°21′48.60″</p>"},{"title":"反向编译wxapkg记录","date":"2019-04-03T12:30:37.000Z","_content":"# 0.目的\n一些小程序出于各种考虑并没有开放源代码，但是有时开发者想要了解学习其中的实现过程，需要去看到源码。当然，应该对开发者报以由衷敬意去阅读。\n\n<!-- more -->\n\n# 1.原理\n\n根据微信官方关于小程序运行过程的描述\n>初次进入小程序的时候，微信客户端初始化好宿主环境，同时从网络下载或者从本地缓存中拿到小程序的代码包，把它注入到宿主环境，初始化完毕后，微信客户端就会给App实例派发onLaunch事件，App构造器参数所定义的onLaunch方法会被调用。\n\n>在某个小程序第一次启动时，微信需要下载小程序代码包。此后，如果小程序代码包未更新且还被保留在缓存中，则下载小程序代码包的步骤会被跳过。下载到的小程序代码包不是小程序的源代码，而是编译、压缩、打包之后的代码包。\n\n从以上过程可知，获取小程序包的方式有两种：\n1. 通过小程序的下载地址直接截取\n  这种方式在之前被人发现后一度被大量拉取，官方很快发现后经过处理现已失效，目前具体下载地址以及鉴权方式未知\n2. 小程序加载后在客户端获取\n 这种方式理论上可行，但进入相应的目录需要root权限，由于真机root现在变得越来越麻烦也不安全，因此目前一般通过模拟器获取(这种方式暂未封，但是微信是可以检测出当前运行环境的，从而将来可以采取一些方式)。根据文档可知，获取的小程序代码是经过处理后的代码包，因而还原到开发的程序还需要经过反向编译。下面是具体实现过程：\n\n# 2 实现\n\n## 2.1 材料\n1. 安卓模拟器：[夜神模拟器](https://www.yeshen.com/)\n2. 微信、ES文件浏览器APK\n3. 反编译脚本及环境\nhttps://github.com/leo9960/wechat-app-unpack/\n\n## 2.2 过程\n1. 小程序源码文件\n\n  下载[夜神模拟器](https://www.yeshen.com/)安装wechat 7.0.3后``闪退``\n\n  换用winserver2012环境：``安装失败``：``显卡驱动版本低``\n\n  换用geomotion模拟器:``无法安装微信``，提示ARM环境版本错误\n\n{% note info %}\n以前可以完整实现，目前暂时卡在这一步\n{% endnote %}\n\n2. 使用脚本解包为小程序典型文件结构  \n\n# Reference\n\n<small>\n[1] 微信小程序团队.小程序开发指南[EB/OL].[https://0x9.me/Uk63r](https://developers.weixin.qq.com/ebook?action=get_post_info&docid=000c8a2f9ac0b0ab0086aafeb5d80a) .2018.\n</small>","source":"_posts/zh-CN/反向编译wxapkg记录.md","raw":"---\ntitle: 反向编译wxapkg记录\ndate: 2019-04-03 20:30:37\ntags:\n  - wechat\ncategories: record\n---\n# 0.目的\n一些小程序出于各种考虑并没有开放源代码，但是有时开发者想要了解学习其中的实现过程，需要去看到源码。当然，应该对开发者报以由衷敬意去阅读。\n\n<!-- more -->\n\n# 1.原理\n\n根据微信官方关于小程序运行过程的描述\n>初次进入小程序的时候，微信客户端初始化好宿主环境，同时从网络下载或者从本地缓存中拿到小程序的代码包，把它注入到宿主环境，初始化完毕后，微信客户端就会给App实例派发onLaunch事件，App构造器参数所定义的onLaunch方法会被调用。\n\n>在某个小程序第一次启动时，微信需要下载小程序代码包。此后，如果小程序代码包未更新且还被保留在缓存中，则下载小程序代码包的步骤会被跳过。下载到的小程序代码包不是小程序的源代码，而是编译、压缩、打包之后的代码包。\n\n从以上过程可知，获取小程序包的方式有两种：\n1. 通过小程序的下载地址直接截取\n  这种方式在之前被人发现后一度被大量拉取，官方很快发现后经过处理现已失效，目前具体下载地址以及鉴权方式未知\n2. 小程序加载后在客户端获取\n 这种方式理论上可行，但进入相应的目录需要root权限，由于真机root现在变得越来越麻烦也不安全，因此目前一般通过模拟器获取(这种方式暂未封，但是微信是可以检测出当前运行环境的，从而将来可以采取一些方式)。根据文档可知，获取的小程序代码是经过处理后的代码包，因而还原到开发的程序还需要经过反向编译。下面是具体实现过程：\n\n# 2 实现\n\n## 2.1 材料\n1. 安卓模拟器：[夜神模拟器](https://www.yeshen.com/)\n2. 微信、ES文件浏览器APK\n3. 反编译脚本及环境\nhttps://github.com/leo9960/wechat-app-unpack/\n\n## 2.2 过程\n1. 小程序源码文件\n\n  下载[夜神模拟器](https://www.yeshen.com/)安装wechat 7.0.3后``闪退``\n\n  换用winserver2012环境：``安装失败``：``显卡驱动版本低``\n\n  换用geomotion模拟器:``无法安装微信``，提示ARM环境版本错误\n\n{% note info %}\n以前可以完整实现，目前暂时卡在这一步\n{% endnote %}\n\n2. 使用脚本解包为小程序典型文件结构  \n\n# Reference\n\n<small>\n[1] 微信小程序团队.小程序开发指南[EB/OL].[https://0x9.me/Uk63r](https://developers.weixin.qq.com/ebook?action=get_post_info&docid=000c8a2f9ac0b0ab0086aafeb5d80a) .2018.\n</small>","slug":"反向编译wxapkg记录","published":1,"lang":"zh-CN","updated":"2019-04-29T01:07:50.656Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjvnq7zah001q7jjx7501p30y","content":"<link rel=\"stylesheet\" class=\"aplayer-secondary-style-marker\" href=\"/assets/css/APlayer.min.css\"><script src=\"/assets/js/APlayer.min.js\" class=\"aplayer-secondary-script-marker\"></script><script class=\"meting-secondary-script-marker\" src=\"/assets/js/Meting.min.js\"></script><link rel=\"stylesheet\" type=\"text/css\" href=\"https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css\"><h1 id=\"0-目的\"><a href=\"#0-目的\" class=\"headerlink\" title=\"0.目的\"></a>0.目的</h1><p>一些小程序出于各种考虑并没有开放源代码，但是有时开发者想要了解学习其中的实现过程，需要去看到源码。当然，应该对开发者报以由衷敬意去阅读。</p>\n<a id=\"more\"></a>\n<h1 id=\"1-原理\"><a href=\"#1-原理\" class=\"headerlink\" title=\"1.原理\"></a>1.原理</h1><p>根据微信官方关于小程序运行过程的描述</p>\n<blockquote>\n<p>初次进入小程序的时候，微信客户端初始化好宿主环境，同时从网络下载或者从本地缓存中拿到小程序的代码包，把它注入到宿主环境，初始化完毕后，微信客户端就会给App实例派发onLaunch事件，App构造器参数所定义的onLaunch方法会被调用。</p>\n</blockquote>\n<blockquote>\n<p>在某个小程序第一次启动时，微信需要下载小程序代码包。此后，如果小程序代码包未更新且还被保留在缓存中，则下载小程序代码包的步骤会被跳过。下载到的小程序代码包不是小程序的源代码，而是编译、压缩、打包之后的代码包。</p>\n</blockquote>\n<p>从以上过程可知，获取小程序包的方式有两种：</p>\n<ol>\n<li>通过小程序的下载地址直接截取<br>这种方式在之前被人发现后一度被大量拉取，官方很快发现后经过处理现已失效，目前具体下载地址以及鉴权方式未知</li>\n<li>小程序加载后在客户端获取<br>这种方式理论上可行，但进入相应的目录需要root权限，由于真机root现在变得越来越麻烦也不安全，因此目前一般通过模拟器获取(这种方式暂未封，但是微信是可以检测出当前运行环境的，从而将来可以采取一些方式)。根据文档可知，获取的小程序代码是经过处理后的代码包，因而还原到开发的程序还需要经过反向编译。下面是具体实现过程：</li>\n</ol>\n<h1 id=\"2-实现\"><a href=\"#2-实现\" class=\"headerlink\" title=\"2 实现\"></a>2 实现</h1><h2 id=\"2-1-材料\"><a href=\"#2-1-材料\" class=\"headerlink\" title=\"2.1 材料\"></a>2.1 材料</h2><ol>\n<li>安卓模拟器：<a href=\"https://www.yeshen.com/\" target=\"_blank\" rel=\"noopener\">夜神模拟器</a></li>\n<li>微信、ES文件浏览器APK</li>\n<li>反编译脚本及环境<br><a href=\"https://github.com/leo9960/wechat-app-unpack/\" target=\"_blank\" rel=\"noopener\">https://github.com/leo9960/wechat-app-unpack/</a></li>\n</ol>\n<h2 id=\"2-2-过程\"><a href=\"#2-2-过程\" class=\"headerlink\" title=\"2.2 过程\"></a>2.2 过程</h2><ol>\n<li><p>小程序源码文件</p>\n<p>下载<a href=\"https://www.yeshen.com/\" target=\"_blank\" rel=\"noopener\">夜神模拟器</a>安装wechat 7.0.3后<code>闪退</code></p>\n<p>换用winserver2012环境：<code>安装失败</code>：<code>显卡驱动版本低</code></p>\n<p>换用geomotion模拟器:<code>无法安装微信</code>，提示ARM环境版本错误</p>\n</li>\n</ol>\n<div class=\"note info\">\n            <p>以前可以完整实现，目前暂时卡在这一步</p>\n          </div>\n<ol start=\"2\">\n<li>使用脚本解包为小程序典型文件结构  </li>\n</ol>\n<h1 id=\"Reference\"><a href=\"#Reference\" class=\"headerlink\" title=\"Reference\"></a>Reference</h1><p><small><br>[1] 微信小程序团队.小程序开发指南[EB/OL].<a href=\"https://developers.weixin.qq.com/ebook?action=get_post_info&amp;docid=000c8a2f9ac0b0ab0086aafeb5d80a\" target=\"_blank\" rel=\"noopener\">https://0x9.me/Uk63r</a> .2018.<br></small></p>\n","site":{"data":{}},"excerpt":"<h1 id=\"0-目的\"><a href=\"#0-目的\" class=\"headerlink\" title=\"0.目的\"></a>0.目的</h1><p>一些小程序出于各种考虑并没有开放源代码，但是有时开发者想要了解学习其中的实现过程，需要去看到源码。当然，应该对开发者报以由衷敬意去阅读。</p>","more":"<h1 id=\"1-原理\"><a href=\"#1-原理\" class=\"headerlink\" title=\"1.原理\"></a>1.原理</h1><p>根据微信官方关于小程序运行过程的描述</p>\n<blockquote>\n<p>初次进入小程序的时候，微信客户端初始化好宿主环境，同时从网络下载或者从本地缓存中拿到小程序的代码包，把它注入到宿主环境，初始化完毕后，微信客户端就会给App实例派发onLaunch事件，App构造器参数所定义的onLaunch方法会被调用。</p>\n</blockquote>\n<blockquote>\n<p>在某个小程序第一次启动时，微信需要下载小程序代码包。此后，如果小程序代码包未更新且还被保留在缓存中，则下载小程序代码包的步骤会被跳过。下载到的小程序代码包不是小程序的源代码，而是编译、压缩、打包之后的代码包。</p>\n</blockquote>\n<p>从以上过程可知，获取小程序包的方式有两种：</p>\n<ol>\n<li>通过小程序的下载地址直接截取<br>这种方式在之前被人发现后一度被大量拉取，官方很快发现后经过处理现已失效，目前具体下载地址以及鉴权方式未知</li>\n<li>小程序加载后在客户端获取<br>这种方式理论上可行，但进入相应的目录需要root权限，由于真机root现在变得越来越麻烦也不安全，因此目前一般通过模拟器获取(这种方式暂未封，但是微信是可以检测出当前运行环境的，从而将来可以采取一些方式)。根据文档可知，获取的小程序代码是经过处理后的代码包，因而还原到开发的程序还需要经过反向编译。下面是具体实现过程：</li>\n</ol>\n<h1 id=\"2-实现\"><a href=\"#2-实现\" class=\"headerlink\" title=\"2 实现\"></a>2 实现</h1><h2 id=\"2-1-材料\"><a href=\"#2-1-材料\" class=\"headerlink\" title=\"2.1 材料\"></a>2.1 材料</h2><ol>\n<li>安卓模拟器：<a href=\"https://www.yeshen.com/\" target=\"_blank\" rel=\"noopener\">夜神模拟器</a></li>\n<li>微信、ES文件浏览器APK</li>\n<li>反编译脚本及环境<br><a href=\"https://github.com/leo9960/wechat-app-unpack/\" target=\"_blank\" rel=\"noopener\">https://github.com/leo9960/wechat-app-unpack/</a></li>\n</ol>\n<h2 id=\"2-2-过程\"><a href=\"#2-2-过程\" class=\"headerlink\" title=\"2.2 过程\"></a>2.2 过程</h2><ol>\n<li><p>小程序源码文件</p>\n<p>下载<a href=\"https://www.yeshen.com/\" target=\"_blank\" rel=\"noopener\">夜神模拟器</a>安装wechat 7.0.3后<code>闪退</code></p>\n<p>换用winserver2012环境：<code>安装失败</code>：<code>显卡驱动版本低</code></p>\n<p>换用geomotion模拟器:<code>无法安装微信</code>，提示ARM环境版本错误</p>\n</li>\n</ol>\n<div class=\"note info\">\n            <p>以前可以完整实现，目前暂时卡在这一步</p>\n          </div>\n<ol start=\"2\">\n<li>使用脚本解包为小程序典型文件结构  </li>\n</ol>\n<h1 id=\"Reference\"><a href=\"#Reference\" class=\"headerlink\" title=\"Reference\"></a>Reference</h1><p><small><br>[1] 微信小程序团队.小程序开发指南[EB/OL].<a href=\"https://developers.weixin.qq.com/ebook?action=get_post_info&amp;docid=000c8a2f9ac0b0ab0086aafeb5d80a\" target=\"_blank\" rel=\"noopener\">https://0x9.me/Uk63r</a> .2018.<br></small></p>"},{"title":"安装matlab","date":"2017-11-03T05:55:21.000Z","_content":"\n{% cq %}无论是分析数据、开发算法还是创建模型，\nMATLAB 都是针对您的思维方式和工作内容而设计的。{% endcq %}\n# 1 winx64平台\n\n## 1.1 教程环境\n+ 系统：windows 10pro 1703\n+ 版本：matlab R2017b win64\n\n<!-- more -->\n## 1.2 基础准备\n+ 安装虚拟光驱工具，如[2345好压](http://dl.2345.com/haozip/haozip_v5.9.5.exe)附带这一功能\n+ 软件iso镜像文件和破解文件，关注“MakerGYT”公众号回复matlab-win\n\n## 1.3 开始\n下载文件后，将获得如下文件\n```log\n-|matlab\n---|R2017b_win64_dvd1.iso #这是镜像1\n---|R2017b_win64_dvd2.iso #这是镜像2\n---|crack\n-----|R2017b \n-------|bin  \n---------|netapi32.dll #这是替换文件\n-----|license_key.txt #这是激活密钥\n-----|license_standalone.lic #这是离线激活认证文件\n```\n\n### 1.3.1 加载镜像1\n然后先将镜像1加载到虚拟光驱（右键,或者直接装载），然后进入光驱文件，以管理员身份运行setup.exe，将跳出安装界面，接下来选择不使用internet，接下来输入激活密钥，后面根据自己选择或执行默认安装，**注意**路径最好不要含中文或空格。\n\n### 1.3.2 加载镜像2\n在安装到60%左右时会提示`请插入DVD2`,这时先将刚才加载的虚拟光驱卸载（右键弹出），然后以同样方式加载镜像2到虚拟光驱。回到安装界面，点击确定，继续执行安装。\n\n### 1.3.3 激活文件\n安装完成后运行matlab，进入激活界面，选择离线激活，将激活认证文件导入，确定，激活完成。\n\n### 1.3.4 覆盖替换\n将`netapi32.dll`文件替换到安装路径里的·`bin`下位置，完成最后一步。\n\n### 1.3.5 语言切换\n默认是半中文界面，可在预设->常规->桌面语言中修改\n\n# 2 linux64平台\n\n## 2.1 教程环境\n+ 系统：Ubuntu 16.04 amd64\n+ 版本：matlab R2017b glnxa64\n\n## 2.2 基础准备\n+ 软件iso镜像文件和破解文件，关注“MakerGYT”公众号回复matlab-linux\n\n## 2.3 开始\n下载文件后，你将获得如下文件，**注意**，命令中所有`makergyt`替换为你的用户名\n```log\n-|matlab\n---|R2017b_glnxa64_dvd1.iso #这是镜像1\n---|R2017b_glnxa64_dvd2.iso #这是镜像2\n---|crack\n-----|libmwservices.so #这是替换文件\n-----|license_key.txt #这是激活密钥\n-----|license_standalone.lic #这是离线激活认证文件\n```\n\n### 2.3.1 创建镜像目录\n\n```linux\n$ sudo mkdir /media/matlab\n```\n\n### 2.3.2 加载镜像1\n\n```linux\n$ sudo mount -o loop R2017b_glnxa64_dvd1.iso /media/matlab/\n$ cd /media/matlab\n$ cd ..\n```\n\n安装\n```linux\n$ sudo /media/matlab/install\n$ sudo mount -o loop R2017b_glnxa64_dvd2.iso /media/matlab/\n$ cd /home/Matlab/bin/\n$ ./matlab\n$ cd~ \n```\n\n### 2.3.3 加载镜像2\n在安装到80%左右时会提示`请插入DVD2`,这时先将刚才加载的虚拟光驱卸载（右键弹出），然后以同样方式加载镜像2到虚拟光驱。回到安装界面，点击确定，继续执行安装。\n\n### 2.3.4 激活文件\n安装完成后运行matlab，进入激活界面，选择离线激活，将激活认证文件导入，确定，激活完成。\n\n### 2.3.5 覆盖替换\n```linux\n$ sudo chmod -R 777 Matlab/\n$ cd crack\n$ sudo cp libmwservices.so /home/Matlab/bin/glnxa64/\n$ cd ../\n$ ./matlab\n```\n### 2.3.6 卸载镜像\n```linux\n$ sudo umount /media/matlab\n```\n\n### 2.3.7 语言切换\n默认是半中文界面，可在预设->常规->桌面语言中修改\n### 2.3.8 快捷方式\n在`/home/Desktop`新建一个文件\n```C\n[Desktop Entry]\nEncoding=UTF-8\nName=Matlab_2017b\nComment=MATLAB\nExec=/home/makergyt/Matlab/bin/matlab\nIcon=/home/makergyt/Matlab/bin/glnxa64/cef_resources/matlab_icon.png\nStartupNotify=true\nType=Application\nCategories=Application;\n```\n在文件属性中permissions->Allow\n\n获取软件包公众号回复`matlab-win`/`matlab-linux`","source":"_posts/zh-CN/安装matlab.md","raw":"---\ntitle: 安装matlab\ndate: 2017-11-03 13:55:21\ntags:\n\t- matlab\ncategories: config\n---\n\n{% cq %}无论是分析数据、开发算法还是创建模型，\nMATLAB 都是针对您的思维方式和工作内容而设计的。{% endcq %}\n# 1 winx64平台\n\n## 1.1 教程环境\n+ 系统：windows 10pro 1703\n+ 版本：matlab R2017b win64\n\n<!-- more -->\n## 1.2 基础准备\n+ 安装虚拟光驱工具，如[2345好压](http://dl.2345.com/haozip/haozip_v5.9.5.exe)附带这一功能\n+ 软件iso镜像文件和破解文件，关注“MakerGYT”公众号回复matlab-win\n\n## 1.3 开始\n下载文件后，将获得如下文件\n```log\n-|matlab\n---|R2017b_win64_dvd1.iso #这是镜像1\n---|R2017b_win64_dvd2.iso #这是镜像2\n---|crack\n-----|R2017b \n-------|bin  \n---------|netapi32.dll #这是替换文件\n-----|license_key.txt #这是激活密钥\n-----|license_standalone.lic #这是离线激活认证文件\n```\n\n### 1.3.1 加载镜像1\n然后先将镜像1加载到虚拟光驱（右键,或者直接装载），然后进入光驱文件，以管理员身份运行setup.exe，将跳出安装界面，接下来选择不使用internet，接下来输入激活密钥，后面根据自己选择或执行默认安装，**注意**路径最好不要含中文或空格。\n\n### 1.3.2 加载镜像2\n在安装到60%左右时会提示`请插入DVD2`,这时先将刚才加载的虚拟光驱卸载（右键弹出），然后以同样方式加载镜像2到虚拟光驱。回到安装界面，点击确定，继续执行安装。\n\n### 1.3.3 激活文件\n安装完成后运行matlab，进入激活界面，选择离线激活，将激活认证文件导入，确定，激活完成。\n\n### 1.3.4 覆盖替换\n将`netapi32.dll`文件替换到安装路径里的·`bin`下位置，完成最后一步。\n\n### 1.3.5 语言切换\n默认是半中文界面，可在预设->常规->桌面语言中修改\n\n# 2 linux64平台\n\n## 2.1 教程环境\n+ 系统：Ubuntu 16.04 amd64\n+ 版本：matlab R2017b glnxa64\n\n## 2.2 基础准备\n+ 软件iso镜像文件和破解文件，关注“MakerGYT”公众号回复matlab-linux\n\n## 2.3 开始\n下载文件后，你将获得如下文件，**注意**，命令中所有`makergyt`替换为你的用户名\n```log\n-|matlab\n---|R2017b_glnxa64_dvd1.iso #这是镜像1\n---|R2017b_glnxa64_dvd2.iso #这是镜像2\n---|crack\n-----|libmwservices.so #这是替换文件\n-----|license_key.txt #这是激活密钥\n-----|license_standalone.lic #这是离线激活认证文件\n```\n\n### 2.3.1 创建镜像目录\n\n```linux\n$ sudo mkdir /media/matlab\n```\n\n### 2.3.2 加载镜像1\n\n```linux\n$ sudo mount -o loop R2017b_glnxa64_dvd1.iso /media/matlab/\n$ cd /media/matlab\n$ cd ..\n```\n\n安装\n```linux\n$ sudo /media/matlab/install\n$ sudo mount -o loop R2017b_glnxa64_dvd2.iso /media/matlab/\n$ cd /home/Matlab/bin/\n$ ./matlab\n$ cd~ \n```\n\n### 2.3.3 加载镜像2\n在安装到80%左右时会提示`请插入DVD2`,这时先将刚才加载的虚拟光驱卸载（右键弹出），然后以同样方式加载镜像2到虚拟光驱。回到安装界面，点击确定，继续执行安装。\n\n### 2.3.4 激活文件\n安装完成后运行matlab，进入激活界面，选择离线激活，将激活认证文件导入，确定，激活完成。\n\n### 2.3.5 覆盖替换\n```linux\n$ sudo chmod -R 777 Matlab/\n$ cd crack\n$ sudo cp libmwservices.so /home/Matlab/bin/glnxa64/\n$ cd ../\n$ ./matlab\n```\n### 2.3.6 卸载镜像\n```linux\n$ sudo umount /media/matlab\n```\n\n### 2.3.7 语言切换\n默认是半中文界面，可在预设->常规->桌面语言中修改\n### 2.3.8 快捷方式\n在`/home/Desktop`新建一个文件\n```C\n[Desktop Entry]\nEncoding=UTF-8\nName=Matlab_2017b\nComment=MATLAB\nExec=/home/makergyt/Matlab/bin/matlab\nIcon=/home/makergyt/Matlab/bin/glnxa64/cef_resources/matlab_icon.png\nStartupNotify=true\nType=Application\nCategories=Application;\n```\n在文件属性中permissions->Allow\n\n获取软件包公众号回复`matlab-win`/`matlab-linux`","slug":"安装matlab","published":1,"lang":"zh-CN","updated":"2019-04-29T01:07:50.656Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjvnq7zai001s7jjxxpu65iok","content":"<link rel=\"stylesheet\" class=\"aplayer-secondary-style-marker\" href=\"/assets/css/APlayer.min.css\"><script src=\"/assets/js/APlayer.min.js\" class=\"aplayer-secondary-script-marker\"></script><script class=\"meting-secondary-script-marker\" src=\"/assets/js/Meting.min.js\"></script><link rel=\"stylesheet\" type=\"text/css\" href=\"https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css\"><blockquote class=\"blockquote-center\"><p>无论是分析数据、开发算法还是创建模型，<br>MATLAB 都是针对您的思维方式和工作内容而设计的。</p>\n</blockquote>\n<h1 id=\"1-winx64平台\"><a href=\"#1-winx64平台\" class=\"headerlink\" title=\"1 winx64平台\"></a>1 winx64平台</h1><h2 id=\"1-1-教程环境\"><a href=\"#1-1-教程环境\" class=\"headerlink\" title=\"1.1 教程环境\"></a>1.1 教程环境</h2><ul>\n<li>系统：windows 10pro 1703</li>\n<li>版本：matlab R2017b win64</li>\n</ul>\n<a id=\"more\"></a>\n<h2 id=\"1-2-基础准备\"><a href=\"#1-2-基础准备\" class=\"headerlink\" title=\"1.2 基础准备\"></a>1.2 基础准备</h2><ul>\n<li>安装虚拟光驱工具，如<a href=\"http://dl.2345.com/haozip/haozip_v5.9.5.exe\" target=\"_blank\" rel=\"noopener\">2345好压</a>附带这一功能</li>\n<li>软件iso镜像文件和破解文件，关注“MakerGYT”公众号回复matlab-win</li>\n</ul>\n<h2 id=\"1-3-开始\"><a href=\"#1-3-开始\" class=\"headerlink\" title=\"1.3 开始\"></a>1.3 开始</h2><p>下载文件后，将获得如下文件<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">-|matlab</span><br><span class=\"line\">---|R2017b_win64_dvd1.iso #这是镜像1</span><br><span class=\"line\">---|R2017b_win64_dvd2.iso #这是镜像2</span><br><span class=\"line\">---|crack</span><br><span class=\"line\">-----|R2017b </span><br><span class=\"line\">-------|bin  </span><br><span class=\"line\">---------|netapi32.dll #这是替换文件</span><br><span class=\"line\">-----|license_key.txt #这是激活密钥</span><br><span class=\"line\">-----|license_standalone.lic #这是离线激活认证文件</span><br></pre></td></tr></table></figure></p>\n<h3 id=\"1-3-1-加载镜像1\"><a href=\"#1-3-1-加载镜像1\" class=\"headerlink\" title=\"1.3.1 加载镜像1\"></a>1.3.1 加载镜像1</h3><p>然后先将镜像1加载到虚拟光驱（右键,或者直接装载），然后进入光驱文件，以管理员身份运行setup.exe，将跳出安装界面，接下来选择不使用internet，接下来输入激活密钥，后面根据自己选择或执行默认安装，<strong>注意</strong>路径最好不要含中文或空格。</p>\n<h3 id=\"1-3-2-加载镜像2\"><a href=\"#1-3-2-加载镜像2\" class=\"headerlink\" title=\"1.3.2 加载镜像2\"></a>1.3.2 加载镜像2</h3><p>在安装到60%左右时会提示<code>请插入DVD2</code>,这时先将刚才加载的虚拟光驱卸载（右键弹出），然后以同样方式加载镜像2到虚拟光驱。回到安装界面，点击确定，继续执行安装。</p>\n<h3 id=\"1-3-3-激活文件\"><a href=\"#1-3-3-激活文件\" class=\"headerlink\" title=\"1.3.3 激活文件\"></a>1.3.3 激活文件</h3><p>安装完成后运行matlab，进入激活界面，选择离线激活，将激活认证文件导入，确定，激活完成。</p>\n<h3 id=\"1-3-4-覆盖替换\"><a href=\"#1-3-4-覆盖替换\" class=\"headerlink\" title=\"1.3.4 覆盖替换\"></a>1.3.4 覆盖替换</h3><p>将<code>netapi32.dll</code>文件替换到安装路径里的·<code>bin</code>下位置，完成最后一步。</p>\n<h3 id=\"1-3-5-语言切换\"><a href=\"#1-3-5-语言切换\" class=\"headerlink\" title=\"1.3.5 语言切换\"></a>1.3.5 语言切换</h3><p>默认是半中文界面，可在预设-&gt;常规-&gt;桌面语言中修改</p>\n<h1 id=\"2-linux64平台\"><a href=\"#2-linux64平台\" class=\"headerlink\" title=\"2 linux64平台\"></a>2 linux64平台</h1><h2 id=\"2-1-教程环境\"><a href=\"#2-1-教程环境\" class=\"headerlink\" title=\"2.1 教程环境\"></a>2.1 教程环境</h2><ul>\n<li>系统：Ubuntu 16.04 amd64</li>\n<li>版本：matlab R2017b glnxa64</li>\n</ul>\n<h2 id=\"2-2-基础准备\"><a href=\"#2-2-基础准备\" class=\"headerlink\" title=\"2.2 基础准备\"></a>2.2 基础准备</h2><ul>\n<li>软件iso镜像文件和破解文件，关注“MakerGYT”公众号回复matlab-linux</li>\n</ul>\n<h2 id=\"2-3-开始\"><a href=\"#2-3-开始\" class=\"headerlink\" title=\"2.3 开始\"></a>2.3 开始</h2><p>下载文件后，你将获得如下文件，<strong>注意</strong>，命令中所有<code>makergyt</code>替换为你的用户名<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">-|matlab</span><br><span class=\"line\">---|R2017b_glnxa64_dvd1.iso #这是镜像1</span><br><span class=\"line\">---|R2017b_glnxa64_dvd2.iso #这是镜像2</span><br><span class=\"line\">---|crack</span><br><span class=\"line\">-----|libmwservices.so #这是替换文件</span><br><span class=\"line\">-----|license_key.txt #这是激活密钥</span><br><span class=\"line\">-----|license_standalone.lic #这是离线激活认证文件</span><br></pre></td></tr></table></figure></p>\n<h3 id=\"2-3-1-创建镜像目录\"><a href=\"#2-3-1-创建镜像目录\" class=\"headerlink\" title=\"2.3.1 创建镜像目录\"></a>2.3.1 创建镜像目录</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ sudo mkdir /media/matlab</span><br></pre></td></tr></table></figure>\n<h3 id=\"2-3-2-加载镜像1\"><a href=\"#2-3-2-加载镜像1\" class=\"headerlink\" title=\"2.3.2 加载镜像1\"></a>2.3.2 加载镜像1</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ sudo mount -o loop R2017b_glnxa64_dvd1.iso /media/matlab/</span><br><span class=\"line\">$ cd /media/matlab</span><br><span class=\"line\">$ cd ..</span><br></pre></td></tr></table></figure>\n<p>安装<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ sudo /media/matlab/install</span><br><span class=\"line\">$ sudo mount -o loop R2017b_glnxa64_dvd2.iso /media/matlab/</span><br><span class=\"line\">$ cd /home/Matlab/bin/</span><br><span class=\"line\">$ ./matlab</span><br><span class=\"line\">$ cd~</span><br></pre></td></tr></table></figure></p>\n<h3 id=\"2-3-3-加载镜像2\"><a href=\"#2-3-3-加载镜像2\" class=\"headerlink\" title=\"2.3.3 加载镜像2\"></a>2.3.3 加载镜像2</h3><p>在安装到80%左右时会提示<code>请插入DVD2</code>,这时先将刚才加载的虚拟光驱卸载（右键弹出），然后以同样方式加载镜像2到虚拟光驱。回到安装界面，点击确定，继续执行安装。</p>\n<h3 id=\"2-3-4-激活文件\"><a href=\"#2-3-4-激活文件\" class=\"headerlink\" title=\"2.3.4 激活文件\"></a>2.3.4 激活文件</h3><p>安装完成后运行matlab，进入激活界面，选择离线激活，将激活认证文件导入，确定，激活完成。</p>\n<h3 id=\"2-3-5-覆盖替换\"><a href=\"#2-3-5-覆盖替换\" class=\"headerlink\" title=\"2.3.5 覆盖替换\"></a>2.3.5 覆盖替换</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ sudo chmod -R 777 Matlab/</span><br><span class=\"line\">$ cd crack</span><br><span class=\"line\">$ sudo cp libmwservices.so /home/Matlab/bin/glnxa64/</span><br><span class=\"line\">$ cd ../</span><br><span class=\"line\">$ ./matlab</span><br></pre></td></tr></table></figure>\n<h3 id=\"2-3-6-卸载镜像\"><a href=\"#2-3-6-卸载镜像\" class=\"headerlink\" title=\"2.3.6 卸载镜像\"></a>2.3.6 卸载镜像</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ sudo umount /media/matlab</span><br></pre></td></tr></table></figure>\n<h3 id=\"2-3-7-语言切换\"><a href=\"#2-3-7-语言切换\" class=\"headerlink\" title=\"2.3.7 语言切换\"></a>2.3.7 语言切换</h3><p>默认是半中文界面，可在预设-&gt;常规-&gt;桌面语言中修改</p>\n<h3 id=\"2-3-8-快捷方式\"><a href=\"#2-3-8-快捷方式\" class=\"headerlink\" title=\"2.3.8 快捷方式\"></a>2.3.8 快捷方式</h3><p>在<code>/home/Desktop</code>新建一个文件<br><figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[Desktop Entry]</span><br><span class=\"line\">Encoding=UTF<span class=\"number\">-8</span></span><br><span class=\"line\">Name=Matlab_2017b</span><br><span class=\"line\">Comment=MATLAB</span><br><span class=\"line\">Exec=/home/makergyt/Matlab/bin/matlab</span><br><span class=\"line\">Icon=/home/makergyt/Matlab/bin/glnxa64/cef_resources/matlab_icon.png</span><br><span class=\"line\">StartupNotify=<span class=\"literal\">true</span></span><br><span class=\"line\">Type=Application</span><br><span class=\"line\">Categories=Application;</span><br></pre></td></tr></table></figure></p>\n<p>在文件属性中permissions-&gt;Allow</p>\n<p>获取软件包公众号回复<code>matlab-win</code>/<code>matlab-linux</code></p>\n","site":{"data":{}},"excerpt":"<blockquote class=\"blockquote-center\"><p>无论是分析数据、开发算法还是创建模型，<br>MATLAB 都是针对您的思维方式和工作内容而设计的。</p>\n</blockquote>\n<h1 id=\"1-winx64平台\"><a href=\"#1-winx64平台\" class=\"headerlink\" title=\"1 winx64平台\"></a>1 winx64平台</h1><h2 id=\"1-1-教程环境\"><a href=\"#1-1-教程环境\" class=\"headerlink\" title=\"1.1 教程环境\"></a>1.1 教程环境</h2><ul>\n<li>系统：windows 10pro 1703</li>\n<li>版本：matlab R2017b win64</li>\n</ul>","more":"<h2 id=\"1-2-基础准备\"><a href=\"#1-2-基础准备\" class=\"headerlink\" title=\"1.2 基础准备\"></a>1.2 基础准备</h2><ul>\n<li>安装虚拟光驱工具，如<a href=\"http://dl.2345.com/haozip/haozip_v5.9.5.exe\" target=\"_blank\" rel=\"noopener\">2345好压</a>附带这一功能</li>\n<li>软件iso镜像文件和破解文件，关注“MakerGYT”公众号回复matlab-win</li>\n</ul>\n<h2 id=\"1-3-开始\"><a href=\"#1-3-开始\" class=\"headerlink\" title=\"1.3 开始\"></a>1.3 开始</h2><p>下载文件后，将获得如下文件<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">-|matlab</span><br><span class=\"line\">---|R2017b_win64_dvd1.iso #这是镜像1</span><br><span class=\"line\">---|R2017b_win64_dvd2.iso #这是镜像2</span><br><span class=\"line\">---|crack</span><br><span class=\"line\">-----|R2017b </span><br><span class=\"line\">-------|bin  </span><br><span class=\"line\">---------|netapi32.dll #这是替换文件</span><br><span class=\"line\">-----|license_key.txt #这是激活密钥</span><br><span class=\"line\">-----|license_standalone.lic #这是离线激活认证文件</span><br></pre></td></tr></table></figure></p>\n<h3 id=\"1-3-1-加载镜像1\"><a href=\"#1-3-1-加载镜像1\" class=\"headerlink\" title=\"1.3.1 加载镜像1\"></a>1.3.1 加载镜像1</h3><p>然后先将镜像1加载到虚拟光驱（右键,或者直接装载），然后进入光驱文件，以管理员身份运行setup.exe，将跳出安装界面，接下来选择不使用internet，接下来输入激活密钥，后面根据自己选择或执行默认安装，<strong>注意</strong>路径最好不要含中文或空格。</p>\n<h3 id=\"1-3-2-加载镜像2\"><a href=\"#1-3-2-加载镜像2\" class=\"headerlink\" title=\"1.3.2 加载镜像2\"></a>1.3.2 加载镜像2</h3><p>在安装到60%左右时会提示<code>请插入DVD2</code>,这时先将刚才加载的虚拟光驱卸载（右键弹出），然后以同样方式加载镜像2到虚拟光驱。回到安装界面，点击确定，继续执行安装。</p>\n<h3 id=\"1-3-3-激活文件\"><a href=\"#1-3-3-激活文件\" class=\"headerlink\" title=\"1.3.3 激活文件\"></a>1.3.3 激活文件</h3><p>安装完成后运行matlab，进入激活界面，选择离线激活，将激活认证文件导入，确定，激活完成。</p>\n<h3 id=\"1-3-4-覆盖替换\"><a href=\"#1-3-4-覆盖替换\" class=\"headerlink\" title=\"1.3.4 覆盖替换\"></a>1.3.4 覆盖替换</h3><p>将<code>netapi32.dll</code>文件替换到安装路径里的·<code>bin</code>下位置，完成最后一步。</p>\n<h3 id=\"1-3-5-语言切换\"><a href=\"#1-3-5-语言切换\" class=\"headerlink\" title=\"1.3.5 语言切换\"></a>1.3.5 语言切换</h3><p>默认是半中文界面，可在预设-&gt;常规-&gt;桌面语言中修改</p>\n<h1 id=\"2-linux64平台\"><a href=\"#2-linux64平台\" class=\"headerlink\" title=\"2 linux64平台\"></a>2 linux64平台</h1><h2 id=\"2-1-教程环境\"><a href=\"#2-1-教程环境\" class=\"headerlink\" title=\"2.1 教程环境\"></a>2.1 教程环境</h2><ul>\n<li>系统：Ubuntu 16.04 amd64</li>\n<li>版本：matlab R2017b glnxa64</li>\n</ul>\n<h2 id=\"2-2-基础准备\"><a href=\"#2-2-基础准备\" class=\"headerlink\" title=\"2.2 基础准备\"></a>2.2 基础准备</h2><ul>\n<li>软件iso镜像文件和破解文件，关注“MakerGYT”公众号回复matlab-linux</li>\n</ul>\n<h2 id=\"2-3-开始\"><a href=\"#2-3-开始\" class=\"headerlink\" title=\"2.3 开始\"></a>2.3 开始</h2><p>下载文件后，你将获得如下文件，<strong>注意</strong>，命令中所有<code>makergyt</code>替换为你的用户名<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">-|matlab</span><br><span class=\"line\">---|R2017b_glnxa64_dvd1.iso #这是镜像1</span><br><span class=\"line\">---|R2017b_glnxa64_dvd2.iso #这是镜像2</span><br><span class=\"line\">---|crack</span><br><span class=\"line\">-----|libmwservices.so #这是替换文件</span><br><span class=\"line\">-----|license_key.txt #这是激活密钥</span><br><span class=\"line\">-----|license_standalone.lic #这是离线激活认证文件</span><br></pre></td></tr></table></figure></p>\n<h3 id=\"2-3-1-创建镜像目录\"><a href=\"#2-3-1-创建镜像目录\" class=\"headerlink\" title=\"2.3.1 创建镜像目录\"></a>2.3.1 创建镜像目录</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ sudo mkdir /media/matlab</span><br></pre></td></tr></table></figure>\n<h3 id=\"2-3-2-加载镜像1\"><a href=\"#2-3-2-加载镜像1\" class=\"headerlink\" title=\"2.3.2 加载镜像1\"></a>2.3.2 加载镜像1</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ sudo mount -o loop R2017b_glnxa64_dvd1.iso /media/matlab/</span><br><span class=\"line\">$ cd /media/matlab</span><br><span class=\"line\">$ cd ..</span><br></pre></td></tr></table></figure>\n<p>安装<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ sudo /media/matlab/install</span><br><span class=\"line\">$ sudo mount -o loop R2017b_glnxa64_dvd2.iso /media/matlab/</span><br><span class=\"line\">$ cd /home/Matlab/bin/</span><br><span class=\"line\">$ ./matlab</span><br><span class=\"line\">$ cd~</span><br></pre></td></tr></table></figure></p>\n<h3 id=\"2-3-3-加载镜像2\"><a href=\"#2-3-3-加载镜像2\" class=\"headerlink\" title=\"2.3.3 加载镜像2\"></a>2.3.3 加载镜像2</h3><p>在安装到80%左右时会提示<code>请插入DVD2</code>,这时先将刚才加载的虚拟光驱卸载（右键弹出），然后以同样方式加载镜像2到虚拟光驱。回到安装界面，点击确定，继续执行安装。</p>\n<h3 id=\"2-3-4-激活文件\"><a href=\"#2-3-4-激活文件\" class=\"headerlink\" title=\"2.3.4 激活文件\"></a>2.3.4 激活文件</h3><p>安装完成后运行matlab，进入激活界面，选择离线激活，将激活认证文件导入，确定，激活完成。</p>\n<h3 id=\"2-3-5-覆盖替换\"><a href=\"#2-3-5-覆盖替换\" class=\"headerlink\" title=\"2.3.5 覆盖替换\"></a>2.3.5 覆盖替换</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ sudo chmod -R 777 Matlab/</span><br><span class=\"line\">$ cd crack</span><br><span class=\"line\">$ sudo cp libmwservices.so /home/Matlab/bin/glnxa64/</span><br><span class=\"line\">$ cd ../</span><br><span class=\"line\">$ ./matlab</span><br></pre></td></tr></table></figure>\n<h3 id=\"2-3-6-卸载镜像\"><a href=\"#2-3-6-卸载镜像\" class=\"headerlink\" title=\"2.3.6 卸载镜像\"></a>2.3.6 卸载镜像</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ sudo umount /media/matlab</span><br></pre></td></tr></table></figure>\n<h3 id=\"2-3-7-语言切换\"><a href=\"#2-3-7-语言切换\" class=\"headerlink\" title=\"2.3.7 语言切换\"></a>2.3.7 语言切换</h3><p>默认是半中文界面，可在预设-&gt;常规-&gt;桌面语言中修改</p>\n<h3 id=\"2-3-8-快捷方式\"><a href=\"#2-3-8-快捷方式\" class=\"headerlink\" title=\"2.3.8 快捷方式\"></a>2.3.8 快捷方式</h3><p>在<code>/home/Desktop</code>新建一个文件<br><figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[Desktop Entry]</span><br><span class=\"line\">Encoding=UTF<span class=\"number\">-8</span></span><br><span class=\"line\">Name=Matlab_2017b</span><br><span class=\"line\">Comment=MATLAB</span><br><span class=\"line\">Exec=/home/makergyt/Matlab/bin/matlab</span><br><span class=\"line\">Icon=/home/makergyt/Matlab/bin/glnxa64/cef_resources/matlab_icon.png</span><br><span class=\"line\">StartupNotify=<span class=\"literal\">true</span></span><br><span class=\"line\">Type=Application</span><br><span class=\"line\">Categories=Application;</span><br></pre></td></tr></table></figure></p>\n<p>在文件属性中permissions-&gt;Allow</p>\n<p>获取软件包公众号回复<code>matlab-win</code>/<code>matlab-linux</code></p>"},{"title":"安装pthreads多线程扩展记录","date":"2017-11-16T11:37:04.000Z","_content":"# 1 当前环境\n+ WampServer Version 3.1.0 64bit\n+ PHP 5.6.31\n+ windows 10 pro 1703\n+ [pthreads-2.0.9-5.6-ts-vc11-x64](http://windows.php.net/downloads/pecl/releases/pthreads/2.0.9/)\n5.6对应php version,vc11代表是Visual Studio 2010 compiler编译器编译的(暂无需考虑)，x64代表wamp平台。\n\n<!-- more -->\n# 2 安装\n只用到下载包内的**pthreadVC2.dll**和**php_pthreads.dll**\n## 2.1 修改php.ini\n```js\n// php.ini\nextension=php_pthreads.dll //加在最后一行\n```\n## 2.2 复制pthreadVC2.dll到*%wamp%\\bin\\php\\\\%php5.6.31%*和*%wamp%\\bin\\apache\\%apache2.4.27*\n%wamp%为WampServer安装路径，%php5.6.31%为对应的php版本路径,%apache2.4.27%为对应的apache版本路径\n## 2.3 复制php_pthreads.dll到`%wamp%\\bin\\php\\\\bin\\php\\%php5.6.31%\\ext`,\n%wamp%为WampServer安装路径，%php5.6.31%为对应的php版本路径。\n## 2.4 重启wamp所有服务。\n\n# 3 测试\n\n```php\n// AsyncOperation.php\n<?php \nclass AsyncOperation extends Thread { \n  public function __construct($arg){ \n    $this->arg = $arg; \n  } \n  \n  public function run(){ \n    if($this->arg){ \n      printf(\"Hello %s\\n\", $this->arg); \n    } \n  } \n} \n$thread = new AsyncOperation(\"World\"); \nif($thread->start()) \n  $thread->join(); \n?> \nphp AsyncOperation.php\nHelloWorld #则配置成功\n```\n# 4 实验\n+ 目的：检测多线程和普通方式的时间消耗\n+ 例程：for循环爬取百度\n\n```php\n<?php  \n  class test_thread_run extends Thread   \n  {  \n      public $url;  \n      public $data;  \n  \n      public function __construct($url)  \n      {  \n          $this->url = $url;  \n      }  \n  \n      public function run()  \n      {  \n          if(($url = $this->url))  \n          {  \n              $this->data = model_http_curl_get($url);  \n          }  \n      }  \n  }  \n  \n  function model_thread_result_get($urls_array)   \n  {  \n      foreach ($urls_array as $key => $value)   \n      {  \n          $thread_array[$key] = new test_thread_run($value[\"url\"]);  \n          $thread_array[$key]->start();  \n      }  \n  \n      foreach ($thread_array as $thread_array_key => $thread_array_value)   \n      {  \n          while($thread_array[$thread_array_key]->isRunning())  \n          {  \n              usleep(10);  \n          }  \n          if($thread_array[$thread_array_key]->join())  \n          {  \n              $variable_data[$thread_array_key] = $thread_array[$thread_array_key]->data;  \n          }  \n      }  \n      return $variable_data;  \n  }  \n  \n  function model_http_curl_get($url,$userAgent=\"\")   \n  {  \n      $userAgent = $userAgent ? $userAgent : 'Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.2)';   \n      $curl = curl_init();  \n      curl_setopt($curl, CURLOPT_URL, $url);  \n      curl_setopt($curl, CURLOPT_RETURNTRANSFER, 1);  \n      curl_setopt($curl, CURLOPT_TIMEOUT, 5);  \n      curl_setopt($curl, CURLOPT_USERAGENT, $userAgent);  \n      $result = curl_exec($curl);  \n      curl_close($curl);  \n      return $result;  \n  }  \n  \n  for ($i=0; $i < 10; $i++)   \n  {   \n      $urls_array[] = array(\"name\" => \"baidu\", \"url\" => \"http://www.baidu.com/s?wd=\".mt_rand(10000,20000));  \n  }  \n  \n  $t = microtime(true);  \n  $result = model_thread_result_get($urls_array);  \n  $e = microtime(true);  \n  echo \"多线程：\".($e-$t).\"\\n\";  \n  \n  $t = microtime(true);  \n  foreach ($urls_array as $key => $value)   \n  {  \n      $result_new[$key] = model_http_curl_get($value[\"url\"]);  \n  }  \n  $e = microtime(true);  \n  echo \"For循环：\".($e-$t).\"\\n\";  \n?>\n```\n输出\n```sh\n多线程：5.1022920608521 For循环：20.272159099579 #具体时间不一定相同\n```","source":"_posts/zh-CN/安装pthreads多线程扩展记录.md","raw":"---\ntitle: 安装pthreads多线程扩展记录\ndate: 2017-11-16 19:37:04\ntags:\n  - php\ncategories: record\n---\n# 1 当前环境\n+ WampServer Version 3.1.0 64bit\n+ PHP 5.6.31\n+ windows 10 pro 1703\n+ [pthreads-2.0.9-5.6-ts-vc11-x64](http://windows.php.net/downloads/pecl/releases/pthreads/2.0.9/)\n5.6对应php version,vc11代表是Visual Studio 2010 compiler编译器编译的(暂无需考虑)，x64代表wamp平台。\n\n<!-- more -->\n# 2 安装\n只用到下载包内的**pthreadVC2.dll**和**php_pthreads.dll**\n## 2.1 修改php.ini\n```js\n// php.ini\nextension=php_pthreads.dll //加在最后一行\n```\n## 2.2 复制pthreadVC2.dll到*%wamp%\\bin\\php\\\\%php5.6.31%*和*%wamp%\\bin\\apache\\%apache2.4.27*\n%wamp%为WampServer安装路径，%php5.6.31%为对应的php版本路径,%apache2.4.27%为对应的apache版本路径\n## 2.3 复制php_pthreads.dll到`%wamp%\\bin\\php\\\\bin\\php\\%php5.6.31%\\ext`,\n%wamp%为WampServer安装路径，%php5.6.31%为对应的php版本路径。\n## 2.4 重启wamp所有服务。\n\n# 3 测试\n\n```php\n// AsyncOperation.php\n<?php \nclass AsyncOperation extends Thread { \n  public function __construct($arg){ \n    $this->arg = $arg; \n  } \n  \n  public function run(){ \n    if($this->arg){ \n      printf(\"Hello %s\\n\", $this->arg); \n    } \n  } \n} \n$thread = new AsyncOperation(\"World\"); \nif($thread->start()) \n  $thread->join(); \n?> \nphp AsyncOperation.php\nHelloWorld #则配置成功\n```\n# 4 实验\n+ 目的：检测多线程和普通方式的时间消耗\n+ 例程：for循环爬取百度\n\n```php\n<?php  \n  class test_thread_run extends Thread   \n  {  \n      public $url;  \n      public $data;  \n  \n      public function __construct($url)  \n      {  \n          $this->url = $url;  \n      }  \n  \n      public function run()  \n      {  \n          if(($url = $this->url))  \n          {  \n              $this->data = model_http_curl_get($url);  \n          }  \n      }  \n  }  \n  \n  function model_thread_result_get($urls_array)   \n  {  \n      foreach ($urls_array as $key => $value)   \n      {  \n          $thread_array[$key] = new test_thread_run($value[\"url\"]);  \n          $thread_array[$key]->start();  \n      }  \n  \n      foreach ($thread_array as $thread_array_key => $thread_array_value)   \n      {  \n          while($thread_array[$thread_array_key]->isRunning())  \n          {  \n              usleep(10);  \n          }  \n          if($thread_array[$thread_array_key]->join())  \n          {  \n              $variable_data[$thread_array_key] = $thread_array[$thread_array_key]->data;  \n          }  \n      }  \n      return $variable_data;  \n  }  \n  \n  function model_http_curl_get($url,$userAgent=\"\")   \n  {  \n      $userAgent = $userAgent ? $userAgent : 'Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.2)';   \n      $curl = curl_init();  \n      curl_setopt($curl, CURLOPT_URL, $url);  \n      curl_setopt($curl, CURLOPT_RETURNTRANSFER, 1);  \n      curl_setopt($curl, CURLOPT_TIMEOUT, 5);  \n      curl_setopt($curl, CURLOPT_USERAGENT, $userAgent);  \n      $result = curl_exec($curl);  \n      curl_close($curl);  \n      return $result;  \n  }  \n  \n  for ($i=0; $i < 10; $i++)   \n  {   \n      $urls_array[] = array(\"name\" => \"baidu\", \"url\" => \"http://www.baidu.com/s?wd=\".mt_rand(10000,20000));  \n  }  \n  \n  $t = microtime(true);  \n  $result = model_thread_result_get($urls_array);  \n  $e = microtime(true);  \n  echo \"多线程：\".($e-$t).\"\\n\";  \n  \n  $t = microtime(true);  \n  foreach ($urls_array as $key => $value)   \n  {  \n      $result_new[$key] = model_http_curl_get($value[\"url\"]);  \n  }  \n  $e = microtime(true);  \n  echo \"For循环：\".($e-$t).\"\\n\";  \n?>\n```\n输出\n```sh\n多线程：5.1022920608521 For循环：20.272159099579 #具体时间不一定相同\n```","slug":"安装pthreads多线程扩展记录","published":1,"lang":"zh-CN","updated":"2019-04-29T01:07:50.660Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjvnq7zak001w7jjx73yz3kmh","content":"<link rel=\"stylesheet\" class=\"aplayer-secondary-style-marker\" href=\"/assets/css/APlayer.min.css\"><script src=\"/assets/js/APlayer.min.js\" class=\"aplayer-secondary-script-marker\"></script><script class=\"meting-secondary-script-marker\" src=\"/assets/js/Meting.min.js\"></script><link rel=\"stylesheet\" type=\"text/css\" href=\"https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css\"><h1 id=\"1-当前环境\"><a href=\"#1-当前环境\" class=\"headerlink\" title=\"1 当前环境\"></a>1 当前环境</h1><ul>\n<li>WampServer Version 3.1.0 64bit</li>\n<li>PHP 5.6.31</li>\n<li>windows 10 pro 1703</li>\n<li><a href=\"http://windows.php.net/downloads/pecl/releases/pthreads/2.0.9/\" target=\"_blank\" rel=\"noopener\">pthreads-2.0.9-5.6-ts-vc11-x64</a><br>5.6对应php version,vc11代表是Visual Studio 2010 compiler编译器编译的(暂无需考虑)，x64代表wamp平台。</li>\n</ul>\n<a id=\"more\"></a>\n<h1 id=\"2-安装\"><a href=\"#2-安装\" class=\"headerlink\" title=\"2 安装\"></a>2 安装</h1><p>只用到下载包内的<strong>pthreadVC2.dll</strong>和<strong>php_pthreads.dll</strong></p>\n<h2 id=\"2-1-修改php-ini\"><a href=\"#2-1-修改php-ini\" class=\"headerlink\" title=\"2.1 修改php.ini\"></a>2.1 修改php.ini</h2><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// php.ini</span></span><br><span class=\"line\">extension=php_pthreads.dll <span class=\"comment\">//加在最后一行</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"2-2-复制pthreadVC2-dll到-wamp-bin-php-php5-6-31-和-wamp-bin-apache-apache2-4-27\"><a href=\"#2-2-复制pthreadVC2-dll到-wamp-bin-php-php5-6-31-和-wamp-bin-apache-apache2-4-27\" class=\"headerlink\" title=\"2.2 复制pthreadVC2.dll到%wamp%\\bin\\php\\%php5.6.31%和%wamp%\\bin\\apache\\%apache2.4.27\"></a>2.2 复制pthreadVC2.dll到<em>%wamp%\\bin\\php\\%php5.6.31%</em>和<em>%wamp%\\bin\\apache\\%apache2.4.27</em></h2><p>%wamp%为WampServer安装路径，%php5.6.31%为对应的php版本路径,%apache2.4.27%为对应的apache版本路径</p>\n<h2 id=\"2-3-复制php-pthreads-dll到-wamp-bin-php-bin-php-php5-6-31-ext\"><a href=\"#2-3-复制php-pthreads-dll到-wamp-bin-php-bin-php-php5-6-31-ext\" class=\"headerlink\" title=\"2.3 复制php_pthreads.dll到%wamp%\\bin\\php\\\\bin\\php\\%php5.6.31%\\ext,\"></a>2.3 复制php_pthreads.dll到<code>%wamp%\\bin\\php\\\\bin\\php\\%php5.6.31%\\ext</code>,</h2><p>%wamp%为WampServer安装路径，%php5.6.31%为对应的php版本路径。</p>\n<h2 id=\"2-4-重启wamp所有服务。\"><a href=\"#2-4-重启wamp所有服务。\" class=\"headerlink\" title=\"2.4 重启wamp所有服务。\"></a>2.4 重启wamp所有服务。</h2><h1 id=\"3-测试\"><a href=\"#3-测试\" class=\"headerlink\" title=\"3 测试\"></a>3 测试</h1><figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// AsyncOperation.php</span></span><br><span class=\"line\"><span class=\"meta\">&lt;?php</span> </span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">AsyncOperation</span> <span class=\"keyword\">extends</span> <span class=\"title\">Thread</span> </span>&#123; </span><br><span class=\"line\">  <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__construct</span><span class=\"params\">($arg)</span></span>&#123; </span><br><span class=\"line\">    <span class=\"keyword\">$this</span>-&gt;arg = $arg; </span><br><span class=\"line\">  &#125; </span><br><span class=\"line\">  </span><br><span class=\"line\">  <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">run</span><span class=\"params\">()</span></span>&#123; </span><br><span class=\"line\">    <span class=\"keyword\">if</span>(<span class=\"keyword\">$this</span>-&gt;arg)&#123; </span><br><span class=\"line\">      printf(<span class=\"string\">\"Hello %s\\n\"</span>, <span class=\"keyword\">$this</span>-&gt;arg); </span><br><span class=\"line\">    &#125; </span><br><span class=\"line\">  &#125; </span><br><span class=\"line\">&#125; </span><br><span class=\"line\">$thread = <span class=\"keyword\">new</span> AsyncOperation(<span class=\"string\">\"World\"</span>); </span><br><span class=\"line\"><span class=\"keyword\">if</span>($thread-&gt;start()) </span><br><span class=\"line\">  $thread-&gt;join(); </span><br><span class=\"line\"><span class=\"meta\">?&gt;</span> </span><br><span class=\"line\">php AsyncOperation.php</span><br><span class=\"line\">HelloWorld <span class=\"comment\">#则配置成功</span></span><br></pre></td></tr></table></figure>\n<h1 id=\"4-实验\"><a href=\"#4-实验\" class=\"headerlink\" title=\"4 实验\"></a>4 实验</h1><ul>\n<li>目的：检测多线程和普通方式的时间消耗</li>\n<li>例程：for循环爬取百度</li>\n</ul>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span>  </span><br><span class=\"line\">  <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">test_thread_run</span> <span class=\"keyword\">extends</span> <span class=\"title\">Thread</span>   </span></span><br><span class=\"line\"><span class=\"class\">  </span>&#123;  </span><br><span class=\"line\">      <span class=\"keyword\">public</span> $url;  </span><br><span class=\"line\">      <span class=\"keyword\">public</span> $data;  </span><br><span class=\"line\">  </span><br><span class=\"line\">      <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__construct</span><span class=\"params\">($url)</span>  </span></span><br><span class=\"line\"><span class=\"function\">      </span>&#123;  </span><br><span class=\"line\">          <span class=\"keyword\">$this</span>-&gt;url = $url;  </span><br><span class=\"line\">      &#125;  </span><br><span class=\"line\">  </span><br><span class=\"line\">      <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">run</span><span class=\"params\">()</span>  </span></span><br><span class=\"line\"><span class=\"function\">      </span>&#123;  </span><br><span class=\"line\">          <span class=\"keyword\">if</span>(($url = <span class=\"keyword\">$this</span>-&gt;url))  </span><br><span class=\"line\">          &#123;  </span><br><span class=\"line\">              <span class=\"keyword\">$this</span>-&gt;data = model_http_curl_get($url);  </span><br><span class=\"line\">          &#125;  </span><br><span class=\"line\">      &#125;  </span><br><span class=\"line\">  &#125;  </span><br><span class=\"line\">  </span><br><span class=\"line\">  <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">model_thread_result_get</span><span class=\"params\">($urls_array)</span>   </span></span><br><span class=\"line\"><span class=\"function\">  </span>&#123;  </span><br><span class=\"line\">      <span class=\"keyword\">foreach</span> ($urls_array <span class=\"keyword\">as</span> $key =&gt; $value)   </span><br><span class=\"line\">      &#123;  </span><br><span class=\"line\">          $thread_array[$key] = <span class=\"keyword\">new</span> test_thread_run($value[<span class=\"string\">\"url\"</span>]);  </span><br><span class=\"line\">          $thread_array[$key]-&gt;start();  </span><br><span class=\"line\">      &#125;  </span><br><span class=\"line\">  </span><br><span class=\"line\">      <span class=\"keyword\">foreach</span> ($thread_array <span class=\"keyword\">as</span> $thread_array_key =&gt; $thread_array_value)   </span><br><span class=\"line\">      &#123;  </span><br><span class=\"line\">          <span class=\"keyword\">while</span>($thread_array[$thread_array_key]-&gt;isRunning())  </span><br><span class=\"line\">          &#123;  </span><br><span class=\"line\">              usleep(<span class=\"number\">10</span>);  </span><br><span class=\"line\">          &#125;  </span><br><span class=\"line\">          <span class=\"keyword\">if</span>($thread_array[$thread_array_key]-&gt;join())  </span><br><span class=\"line\">          &#123;  </span><br><span class=\"line\">              $variable_data[$thread_array_key] = $thread_array[$thread_array_key]-&gt;data;  </span><br><span class=\"line\">          &#125;  </span><br><span class=\"line\">      &#125;  </span><br><span class=\"line\">      <span class=\"keyword\">return</span> $variable_data;  </span><br><span class=\"line\">  &#125;  </span><br><span class=\"line\">  </span><br><span class=\"line\">  <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">model_http_curl_get</span><span class=\"params\">($url,$userAgent=<span class=\"string\">\"\"</span>)</span>   </span></span><br><span class=\"line\"><span class=\"function\">  </span>&#123;  </span><br><span class=\"line\">      $userAgent = $userAgent ? $userAgent : <span class=\"string\">'Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.2)'</span>;   </span><br><span class=\"line\">      $curl = curl_init();  </span><br><span class=\"line\">      curl_setopt($curl, CURLOPT_URL, $url);  </span><br><span class=\"line\">      curl_setopt($curl, CURLOPT_RETURNTRANSFER, <span class=\"number\">1</span>);  </span><br><span class=\"line\">      curl_setopt($curl, CURLOPT_TIMEOUT, <span class=\"number\">5</span>);  </span><br><span class=\"line\">      curl_setopt($curl, CURLOPT_USERAGENT, $userAgent);  </span><br><span class=\"line\">      $result = curl_exec($curl);  </span><br><span class=\"line\">      curl_close($curl);  </span><br><span class=\"line\">      <span class=\"keyword\">return</span> $result;  </span><br><span class=\"line\">  &#125;  </span><br><span class=\"line\">  </span><br><span class=\"line\">  <span class=\"keyword\">for</span> ($i=<span class=\"number\">0</span>; $i &lt; <span class=\"number\">10</span>; $i++)   </span><br><span class=\"line\">  &#123;   </span><br><span class=\"line\">      $urls_array[] = <span class=\"keyword\">array</span>(<span class=\"string\">\"name\"</span> =&gt; <span class=\"string\">\"baidu\"</span>, <span class=\"string\">\"url\"</span> =&gt; <span class=\"string\">\"http://www.baidu.com/s?wd=\"</span>.mt_rand(<span class=\"number\">10000</span>,<span class=\"number\">20000</span>));  </span><br><span class=\"line\">  &#125;  </span><br><span class=\"line\">  </span><br><span class=\"line\">  $t = microtime(<span class=\"keyword\">true</span>);  </span><br><span class=\"line\">  $result = model_thread_result_get($urls_array);  </span><br><span class=\"line\">  $e = microtime(<span class=\"keyword\">true</span>);  </span><br><span class=\"line\">  <span class=\"keyword\">echo</span> <span class=\"string\">\"多线程：\"</span>.($e-$t).<span class=\"string\">\"\\n\"</span>;  </span><br><span class=\"line\">  </span><br><span class=\"line\">  $t = microtime(<span class=\"keyword\">true</span>);  </span><br><span class=\"line\">  <span class=\"keyword\">foreach</span> ($urls_array <span class=\"keyword\">as</span> $key =&gt; $value)   </span><br><span class=\"line\">  &#123;  </span><br><span class=\"line\">      $result_new[$key] = model_http_curl_get($value[<span class=\"string\">\"url\"</span>]);  </span><br><span class=\"line\">  &#125;  </span><br><span class=\"line\">  $e = microtime(<span class=\"keyword\">true</span>);  </span><br><span class=\"line\">  <span class=\"keyword\">echo</span> <span class=\"string\">\"For循环：\"</span>.($e-$t).<span class=\"string\">\"\\n\"</span>;  </span><br><span class=\"line\"><span class=\"meta\">?&gt;</span></span><br></pre></td></tr></table></figure>\n<p>输出<br><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">多线程：5.1022920608521 For循环：20.272159099579 <span class=\"comment\">#具体时间不一定相同</span></span><br></pre></td></tr></table></figure></p>\n","site":{"data":{}},"excerpt":"<h1 id=\"1-当前环境\"><a href=\"#1-当前环境\" class=\"headerlink\" title=\"1 当前环境\"></a>1 当前环境</h1><ul>\n<li>WampServer Version 3.1.0 64bit</li>\n<li>PHP 5.6.31</li>\n<li>windows 10 pro 1703</li>\n<li><a href=\"http://windows.php.net/downloads/pecl/releases/pthreads/2.0.9/\" target=\"_blank\" rel=\"noopener\">pthreads-2.0.9-5.6-ts-vc11-x64</a><br>5.6对应php version,vc11代表是Visual Studio 2010 compiler编译器编译的(暂无需考虑)，x64代表wamp平台。</li>\n</ul>","more":"<h1 id=\"2-安装\"><a href=\"#2-安装\" class=\"headerlink\" title=\"2 安装\"></a>2 安装</h1><p>只用到下载包内的<strong>pthreadVC2.dll</strong>和<strong>php_pthreads.dll</strong></p>\n<h2 id=\"2-1-修改php-ini\"><a href=\"#2-1-修改php-ini\" class=\"headerlink\" title=\"2.1 修改php.ini\"></a>2.1 修改php.ini</h2><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// php.ini</span></span><br><span class=\"line\">extension=php_pthreads.dll <span class=\"comment\">//加在最后一行</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"2-2-复制pthreadVC2-dll到-wamp-bin-php-php5-6-31-和-wamp-bin-apache-apache2-4-27\"><a href=\"#2-2-复制pthreadVC2-dll到-wamp-bin-php-php5-6-31-和-wamp-bin-apache-apache2-4-27\" class=\"headerlink\" title=\"2.2 复制pthreadVC2.dll到%wamp%\\bin\\php\\%php5.6.31%和%wamp%\\bin\\apache\\%apache2.4.27\"></a>2.2 复制pthreadVC2.dll到<em>%wamp%\\bin\\php\\%php5.6.31%</em>和<em>%wamp%\\bin\\apache\\%apache2.4.27</em></h2><p>%wamp%为WampServer安装路径，%php5.6.31%为对应的php版本路径,%apache2.4.27%为对应的apache版本路径</p>\n<h2 id=\"2-3-复制php-pthreads-dll到-wamp-bin-php-bin-php-php5-6-31-ext\"><a href=\"#2-3-复制php-pthreads-dll到-wamp-bin-php-bin-php-php5-6-31-ext\" class=\"headerlink\" title=\"2.3 复制php_pthreads.dll到%wamp%\\bin\\php\\\\bin\\php\\%php5.6.31%\\ext,\"></a>2.3 复制php_pthreads.dll到<code>%wamp%\\bin\\php\\\\bin\\php\\%php5.6.31%\\ext</code>,</h2><p>%wamp%为WampServer安装路径，%php5.6.31%为对应的php版本路径。</p>\n<h2 id=\"2-4-重启wamp所有服务。\"><a href=\"#2-4-重启wamp所有服务。\" class=\"headerlink\" title=\"2.4 重启wamp所有服务。\"></a>2.4 重启wamp所有服务。</h2><h1 id=\"3-测试\"><a href=\"#3-测试\" class=\"headerlink\" title=\"3 测试\"></a>3 测试</h1><figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// AsyncOperation.php</span></span><br><span class=\"line\"><span class=\"meta\">&lt;?php</span> </span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">AsyncOperation</span> <span class=\"keyword\">extends</span> <span class=\"title\">Thread</span> </span>&#123; </span><br><span class=\"line\">  <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__construct</span><span class=\"params\">($arg)</span></span>&#123; </span><br><span class=\"line\">    <span class=\"keyword\">$this</span>-&gt;arg = $arg; </span><br><span class=\"line\">  &#125; </span><br><span class=\"line\">  </span><br><span class=\"line\">  <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">run</span><span class=\"params\">()</span></span>&#123; </span><br><span class=\"line\">    <span class=\"keyword\">if</span>(<span class=\"keyword\">$this</span>-&gt;arg)&#123; </span><br><span class=\"line\">      printf(<span class=\"string\">\"Hello %s\\n\"</span>, <span class=\"keyword\">$this</span>-&gt;arg); </span><br><span class=\"line\">    &#125; </span><br><span class=\"line\">  &#125; </span><br><span class=\"line\">&#125; </span><br><span class=\"line\">$thread = <span class=\"keyword\">new</span> AsyncOperation(<span class=\"string\">\"World\"</span>); </span><br><span class=\"line\"><span class=\"keyword\">if</span>($thread-&gt;start()) </span><br><span class=\"line\">  $thread-&gt;join(); </span><br><span class=\"line\"><span class=\"meta\">?&gt;</span> </span><br><span class=\"line\">php AsyncOperation.php</span><br><span class=\"line\">HelloWorld <span class=\"comment\">#则配置成功</span></span><br></pre></td></tr></table></figure>\n<h1 id=\"4-实验\"><a href=\"#4-实验\" class=\"headerlink\" title=\"4 实验\"></a>4 实验</h1><ul>\n<li>目的：检测多线程和普通方式的时间消耗</li>\n<li>例程：for循环爬取百度</li>\n</ul>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span>  </span><br><span class=\"line\">  <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">test_thread_run</span> <span class=\"keyword\">extends</span> <span class=\"title\">Thread</span>   </span></span><br><span class=\"line\"><span class=\"class\">  </span>&#123;  </span><br><span class=\"line\">      <span class=\"keyword\">public</span> $url;  </span><br><span class=\"line\">      <span class=\"keyword\">public</span> $data;  </span><br><span class=\"line\">  </span><br><span class=\"line\">      <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__construct</span><span class=\"params\">($url)</span>  </span></span><br><span class=\"line\"><span class=\"function\">      </span>&#123;  </span><br><span class=\"line\">          <span class=\"keyword\">$this</span>-&gt;url = $url;  </span><br><span class=\"line\">      &#125;  </span><br><span class=\"line\">  </span><br><span class=\"line\">      <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">run</span><span class=\"params\">()</span>  </span></span><br><span class=\"line\"><span class=\"function\">      </span>&#123;  </span><br><span class=\"line\">          <span class=\"keyword\">if</span>(($url = <span class=\"keyword\">$this</span>-&gt;url))  </span><br><span class=\"line\">          &#123;  </span><br><span class=\"line\">              <span class=\"keyword\">$this</span>-&gt;data = model_http_curl_get($url);  </span><br><span class=\"line\">          &#125;  </span><br><span class=\"line\">      &#125;  </span><br><span class=\"line\">  &#125;  </span><br><span class=\"line\">  </span><br><span class=\"line\">  <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">model_thread_result_get</span><span class=\"params\">($urls_array)</span>   </span></span><br><span class=\"line\"><span class=\"function\">  </span>&#123;  </span><br><span class=\"line\">      <span class=\"keyword\">foreach</span> ($urls_array <span class=\"keyword\">as</span> $key =&gt; $value)   </span><br><span class=\"line\">      &#123;  </span><br><span class=\"line\">          $thread_array[$key] = <span class=\"keyword\">new</span> test_thread_run($value[<span class=\"string\">\"url\"</span>]);  </span><br><span class=\"line\">          $thread_array[$key]-&gt;start();  </span><br><span class=\"line\">      &#125;  </span><br><span class=\"line\">  </span><br><span class=\"line\">      <span class=\"keyword\">foreach</span> ($thread_array <span class=\"keyword\">as</span> $thread_array_key =&gt; $thread_array_value)   </span><br><span class=\"line\">      &#123;  </span><br><span class=\"line\">          <span class=\"keyword\">while</span>($thread_array[$thread_array_key]-&gt;isRunning())  </span><br><span class=\"line\">          &#123;  </span><br><span class=\"line\">              usleep(<span class=\"number\">10</span>);  </span><br><span class=\"line\">          &#125;  </span><br><span class=\"line\">          <span class=\"keyword\">if</span>($thread_array[$thread_array_key]-&gt;join())  </span><br><span class=\"line\">          &#123;  </span><br><span class=\"line\">              $variable_data[$thread_array_key] = $thread_array[$thread_array_key]-&gt;data;  </span><br><span class=\"line\">          &#125;  </span><br><span class=\"line\">      &#125;  </span><br><span class=\"line\">      <span class=\"keyword\">return</span> $variable_data;  </span><br><span class=\"line\">  &#125;  </span><br><span class=\"line\">  </span><br><span class=\"line\">  <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">model_http_curl_get</span><span class=\"params\">($url,$userAgent=<span class=\"string\">\"\"</span>)</span>   </span></span><br><span class=\"line\"><span class=\"function\">  </span>&#123;  </span><br><span class=\"line\">      $userAgent = $userAgent ? $userAgent : <span class=\"string\">'Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.2)'</span>;   </span><br><span class=\"line\">      $curl = curl_init();  </span><br><span class=\"line\">      curl_setopt($curl, CURLOPT_URL, $url);  </span><br><span class=\"line\">      curl_setopt($curl, CURLOPT_RETURNTRANSFER, <span class=\"number\">1</span>);  </span><br><span class=\"line\">      curl_setopt($curl, CURLOPT_TIMEOUT, <span class=\"number\">5</span>);  </span><br><span class=\"line\">      curl_setopt($curl, CURLOPT_USERAGENT, $userAgent);  </span><br><span class=\"line\">      $result = curl_exec($curl);  </span><br><span class=\"line\">      curl_close($curl);  </span><br><span class=\"line\">      <span class=\"keyword\">return</span> $result;  </span><br><span class=\"line\">  &#125;  </span><br><span class=\"line\">  </span><br><span class=\"line\">  <span class=\"keyword\">for</span> ($i=<span class=\"number\">0</span>; $i &lt; <span class=\"number\">10</span>; $i++)   </span><br><span class=\"line\">  &#123;   </span><br><span class=\"line\">      $urls_array[] = <span class=\"keyword\">array</span>(<span class=\"string\">\"name\"</span> =&gt; <span class=\"string\">\"baidu\"</span>, <span class=\"string\">\"url\"</span> =&gt; <span class=\"string\">\"http://www.baidu.com/s?wd=\"</span>.mt_rand(<span class=\"number\">10000</span>,<span class=\"number\">20000</span>));  </span><br><span class=\"line\">  &#125;  </span><br><span class=\"line\">  </span><br><span class=\"line\">  $t = microtime(<span class=\"keyword\">true</span>);  </span><br><span class=\"line\">  $result = model_thread_result_get($urls_array);  </span><br><span class=\"line\">  $e = microtime(<span class=\"keyword\">true</span>);  </span><br><span class=\"line\">  <span class=\"keyword\">echo</span> <span class=\"string\">\"多线程：\"</span>.($e-$t).<span class=\"string\">\"\\n\"</span>;  </span><br><span class=\"line\">  </span><br><span class=\"line\">  $t = microtime(<span class=\"keyword\">true</span>);  </span><br><span class=\"line\">  <span class=\"keyword\">foreach</span> ($urls_array <span class=\"keyword\">as</span> $key =&gt; $value)   </span><br><span class=\"line\">  &#123;  </span><br><span class=\"line\">      $result_new[$key] = model_http_curl_get($value[<span class=\"string\">\"url\"</span>]);  </span><br><span class=\"line\">  &#125;  </span><br><span class=\"line\">  $e = microtime(<span class=\"keyword\">true</span>);  </span><br><span class=\"line\">  <span class=\"keyword\">echo</span> <span class=\"string\">\"For循环：\"</span>.($e-$t).<span class=\"string\">\"\\n\"</span>;  </span><br><span class=\"line\"><span class=\"meta\">?&gt;</span></span><br></pre></td></tr></table></figure>\n<p>输出<br><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">多线程：5.1022920608521 For循环：20.272159099579 <span class=\"comment\">#具体时间不一定相同</span></span><br></pre></td></tr></table></figure></p>"},{"title":"安装双系统记录","date":"2018-12-24T09:15:19.000Z","_content":"# 1 当前环境\n\n联想lenovo G50:4G+4G(自行扩展)内存，512G机械硬盘，128G SSD 64位i5CPU\n<!-- more -->\n# 2 使用工具：\n\n- 系统盘刻录：[rufus 3.2](http://rufus.akeo.ie/)(类似刻录工具有ultraiso，老毛桃、大白菜之类装机工具虽然集成度高，但比较笨重且不稳定，不便于引导启动系统)\n- U盘：8G USB2.0 （USB规格不影响，容量8G足够）\n- 分区：[Disk genius V4.9.6.564](http://www.diskgenius.cn/)\n- 激活工具：[MicroKMS_v18.08.09](http://www.yishimei123.com/network/319.html?=microKMS_17.06.25)（容易被windows defender识别为病毒并直接删除，需先关闭后下载，执行完后删除，恢复defender）\n\n# 3 系统版本\n\n- Windows 10 pro Version 1803(English)(目前最新稳定版，省去安装后不停更新)\n- Ubuntu 16.04.5 desktop amd64（目前最新版本为18.04，此版本稳定支持各类开源软件）\n\n# 4 安装模式\n\n先安装win到机械盘后安装ubuntu到固态（限于资源，权衡系统使用场景频率协调）\n\n# 5 详细记录\n\n## 5.1 安装windows\n\n### 5.1.1 准备：\n#### 5.1.1.0 分区\n原分区符合当前需求故不重新分，本次采用以下分区：\n\n+ system partition:`166G`\n+ data partition:`150G`\n+ software partition:`150G`\n\n#### 5.1.1.1 制作系统盘\n使用rufus刻录系统镜像文件\n[en_windows_10_consumer_editions_version_1803_updated_march_2018_x64_dvd_12063379](ed2k://|file|en_windows_10_consumer_editions_version_1803_updated_march_2018_x64_dvd_12063379.iso|4692365312|E991C13EC003F6C98C8A6BD4364F806F|/)，配置项默认：\n+ partition scheme:`GPT`\n+ target system:`UEFI`\n+ file system:`FAT32`\n\n### 5.1.2 安装\n#### 5.1.2.1 修改启动项\n重启F2进入BIOS，修改boot启动项，将USB DRIVE（根据名称大致判别引导U盘）修改为第一项（F5上移）,关闭安全启动和快速启动，os scheme 为others,save and quit\n\n#### 5.1.2.2 开始安装\n1. 按照guide，修改region和time and input,暂不输入序列号。\n2. 选择系统版本为windows pro x64,\n3. 进入磁盘选择后，delete原有系统引导启动分区，保证三个分区后分别format,选定size为166G的分区\n4. 安装完成后拔除U盘进入个性化设置，跳过联网\n5. 其余默认\n### 5.1.3 激活系统\n1. 连接网络\n2. 右下角进入windows defender,暂时关闭threat protection\n3. 使1用KMS一键激活，进入control panel->system，查看激活状态\n\n## 5.2 安装ubuntu\n### 5.2.1 准备：\n#### 5.2.1.0 分区\n通过Disk Genius将SSD格式化，4096k对齐，在windows里通过disk management将该磁盘卸载，保持为未挂载状态，稍后安装时再进行分区\n\n#### 5.2.1.1 制作系统盘\n使用rufus刻录系统镜像文件，\n[ubuntu-16.04.5-desktop-amd64.iso](http://releases.ubuntu.com/16.04/ubuntu-16.04.5-desktop-amd64.iso.torrent?_ga=2.90542874.18967268.1536736360-304383447.1536736360) 配置项默认\n### 5.2.2 安装\n#### 5.2.2.1 修改启动项\n重启F2进入BIOS，修改boot启动项，将USB DRIVE修改为第一项（F5上移）,关闭安全启动和快速启动，os scheme 为others,save and quit\n#### 5.2.2.2 开始安装\n进入界面后，选择install ubuntu,选择语言及输入法English，安装方式为something else,进入磁盘选择，先对SSD进行分区，选定sdb1中的free partition,+依此分区：\n+ / ：30G,primary,ext filesystem,begin\n+ swap:8G*2=16384MB,logical,\n+ boot:512MB,primary\n+ home:left space,logical\n\n选择启动位置为SSD对应的标称,结合容量大小，sdb1 120G\n根据引导执行后续步骤\n### 5.2.3 修改root密码\nsudo passwd\n试用su验证\n\n## 5.3 验证双系统可正确引导\n关机重启后可出现unity风格的系统选择界面，第一项为ubuntu，第三项为检测出的windows boot,分别尝试登陆","source":"_posts/zh-CN/安装双系统记录.md","raw":"---\ntitle: 安装双系统记录\ndate: 2018-12-24 17:15:19\ntags:\n\t- linux\ncategories: record\n---\n# 1 当前环境\n\n联想lenovo G50:4G+4G(自行扩展)内存，512G机械硬盘，128G SSD 64位i5CPU\n<!-- more -->\n# 2 使用工具：\n\n- 系统盘刻录：[rufus 3.2](http://rufus.akeo.ie/)(类似刻录工具有ultraiso，老毛桃、大白菜之类装机工具虽然集成度高，但比较笨重且不稳定，不便于引导启动系统)\n- U盘：8G USB2.0 （USB规格不影响，容量8G足够）\n- 分区：[Disk genius V4.9.6.564](http://www.diskgenius.cn/)\n- 激活工具：[MicroKMS_v18.08.09](http://www.yishimei123.com/network/319.html?=microKMS_17.06.25)（容易被windows defender识别为病毒并直接删除，需先关闭后下载，执行完后删除，恢复defender）\n\n# 3 系统版本\n\n- Windows 10 pro Version 1803(English)(目前最新稳定版，省去安装后不停更新)\n- Ubuntu 16.04.5 desktop amd64（目前最新版本为18.04，此版本稳定支持各类开源软件）\n\n# 4 安装模式\n\n先安装win到机械盘后安装ubuntu到固态（限于资源，权衡系统使用场景频率协调）\n\n# 5 详细记录\n\n## 5.1 安装windows\n\n### 5.1.1 准备：\n#### 5.1.1.0 分区\n原分区符合当前需求故不重新分，本次采用以下分区：\n\n+ system partition:`166G`\n+ data partition:`150G`\n+ software partition:`150G`\n\n#### 5.1.1.1 制作系统盘\n使用rufus刻录系统镜像文件\n[en_windows_10_consumer_editions_version_1803_updated_march_2018_x64_dvd_12063379](ed2k://|file|en_windows_10_consumer_editions_version_1803_updated_march_2018_x64_dvd_12063379.iso|4692365312|E991C13EC003F6C98C8A6BD4364F806F|/)，配置项默认：\n+ partition scheme:`GPT`\n+ target system:`UEFI`\n+ file system:`FAT32`\n\n### 5.1.2 安装\n#### 5.1.2.1 修改启动项\n重启F2进入BIOS，修改boot启动项，将USB DRIVE（根据名称大致判别引导U盘）修改为第一项（F5上移）,关闭安全启动和快速启动，os scheme 为others,save and quit\n\n#### 5.1.2.2 开始安装\n1. 按照guide，修改region和time and input,暂不输入序列号。\n2. 选择系统版本为windows pro x64,\n3. 进入磁盘选择后，delete原有系统引导启动分区，保证三个分区后分别format,选定size为166G的分区\n4. 安装完成后拔除U盘进入个性化设置，跳过联网\n5. 其余默认\n### 5.1.3 激活系统\n1. 连接网络\n2. 右下角进入windows defender,暂时关闭threat protection\n3. 使1用KMS一键激活，进入control panel->system，查看激活状态\n\n## 5.2 安装ubuntu\n### 5.2.1 准备：\n#### 5.2.1.0 分区\n通过Disk Genius将SSD格式化，4096k对齐，在windows里通过disk management将该磁盘卸载，保持为未挂载状态，稍后安装时再进行分区\n\n#### 5.2.1.1 制作系统盘\n使用rufus刻录系统镜像文件，\n[ubuntu-16.04.5-desktop-amd64.iso](http://releases.ubuntu.com/16.04/ubuntu-16.04.5-desktop-amd64.iso.torrent?_ga=2.90542874.18967268.1536736360-304383447.1536736360) 配置项默认\n### 5.2.2 安装\n#### 5.2.2.1 修改启动项\n重启F2进入BIOS，修改boot启动项，将USB DRIVE修改为第一项（F5上移）,关闭安全启动和快速启动，os scheme 为others,save and quit\n#### 5.2.2.2 开始安装\n进入界面后，选择install ubuntu,选择语言及输入法English，安装方式为something else,进入磁盘选择，先对SSD进行分区，选定sdb1中的free partition,+依此分区：\n+ / ：30G,primary,ext filesystem,begin\n+ swap:8G*2=16384MB,logical,\n+ boot:512MB,primary\n+ home:left space,logical\n\n选择启动位置为SSD对应的标称,结合容量大小，sdb1 120G\n根据引导执行后续步骤\n### 5.2.3 修改root密码\nsudo passwd\n试用su验证\n\n## 5.3 验证双系统可正确引导\n关机重启后可出现unity风格的系统选择界面，第一项为ubuntu，第三项为检测出的windows boot,分别尝试登陆","slug":"安装双系统记录","published":1,"lang":"zh-CN","updated":"2019-04-29T01:07:50.660Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjvnq7zal001y7jjxsghabvc6","content":"<link rel=\"stylesheet\" class=\"aplayer-secondary-style-marker\" href=\"/assets/css/APlayer.min.css\"><script src=\"/assets/js/APlayer.min.js\" class=\"aplayer-secondary-script-marker\"></script><script class=\"meting-secondary-script-marker\" src=\"/assets/js/Meting.min.js\"></script><link rel=\"stylesheet\" type=\"text/css\" href=\"https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css\"><h1 id=\"1-当前环境\"><a href=\"#1-当前环境\" class=\"headerlink\" title=\"1 当前环境\"></a>1 当前环境</h1><p>联想lenovo G50:4G+4G(自行扩展)内存，512G机械硬盘，128G SSD 64位i5CPU<br><a id=\"more\"></a></p>\n<h1 id=\"2-使用工具：\"><a href=\"#2-使用工具：\" class=\"headerlink\" title=\"2 使用工具：\"></a>2 使用工具：</h1><ul>\n<li>系统盘刻录：<a href=\"http://rufus.akeo.ie/\" target=\"_blank\" rel=\"noopener\">rufus 3.2</a>(类似刻录工具有ultraiso，老毛桃、大白菜之类装机工具虽然集成度高，但比较笨重且不稳定，不便于引导启动系统)</li>\n<li>U盘：8G USB2.0 （USB规格不影响，容量8G足够）</li>\n<li>分区：<a href=\"http://www.diskgenius.cn/\" target=\"_blank\" rel=\"noopener\">Disk genius V4.9.6.564</a></li>\n<li>激活工具：<a href=\"http://www.yishimei123.com/network/319.html?=microKMS_17.06.25\" target=\"_blank\" rel=\"noopener\">MicroKMS_v18.08.09</a>（容易被windows defender识别为病毒并直接删除，需先关闭后下载，执行完后删除，恢复defender）</li>\n</ul>\n<h1 id=\"3-系统版本\"><a href=\"#3-系统版本\" class=\"headerlink\" title=\"3 系统版本\"></a>3 系统版本</h1><ul>\n<li>Windows 10 pro Version 1803(English)(目前最新稳定版，省去安装后不停更新)</li>\n<li>Ubuntu 16.04.5 desktop amd64（目前最新版本为18.04，此版本稳定支持各类开源软件）</li>\n</ul>\n<h1 id=\"4-安装模式\"><a href=\"#4-安装模式\" class=\"headerlink\" title=\"4 安装模式\"></a>4 安装模式</h1><p>先安装win到机械盘后安装ubuntu到固态（限于资源，权衡系统使用场景频率协调）</p>\n<h1 id=\"5-详细记录\"><a href=\"#5-详细记录\" class=\"headerlink\" title=\"5 详细记录\"></a>5 详细记录</h1><h2 id=\"5-1-安装windows\"><a href=\"#5-1-安装windows\" class=\"headerlink\" title=\"5.1 安装windows\"></a>5.1 安装windows</h2><h3 id=\"5-1-1-准备：\"><a href=\"#5-1-1-准备：\" class=\"headerlink\" title=\"5.1.1 准备：\"></a>5.1.1 准备：</h3><h4 id=\"5-1-1-0-分区\"><a href=\"#5-1-1-0-分区\" class=\"headerlink\" title=\"5.1.1.0 分区\"></a>5.1.1.0 分区</h4><p>原分区符合当前需求故不重新分，本次采用以下分区：</p>\n<ul>\n<li>system partition:<code>166G</code></li>\n<li>data partition:<code>150G</code></li>\n<li>software partition:<code>150G</code></li>\n</ul>\n<h4 id=\"5-1-1-1-制作系统盘\"><a href=\"#5-1-1-1-制作系统盘\" class=\"headerlink\" title=\"5.1.1.1 制作系统盘\"></a>5.1.1.1 制作系统盘</h4><p>使用rufus刻录系统镜像文件<br><a href=\"ed2k://|file|en_windows_10_consumer_editions_version_1803_updated_march_2018_x64_dvd_12063379.iso|4692365312|E991C13EC003F6C98C8A6BD4364F806F|/\" target=\"_blank\" rel=\"noopener\">en_windows_10_consumer_editions_version_1803_updated_march_2018_x64_dvd_12063379</a>，配置项默认：</p>\n<ul>\n<li>partition scheme:<code>GPT</code></li>\n<li>target system:<code>UEFI</code></li>\n<li>file system:<code>FAT32</code></li>\n</ul>\n<h3 id=\"5-1-2-安装\"><a href=\"#5-1-2-安装\" class=\"headerlink\" title=\"5.1.2 安装\"></a>5.1.2 安装</h3><h4 id=\"5-1-2-1-修改启动项\"><a href=\"#5-1-2-1-修改启动项\" class=\"headerlink\" title=\"5.1.2.1 修改启动项\"></a>5.1.2.1 修改启动项</h4><p>重启F2进入BIOS，修改boot启动项，将USB DRIVE（根据名称大致判别引导U盘）修改为第一项（F5上移）,关闭安全启动和快速启动，os scheme 为others,save and quit</p>\n<h4 id=\"5-1-2-2-开始安装\"><a href=\"#5-1-2-2-开始安装\" class=\"headerlink\" title=\"5.1.2.2 开始安装\"></a>5.1.2.2 开始安装</h4><ol>\n<li>按照guide，修改region和time and input,暂不输入序列号。</li>\n<li>选择系统版本为windows pro x64,</li>\n<li>进入磁盘选择后，delete原有系统引导启动分区，保证三个分区后分别format,选定size为166G的分区</li>\n<li>安装完成后拔除U盘进入个性化设置，跳过联网</li>\n<li>其余默认<h3 id=\"5-1-3-激活系统\"><a href=\"#5-1-3-激活系统\" class=\"headerlink\" title=\"5.1.3 激活系统\"></a>5.1.3 激活系统</h3></li>\n<li>连接网络</li>\n<li>右下角进入windows defender,暂时关闭threat protection</li>\n<li>使1用KMS一键激活，进入control panel-&gt;system，查看激活状态</li>\n</ol>\n<h2 id=\"5-2-安装ubuntu\"><a href=\"#5-2-安装ubuntu\" class=\"headerlink\" title=\"5.2 安装ubuntu\"></a>5.2 安装ubuntu</h2><h3 id=\"5-2-1-准备：\"><a href=\"#5-2-1-准备：\" class=\"headerlink\" title=\"5.2.1 准备：\"></a>5.2.1 准备：</h3><h4 id=\"5-2-1-0-分区\"><a href=\"#5-2-1-0-分区\" class=\"headerlink\" title=\"5.2.1.0 分区\"></a>5.2.1.0 分区</h4><p>通过Disk Genius将SSD格式化，4096k对齐，在windows里通过disk management将该磁盘卸载，保持为未挂载状态，稍后安装时再进行分区</p>\n<h4 id=\"5-2-1-1-制作系统盘\"><a href=\"#5-2-1-1-制作系统盘\" class=\"headerlink\" title=\"5.2.1.1 制作系统盘\"></a>5.2.1.1 制作系统盘</h4><p>使用rufus刻录系统镜像文件，<br><a href=\"http://releases.ubuntu.com/16.04/ubuntu-16.04.5-desktop-amd64.iso.torrent?_ga=2.90542874.18967268.1536736360-304383447.1536736360\" target=\"_blank\" rel=\"noopener\">ubuntu-16.04.5-desktop-amd64.iso</a> 配置项默认</p>\n<h3 id=\"5-2-2-安装\"><a href=\"#5-2-2-安装\" class=\"headerlink\" title=\"5.2.2 安装\"></a>5.2.2 安装</h3><h4 id=\"5-2-2-1-修改启动项\"><a href=\"#5-2-2-1-修改启动项\" class=\"headerlink\" title=\"5.2.2.1 修改启动项\"></a>5.2.2.1 修改启动项</h4><p>重启F2进入BIOS，修改boot启动项，将USB DRIVE修改为第一项（F5上移）,关闭安全启动和快速启动，os scheme 为others,save and quit</p>\n<h4 id=\"5-2-2-2-开始安装\"><a href=\"#5-2-2-2-开始安装\" class=\"headerlink\" title=\"5.2.2.2 开始安装\"></a>5.2.2.2 开始安装</h4><p>进入界面后，选择install ubuntu,选择语言及输入法English，安装方式为something else,进入磁盘选择，先对SSD进行分区，选定sdb1中的free partition,+依此分区：</p>\n<ul>\n<li>/ ：30G,primary,ext filesystem,begin</li>\n<li>swap:8G*2=16384MB,logical,</li>\n<li>boot:512MB,primary</li>\n<li>home:left space,logical</li>\n</ul>\n<p>选择启动位置为SSD对应的标称,结合容量大小，sdb1 120G<br>根据引导执行后续步骤</p>\n<h3 id=\"5-2-3-修改root密码\"><a href=\"#5-2-3-修改root密码\" class=\"headerlink\" title=\"5.2.3 修改root密码\"></a>5.2.3 修改root密码</h3><p>sudo passwd<br>试用su验证</p>\n<h2 id=\"5-3-验证双系统可正确引导\"><a href=\"#5-3-验证双系统可正确引导\" class=\"headerlink\" title=\"5.3 验证双系统可正确引导\"></a>5.3 验证双系统可正确引导</h2><p>关机重启后可出现unity风格的系统选择界面，第一项为ubuntu，第三项为检测出的windows boot,分别尝试登陆</p>\n","site":{"data":{}},"excerpt":"<h1 id=\"1-当前环境\"><a href=\"#1-当前环境\" class=\"headerlink\" title=\"1 当前环境\"></a>1 当前环境</h1><p>联想lenovo G50:4G+4G(自行扩展)内存，512G机械硬盘，128G SSD 64位i5CPU<br>","more":"</p>\n<h1 id=\"2-使用工具：\"><a href=\"#2-使用工具：\" class=\"headerlink\" title=\"2 使用工具：\"></a>2 使用工具：</h1><ul>\n<li>系统盘刻录：<a href=\"http://rufus.akeo.ie/\" target=\"_blank\" rel=\"noopener\">rufus 3.2</a>(类似刻录工具有ultraiso，老毛桃、大白菜之类装机工具虽然集成度高，但比较笨重且不稳定，不便于引导启动系统)</li>\n<li>U盘：8G USB2.0 （USB规格不影响，容量8G足够）</li>\n<li>分区：<a href=\"http://www.diskgenius.cn/\" target=\"_blank\" rel=\"noopener\">Disk genius V4.9.6.564</a></li>\n<li>激活工具：<a href=\"http://www.yishimei123.com/network/319.html?=microKMS_17.06.25\" target=\"_blank\" rel=\"noopener\">MicroKMS_v18.08.09</a>（容易被windows defender识别为病毒并直接删除，需先关闭后下载，执行完后删除，恢复defender）</li>\n</ul>\n<h1 id=\"3-系统版本\"><a href=\"#3-系统版本\" class=\"headerlink\" title=\"3 系统版本\"></a>3 系统版本</h1><ul>\n<li>Windows 10 pro Version 1803(English)(目前最新稳定版，省去安装后不停更新)</li>\n<li>Ubuntu 16.04.5 desktop amd64（目前最新版本为18.04，此版本稳定支持各类开源软件）</li>\n</ul>\n<h1 id=\"4-安装模式\"><a href=\"#4-安装模式\" class=\"headerlink\" title=\"4 安装模式\"></a>4 安装模式</h1><p>先安装win到机械盘后安装ubuntu到固态（限于资源，权衡系统使用场景频率协调）</p>\n<h1 id=\"5-详细记录\"><a href=\"#5-详细记录\" class=\"headerlink\" title=\"5 详细记录\"></a>5 详细记录</h1><h2 id=\"5-1-安装windows\"><a href=\"#5-1-安装windows\" class=\"headerlink\" title=\"5.1 安装windows\"></a>5.1 安装windows</h2><h3 id=\"5-1-1-准备：\"><a href=\"#5-1-1-准备：\" class=\"headerlink\" title=\"5.1.1 准备：\"></a>5.1.1 准备：</h3><h4 id=\"5-1-1-0-分区\"><a href=\"#5-1-1-0-分区\" class=\"headerlink\" title=\"5.1.1.0 分区\"></a>5.1.1.0 分区</h4><p>原分区符合当前需求故不重新分，本次采用以下分区：</p>\n<ul>\n<li>system partition:<code>166G</code></li>\n<li>data partition:<code>150G</code></li>\n<li>software partition:<code>150G</code></li>\n</ul>\n<h4 id=\"5-1-1-1-制作系统盘\"><a href=\"#5-1-1-1-制作系统盘\" class=\"headerlink\" title=\"5.1.1.1 制作系统盘\"></a>5.1.1.1 制作系统盘</h4><p>使用rufus刻录系统镜像文件<br><a href=\"ed2k://|file|en_windows_10_consumer_editions_version_1803_updated_march_2018_x64_dvd_12063379.iso|4692365312|E991C13EC003F6C98C8A6BD4364F806F|/\" target=\"_blank\" rel=\"noopener\">en_windows_10_consumer_editions_version_1803_updated_march_2018_x64_dvd_12063379</a>，配置项默认：</p>\n<ul>\n<li>partition scheme:<code>GPT</code></li>\n<li>target system:<code>UEFI</code></li>\n<li>file system:<code>FAT32</code></li>\n</ul>\n<h3 id=\"5-1-2-安装\"><a href=\"#5-1-2-安装\" class=\"headerlink\" title=\"5.1.2 安装\"></a>5.1.2 安装</h3><h4 id=\"5-1-2-1-修改启动项\"><a href=\"#5-1-2-1-修改启动项\" class=\"headerlink\" title=\"5.1.2.1 修改启动项\"></a>5.1.2.1 修改启动项</h4><p>重启F2进入BIOS，修改boot启动项，将USB DRIVE（根据名称大致判别引导U盘）修改为第一项（F5上移）,关闭安全启动和快速启动，os scheme 为others,save and quit</p>\n<h4 id=\"5-1-2-2-开始安装\"><a href=\"#5-1-2-2-开始安装\" class=\"headerlink\" title=\"5.1.2.2 开始安装\"></a>5.1.2.2 开始安装</h4><ol>\n<li>按照guide，修改region和time and input,暂不输入序列号。</li>\n<li>选择系统版本为windows pro x64,</li>\n<li>进入磁盘选择后，delete原有系统引导启动分区，保证三个分区后分别format,选定size为166G的分区</li>\n<li>安装完成后拔除U盘进入个性化设置，跳过联网</li>\n<li>其余默认<h3 id=\"5-1-3-激活系统\"><a href=\"#5-1-3-激活系统\" class=\"headerlink\" title=\"5.1.3 激活系统\"></a>5.1.3 激活系统</h3></li>\n<li>连接网络</li>\n<li>右下角进入windows defender,暂时关闭threat protection</li>\n<li>使1用KMS一键激活，进入control panel-&gt;system，查看激活状态</li>\n</ol>\n<h2 id=\"5-2-安装ubuntu\"><a href=\"#5-2-安装ubuntu\" class=\"headerlink\" title=\"5.2 安装ubuntu\"></a>5.2 安装ubuntu</h2><h3 id=\"5-2-1-准备：\"><a href=\"#5-2-1-准备：\" class=\"headerlink\" title=\"5.2.1 准备：\"></a>5.2.1 准备：</h3><h4 id=\"5-2-1-0-分区\"><a href=\"#5-2-1-0-分区\" class=\"headerlink\" title=\"5.2.1.0 分区\"></a>5.2.1.0 分区</h4><p>通过Disk Genius将SSD格式化，4096k对齐，在windows里通过disk management将该磁盘卸载，保持为未挂载状态，稍后安装时再进行分区</p>\n<h4 id=\"5-2-1-1-制作系统盘\"><a href=\"#5-2-1-1-制作系统盘\" class=\"headerlink\" title=\"5.2.1.1 制作系统盘\"></a>5.2.1.1 制作系统盘</h4><p>使用rufus刻录系统镜像文件，<br><a href=\"http://releases.ubuntu.com/16.04/ubuntu-16.04.5-desktop-amd64.iso.torrent?_ga=2.90542874.18967268.1536736360-304383447.1536736360\" target=\"_blank\" rel=\"noopener\">ubuntu-16.04.5-desktop-amd64.iso</a> 配置项默认</p>\n<h3 id=\"5-2-2-安装\"><a href=\"#5-2-2-安装\" class=\"headerlink\" title=\"5.2.2 安装\"></a>5.2.2 安装</h3><h4 id=\"5-2-2-1-修改启动项\"><a href=\"#5-2-2-1-修改启动项\" class=\"headerlink\" title=\"5.2.2.1 修改启动项\"></a>5.2.2.1 修改启动项</h4><p>重启F2进入BIOS，修改boot启动项，将USB DRIVE修改为第一项（F5上移）,关闭安全启动和快速启动，os scheme 为others,save and quit</p>\n<h4 id=\"5-2-2-2-开始安装\"><a href=\"#5-2-2-2-开始安装\" class=\"headerlink\" title=\"5.2.2.2 开始安装\"></a>5.2.2.2 开始安装</h4><p>进入界面后，选择install ubuntu,选择语言及输入法English，安装方式为something else,进入磁盘选择，先对SSD进行分区，选定sdb1中的free partition,+依此分区：</p>\n<ul>\n<li>/ ：30G,primary,ext filesystem,begin</li>\n<li>swap:8G*2=16384MB,logical,</li>\n<li>boot:512MB,primary</li>\n<li>home:left space,logical</li>\n</ul>\n<p>选择启动位置为SSD对应的标称,结合容量大小，sdb1 120G<br>根据引导执行后续步骤</p>\n<h3 id=\"5-2-3-修改root密码\"><a href=\"#5-2-3-修改root密码\" class=\"headerlink\" title=\"5.2.3 修改root密码\"></a>5.2.3 修改root密码</h3><p>sudo passwd<br>试用su验证</p>\n<h2 id=\"5-3-验证双系统可正确引导\"><a href=\"#5-3-验证双系统可正确引导\" class=\"headerlink\" title=\"5.3 验证双系统可正确引导\"></a>5.3 验证双系统可正确引导</h2><p>关机重启后可出现unity风格的系统选择界面，第一项为ubuntu，第三项为检测出的windows boot,分别尝试登陆</p>"},{"title":"微信小程序云开发之云函数外部请求","date":"2019-04-18T03:59:07.000Z","cagetories":"record","_content":"{% note info no-icon %}\n在小程序开发中，遇到一些未在国内备案的域名无法加到管理后台的情况，突破这个限制，想到了用云开发做接口转发\n{% endnote%}\n\n<!-- more -->\n\n官方提示：\n{% note info %}\n在云函数中我们可以引入第三方依赖来帮助我们更快的开发。云函数的运行环境是 Node.js，因此我们可以使用 npm 安装第三方依赖。比如除了使用 Node.js 提供的原生 http 接口在云函数中发起网络请求，我们还可以使用一个流行的 Node.js 网络请求库 request 来更便捷的发起网络请求。\n{% endnote%}\n于是新建一个云函数\n```js\n//cloudFuntion/github/index.js\nconst cloud = require('wx-server-sdk')\nvar request = require('request-promise');\n\nexports.main = async (event, context) => {\n  cloud.init({\n    env: 'test-728bbc'\n  });\n var request = require('request');\n \nvar options = {\n  url: 'https://api.github.com/repos/request/request',\n  headers: {\n    'User-Agent': 'request'\n  }\n};\n \nfunction callback(error, response, body) {\n  if (!error && response.statusCode == 200) {\n    var info = JSON.parse(body);\n    return info;\n  }\n}\nrequest(options, callback);\n}\n```\n在小程序端\n```js\n//app.js\nApp({\n  onLaunch: function () {\n    wx.cloud.init({\n      env: \"test-728bbc\"\n    });\n  },\n  globalData: {\n    userInfo: null\n  }\n});\n//source/index.js\nPage({\n    onLoad: function () {\n        wx.cloud.callFunction({\n            name: 'github',\n            complete: res => {\n                console.log('callFunction test result: ', res)\n            },\n        })\n    },\n )}\n```\n然而上传云函数后测试始终返回\n```json\n{\n    errMsg: \"cloud.callFunction:ok\",\n    result: null,\n    requestID: \"1618a9aa-618e-11e9-97c2-52540025df0e\"\n}\n```\n开始换用node自带的http模块，但结果相同，后换用promise写法\n```js\n//cloudFuntion/github/index.js\nconst cloud = require('wx-server-sdk')\nvar request = require('request-promise');\n\nexports.main = async (event, context) => {\n  cloud.init({\n    env: 'test-728bbc'\n  });\n  var options = {\n    method: 'GET',\n    url: 'https://api.github.com/repos/request/request',\n    headers: {\n      'User-Agent': 'request'\n    },\n    json: true\n  };\n  const resultValue = await request(options);\n  return resultValue\n}\n```\n成功返回预期结果,但异常类型未知\n# Reference\n<small>\n[1] 微信小程序团队.小程序开发-云开发[EB/OL].[https://dwz.cn/YfXcrBcN](https://developers.weixin.qq.com/miniprogram/dev/wxcloud/guide/functions/npm.html) .2019.\n</small>","source":"_posts/zh-CN/微信小程序云开发之云函数外部请求.md","raw":"---\ntitle: 微信小程序云开发之云函数外部请求\ndate: 2019-04-18 11:59:07\ntags:\n- wechat\n\ncagetories: record \n---\n{% note info no-icon %}\n在小程序开发中，遇到一些未在国内备案的域名无法加到管理后台的情况，突破这个限制，想到了用云开发做接口转发\n{% endnote%}\n\n<!-- more -->\n\n官方提示：\n{% note info %}\n在云函数中我们可以引入第三方依赖来帮助我们更快的开发。云函数的运行环境是 Node.js，因此我们可以使用 npm 安装第三方依赖。比如除了使用 Node.js 提供的原生 http 接口在云函数中发起网络请求，我们还可以使用一个流行的 Node.js 网络请求库 request 来更便捷的发起网络请求。\n{% endnote%}\n于是新建一个云函数\n```js\n//cloudFuntion/github/index.js\nconst cloud = require('wx-server-sdk')\nvar request = require('request-promise');\n\nexports.main = async (event, context) => {\n  cloud.init({\n    env: 'test-728bbc'\n  });\n var request = require('request');\n \nvar options = {\n  url: 'https://api.github.com/repos/request/request',\n  headers: {\n    'User-Agent': 'request'\n  }\n};\n \nfunction callback(error, response, body) {\n  if (!error && response.statusCode == 200) {\n    var info = JSON.parse(body);\n    return info;\n  }\n}\nrequest(options, callback);\n}\n```\n在小程序端\n```js\n//app.js\nApp({\n  onLaunch: function () {\n    wx.cloud.init({\n      env: \"test-728bbc\"\n    });\n  },\n  globalData: {\n    userInfo: null\n  }\n});\n//source/index.js\nPage({\n    onLoad: function () {\n        wx.cloud.callFunction({\n            name: 'github',\n            complete: res => {\n                console.log('callFunction test result: ', res)\n            },\n        })\n    },\n )}\n```\n然而上传云函数后测试始终返回\n```json\n{\n    errMsg: \"cloud.callFunction:ok\",\n    result: null,\n    requestID: \"1618a9aa-618e-11e9-97c2-52540025df0e\"\n}\n```\n开始换用node自带的http模块，但结果相同，后换用promise写法\n```js\n//cloudFuntion/github/index.js\nconst cloud = require('wx-server-sdk')\nvar request = require('request-promise');\n\nexports.main = async (event, context) => {\n  cloud.init({\n    env: 'test-728bbc'\n  });\n  var options = {\n    method: 'GET',\n    url: 'https://api.github.com/repos/request/request',\n    headers: {\n      'User-Agent': 'request'\n    },\n    json: true\n  };\n  const resultValue = await request(options);\n  return resultValue\n}\n```\n成功返回预期结果,但异常类型未知\n# Reference\n<small>\n[1] 微信小程序团队.小程序开发-云开发[EB/OL].[https://dwz.cn/YfXcrBcN](https://developers.weixin.qq.com/miniprogram/dev/wxcloud/guide/functions/npm.html) .2019.\n</small>","slug":"微信小程序云开发之云函数外部请求","published":1,"lang":"zh-CN","updated":"2019-04-29T01:50:33.868Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjvnq7zan00227jjxfv2l5adt","content":"<link rel=\"stylesheet\" class=\"aplayer-secondary-style-marker\" href=\"/assets/css/APlayer.min.css\"><script src=\"/assets/js/APlayer.min.js\" class=\"aplayer-secondary-script-marker\"></script><script class=\"meting-secondary-script-marker\" src=\"/assets/js/Meting.min.js\"></script><link rel=\"stylesheet\" type=\"text/css\" href=\"https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css\"><div class=\"note info no-icon\">\n            <p>在小程序开发中，遇到一些未在国内备案的域名无法加到管理后台的情况，突破这个限制，想到了用云开发做接口转发</p>\n          </div>\n<a id=\"more\"></a>\n<p>官方提示：<br><div class=\"note info\">\n            <p>在云函数中我们可以引入第三方依赖来帮助我们更快的开发。云函数的运行环境是 Node.js，因此我们可以使用 npm 安装第三方依赖。比如除了使用 Node.js 提供的原生 http 接口在云函数中发起网络请求，我们还可以使用一个流行的 Node.js 网络请求库 request 来更便捷的发起网络请求。</p>\n          </div><br>于是新建一个云函数<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//cloudFuntion/github/index.js</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> cloud = <span class=\"built_in\">require</span>(<span class=\"string\">'wx-server-sdk'</span>)</span><br><span class=\"line\"><span class=\"keyword\">var</span> request = <span class=\"built_in\">require</span>(<span class=\"string\">'request-promise'</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">exports.main = <span class=\"keyword\">async</span> (event, context) =&gt; &#123;</span><br><span class=\"line\">  cloud.init(&#123;</span><br><span class=\"line\">    env: <span class=\"string\">'test-728bbc'</span></span><br><span class=\"line\">  &#125;);</span><br><span class=\"line\"> <span class=\"keyword\">var</span> request = <span class=\"built_in\">require</span>(<span class=\"string\">'request'</span>);</span><br><span class=\"line\"> </span><br><span class=\"line\"><span class=\"keyword\">var</span> options = &#123;</span><br><span class=\"line\">  url: <span class=\"string\">'https://api.github.com/repos/request/request'</span>,</span><br><span class=\"line\">  headers: &#123;</span><br><span class=\"line\">    <span class=\"string\">'User-Agent'</span>: <span class=\"string\">'request'</span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"> </span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">callback</span>(<span class=\"params\">error, response, body</span>) </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (!error &amp;&amp; response.statusCode == <span class=\"number\">200</span>) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> info = <span class=\"built_in\">JSON</span>.parse(body);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> info;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">request(options, callback);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p>在小程序端<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//app.js</span></span><br><span class=\"line\">App(&#123;</span><br><span class=\"line\">  onLaunch: <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">    wx.cloud.init(&#123;</span><br><span class=\"line\">      env: <span class=\"string\">\"test-728bbc\"</span></span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  globalData: &#123;</span><br><span class=\"line\">    userInfo: <span class=\"literal\">null</span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"><span class=\"comment\">//source/index.js</span></span><br><span class=\"line\">Page(&#123;</span><br><span class=\"line\">    onLoad: <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">        wx.cloud.callFunction(&#123;</span><br><span class=\"line\">            name: <span class=\"string\">'github'</span>,</span><br><span class=\"line\">            complete: <span class=\"function\"><span class=\"params\">res</span> =&gt;</span> &#123;</span><br><span class=\"line\">                <span class=\"built_in\">console</span>.log(<span class=\"string\">'callFunction test result: '</span>, res)</span><br><span class=\"line\">            &#125;,</span><br><span class=\"line\">        &#125;)</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\"> )&#125;</span><br></pre></td></tr></table></figure></p>\n<p>然而上传云函数后测试始终返回<br><figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">    errMsg: \"cloud.callFunction:ok\",</span><br><span class=\"line\">    result: null,</span><br><span class=\"line\">    requestID: \"1618a9aa-618e-11e9-97c2-52540025df0e\"</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p>开始换用node自带的http模块，但结果相同，后换用promise写法<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//cloudFuntion/github/index.js</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> cloud = <span class=\"built_in\">require</span>(<span class=\"string\">'wx-server-sdk'</span>)</span><br><span class=\"line\"><span class=\"keyword\">var</span> request = <span class=\"built_in\">require</span>(<span class=\"string\">'request-promise'</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">exports.main = <span class=\"keyword\">async</span> (event, context) =&gt; &#123;</span><br><span class=\"line\">  cloud.init(&#123;</span><br><span class=\"line\">    env: <span class=\"string\">'test-728bbc'</span></span><br><span class=\"line\">  &#125;);</span><br><span class=\"line\">  <span class=\"keyword\">var</span> options = &#123;</span><br><span class=\"line\">    method: <span class=\"string\">'GET'</span>,</span><br><span class=\"line\">    url: <span class=\"string\">'https://api.github.com/repos/request/request'</span>,</span><br><span class=\"line\">    headers: &#123;</span><br><span class=\"line\">      <span class=\"string\">'User-Agent'</span>: <span class=\"string\">'request'</span></span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    json: <span class=\"literal\">true</span></span><br><span class=\"line\">  &#125;;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> resultValue = <span class=\"keyword\">await</span> request(options);</span><br><span class=\"line\">  <span class=\"keyword\">return</span> resultValue</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p>成功返回预期结果,但异常类型未知</p>\n<h1 id=\"Reference\"><a href=\"#Reference\" class=\"headerlink\" title=\"Reference\"></a>Reference</h1><p><small><br>[1] 微信小程序团队.小程序开发-云开发[EB/OL].<a href=\"https://developers.weixin.qq.com/miniprogram/dev/wxcloud/guide/functions/npm.html\" target=\"_blank\" rel=\"noopener\">https://dwz.cn/YfXcrBcN</a> .2019.<br></small></p>\n","site":{"data":{}},"excerpt":"<div class=\"note info no-icon\">\n            <p>在小程序开发中，遇到一些未在国内备案的域名无法加到管理后台的情况，突破这个限制，想到了用云开发做接口转发</p>\n          </div>","more":"<p>官方提示：<br><div class=\"note info\">\n            <p>在云函数中我们可以引入第三方依赖来帮助我们更快的开发。云函数的运行环境是 Node.js，因此我们可以使用 npm 安装第三方依赖。比如除了使用 Node.js 提供的原生 http 接口在云函数中发起网络请求，我们还可以使用一个流行的 Node.js 网络请求库 request 来更便捷的发起网络请求。</p>\n          </div><br>于是新建一个云函数<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//cloudFuntion/github/index.js</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> cloud = <span class=\"built_in\">require</span>(<span class=\"string\">'wx-server-sdk'</span>)</span><br><span class=\"line\"><span class=\"keyword\">var</span> request = <span class=\"built_in\">require</span>(<span class=\"string\">'request-promise'</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">exports.main = <span class=\"keyword\">async</span> (event, context) =&gt; &#123;</span><br><span class=\"line\">  cloud.init(&#123;</span><br><span class=\"line\">    env: <span class=\"string\">'test-728bbc'</span></span><br><span class=\"line\">  &#125;);</span><br><span class=\"line\"> <span class=\"keyword\">var</span> request = <span class=\"built_in\">require</span>(<span class=\"string\">'request'</span>);</span><br><span class=\"line\"> </span><br><span class=\"line\"><span class=\"keyword\">var</span> options = &#123;</span><br><span class=\"line\">  url: <span class=\"string\">'https://api.github.com/repos/request/request'</span>,</span><br><span class=\"line\">  headers: &#123;</span><br><span class=\"line\">    <span class=\"string\">'User-Agent'</span>: <span class=\"string\">'request'</span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"> </span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">callback</span>(<span class=\"params\">error, response, body</span>) </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (!error &amp;&amp; response.statusCode == <span class=\"number\">200</span>) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> info = <span class=\"built_in\">JSON</span>.parse(body);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> info;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">request(options, callback);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p>在小程序端<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//app.js</span></span><br><span class=\"line\">App(&#123;</span><br><span class=\"line\">  onLaunch: <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">    wx.cloud.init(&#123;</span><br><span class=\"line\">      env: <span class=\"string\">\"test-728bbc\"</span></span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  globalData: &#123;</span><br><span class=\"line\">    userInfo: <span class=\"literal\">null</span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"><span class=\"comment\">//source/index.js</span></span><br><span class=\"line\">Page(&#123;</span><br><span class=\"line\">    onLoad: <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">        wx.cloud.callFunction(&#123;</span><br><span class=\"line\">            name: <span class=\"string\">'github'</span>,</span><br><span class=\"line\">            complete: <span class=\"function\"><span class=\"params\">res</span> =&gt;</span> &#123;</span><br><span class=\"line\">                <span class=\"built_in\">console</span>.log(<span class=\"string\">'callFunction test result: '</span>, res)</span><br><span class=\"line\">            &#125;,</span><br><span class=\"line\">        &#125;)</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\"> )&#125;</span><br></pre></td></tr></table></figure></p>\n<p>然而上传云函数后测试始终返回<br><figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">    errMsg: \"cloud.callFunction:ok\",</span><br><span class=\"line\">    result: null,</span><br><span class=\"line\">    requestID: \"1618a9aa-618e-11e9-97c2-52540025df0e\"</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p>开始换用node自带的http模块，但结果相同，后换用promise写法<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//cloudFuntion/github/index.js</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> cloud = <span class=\"built_in\">require</span>(<span class=\"string\">'wx-server-sdk'</span>)</span><br><span class=\"line\"><span class=\"keyword\">var</span> request = <span class=\"built_in\">require</span>(<span class=\"string\">'request-promise'</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">exports.main = <span class=\"keyword\">async</span> (event, context) =&gt; &#123;</span><br><span class=\"line\">  cloud.init(&#123;</span><br><span class=\"line\">    env: <span class=\"string\">'test-728bbc'</span></span><br><span class=\"line\">  &#125;);</span><br><span class=\"line\">  <span class=\"keyword\">var</span> options = &#123;</span><br><span class=\"line\">    method: <span class=\"string\">'GET'</span>,</span><br><span class=\"line\">    url: <span class=\"string\">'https://api.github.com/repos/request/request'</span>,</span><br><span class=\"line\">    headers: &#123;</span><br><span class=\"line\">      <span class=\"string\">'User-Agent'</span>: <span class=\"string\">'request'</span></span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    json: <span class=\"literal\">true</span></span><br><span class=\"line\">  &#125;;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> resultValue = <span class=\"keyword\">await</span> request(options);</span><br><span class=\"line\">  <span class=\"keyword\">return</span> resultValue</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p>成功返回预期结果,但异常类型未知</p>\n<h1 id=\"Reference\"><a href=\"#Reference\" class=\"headerlink\" title=\"Reference\"></a>Reference</h1><p><small><br>[1] 微信小程序团队.小程序开发-云开发[EB/OL].<a href=\"https://developers.weixin.qq.com/miniprogram/dev/wxcloud/guide/functions/npm.html\" target=\"_blank\" rel=\"noopener\">https://dwz.cn/YfXcrBcN</a> .2019.<br></small></p>"},{"title":"微信订阅号开发记录","date":"2019-01-04T13:21:36.000Z","_content":"## 问题\npm2安装npm install pm2@latest -g\n测试号重复回复\n\n<!-- more -->\n\n\n## 步骤\n开发配置验证域名下token,公众号内回复固定内容\n- nodejs:https://cloud.tencent.com/developer/labs/lab/10196\n- python:https://mp.weixin.qq.com/wiki?t=resource/res_main&id=mp1472017492_58YV5\n- php:https://mp.weixin.qq.com/wiki?t=resource/res_main&id=mp1421135319\n","source":"_posts/zh-CN/微信订阅号开发记录.md","raw":"---\ntitle: 微信订阅号开发记录\ndate: 2019-01-04 21:21:36\ntags: \n  - 微信\ncategories: record\n---\n## 问题\npm2安装npm install pm2@latest -g\n测试号重复回复\n\n<!-- more -->\n\n\n## 步骤\n开发配置验证域名下token,公众号内回复固定内容\n- nodejs:https://cloud.tencent.com/developer/labs/lab/10196\n- python:https://mp.weixin.qq.com/wiki?t=resource/res_main&id=mp1472017492_58YV5\n- php:https://mp.weixin.qq.com/wiki?t=resource/res_main&id=mp1421135319\n","slug":"微信订阅号开发记录","published":1,"lang":"zh-CN","updated":"2019-04-29T01:07:50.660Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjvnq7zao00257jjxhq2paeg9","content":"<link rel=\"stylesheet\" class=\"aplayer-secondary-style-marker\" href=\"/assets/css/APlayer.min.css\"><script src=\"/assets/js/APlayer.min.js\" class=\"aplayer-secondary-script-marker\"></script><script class=\"meting-secondary-script-marker\" src=\"/assets/js/Meting.min.js\"></script><link rel=\"stylesheet\" type=\"text/css\" href=\"https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css\"><h2 id=\"问题\"><a href=\"#问题\" class=\"headerlink\" title=\"问题\"></a>问题</h2><p>pm2安装npm install pm2@latest -g<br>测试号重复回复</p>\n<a id=\"more\"></a>\n<h2 id=\"步骤\"><a href=\"#步骤\" class=\"headerlink\" title=\"步骤\"></a>步骤</h2><p>开发配置验证域名下token,公众号内回复固定内容</p>\n<ul>\n<li>nodejs:<a href=\"https://cloud.tencent.com/developer/labs/lab/10196\" target=\"_blank\" rel=\"noopener\">https://cloud.tencent.com/developer/labs/lab/10196</a></li>\n<li>python:<a href=\"https://mp.weixin.qq.com/wiki?t=resource/res_main&amp;id=mp1472017492_58YV5\" target=\"_blank\" rel=\"noopener\">https://mp.weixin.qq.com/wiki?t=resource/res_main&amp;id=mp1472017492_58YV5</a></li>\n<li>php:<a href=\"https://mp.weixin.qq.com/wiki?t=resource/res_main&amp;id=mp1421135319\" target=\"_blank\" rel=\"noopener\">https://mp.weixin.qq.com/wiki?t=resource/res_main&amp;id=mp1421135319</a></li>\n</ul>\n","site":{"data":{}},"excerpt":"<h2 id=\"问题\"><a href=\"#问题\" class=\"headerlink\" title=\"问题\"></a>问题</h2><p>pm2安装npm install pm2@latest -g<br>测试号重复回复</p>","more":"<h2 id=\"步骤\"><a href=\"#步骤\" class=\"headerlink\" title=\"步骤\"></a>步骤</h2><p>开发配置验证域名下token,公众号内回复固定内容</p>\n<ul>\n<li>nodejs:<a href=\"https://cloud.tencent.com/developer/labs/lab/10196\" target=\"_blank\" rel=\"noopener\">https://cloud.tencent.com/developer/labs/lab/10196</a></li>\n<li>python:<a href=\"https://mp.weixin.qq.com/wiki?t=resource/res_main&amp;id=mp1472017492_58YV5\" target=\"_blank\" rel=\"noopener\">https://mp.weixin.qq.com/wiki?t=resource/res_main&amp;id=mp1472017492_58YV5</a></li>\n<li>php:<a href=\"https://mp.weixin.qq.com/wiki?t=resource/res_main&amp;id=mp1421135319\" target=\"_blank\" rel=\"noopener\">https://mp.weixin.qq.com/wiki?t=resource/res_main&amp;id=mp1421135319</a></li>\n</ul>"},{"title":"总有一种美好值得期待","date":"2017-05-10T05:39:04.000Z","_content":"<center>\n你不知道前面什么等着你，可你必须往前走。\n即使迷茫，时间依旧拖着你。\n所以我更在意的是与什么样的人同行，而我比过去前进了多少。\n不悲观也不乐观，如果前方坦途就大步向前走，\n如果是堵墙就把它砸出个口来。\n毕竟只有前行的人，才能遇到同样前行的人。\n</center>\n","source":"_posts/zh-CN/总有一种美好值得期待.md","raw":"---\ntitle: 总有一种美好值得期待\ndate: 2017-05-10 13:39:04\ntags:\ncategories: thoughts\n---\n<center>\n你不知道前面什么等着你，可你必须往前走。\n即使迷茫，时间依旧拖着你。\n所以我更在意的是与什么样的人同行，而我比过去前进了多少。\n不悲观也不乐观，如果前方坦途就大步向前走，\n如果是堵墙就把它砸出个口来。\n毕竟只有前行的人，才能遇到同样前行的人。\n</center>\n","slug":"总有一种美好值得期待","published":1,"lang":"zh-CN","updated":"2019-04-29T01:07:50.660Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjvnq7zap00297jjxeb95frtk","content":"<link rel=\"stylesheet\" class=\"aplayer-secondary-style-marker\" href=\"/assets/css/APlayer.min.css\"><script src=\"/assets/js/APlayer.min.js\" class=\"aplayer-secondary-script-marker\"></script><script class=\"meting-secondary-script-marker\" src=\"/assets/js/Meting.min.js\"></script><link rel=\"stylesheet\" type=\"text/css\" href=\"https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css\"><center><br>你不知道前面什么等着你，可你必须往前走。<br>即使迷茫，时间依旧拖着你。<br>所以我更在意的是与什么样的人同行，而我比过去前进了多少。<br>不悲观也不乐观，如果前方坦途就大步向前走，<br>如果是堵墙就把它砸出个口来。<br>毕竟只有前行的人，才能遇到同样前行的人。<br></center>\n","site":{"data":{}},"excerpt":"","more":"<center><br>你不知道前面什么等着你，可你必须往前走。<br>即使迷茫，时间依旧拖着你。<br>所以我更在意的是与什么样的人同行，而我比过去前进了多少。<br>不悲观也不乐观，如果前方坦途就大步向前走，<br>如果是堵墙就把它砸出个口来。<br>毕竟只有前行的人，才能遇到同样前行的人。<br></center>\n"},{"title":"第三方平台API(以易班为例)的使用记录","date":"2017-06-15T20:14:42.000Z","_content":"# 1. 前言\n服务商提供给第三方网站的API使用原理基本相似，使用说明都可以在相应开发平台查看wiki文档。以[易班开放平台](https://open.yiban.cn)为例:\n\n鉴于易班API使用目前最主要的用户身份验证和授权方式——[oauth2.0](https://oauth.net/2/)，先了解下它的[授权机制](http://www.cnblogs.com/neutra/archive/2012/07/26/2609300.html)\n\n当然，易班开放平台也给出了[授权概述](https://open.yiban.cn/wiki/index.php?page=%E6%8E%88%E6%9D%83%E6%9C%BA%E5%88%B6%E8%AF%B4%E6%98%8E)\n\n<!-- more -->\n# 2. 开始\n\n将以网站接入SDK为例，javaSDK的使用可以[参考](http://blog.csdn.net/u010513756/article/details/50535657)（这应该是目前能百度到的唯一的文章）\n\n.netSDK的使用[参考](https://github.com/eightHundreds/YbSDK),资料不多，不过是矿大学生开发的。\n\n下面是phpSDK的（这个琢磨了些日子，容易上手）\n\n## 2.1.php环境\n\n{% note warning %}\nphp需要开启CURL，这是文档要求，如果没有启用这个扩展，会报错！\n{% endnote %}\n\n当然也有其他的要求，不过后两个一般来说应该都会满足的\n\n那么如果不支持curl扩展该怎么办呢？当然，你可以参照网上[资料](http://blog.163.com/ymboy@126/blog/static/2871108420108253201587/)。不过经过测试，无论是改php.ini还是copy那些.dll文件到system32，均无效！那么简单粗暴的方式是重新配置升级php服务器（5.6就行），然后就OK了。\n\n## 2.2 注册开放平台账号\n\n[易班开放平台](https://open.yiban.cn/)：可以直接申请（也不费事）。\n\n申请后就获得了[测试权限](https://o.yiban.cn/debug/apitest)（就是可以体验接口作用的权限），至于要上线的网站，肯定会用到一些实名认证信息，就需要跟管理员[申请更多权限](https://open.yiban.cn/wiki/index.php?page=%E6%9D%83%E9%99%90%E7%94%B3%E8%AF%B7%E6%B5%81%E7%A8%8B)\n\n其他：\n[QQ互联平台](http://wiki.connect.qq.com/)：首先个人开发者需要完成[认证](https://connect.qq.com/),用QQ登录后创建网站应用，然后就耐心等待吧(此平台体验并不完善，可能已经逐步放弃维护)\n\n[微信开放平台](https://open.weixin.qq.com)：当然也可以申请，不过是需要认证费用以及企业信息的。\n\n其他还有类似百度、微博开发者平台/开放平台。\n\n## 2.3 下载SDK\n\n[易班phpSDK](https://open.yiban.cn/wiki/download/YBApi_sdk_php.zip)\n\n## 2.4 认真阅读wiki后找一些demo下载\n\n- 易班php：SDK里面有个demo文件夹\n- github：[yibanSDK](https://github.com/search?utf8=%E2%9C%93&amp;q=yibanSDK&amp;type=)\n- 玉林师范学院： 链接：http://pan.baidu.com/s/1o7RcYwi 密码：5who \n\n## 依照原理重写了易班PHP SDK\n主要用于实现过程，不可用于生产环境\n[https://github.com/MakerGYT/dx/blob/master/extend/ThinkSDK/Yiban.php](https://github.com/MakerGYT/dx/blob/master/extend/ThinkSDK/Yiban.php)","source":"_posts/zh-CN/第三方平台API(以易班为例)的使用记录.md","raw":"---\ntitle: 第三方平台API(以易班为例)的使用记录\ndate: 2017-06-16 04:14:42\ntags: \n\ncategories: record\n---\n# 1. 前言\n服务商提供给第三方网站的API使用原理基本相似，使用说明都可以在相应开发平台查看wiki文档。以[易班开放平台](https://open.yiban.cn)为例:\n\n鉴于易班API使用目前最主要的用户身份验证和授权方式——[oauth2.0](https://oauth.net/2/)，先了解下它的[授权机制](http://www.cnblogs.com/neutra/archive/2012/07/26/2609300.html)\n\n当然，易班开放平台也给出了[授权概述](https://open.yiban.cn/wiki/index.php?page=%E6%8E%88%E6%9D%83%E6%9C%BA%E5%88%B6%E8%AF%B4%E6%98%8E)\n\n<!-- more -->\n# 2. 开始\n\n将以网站接入SDK为例，javaSDK的使用可以[参考](http://blog.csdn.net/u010513756/article/details/50535657)（这应该是目前能百度到的唯一的文章）\n\n.netSDK的使用[参考](https://github.com/eightHundreds/YbSDK),资料不多，不过是矿大学生开发的。\n\n下面是phpSDK的（这个琢磨了些日子，容易上手）\n\n## 2.1.php环境\n\n{% note warning %}\nphp需要开启CURL，这是文档要求，如果没有启用这个扩展，会报错！\n{% endnote %}\n\n当然也有其他的要求，不过后两个一般来说应该都会满足的\n\n那么如果不支持curl扩展该怎么办呢？当然，你可以参照网上[资料](http://blog.163.com/ymboy@126/blog/static/2871108420108253201587/)。不过经过测试，无论是改php.ini还是copy那些.dll文件到system32，均无效！那么简单粗暴的方式是重新配置升级php服务器（5.6就行），然后就OK了。\n\n## 2.2 注册开放平台账号\n\n[易班开放平台](https://open.yiban.cn/)：可以直接申请（也不费事）。\n\n申请后就获得了[测试权限](https://o.yiban.cn/debug/apitest)（就是可以体验接口作用的权限），至于要上线的网站，肯定会用到一些实名认证信息，就需要跟管理员[申请更多权限](https://open.yiban.cn/wiki/index.php?page=%E6%9D%83%E9%99%90%E7%94%B3%E8%AF%B7%E6%B5%81%E7%A8%8B)\n\n其他：\n[QQ互联平台](http://wiki.connect.qq.com/)：首先个人开发者需要完成[认证](https://connect.qq.com/),用QQ登录后创建网站应用，然后就耐心等待吧(此平台体验并不完善，可能已经逐步放弃维护)\n\n[微信开放平台](https://open.weixin.qq.com)：当然也可以申请，不过是需要认证费用以及企业信息的。\n\n其他还有类似百度、微博开发者平台/开放平台。\n\n## 2.3 下载SDK\n\n[易班phpSDK](https://open.yiban.cn/wiki/download/YBApi_sdk_php.zip)\n\n## 2.4 认真阅读wiki后找一些demo下载\n\n- 易班php：SDK里面有个demo文件夹\n- github：[yibanSDK](https://github.com/search?utf8=%E2%9C%93&amp;q=yibanSDK&amp;type=)\n- 玉林师范学院： 链接：http://pan.baidu.com/s/1o7RcYwi 密码：5who \n\n## 依照原理重写了易班PHP SDK\n主要用于实现过程，不可用于生产环境\n[https://github.com/MakerGYT/dx/blob/master/extend/ThinkSDK/Yiban.php](https://github.com/MakerGYT/dx/blob/master/extend/ThinkSDK/Yiban.php)","slug":"第三方平台API(以易班为例)的使用记录","published":1,"lang":"zh-CN","updated":"2019-04-29T01:07:50.660Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjvnq7zar002d7jjxtkusqr78","content":"<link rel=\"stylesheet\" class=\"aplayer-secondary-style-marker\" href=\"/assets/css/APlayer.min.css\"><script src=\"/assets/js/APlayer.min.js\" class=\"aplayer-secondary-script-marker\"></script><script class=\"meting-secondary-script-marker\" src=\"/assets/js/Meting.min.js\"></script><link rel=\"stylesheet\" type=\"text/css\" href=\"https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css\"><h1 id=\"1-前言\"><a href=\"#1-前言\" class=\"headerlink\" title=\"1. 前言\"></a>1. 前言</h1><p>服务商提供给第三方网站的API使用原理基本相似，使用说明都可以在相应开发平台查看wiki文档。以<a href=\"https://open.yiban.cn\" target=\"_blank\" rel=\"noopener\">易班开放平台</a>为例:</p>\n<p>鉴于易班API使用目前最主要的用户身份验证和授权方式——<a href=\"https://oauth.net/2/\" target=\"_blank\" rel=\"noopener\">oauth2.0</a>，先了解下它的<a href=\"http://www.cnblogs.com/neutra/archive/2012/07/26/2609300.html\" target=\"_blank\" rel=\"noopener\">授权机制</a></p>\n<p>当然，易班开放平台也给出了<a href=\"https://open.yiban.cn/wiki/index.php?page=%E6%8E%88%E6%9D%83%E6%9C%BA%E5%88%B6%E8%AF%B4%E6%98%8E\" target=\"_blank\" rel=\"noopener\">授权概述</a></p>\n<a id=\"more\"></a>\n<h1 id=\"2-开始\"><a href=\"#2-开始\" class=\"headerlink\" title=\"2. 开始\"></a>2. 开始</h1><p>将以网站接入SDK为例，javaSDK的使用可以<a href=\"http://blog.csdn.net/u010513756/article/details/50535657\" target=\"_blank\" rel=\"noopener\">参考</a>（这应该是目前能百度到的唯一的文章）</p>\n<p>.netSDK的使用<a href=\"https://github.com/eightHundreds/YbSDK\" target=\"_blank\" rel=\"noopener\">参考</a>,资料不多，不过是矿大学生开发的。</p>\n<p>下面是phpSDK的（这个琢磨了些日子，容易上手）</p>\n<h2 id=\"2-1-php环境\"><a href=\"#2-1-php环境\" class=\"headerlink\" title=\"2.1.php环境\"></a>2.1.php环境</h2><div class=\"note warning\">\n            <p>php需要开启CURL，这是文档要求，如果没有启用这个扩展，会报错！</p>\n          </div>\n<p>当然也有其他的要求，不过后两个一般来说应该都会满足的</p>\n<p>那么如果不支持curl扩展该怎么办呢？当然，你可以参照网上<a href=\"http://blog.163.com/ymboy@126/blog/static/2871108420108253201587/\" target=\"_blank\" rel=\"noopener\">资料</a>。不过经过测试，无论是改php.ini还是copy那些.dll文件到system32，均无效！那么简单粗暴的方式是重新配置升级php服务器（5.6就行），然后就OK了。</p>\n<h2 id=\"2-2-注册开放平台账号\"><a href=\"#2-2-注册开放平台账号\" class=\"headerlink\" title=\"2.2 注册开放平台账号\"></a>2.2 注册开放平台账号</h2><p><a href=\"https://open.yiban.cn/\" target=\"_blank\" rel=\"noopener\">易班开放平台</a>：可以直接申请（也不费事）。</p>\n<p>申请后就获得了<a href=\"https://o.yiban.cn/debug/apitest\" target=\"_blank\" rel=\"noopener\">测试权限</a>（就是可以体验接口作用的权限），至于要上线的网站，肯定会用到一些实名认证信息，就需要跟管理员<a href=\"https://open.yiban.cn/wiki/index.php?page=%E6%9D%83%E9%99%90%E7%94%B3%E8%AF%B7%E6%B5%81%E7%A8%8B\" target=\"_blank\" rel=\"noopener\">申请更多权限</a></p>\n<p>其他：<br><a href=\"http://wiki.connect.qq.com/\" target=\"_blank\" rel=\"noopener\">QQ互联平台</a>：首先个人开发者需要完成<a href=\"https://connect.qq.com/\" target=\"_blank\" rel=\"noopener\">认证</a>,用QQ登录后创建网站应用，然后就耐心等待吧(此平台体验并不完善，可能已经逐步放弃维护)</p>\n<p><a href=\"https://open.weixin.qq.com\" target=\"_blank\" rel=\"noopener\">微信开放平台</a>：当然也可以申请，不过是需要认证费用以及企业信息的。</p>\n<p>其他还有类似百度、微博开发者平台/开放平台。</p>\n<h2 id=\"2-3-下载SDK\"><a href=\"#2-3-下载SDK\" class=\"headerlink\" title=\"2.3 下载SDK\"></a>2.3 下载SDK</h2><p><a href=\"https://open.yiban.cn/wiki/download/YBApi_sdk_php.zip\" target=\"_blank\" rel=\"noopener\">易班phpSDK</a></p>\n<h2 id=\"2-4-认真阅读wiki后找一些demo下载\"><a href=\"#2-4-认真阅读wiki后找一些demo下载\" class=\"headerlink\" title=\"2.4 认真阅读wiki后找一些demo下载\"></a>2.4 认真阅读wiki后找一些demo下载</h2><ul>\n<li>易班php：SDK里面有个demo文件夹</li>\n<li>github：<a href=\"https://github.com/search?utf8=%E2%9C%93&amp;q=yibanSDK&amp;type=\" target=\"_blank\" rel=\"noopener\">yibanSDK</a></li>\n<li>玉林师范学院： 链接：<a href=\"http://pan.baidu.com/s/1o7RcYwi\" target=\"_blank\" rel=\"noopener\">http://pan.baidu.com/s/1o7RcYwi</a> 密码：5who </li>\n</ul>\n<h2 id=\"依照原理重写了易班PHP-SDK\"><a href=\"#依照原理重写了易班PHP-SDK\" class=\"headerlink\" title=\"依照原理重写了易班PHP SDK\"></a>依照原理重写了易班PHP SDK</h2><p>主要用于实现过程，不可用于生产环境<br><a href=\"https://github.com/MakerGYT/dx/blob/master/extend/ThinkSDK/Yiban.php\" target=\"_blank\" rel=\"noopener\">https://github.com/MakerGYT/dx/blob/master/extend/ThinkSDK/Yiban.php</a></p>\n","site":{"data":{}},"excerpt":"<h1 id=\"1-前言\"><a href=\"#1-前言\" class=\"headerlink\" title=\"1. 前言\"></a>1. 前言</h1><p>服务商提供给第三方网站的API使用原理基本相似，使用说明都可以在相应开发平台查看wiki文档。以<a href=\"https://open.yiban.cn\" target=\"_blank\" rel=\"noopener\">易班开放平台</a>为例:</p>\n<p>鉴于易班API使用目前最主要的用户身份验证和授权方式——<a href=\"https://oauth.net/2/\" target=\"_blank\" rel=\"noopener\">oauth2.0</a>，先了解下它的<a href=\"http://www.cnblogs.com/neutra/archive/2012/07/26/2609300.html\" target=\"_blank\" rel=\"noopener\">授权机制</a></p>\n<p>当然，易班开放平台也给出了<a href=\"https://open.yiban.cn/wiki/index.php?page=%E6%8E%88%E6%9D%83%E6%9C%BA%E5%88%B6%E8%AF%B4%E6%98%8E\" target=\"_blank\" rel=\"noopener\">授权概述</a></p>","more":"<h1 id=\"2-开始\"><a href=\"#2-开始\" class=\"headerlink\" title=\"2. 开始\"></a>2. 开始</h1><p>将以网站接入SDK为例，javaSDK的使用可以<a href=\"http://blog.csdn.net/u010513756/article/details/50535657\" target=\"_blank\" rel=\"noopener\">参考</a>（这应该是目前能百度到的唯一的文章）</p>\n<p>.netSDK的使用<a href=\"https://github.com/eightHundreds/YbSDK\" target=\"_blank\" rel=\"noopener\">参考</a>,资料不多，不过是矿大学生开发的。</p>\n<p>下面是phpSDK的（这个琢磨了些日子，容易上手）</p>\n<h2 id=\"2-1-php环境\"><a href=\"#2-1-php环境\" class=\"headerlink\" title=\"2.1.php环境\"></a>2.1.php环境</h2><div class=\"note warning\">\n            <p>php需要开启CURL，这是文档要求，如果没有启用这个扩展，会报错！</p>\n          </div>\n<p>当然也有其他的要求，不过后两个一般来说应该都会满足的</p>\n<p>那么如果不支持curl扩展该怎么办呢？当然，你可以参照网上<a href=\"http://blog.163.com/ymboy@126/blog/static/2871108420108253201587/\" target=\"_blank\" rel=\"noopener\">资料</a>。不过经过测试，无论是改php.ini还是copy那些.dll文件到system32，均无效！那么简单粗暴的方式是重新配置升级php服务器（5.6就行），然后就OK了。</p>\n<h2 id=\"2-2-注册开放平台账号\"><a href=\"#2-2-注册开放平台账号\" class=\"headerlink\" title=\"2.2 注册开放平台账号\"></a>2.2 注册开放平台账号</h2><p><a href=\"https://open.yiban.cn/\" target=\"_blank\" rel=\"noopener\">易班开放平台</a>：可以直接申请（也不费事）。</p>\n<p>申请后就获得了<a href=\"https://o.yiban.cn/debug/apitest\" target=\"_blank\" rel=\"noopener\">测试权限</a>（就是可以体验接口作用的权限），至于要上线的网站，肯定会用到一些实名认证信息，就需要跟管理员<a href=\"https://open.yiban.cn/wiki/index.php?page=%E6%9D%83%E9%99%90%E7%94%B3%E8%AF%B7%E6%B5%81%E7%A8%8B\" target=\"_blank\" rel=\"noopener\">申请更多权限</a></p>\n<p>其他：<br><a href=\"http://wiki.connect.qq.com/\" target=\"_blank\" rel=\"noopener\">QQ互联平台</a>：首先个人开发者需要完成<a href=\"https://connect.qq.com/\" target=\"_blank\" rel=\"noopener\">认证</a>,用QQ登录后创建网站应用，然后就耐心等待吧(此平台体验并不完善，可能已经逐步放弃维护)</p>\n<p><a href=\"https://open.weixin.qq.com\" target=\"_blank\" rel=\"noopener\">微信开放平台</a>：当然也可以申请，不过是需要认证费用以及企业信息的。</p>\n<p>其他还有类似百度、微博开发者平台/开放平台。</p>\n<h2 id=\"2-3-下载SDK\"><a href=\"#2-3-下载SDK\" class=\"headerlink\" title=\"2.3 下载SDK\"></a>2.3 下载SDK</h2><p><a href=\"https://open.yiban.cn/wiki/download/YBApi_sdk_php.zip\" target=\"_blank\" rel=\"noopener\">易班phpSDK</a></p>\n<h2 id=\"2-4-认真阅读wiki后找一些demo下载\"><a href=\"#2-4-认真阅读wiki后找一些demo下载\" class=\"headerlink\" title=\"2.4 认真阅读wiki后找一些demo下载\"></a>2.4 认真阅读wiki后找一些demo下载</h2><ul>\n<li>易班php：SDK里面有个demo文件夹</li>\n<li>github：<a href=\"https://github.com/search?utf8=%E2%9C%93&amp;q=yibanSDK&amp;type=\" target=\"_blank\" rel=\"noopener\">yibanSDK</a></li>\n<li>玉林师范学院： 链接：<a href=\"http://pan.baidu.com/s/1o7RcYwi\" target=\"_blank\" rel=\"noopener\">http://pan.baidu.com/s/1o7RcYwi</a> 密码：5who </li>\n</ul>\n<h2 id=\"依照原理重写了易班PHP-SDK\"><a href=\"#依照原理重写了易班PHP-SDK\" class=\"headerlink\" title=\"依照原理重写了易班PHP SDK\"></a>依照原理重写了易班PHP SDK</h2><p>主要用于实现过程，不可用于生产环境<br><a href=\"https://github.com/MakerGYT/dx/blob/master/extend/ThinkSDK/Yiban.php\" target=\"_blank\" rel=\"noopener\">https://github.com/MakerGYT/dx/blob/master/extend/ThinkSDK/Yiban.php</a></p>"},{"title":"本地“模拟”一台服务器记录","date":"2017-11-19T10:33:16.000Z","_content":"手头有租用阿里云的centos7的服务器，但目前它的角色既是实验机又是生产环境，感觉这样不太合适，于是产生了下面的需求\n{% note info no-icon %}\n在本地电脑上通过安装虚拟机，实现模拟与操作远程服务器一样的情形，这样将实验环境和生产环境隔离开，也起到本地验证的作用，提高项目的稳定性和安全性\n{% endnote %}\n\n<!-- more -->\n\n# 1 前言\n\n其实，顾名思义**模拟**操作，跟配置远程的服务器/虚拟主机操作是一模一样的，区别在于网络：\n+ 远程服务器是有一个**公网IP**，也就是我们可以从其他联网的IP访问到它\n+ 本地虚拟机是使用宿主机的网络，因而它分到的IP地址是一个**内网IP**，也就是说只能通过宿主机访问到。这一点就如同你用手上的设备访问路由器一样。\n\n那么，基于网络的差异，也就决定了需要做以下两点：\n1. 设置好虚拟机的网络\n2. 改变某些参数使得宿主机能访问到“服务器”\n\n## 1.1 当前环境\n+ 系统：`windows 10 pro 1703`\n+ 工具：[VMware® Workstation 12 Pro](http://sw.bos.baidu.com/sw-search-sp/software/ca7ad8c6d3103/VMware-workstation-full-14.0.0.24051.exe)\n+ 服务器系统:[centos 7.4.1](http://mirrors.aliyun.com/centos/7/isos/x86_64/CentOS-7-x86_64-DVD-1708.iso)\n+ 服务器环境：`Apache 2.4.6` \\ `php-5.4.16` \\ `MariaDB-5.5.56` (`phpmyadmin 4.4.15.10`)\n\n*已测试且仅成功测试以上环境*\n## 1.2 名词约定\n+ 宿主机：物理机，即本地电脑\n\n# 2 开工\n## 2.1 新建虚拟机\n在此之前，已经熟悉VMware且[新建](https://www.cnblogs.com/fzng/p/7228284.html?utm_source=itdadao&utm_medium=referral)了一台适合centos64位的虚拟机\n这里需要注意两点：\n1. 如果跳出不支持虚拟化，请在开机进入BIOS将virtual选项改为enable，具体机型具体百度\n2. 选择自定义(高级)：\n\t+ 安装来源：稍后安装操作系统\n\t+ 选择客户机操作系统：CentOS 64位\n\t+ 位置：不要含中文、特殊字符、空格(所有软件安装不出错的基础要求【1】)\n\t+ 处理器配置、内存、磁盘容量：由于模拟，我设置跟服务器一样的\n\t+ 网络类型：**使用桥接网络***\n\t其余基本一路默认\n\n## 2.2 安装操作系统\n1. 开启后，两项安装方式都可以，我这里选择第一项，Install CentOS 7\n2. 安装语言我选择默认，English，避免乱码字符(所有软件安装不出错的基础要求【2】)\n3. 安装信息摘要：\n\t+ 语言支持把Chinese加上\n\t+ 基本环境由于是模拟，选择最小安装，从头体验配置的操作(这里没有GUI桌面)\n    + 安装位置：分区自动配置\n    + 其余按提示或默认\n4. 完成后重启以root登陆\n\n## 2.3 配置虚拟机基本\n\n### 2.3.1 开启网络连接\n\n先测试一下网络\n```sh\nping -c 5 202.108.22.5 #ping百度的IP，5次\n```\n\nCentOS 7.4默认安装好之后是没有自动开启网络连接的，因此需要我们更改配置文件来开启网络\n```sh\ncd /etc/sysconfig/network-scripts\nls\nifcfg-enXXX ifdown-cth xxxxxxxx\n···\n# 这里会列出该目录下所有脚本，注意第一个ifcfg-enXXX\nvi ifcfg-enXXX\n···\nONBOOT=yes #这里将no改成yes\n```\n\n然后Esc键退出insert模式，`:wq`保存退出，重启网卡：\n```sh\nservice network start\n#再次测试\nping -c 5 202.108.22.5 #ping百度的IP，5次\n#有ttl回应，Ctrl+C退出`ping`\n```\n### 2.3.2 安装vim\n```sh\nyum install vim\n# vim是支持命令行内的编辑器，yum 是一种便捷的安装方式，会自动安装依赖项\n```\n## 2.4 安装LAMP环境\n### 2.4.1 安装Apache\n```sh\nyum install httpd # Apache的软件包名是httpd，服务名也是\n# 启动\nsystemctl start httpd.service\n# 允许开机启动Apache\nsystemctl enable httpd.service\n#检查httpd服务状态\nsystemctl status httpd.service\n#验证：loaded为enables,Active为running\n```\n\n#### 2.4.1.1 防火墙开放tcp端口80：\n```sh\nfirewall-cmd --zone=public --add-port=80/tcp --permanent\n#重启防火墙\nfirewall-cmd --reload\n#检查配置是否成功：\nfirewall-cmd --list-all\n#验证：ports：80/tcp\n```\n##### 2.4.1.2 查询当前主机IP:\n```sh\nip addr\n#形如192.168.xxx 2中找inet第一个地址\n```\n此时，可在宿主机(你的物理机)浏览器访问该IP，会获取Apache欢迎页面\n### 2.4.2 安装php\n```sh\nyum install php\n```\n安装完成后，PHP生成三个配置文件\n1. `/etc/httpd/conf.d/php.conf` 用于被Apache读取\n2. `/etc/httpd/conf.modules.d/10-php.conf` 用于Apache加载LoadModule指定的模块(PHP模块)\n3. `/etc/php.ini` php针对生产环境和开发环境自身的配置文件\n\n#### 2.4.2.1 重启Apache\n```sh\nsystemctl restart httpd\n```\n#### 2.4.2.2 测试Apache正常调用PHP\n```sh\nvim /var/www/html/phpinfo.php\n<?php phpinfo ();?>\n```\n宿主机浏览器访问http://ip/phpinfo.php,如果正常的话可以看到php的安装信息\n### 2.4.3 安装MariaDB\n\n> 从RHEL 7开始Red Hat公司推荐使用MariaDB替换MySQL,基础功能操作一样\n\n```sh\nyum install mariadb-server mariadb\n```\n#### 2.4.3.1 启动\n```sh\nsystemctl start mariadb\nsystemctl status mariadb\n# 验证Active为running\n```\n#### 2.4.3.2 保护数据库\n\n包括设置数据库的 root 密码、移除测试数据库test、移除匿名用户anonymous等\n```sh\nmysqlsecureinstallation\n#出现提示时自行选择是否移除，这里暂不移除，选择n\n```\n#### 2.4.3.3 测试数据库\n\n使用 root 账户登录 MariaDB 并用 quit 退出\n```sh\nmysql -u root -p\nEnter password:\nMariaDB [(none)]> SHOW VARIABLES;\n```\n#### 2.4.3.4 允许远程访问\n```sql\nMariaDB [(none)]> grant all privileges on *.* to root@'%' identified by 'password' with grant option;\n#允许任意ip以root身份password访问\nMariaDB [(none)]> flush privileges;\n#刷新权限\n```\n测试一下在宿主机上navicat访问，*我测试时一般连接会迟滞，使用ssh连接正常*\n\n### 2.4.4 安装PhpMyAdmin\n#### 2.4.4.1 安装库\nCentOS 7.4 仓库默认没有提供 PhpMyAdmin 二进制安装包。如果不适应使用 MySQL 命令行来管理你的数据库，可以通过下面的命令启用 [CentOS\n 7.4 rpmforge 仓库](http://fedoraproject.org/wiki/EPEL#How_can_I_use_these_extra_packages.3F) 来安装 PhpMyAdmin。\n```sh\nyum install https://dl.fedoraproject.org/pub/epel/epel-release-latest-7.noarch.rpm\n#最新链接可在The newest version of ‘epel-release’ for EL7找到\nyum install phpmyadmin\n```\n#### 2.4.4.2 配置\n\n配置远程连接，使得能在宿主机上以http://ip/phpmyadmin访问\n```sh\nvi /etc/httpd/conf.d/phpMyAdmin.conf\n<Directory /usr/share/phpMyAdmin/>\n   AddDefaultCharset UTF-8\n\n   <IfModule mod_authz_core.c>\n     # Apache 2.4\n     <RequireAny>\n      # Require ip 127.0.0.1  #注释掉\n      # Require ip ::1   #注释掉\n      Require all granted   #新添加\n     </RequireAny>\n </IfModule>\n <IfModule !mod_authz_core.c>\n     # Apache 2.2\n     Order Deny,Allow\n     Deny from All\n     Allow from 127.0.0.1\n     Allow from ::1\n   </IfModule>\n</Directory>\n\n<Directory /usr/share/phpMyAdmin/setup/>\n   <IfModule mod_authz_core.c>\n     # Apache 2.4\n     <RequireAny>\n      #Require ip 127.0.0.1  #注释掉\n      #Require ip ::1   #注释掉\n      Require all granted   #新添加\n     </RequireAny>\n   </IfModule>\n   <IfModule !mod_authz_core.c>\n     # Apache 2.2\n     Order Deny,Allow\n     Deny from All\n     Allow from 127.0.0.1\n     Allow from ::1\n   </IfModule>\n</Directory>\n#保存退出\nsystemctl restart httpd\n```\n测试一下并登录http://ip/phpmyadmin\n# 3 完工\n现在可以使用xshell访问，xftp连接模拟上传下载文件，网站文件放在 /var/www/html下。也就是说开启VM让虚拟机跑起来，然后就可以忽略它是虚拟机的存在。","source":"_posts/zh-CN/本地“模拟”一台服务器记录.md","raw":"---\ntitle: 本地“模拟”一台服务器记录\ndate: 2017-11-19 18:33:16\ntags:\n  - centos\ncategories: record\n---\n手头有租用阿里云的centos7的服务器，但目前它的角色既是实验机又是生产环境，感觉这样不太合适，于是产生了下面的需求\n{% note info no-icon %}\n在本地电脑上通过安装虚拟机，实现模拟与操作远程服务器一样的情形，这样将实验环境和生产环境隔离开，也起到本地验证的作用，提高项目的稳定性和安全性\n{% endnote %}\n\n<!-- more -->\n\n# 1 前言\n\n其实，顾名思义**模拟**操作，跟配置远程的服务器/虚拟主机操作是一模一样的，区别在于网络：\n+ 远程服务器是有一个**公网IP**，也就是我们可以从其他联网的IP访问到它\n+ 本地虚拟机是使用宿主机的网络，因而它分到的IP地址是一个**内网IP**，也就是说只能通过宿主机访问到。这一点就如同你用手上的设备访问路由器一样。\n\n那么，基于网络的差异，也就决定了需要做以下两点：\n1. 设置好虚拟机的网络\n2. 改变某些参数使得宿主机能访问到“服务器”\n\n## 1.1 当前环境\n+ 系统：`windows 10 pro 1703`\n+ 工具：[VMware® Workstation 12 Pro](http://sw.bos.baidu.com/sw-search-sp/software/ca7ad8c6d3103/VMware-workstation-full-14.0.0.24051.exe)\n+ 服务器系统:[centos 7.4.1](http://mirrors.aliyun.com/centos/7/isos/x86_64/CentOS-7-x86_64-DVD-1708.iso)\n+ 服务器环境：`Apache 2.4.6` \\ `php-5.4.16` \\ `MariaDB-5.5.56` (`phpmyadmin 4.4.15.10`)\n\n*已测试且仅成功测试以上环境*\n## 1.2 名词约定\n+ 宿主机：物理机，即本地电脑\n\n# 2 开工\n## 2.1 新建虚拟机\n在此之前，已经熟悉VMware且[新建](https://www.cnblogs.com/fzng/p/7228284.html?utm_source=itdadao&utm_medium=referral)了一台适合centos64位的虚拟机\n这里需要注意两点：\n1. 如果跳出不支持虚拟化，请在开机进入BIOS将virtual选项改为enable，具体机型具体百度\n2. 选择自定义(高级)：\n\t+ 安装来源：稍后安装操作系统\n\t+ 选择客户机操作系统：CentOS 64位\n\t+ 位置：不要含中文、特殊字符、空格(所有软件安装不出错的基础要求【1】)\n\t+ 处理器配置、内存、磁盘容量：由于模拟，我设置跟服务器一样的\n\t+ 网络类型：**使用桥接网络***\n\t其余基本一路默认\n\n## 2.2 安装操作系统\n1. 开启后，两项安装方式都可以，我这里选择第一项，Install CentOS 7\n2. 安装语言我选择默认，English，避免乱码字符(所有软件安装不出错的基础要求【2】)\n3. 安装信息摘要：\n\t+ 语言支持把Chinese加上\n\t+ 基本环境由于是模拟，选择最小安装，从头体验配置的操作(这里没有GUI桌面)\n    + 安装位置：分区自动配置\n    + 其余按提示或默认\n4. 完成后重启以root登陆\n\n## 2.3 配置虚拟机基本\n\n### 2.3.1 开启网络连接\n\n先测试一下网络\n```sh\nping -c 5 202.108.22.5 #ping百度的IP，5次\n```\n\nCentOS 7.4默认安装好之后是没有自动开启网络连接的，因此需要我们更改配置文件来开启网络\n```sh\ncd /etc/sysconfig/network-scripts\nls\nifcfg-enXXX ifdown-cth xxxxxxxx\n···\n# 这里会列出该目录下所有脚本，注意第一个ifcfg-enXXX\nvi ifcfg-enXXX\n···\nONBOOT=yes #这里将no改成yes\n```\n\n然后Esc键退出insert模式，`:wq`保存退出，重启网卡：\n```sh\nservice network start\n#再次测试\nping -c 5 202.108.22.5 #ping百度的IP，5次\n#有ttl回应，Ctrl+C退出`ping`\n```\n### 2.3.2 安装vim\n```sh\nyum install vim\n# vim是支持命令行内的编辑器，yum 是一种便捷的安装方式，会自动安装依赖项\n```\n## 2.4 安装LAMP环境\n### 2.4.1 安装Apache\n```sh\nyum install httpd # Apache的软件包名是httpd，服务名也是\n# 启动\nsystemctl start httpd.service\n# 允许开机启动Apache\nsystemctl enable httpd.service\n#检查httpd服务状态\nsystemctl status httpd.service\n#验证：loaded为enables,Active为running\n```\n\n#### 2.4.1.1 防火墙开放tcp端口80：\n```sh\nfirewall-cmd --zone=public --add-port=80/tcp --permanent\n#重启防火墙\nfirewall-cmd --reload\n#检查配置是否成功：\nfirewall-cmd --list-all\n#验证：ports：80/tcp\n```\n##### 2.4.1.2 查询当前主机IP:\n```sh\nip addr\n#形如192.168.xxx 2中找inet第一个地址\n```\n此时，可在宿主机(你的物理机)浏览器访问该IP，会获取Apache欢迎页面\n### 2.4.2 安装php\n```sh\nyum install php\n```\n安装完成后，PHP生成三个配置文件\n1. `/etc/httpd/conf.d/php.conf` 用于被Apache读取\n2. `/etc/httpd/conf.modules.d/10-php.conf` 用于Apache加载LoadModule指定的模块(PHP模块)\n3. `/etc/php.ini` php针对生产环境和开发环境自身的配置文件\n\n#### 2.4.2.1 重启Apache\n```sh\nsystemctl restart httpd\n```\n#### 2.4.2.2 测试Apache正常调用PHP\n```sh\nvim /var/www/html/phpinfo.php\n<?php phpinfo ();?>\n```\n宿主机浏览器访问http://ip/phpinfo.php,如果正常的话可以看到php的安装信息\n### 2.4.3 安装MariaDB\n\n> 从RHEL 7开始Red Hat公司推荐使用MariaDB替换MySQL,基础功能操作一样\n\n```sh\nyum install mariadb-server mariadb\n```\n#### 2.4.3.1 启动\n```sh\nsystemctl start mariadb\nsystemctl status mariadb\n# 验证Active为running\n```\n#### 2.4.3.2 保护数据库\n\n包括设置数据库的 root 密码、移除测试数据库test、移除匿名用户anonymous等\n```sh\nmysqlsecureinstallation\n#出现提示时自行选择是否移除，这里暂不移除，选择n\n```\n#### 2.4.3.3 测试数据库\n\n使用 root 账户登录 MariaDB 并用 quit 退出\n```sh\nmysql -u root -p\nEnter password:\nMariaDB [(none)]> SHOW VARIABLES;\n```\n#### 2.4.3.4 允许远程访问\n```sql\nMariaDB [(none)]> grant all privileges on *.* to root@'%' identified by 'password' with grant option;\n#允许任意ip以root身份password访问\nMariaDB [(none)]> flush privileges;\n#刷新权限\n```\n测试一下在宿主机上navicat访问，*我测试时一般连接会迟滞，使用ssh连接正常*\n\n### 2.4.4 安装PhpMyAdmin\n#### 2.4.4.1 安装库\nCentOS 7.4 仓库默认没有提供 PhpMyAdmin 二进制安装包。如果不适应使用 MySQL 命令行来管理你的数据库，可以通过下面的命令启用 [CentOS\n 7.4 rpmforge 仓库](http://fedoraproject.org/wiki/EPEL#How_can_I_use_these_extra_packages.3F) 来安装 PhpMyAdmin。\n```sh\nyum install https://dl.fedoraproject.org/pub/epel/epel-release-latest-7.noarch.rpm\n#最新链接可在The newest version of ‘epel-release’ for EL7找到\nyum install phpmyadmin\n```\n#### 2.4.4.2 配置\n\n配置远程连接，使得能在宿主机上以http://ip/phpmyadmin访问\n```sh\nvi /etc/httpd/conf.d/phpMyAdmin.conf\n<Directory /usr/share/phpMyAdmin/>\n   AddDefaultCharset UTF-8\n\n   <IfModule mod_authz_core.c>\n     # Apache 2.4\n     <RequireAny>\n      # Require ip 127.0.0.1  #注释掉\n      # Require ip ::1   #注释掉\n      Require all granted   #新添加\n     </RequireAny>\n </IfModule>\n <IfModule !mod_authz_core.c>\n     # Apache 2.2\n     Order Deny,Allow\n     Deny from All\n     Allow from 127.0.0.1\n     Allow from ::1\n   </IfModule>\n</Directory>\n\n<Directory /usr/share/phpMyAdmin/setup/>\n   <IfModule mod_authz_core.c>\n     # Apache 2.4\n     <RequireAny>\n      #Require ip 127.0.0.1  #注释掉\n      #Require ip ::1   #注释掉\n      Require all granted   #新添加\n     </RequireAny>\n   </IfModule>\n   <IfModule !mod_authz_core.c>\n     # Apache 2.2\n     Order Deny,Allow\n     Deny from All\n     Allow from 127.0.0.1\n     Allow from ::1\n   </IfModule>\n</Directory>\n#保存退出\nsystemctl restart httpd\n```\n测试一下并登录http://ip/phpmyadmin\n# 3 完工\n现在可以使用xshell访问，xftp连接模拟上传下载文件，网站文件放在 /var/www/html下。也就是说开启VM让虚拟机跑起来，然后就可以忽略它是虚拟机的存在。","slug":"本地“模拟”一台服务器记录","published":1,"lang":"zh-CN","updated":"2019-04-29T01:07:50.660Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjvnq7zat002f7jjxgkpi0zt6","content":"<link rel=\"stylesheet\" class=\"aplayer-secondary-style-marker\" href=\"/assets/css/APlayer.min.css\"><script src=\"/assets/js/APlayer.min.js\" class=\"aplayer-secondary-script-marker\"></script><script class=\"meting-secondary-script-marker\" src=\"/assets/js/Meting.min.js\"></script><link rel=\"stylesheet\" type=\"text/css\" href=\"https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css\"><p>手头有租用阿里云的centos7的服务器，但目前它的角色既是实验机又是生产环境，感觉这样不太合适，于是产生了下面的需求<br><div class=\"note info no-icon\">\n            <p>在本地电脑上通过安装虚拟机，实现模拟与操作远程服务器一样的情形，这样将实验环境和生产环境隔离开，也起到本地验证的作用，提高项目的稳定性和安全性</p>\n          </div></p>\n<a id=\"more\"></a>\n<h1 id=\"1-前言\"><a href=\"#1-前言\" class=\"headerlink\" title=\"1 前言\"></a>1 前言</h1><p>其实，顾名思义<strong>模拟</strong>操作，跟配置远程的服务器/虚拟主机操作是一模一样的，区别在于网络：</p>\n<ul>\n<li>远程服务器是有一个<strong>公网IP</strong>，也就是我们可以从其他联网的IP访问到它</li>\n<li>本地虚拟机是使用宿主机的网络，因而它分到的IP地址是一个<strong>内网IP</strong>，也就是说只能通过宿主机访问到。这一点就如同你用手上的设备访问路由器一样。</li>\n</ul>\n<p>那么，基于网络的差异，也就决定了需要做以下两点：</p>\n<ol>\n<li>设置好虚拟机的网络</li>\n<li>改变某些参数使得宿主机能访问到“服务器”</li>\n</ol>\n<h2 id=\"1-1-当前环境\"><a href=\"#1-1-当前环境\" class=\"headerlink\" title=\"1.1 当前环境\"></a>1.1 当前环境</h2><ul>\n<li>系统：<code>windows 10 pro 1703</code></li>\n<li>工具：<a href=\"http://sw.bos.baidu.com/sw-search-sp/software/ca7ad8c6d3103/VMware-workstation-full-14.0.0.24051.exe\" target=\"_blank\" rel=\"noopener\">VMware® Workstation 12 Pro</a></li>\n<li>服务器系统:<a href=\"http://mirrors.aliyun.com/centos/7/isos/x86_64/CentOS-7-x86_64-DVD-1708.iso\" target=\"_blank\" rel=\"noopener\">centos 7.4.1</a></li>\n<li>服务器环境：<code>Apache 2.4.6</code> \\ <code>php-5.4.16</code> \\ <code>MariaDB-5.5.56</code> (<code>phpmyadmin 4.4.15.10</code>)</li>\n</ul>\n<p><em>已测试且仅成功测试以上环境</em></p>\n<h2 id=\"1-2-名词约定\"><a href=\"#1-2-名词约定\" class=\"headerlink\" title=\"1.2 名词约定\"></a>1.2 名词约定</h2><ul>\n<li>宿主机：物理机，即本地电脑</li>\n</ul>\n<h1 id=\"2-开工\"><a href=\"#2-开工\" class=\"headerlink\" title=\"2 开工\"></a>2 开工</h1><h2 id=\"2-1-新建虚拟机\"><a href=\"#2-1-新建虚拟机\" class=\"headerlink\" title=\"2.1 新建虚拟机\"></a>2.1 新建虚拟机</h2><p>在此之前，已经熟悉VMware且<a href=\"https://www.cnblogs.com/fzng/p/7228284.html?utm_source=itdadao&amp;utm_medium=referral\" target=\"_blank\" rel=\"noopener\">新建</a>了一台适合centos64位的虚拟机<br>这里需要注意两点：</p>\n<ol>\n<li>如果跳出不支持虚拟化，请在开机进入BIOS将virtual选项改为enable，具体机型具体百度</li>\n<li>选择自定义(高级)：<ul>\n<li>安装来源：稍后安装操作系统</li>\n<li>选择客户机操作系统：CentOS 64位</li>\n<li>位置：不要含中文、特殊字符、空格(所有软件安装不出错的基础要求【1】)</li>\n<li>处理器配置、内存、磁盘容量：由于模拟，我设置跟服务器一样的</li>\n<li>网络类型：<strong>使用桥接网络*</strong><br>其余基本一路默认</li>\n</ul>\n</li>\n</ol>\n<h2 id=\"2-2-安装操作系统\"><a href=\"#2-2-安装操作系统\" class=\"headerlink\" title=\"2.2 安装操作系统\"></a>2.2 安装操作系统</h2><ol>\n<li>开启后，两项安装方式都可以，我这里选择第一项，Install CentOS 7</li>\n<li>安装语言我选择默认，English，避免乱码字符(所有软件安装不出错的基础要求【2】)</li>\n<li>安装信息摘要：<ul>\n<li>语言支持把Chinese加上</li>\n<li>基本环境由于是模拟，选择最小安装，从头体验配置的操作(这里没有GUI桌面)</li>\n<li>安装位置：分区自动配置</li>\n<li>其余按提示或默认</li>\n</ul>\n</li>\n<li>完成后重启以root登陆</li>\n</ol>\n<h2 id=\"2-3-配置虚拟机基本\"><a href=\"#2-3-配置虚拟机基本\" class=\"headerlink\" title=\"2.3 配置虚拟机基本\"></a>2.3 配置虚拟机基本</h2><h3 id=\"2-3-1-开启网络连接\"><a href=\"#2-3-1-开启网络连接\" class=\"headerlink\" title=\"2.3.1 开启网络连接\"></a>2.3.1 开启网络连接</h3><p>先测试一下网络<br><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ping -c 5 202.108.22.5 <span class=\"comment\">#ping百度的IP，5次</span></span><br></pre></td></tr></table></figure></p>\n<p>CentOS 7.4默认安装好之后是没有自动开启网络连接的，因此需要我们更改配置文件来开启网络<br><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">cd</span> /etc/sysconfig/network-scripts</span><br><span class=\"line\">ls</span><br><span class=\"line\">ifcfg-enXXX ifdown-cth xxxxxxxx</span><br><span class=\"line\">···</span><br><span class=\"line\"><span class=\"comment\"># 这里会列出该目录下所有脚本，注意第一个ifcfg-enXXX</span></span><br><span class=\"line\">vi ifcfg-enXXX</span><br><span class=\"line\">···</span><br><span class=\"line\">ONBOOT=yes <span class=\"comment\">#这里将no改成yes</span></span><br></pre></td></tr></table></figure></p>\n<p>然后Esc键退出insert模式，<code>:wq</code>保存退出，重启网卡：<br><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">service network start</span><br><span class=\"line\"><span class=\"comment\">#再次测试</span></span><br><span class=\"line\">ping -c 5 202.108.22.5 <span class=\"comment\">#ping百度的IP，5次</span></span><br><span class=\"line\"><span class=\"comment\">#有ttl回应，Ctrl+C退出`ping`</span></span><br></pre></td></tr></table></figure></p>\n<h3 id=\"2-3-2-安装vim\"><a href=\"#2-3-2-安装vim\" class=\"headerlink\" title=\"2.3.2 安装vim\"></a>2.3.2 安装vim</h3><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yum install vim</span><br><span class=\"line\"><span class=\"comment\"># vim是支持命令行内的编辑器，yum 是一种便捷的安装方式，会自动安装依赖项</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"2-4-安装LAMP环境\"><a href=\"#2-4-安装LAMP环境\" class=\"headerlink\" title=\"2.4 安装LAMP环境\"></a>2.4 安装LAMP环境</h2><h3 id=\"2-4-1-安装Apache\"><a href=\"#2-4-1-安装Apache\" class=\"headerlink\" title=\"2.4.1 安装Apache\"></a>2.4.1 安装Apache</h3><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yum install httpd <span class=\"comment\"># Apache的软件包名是httpd，服务名也是</span></span><br><span class=\"line\"><span class=\"comment\"># 启动</span></span><br><span class=\"line\">systemctl start httpd.service</span><br><span class=\"line\"><span class=\"comment\"># 允许开机启动Apache</span></span><br><span class=\"line\">systemctl <span class=\"built_in\">enable</span> httpd.service</span><br><span class=\"line\"><span class=\"comment\">#检查httpd服务状态</span></span><br><span class=\"line\">systemctl status httpd.service</span><br><span class=\"line\"><span class=\"comment\">#验证：loaded为enables,Active为running</span></span><br></pre></td></tr></table></figure>\n<h4 id=\"2-4-1-1-防火墙开放tcp端口80：\"><a href=\"#2-4-1-1-防火墙开放tcp端口80：\" class=\"headerlink\" title=\"2.4.1.1 防火墙开放tcp端口80：\"></a>2.4.1.1 防火墙开放tcp端口80：</h4><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">firewall-cmd --zone=public --add-port=80/tcp --permanent</span><br><span class=\"line\"><span class=\"comment\">#重启防火墙</span></span><br><span class=\"line\">firewall-cmd --reload</span><br><span class=\"line\"><span class=\"comment\">#检查配置是否成功：</span></span><br><span class=\"line\">firewall-cmd --list-all</span><br><span class=\"line\"><span class=\"comment\">#验证：ports：80/tcp</span></span><br></pre></td></tr></table></figure>\n<h5 id=\"2-4-1-2-查询当前主机IP\"><a href=\"#2-4-1-2-查询当前主机IP\" class=\"headerlink\" title=\"2.4.1.2 查询当前主机IP:\"></a>2.4.1.2 查询当前主机IP:</h5><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ip addr</span><br><span class=\"line\"><span class=\"comment\">#形如192.168.xxx 2中找inet第一个地址</span></span><br></pre></td></tr></table></figure>\n<p>此时，可在宿主机(你的物理机)浏览器访问该IP，会获取Apache欢迎页面</p>\n<h3 id=\"2-4-2-安装php\"><a href=\"#2-4-2-安装php\" class=\"headerlink\" title=\"2.4.2 安装php\"></a>2.4.2 安装php</h3><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yum install php</span><br></pre></td></tr></table></figure>\n<p>安装完成后，PHP生成三个配置文件</p>\n<ol>\n<li><code>/etc/httpd/conf.d/php.conf</code> 用于被Apache读取</li>\n<li><code>/etc/httpd/conf.modules.d/10-php.conf</code> 用于Apache加载LoadModule指定的模块(PHP模块)</li>\n<li><code>/etc/php.ini</code> php针对生产环境和开发环境自身的配置文件</li>\n</ol>\n<h4 id=\"2-4-2-1-重启Apache\"><a href=\"#2-4-2-1-重启Apache\" class=\"headerlink\" title=\"2.4.2.1 重启Apache\"></a>2.4.2.1 重启Apache</h4><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">systemctl restart httpd</span><br></pre></td></tr></table></figure>\n<h4 id=\"2-4-2-2-测试Apache正常调用PHP\"><a href=\"#2-4-2-2-测试Apache正常调用PHP\" class=\"headerlink\" title=\"2.4.2.2 测试Apache正常调用PHP\"></a>2.4.2.2 测试Apache正常调用PHP</h4><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vim /var/www/html/phpinfo.php</span><br><span class=\"line\">&lt;?php phpinfo ();?&gt;</span><br></pre></td></tr></table></figure>\n<p>宿主机浏览器访问<a href=\"http://ip/phpinfo.php,如果正常的话可以看到php的安装信息\" target=\"_blank\" rel=\"noopener\">http://ip/phpinfo.php,如果正常的话可以看到php的安装信息</a></p>\n<h3 id=\"2-4-3-安装MariaDB\"><a href=\"#2-4-3-安装MariaDB\" class=\"headerlink\" title=\"2.4.3 安装MariaDB\"></a>2.4.3 安装MariaDB</h3><blockquote>\n<p>从RHEL 7开始Red Hat公司推荐使用MariaDB替换MySQL,基础功能操作一样</p>\n</blockquote>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yum install mariadb-server mariadb</span><br></pre></td></tr></table></figure>\n<h4 id=\"2-4-3-1-启动\"><a href=\"#2-4-3-1-启动\" class=\"headerlink\" title=\"2.4.3.1 启动\"></a>2.4.3.1 启动</h4><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">systemctl start mariadb</span><br><span class=\"line\">systemctl status mariadb</span><br><span class=\"line\"><span class=\"comment\"># 验证Active为running</span></span><br></pre></td></tr></table></figure>\n<h4 id=\"2-4-3-2-保护数据库\"><a href=\"#2-4-3-2-保护数据库\" class=\"headerlink\" title=\"2.4.3.2 保护数据库\"></a>2.4.3.2 保护数据库</h4><p>包括设置数据库的 root 密码、移除测试数据库test、移除匿名用户anonymous等<br><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mysqlsecureinstallation</span><br><span class=\"line\"><span class=\"comment\">#出现提示时自行选择是否移除，这里暂不移除，选择n</span></span><br></pre></td></tr></table></figure></p>\n<h4 id=\"2-4-3-3-测试数据库\"><a href=\"#2-4-3-3-测试数据库\" class=\"headerlink\" title=\"2.4.3.3 测试数据库\"></a>2.4.3.3 测试数据库</h4><p>使用 root 账户登录 MariaDB 并用 quit 退出<br><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mysql -u root -p</span><br><span class=\"line\">Enter password:</span><br><span class=\"line\">MariaDB [(none)]&gt; SHOW VARIABLES;</span><br></pre></td></tr></table></figure></p>\n<h4 id=\"2-4-3-4-允许远程访问\"><a href=\"#2-4-3-4-允许远程访问\" class=\"headerlink\" title=\"2.4.3.4 允许远程访问\"></a>2.4.3.4 允许远程访问</h4><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">MariaDB [(none)]&gt; grant all privileges on *.* to root@'%' identified by 'password' with grant option;</span><br><span class=\"line\"><span class=\"comment\">#允许任意ip以root身份password访问</span></span><br><span class=\"line\">MariaDB [(none)]&gt; flush privileges;</span><br><span class=\"line\"><span class=\"comment\">#刷新权限</span></span><br></pre></td></tr></table></figure>\n<p>测试一下在宿主机上navicat访问，<em>我测试时一般连接会迟滞，使用ssh连接正常</em></p>\n<h3 id=\"2-4-4-安装PhpMyAdmin\"><a href=\"#2-4-4-安装PhpMyAdmin\" class=\"headerlink\" title=\"2.4.4 安装PhpMyAdmin\"></a>2.4.4 安装PhpMyAdmin</h3><h4 id=\"2-4-4-1-安装库\"><a href=\"#2-4-4-1-安装库\" class=\"headerlink\" title=\"2.4.4.1 安装库\"></a>2.4.4.1 安装库</h4><p>CentOS 7.4 仓库默认没有提供 PhpMyAdmin 二进制安装包。如果不适应使用 MySQL 命令行来管理你的数据库，可以通过下面的命令启用 <a href=\"http://fedoraproject.org/wiki/EPEL#How_can_I_use_these_extra_packages.3F\" target=\"_blank\" rel=\"noopener\">CentOS<br> 7.4 rpmforge 仓库</a> 来安装 PhpMyAdmin。<br><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yum install https://dl.fedoraproject.org/pub/epel/epel-release-latest-7.noarch.rpm</span><br><span class=\"line\"><span class=\"comment\">#最新链接可在The newest version of ‘epel-release’ for EL7找到</span></span><br><span class=\"line\">yum install phpmyadmin</span><br></pre></td></tr></table></figure></p>\n<h4 id=\"2-4-4-2-配置\"><a href=\"#2-4-4-2-配置\" class=\"headerlink\" title=\"2.4.4.2 配置\"></a>2.4.4.2 配置</h4><p>配置远程连接，使得能在宿主机上以<a href=\"http://ip/phpmyadmin访问\" target=\"_blank\" rel=\"noopener\">http://ip/phpmyadmin访问</a><br><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vi /etc/httpd/conf.d/phpMyAdmin.conf</span><br><span class=\"line\">&lt;Directory /usr/share/phpMyAdmin/&gt;</span><br><span class=\"line\">   AddDefaultCharset UTF-8</span><br><span class=\"line\"></span><br><span class=\"line\">   &lt;IfModule mod_authz_core.c&gt;</span><br><span class=\"line\">     <span class=\"comment\"># Apache 2.4</span></span><br><span class=\"line\">     &lt;RequireAny&gt;</span><br><span class=\"line\">      <span class=\"comment\"># Require ip 127.0.0.1  #注释掉</span></span><br><span class=\"line\">      <span class=\"comment\"># Require ip ::1   #注释掉</span></span><br><span class=\"line\">      Require all granted   <span class=\"comment\">#新添加</span></span><br><span class=\"line\">     &lt;/RequireAny&gt;</span><br><span class=\"line\"> &lt;/IfModule&gt;</span><br><span class=\"line\"> &lt;IfModule !mod_authz_core.c&gt;</span><br><span class=\"line\">     <span class=\"comment\"># Apache 2.2</span></span><br><span class=\"line\">     Order Deny,Allow</span><br><span class=\"line\">     Deny from All</span><br><span class=\"line\">     Allow from 127.0.0.1</span><br><span class=\"line\">     Allow from ::1</span><br><span class=\"line\">   &lt;/IfModule&gt;</span><br><span class=\"line\">&lt;/Directory&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;Directory /usr/share/phpMyAdmin/setup/&gt;</span><br><span class=\"line\">   &lt;IfModule mod_authz_core.c&gt;</span><br><span class=\"line\">     <span class=\"comment\"># Apache 2.4</span></span><br><span class=\"line\">     &lt;RequireAny&gt;</span><br><span class=\"line\">      <span class=\"comment\">#Require ip 127.0.0.1  #注释掉</span></span><br><span class=\"line\">      <span class=\"comment\">#Require ip ::1   #注释掉</span></span><br><span class=\"line\">      Require all granted   <span class=\"comment\">#新添加</span></span><br><span class=\"line\">     &lt;/RequireAny&gt;</span><br><span class=\"line\">   &lt;/IfModule&gt;</span><br><span class=\"line\">   &lt;IfModule !mod_authz_core.c&gt;</span><br><span class=\"line\">     <span class=\"comment\"># Apache 2.2</span></span><br><span class=\"line\">     Order Deny,Allow</span><br><span class=\"line\">     Deny from All</span><br><span class=\"line\">     Allow from 127.0.0.1</span><br><span class=\"line\">     Allow from ::1</span><br><span class=\"line\">   &lt;/IfModule&gt;</span><br><span class=\"line\">&lt;/Directory&gt;</span><br><span class=\"line\"><span class=\"comment\">#保存退出</span></span><br><span class=\"line\">systemctl restart httpd</span><br></pre></td></tr></table></figure></p>\n<p>测试一下并登录<a href=\"http://ip/phpmyadmin\" target=\"_blank\" rel=\"noopener\">http://ip/phpmyadmin</a></p>\n<h1 id=\"3-完工\"><a href=\"#3-完工\" class=\"headerlink\" title=\"3 完工\"></a>3 完工</h1><p>现在可以使用xshell访问，xftp连接模拟上传下载文件，网站文件放在 /var/www/html下。也就是说开启VM让虚拟机跑起来，然后就可以忽略它是虚拟机的存在。</p>\n","site":{"data":{}},"excerpt":"<p>手头有租用阿里云的centos7的服务器，但目前它的角色既是实验机又是生产环境，感觉这样不太合适，于是产生了下面的需求<br><div class=\"note info no-icon\">\n            <p>在本地电脑上通过安装虚拟机，实现模拟与操作远程服务器一样的情形，这样将实验环境和生产环境隔离开，也起到本地验证的作用，提高项目的稳定性和安全性</p>\n          </div></p>","more":"<h1 id=\"1-前言\"><a href=\"#1-前言\" class=\"headerlink\" title=\"1 前言\"></a>1 前言</h1><p>其实，顾名思义<strong>模拟</strong>操作，跟配置远程的服务器/虚拟主机操作是一模一样的，区别在于网络：</p>\n<ul>\n<li>远程服务器是有一个<strong>公网IP</strong>，也就是我们可以从其他联网的IP访问到它</li>\n<li>本地虚拟机是使用宿主机的网络，因而它分到的IP地址是一个<strong>内网IP</strong>，也就是说只能通过宿主机访问到。这一点就如同你用手上的设备访问路由器一样。</li>\n</ul>\n<p>那么，基于网络的差异，也就决定了需要做以下两点：</p>\n<ol>\n<li>设置好虚拟机的网络</li>\n<li>改变某些参数使得宿主机能访问到“服务器”</li>\n</ol>\n<h2 id=\"1-1-当前环境\"><a href=\"#1-1-当前环境\" class=\"headerlink\" title=\"1.1 当前环境\"></a>1.1 当前环境</h2><ul>\n<li>系统：<code>windows 10 pro 1703</code></li>\n<li>工具：<a href=\"http://sw.bos.baidu.com/sw-search-sp/software/ca7ad8c6d3103/VMware-workstation-full-14.0.0.24051.exe\" target=\"_blank\" rel=\"noopener\">VMware® Workstation 12 Pro</a></li>\n<li>服务器系统:<a href=\"http://mirrors.aliyun.com/centos/7/isos/x86_64/CentOS-7-x86_64-DVD-1708.iso\" target=\"_blank\" rel=\"noopener\">centos 7.4.1</a></li>\n<li>服务器环境：<code>Apache 2.4.6</code> \\ <code>php-5.4.16</code> \\ <code>MariaDB-5.5.56</code> (<code>phpmyadmin 4.4.15.10</code>)</li>\n</ul>\n<p><em>已测试且仅成功测试以上环境</em></p>\n<h2 id=\"1-2-名词约定\"><a href=\"#1-2-名词约定\" class=\"headerlink\" title=\"1.2 名词约定\"></a>1.2 名词约定</h2><ul>\n<li>宿主机：物理机，即本地电脑</li>\n</ul>\n<h1 id=\"2-开工\"><a href=\"#2-开工\" class=\"headerlink\" title=\"2 开工\"></a>2 开工</h1><h2 id=\"2-1-新建虚拟机\"><a href=\"#2-1-新建虚拟机\" class=\"headerlink\" title=\"2.1 新建虚拟机\"></a>2.1 新建虚拟机</h2><p>在此之前，已经熟悉VMware且<a href=\"https://www.cnblogs.com/fzng/p/7228284.html?utm_source=itdadao&amp;utm_medium=referral\" target=\"_blank\" rel=\"noopener\">新建</a>了一台适合centos64位的虚拟机<br>这里需要注意两点：</p>\n<ol>\n<li>如果跳出不支持虚拟化，请在开机进入BIOS将virtual选项改为enable，具体机型具体百度</li>\n<li>选择自定义(高级)：<ul>\n<li>安装来源：稍后安装操作系统</li>\n<li>选择客户机操作系统：CentOS 64位</li>\n<li>位置：不要含中文、特殊字符、空格(所有软件安装不出错的基础要求【1】)</li>\n<li>处理器配置、内存、磁盘容量：由于模拟，我设置跟服务器一样的</li>\n<li>网络类型：<strong>使用桥接网络*</strong><br>其余基本一路默认</li>\n</ul>\n</li>\n</ol>\n<h2 id=\"2-2-安装操作系统\"><a href=\"#2-2-安装操作系统\" class=\"headerlink\" title=\"2.2 安装操作系统\"></a>2.2 安装操作系统</h2><ol>\n<li>开启后，两项安装方式都可以，我这里选择第一项，Install CentOS 7</li>\n<li>安装语言我选择默认，English，避免乱码字符(所有软件安装不出错的基础要求【2】)</li>\n<li>安装信息摘要：<ul>\n<li>语言支持把Chinese加上</li>\n<li>基本环境由于是模拟，选择最小安装，从头体验配置的操作(这里没有GUI桌面)</li>\n<li>安装位置：分区自动配置</li>\n<li>其余按提示或默认</li>\n</ul>\n</li>\n<li>完成后重启以root登陆</li>\n</ol>\n<h2 id=\"2-3-配置虚拟机基本\"><a href=\"#2-3-配置虚拟机基本\" class=\"headerlink\" title=\"2.3 配置虚拟机基本\"></a>2.3 配置虚拟机基本</h2><h3 id=\"2-3-1-开启网络连接\"><a href=\"#2-3-1-开启网络连接\" class=\"headerlink\" title=\"2.3.1 开启网络连接\"></a>2.3.1 开启网络连接</h3><p>先测试一下网络<br><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ping -c 5 202.108.22.5 <span class=\"comment\">#ping百度的IP，5次</span></span><br></pre></td></tr></table></figure></p>\n<p>CentOS 7.4默认安装好之后是没有自动开启网络连接的，因此需要我们更改配置文件来开启网络<br><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">cd</span> /etc/sysconfig/network-scripts</span><br><span class=\"line\">ls</span><br><span class=\"line\">ifcfg-enXXX ifdown-cth xxxxxxxx</span><br><span class=\"line\">···</span><br><span class=\"line\"><span class=\"comment\"># 这里会列出该目录下所有脚本，注意第一个ifcfg-enXXX</span></span><br><span class=\"line\">vi ifcfg-enXXX</span><br><span class=\"line\">···</span><br><span class=\"line\">ONBOOT=yes <span class=\"comment\">#这里将no改成yes</span></span><br></pre></td></tr></table></figure></p>\n<p>然后Esc键退出insert模式，<code>:wq</code>保存退出，重启网卡：<br><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">service network start</span><br><span class=\"line\"><span class=\"comment\">#再次测试</span></span><br><span class=\"line\">ping -c 5 202.108.22.5 <span class=\"comment\">#ping百度的IP，5次</span></span><br><span class=\"line\"><span class=\"comment\">#有ttl回应，Ctrl+C退出`ping`</span></span><br></pre></td></tr></table></figure></p>\n<h3 id=\"2-3-2-安装vim\"><a href=\"#2-3-2-安装vim\" class=\"headerlink\" title=\"2.3.2 安装vim\"></a>2.3.2 安装vim</h3><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yum install vim</span><br><span class=\"line\"><span class=\"comment\"># vim是支持命令行内的编辑器，yum 是一种便捷的安装方式，会自动安装依赖项</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"2-4-安装LAMP环境\"><a href=\"#2-4-安装LAMP环境\" class=\"headerlink\" title=\"2.4 安装LAMP环境\"></a>2.4 安装LAMP环境</h2><h3 id=\"2-4-1-安装Apache\"><a href=\"#2-4-1-安装Apache\" class=\"headerlink\" title=\"2.4.1 安装Apache\"></a>2.4.1 安装Apache</h3><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yum install httpd <span class=\"comment\"># Apache的软件包名是httpd，服务名也是</span></span><br><span class=\"line\"><span class=\"comment\"># 启动</span></span><br><span class=\"line\">systemctl start httpd.service</span><br><span class=\"line\"><span class=\"comment\"># 允许开机启动Apache</span></span><br><span class=\"line\">systemctl <span class=\"built_in\">enable</span> httpd.service</span><br><span class=\"line\"><span class=\"comment\">#检查httpd服务状态</span></span><br><span class=\"line\">systemctl status httpd.service</span><br><span class=\"line\"><span class=\"comment\">#验证：loaded为enables,Active为running</span></span><br></pre></td></tr></table></figure>\n<h4 id=\"2-4-1-1-防火墙开放tcp端口80：\"><a href=\"#2-4-1-1-防火墙开放tcp端口80：\" class=\"headerlink\" title=\"2.4.1.1 防火墙开放tcp端口80：\"></a>2.4.1.1 防火墙开放tcp端口80：</h4><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">firewall-cmd --zone=public --add-port=80/tcp --permanent</span><br><span class=\"line\"><span class=\"comment\">#重启防火墙</span></span><br><span class=\"line\">firewall-cmd --reload</span><br><span class=\"line\"><span class=\"comment\">#检查配置是否成功：</span></span><br><span class=\"line\">firewall-cmd --list-all</span><br><span class=\"line\"><span class=\"comment\">#验证：ports：80/tcp</span></span><br></pre></td></tr></table></figure>\n<h5 id=\"2-4-1-2-查询当前主机IP\"><a href=\"#2-4-1-2-查询当前主机IP\" class=\"headerlink\" title=\"2.4.1.2 查询当前主机IP:\"></a>2.4.1.2 查询当前主机IP:</h5><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ip addr</span><br><span class=\"line\"><span class=\"comment\">#形如192.168.xxx 2中找inet第一个地址</span></span><br></pre></td></tr></table></figure>\n<p>此时，可在宿主机(你的物理机)浏览器访问该IP，会获取Apache欢迎页面</p>\n<h3 id=\"2-4-2-安装php\"><a href=\"#2-4-2-安装php\" class=\"headerlink\" title=\"2.4.2 安装php\"></a>2.4.2 安装php</h3><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yum install php</span><br></pre></td></tr></table></figure>\n<p>安装完成后，PHP生成三个配置文件</p>\n<ol>\n<li><code>/etc/httpd/conf.d/php.conf</code> 用于被Apache读取</li>\n<li><code>/etc/httpd/conf.modules.d/10-php.conf</code> 用于Apache加载LoadModule指定的模块(PHP模块)</li>\n<li><code>/etc/php.ini</code> php针对生产环境和开发环境自身的配置文件</li>\n</ol>\n<h4 id=\"2-4-2-1-重启Apache\"><a href=\"#2-4-2-1-重启Apache\" class=\"headerlink\" title=\"2.4.2.1 重启Apache\"></a>2.4.2.1 重启Apache</h4><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">systemctl restart httpd</span><br></pre></td></tr></table></figure>\n<h4 id=\"2-4-2-2-测试Apache正常调用PHP\"><a href=\"#2-4-2-2-测试Apache正常调用PHP\" class=\"headerlink\" title=\"2.4.2.2 测试Apache正常调用PHP\"></a>2.4.2.2 测试Apache正常调用PHP</h4><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vim /var/www/html/phpinfo.php</span><br><span class=\"line\">&lt;?php phpinfo ();?&gt;</span><br></pre></td></tr></table></figure>\n<p>宿主机浏览器访问<a href=\"http://ip/phpinfo.php,如果正常的话可以看到php的安装信息\" target=\"_blank\" rel=\"noopener\">http://ip/phpinfo.php,如果正常的话可以看到php的安装信息</a></p>\n<h3 id=\"2-4-3-安装MariaDB\"><a href=\"#2-4-3-安装MariaDB\" class=\"headerlink\" title=\"2.4.3 安装MariaDB\"></a>2.4.3 安装MariaDB</h3><blockquote>\n<p>从RHEL 7开始Red Hat公司推荐使用MariaDB替换MySQL,基础功能操作一样</p>\n</blockquote>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yum install mariadb-server mariadb</span><br></pre></td></tr></table></figure>\n<h4 id=\"2-4-3-1-启动\"><a href=\"#2-4-3-1-启动\" class=\"headerlink\" title=\"2.4.3.1 启动\"></a>2.4.3.1 启动</h4><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">systemctl start mariadb</span><br><span class=\"line\">systemctl status mariadb</span><br><span class=\"line\"><span class=\"comment\"># 验证Active为running</span></span><br></pre></td></tr></table></figure>\n<h4 id=\"2-4-3-2-保护数据库\"><a href=\"#2-4-3-2-保护数据库\" class=\"headerlink\" title=\"2.4.3.2 保护数据库\"></a>2.4.3.2 保护数据库</h4><p>包括设置数据库的 root 密码、移除测试数据库test、移除匿名用户anonymous等<br><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mysqlsecureinstallation</span><br><span class=\"line\"><span class=\"comment\">#出现提示时自行选择是否移除，这里暂不移除，选择n</span></span><br></pre></td></tr></table></figure></p>\n<h4 id=\"2-4-3-3-测试数据库\"><a href=\"#2-4-3-3-测试数据库\" class=\"headerlink\" title=\"2.4.3.3 测试数据库\"></a>2.4.3.3 测试数据库</h4><p>使用 root 账户登录 MariaDB 并用 quit 退出<br><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mysql -u root -p</span><br><span class=\"line\">Enter password:</span><br><span class=\"line\">MariaDB [(none)]&gt; SHOW VARIABLES;</span><br></pre></td></tr></table></figure></p>\n<h4 id=\"2-4-3-4-允许远程访问\"><a href=\"#2-4-3-4-允许远程访问\" class=\"headerlink\" title=\"2.4.3.4 允许远程访问\"></a>2.4.3.4 允许远程访问</h4><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">MariaDB [(none)]&gt; grant all privileges on *.* to root@'%' identified by 'password' with grant option;</span><br><span class=\"line\"><span class=\"comment\">#允许任意ip以root身份password访问</span></span><br><span class=\"line\">MariaDB [(none)]&gt; flush privileges;</span><br><span class=\"line\"><span class=\"comment\">#刷新权限</span></span><br></pre></td></tr></table></figure>\n<p>测试一下在宿主机上navicat访问，<em>我测试时一般连接会迟滞，使用ssh连接正常</em></p>\n<h3 id=\"2-4-4-安装PhpMyAdmin\"><a href=\"#2-4-4-安装PhpMyAdmin\" class=\"headerlink\" title=\"2.4.4 安装PhpMyAdmin\"></a>2.4.4 安装PhpMyAdmin</h3><h4 id=\"2-4-4-1-安装库\"><a href=\"#2-4-4-1-安装库\" class=\"headerlink\" title=\"2.4.4.1 安装库\"></a>2.4.4.1 安装库</h4><p>CentOS 7.4 仓库默认没有提供 PhpMyAdmin 二进制安装包。如果不适应使用 MySQL 命令行来管理你的数据库，可以通过下面的命令启用 <a href=\"http://fedoraproject.org/wiki/EPEL#How_can_I_use_these_extra_packages.3F\" target=\"_blank\" rel=\"noopener\">CentOS<br> 7.4 rpmforge 仓库</a> 来安装 PhpMyAdmin。<br><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yum install https://dl.fedoraproject.org/pub/epel/epel-release-latest-7.noarch.rpm</span><br><span class=\"line\"><span class=\"comment\">#最新链接可在The newest version of ‘epel-release’ for EL7找到</span></span><br><span class=\"line\">yum install phpmyadmin</span><br></pre></td></tr></table></figure></p>\n<h4 id=\"2-4-4-2-配置\"><a href=\"#2-4-4-2-配置\" class=\"headerlink\" title=\"2.4.4.2 配置\"></a>2.4.4.2 配置</h4><p>配置远程连接，使得能在宿主机上以<a href=\"http://ip/phpmyadmin访问\" target=\"_blank\" rel=\"noopener\">http://ip/phpmyadmin访问</a><br><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vi /etc/httpd/conf.d/phpMyAdmin.conf</span><br><span class=\"line\">&lt;Directory /usr/share/phpMyAdmin/&gt;</span><br><span class=\"line\">   AddDefaultCharset UTF-8</span><br><span class=\"line\"></span><br><span class=\"line\">   &lt;IfModule mod_authz_core.c&gt;</span><br><span class=\"line\">     <span class=\"comment\"># Apache 2.4</span></span><br><span class=\"line\">     &lt;RequireAny&gt;</span><br><span class=\"line\">      <span class=\"comment\"># Require ip 127.0.0.1  #注释掉</span></span><br><span class=\"line\">      <span class=\"comment\"># Require ip ::1   #注释掉</span></span><br><span class=\"line\">      Require all granted   <span class=\"comment\">#新添加</span></span><br><span class=\"line\">     &lt;/RequireAny&gt;</span><br><span class=\"line\"> &lt;/IfModule&gt;</span><br><span class=\"line\"> &lt;IfModule !mod_authz_core.c&gt;</span><br><span class=\"line\">     <span class=\"comment\"># Apache 2.2</span></span><br><span class=\"line\">     Order Deny,Allow</span><br><span class=\"line\">     Deny from All</span><br><span class=\"line\">     Allow from 127.0.0.1</span><br><span class=\"line\">     Allow from ::1</span><br><span class=\"line\">   &lt;/IfModule&gt;</span><br><span class=\"line\">&lt;/Directory&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;Directory /usr/share/phpMyAdmin/setup/&gt;</span><br><span class=\"line\">   &lt;IfModule mod_authz_core.c&gt;</span><br><span class=\"line\">     <span class=\"comment\"># Apache 2.4</span></span><br><span class=\"line\">     &lt;RequireAny&gt;</span><br><span class=\"line\">      <span class=\"comment\">#Require ip 127.0.0.1  #注释掉</span></span><br><span class=\"line\">      <span class=\"comment\">#Require ip ::1   #注释掉</span></span><br><span class=\"line\">      Require all granted   <span class=\"comment\">#新添加</span></span><br><span class=\"line\">     &lt;/RequireAny&gt;</span><br><span class=\"line\">   &lt;/IfModule&gt;</span><br><span class=\"line\">   &lt;IfModule !mod_authz_core.c&gt;</span><br><span class=\"line\">     <span class=\"comment\"># Apache 2.2</span></span><br><span class=\"line\">     Order Deny,Allow</span><br><span class=\"line\">     Deny from All</span><br><span class=\"line\">     Allow from 127.0.0.1</span><br><span class=\"line\">     Allow from ::1</span><br><span class=\"line\">   &lt;/IfModule&gt;</span><br><span class=\"line\">&lt;/Directory&gt;</span><br><span class=\"line\"><span class=\"comment\">#保存退出</span></span><br><span class=\"line\">systemctl restart httpd</span><br></pre></td></tr></table></figure></p>\n<p>测试一下并登录<a href=\"http://ip/phpmyadmin\" target=\"_blank\" rel=\"noopener\">http://ip/phpmyadmin</a></p>\n<h1 id=\"3-完工\"><a href=\"#3-完工\" class=\"headerlink\" title=\"3 完工\"></a>3 完工</h1><p>现在可以使用xshell访问，xftp连接模拟上传下载文件，网站文件放在 /var/www/html下。也就是说开启VM让虚拟机跑起来，然后就可以忽略它是虚拟机的存在。</p>"},{"title":"网络代理初探记录","date":"2018-12-24T09:30:30.000Z","_content":"\n# 一、概述：\n主要由两部分组成:服务端(中介)和客户端\n<!-- more -->\n# 二、准备材料：\n- 资金：>=$10\n- Paypal账户：绑定信用卡\n- 本地工具：ubuntu terminal(用到ssh,ftp,git) \n\n# 三、开工：\n\n## 3.1 服务端配置\n\n### 3.1.1 注册vultr账户\n\n> Vultr, founded in 2014, is on a mission to empower developers and businesses by simplifying the deployment of infrastructure via its advanced cloud platform. \n\n<a href=\"https://www.vultr.com/?ref=7910710-4F\"><img src=\"https://www.vultr.com/media/banners/banner_728x90.png\" width=\"728\" height=\"90\"></a>\n\n[注册](https://www.vultr.com/?ref=7533527)\n\n该服务商采用的是先[充值](https://www.vultr.com/?ref=7910710-4F)后消费，按量计费。然后deploy一台服务器，规格如下：\n\n| Server Location        | New York (NJ) | \n| ------------- |:-------------:| \n| Server Type     | Ubuntu 16.04 x64 | \n| Server Size  | 25 GB  `SSD` 1 `CPU` 1024MB `Memory` 1000GB `Bandwidth` （ $5/month）|   \n| Other options | Temporary default |  \n\n完成后会生成随机密码（不支持直接修改），通过提供的console或远程shell工具登录服务器后修改root用户密码(`sudo passwd root`)。\n\n### 3.1.2 安装\n\n安装SS\n\n```python\n#install basic pip dependency:\napt-get install python-pip #default 8.1.1\npip install --upgrade pip #to 18.1 close current terminal and restart\napt-get install python-setuptools\n#start core work\npip install shadowsocks\n```\n或者\n```linux\n#install:shadowsocks-libev\nsudo apt-get install software-properties-common -y\nsudo add-apt-repository ppa:max-c-lv/shadowsocks-libev -y\nsudo apt-get update\nsudo apt install shadowsocks-libev\n```\n在`/etc`下新建一个配置文件\n```\nvim /etc/shadowsocks.json\n```\n配置内容如下：\n```python\n {\n \"server\": \"3.1.1中server的公网ip\",\n \"server_port\": 8388,#注册端口范围1024~65535内均可\n \"local_address\": \"127.0.0.1\",\n \"local_port\": 1080,\n \"password\": \"客户端用来连接的密码\",\n \"timeout\": 300,\n \"method\": \"aes-256-cfb\",\n \"fast_open\": false\n }\n```\n\n{% note primary %}\n如需多人使用，配置内容如下\n端口1和端口2填两个不同的端口，如8388 8389\n密码1和密码2是两个端口对应的登录密码，可不同\n```python\n{\n\"server\": \"服务器ip\",\n\"port_password\": {\n\"端口1\": \"密码1\",\n\"端口2\": \"密码2\"\n},\n\"timeout\": 300,\n\"method\": \"aes-256-cfb\",\n\"fast_open\": false\n}\n```\n{% endnote %}\n\n保存配置文件后，启动服务端\n```\nssserver -c /etc/shadowsocks.json -d start\n```\n``AttributeError: /usr/lib/x86_64-linux-gnu/libcrypto.so.1.1: undefined symbol: EVP_CIPHER_CTX_cleanup``\n```sh\nvim /usr/local/lib/python2.7/dist-packages/shadowsocks/crypto/openssl.py\n# /usr/local/lib/python2.7/dist-packages/shadowsocks/crypto/openssl.py\nline52 libcrypto.EVP_CIPHER_CTX_cleanup.argtypes = (c_void_p,) -> libcrypto.EVP_CIPHER_CTX_reset.argtypes = (c_void_p,)\nline111 libcrypto.EVP_CIPHER_CTX_cleanup(self._ctx) -> libcrypto.EVP_CIPHER_CTX_reset(self._ctx) \n```\n本地测试服务端是否可连接`telnet ip地址 8388`，若不通需在服务器中配置防火墙，永久开启此TCP端口，官方安全组配置无效。\n\n### 3.1.3 bbr 加速\n\n#### 3.1.3.1 升级内核\n\n#### 3.1.3.2 修改系统变量：\n```sh\nsudo echo \"net.core.default_qdisc=fq\" >> /etc/sysctl.conf\nsudo echo \"net.ipv4.tcp_congestion_control=bbr\" >> /etc/sysctl.conf\n#保存生效\nsysctl -p\n#测试\nsysctl net.ipv4.tcp_available_congestion_control\n#如果返回结果，则开启成功\nnet.ipv4.tcp_available_congestion_control = bbr cubic reno\n```\n\n## 3.2 客户端配置\n\n### 3.2.1 GUI客户端:Windows、Mac、Android、iOS版本\n[https://github.com/shadowsocks/shadowsocks/wiki/Ports-and-Clients](https://github.com/shadowsocks/shadowsocks/wiki/Ports-and-Clients)\n### 3.2.2 ubuntu客户端\n\n#### 3.2.2.1 基础配置\n\n```sh\n#首先需要保证网络是畅通的，然后更新软件源：\nsudo apt-get update\n#安装python-pip\nsudo apt-get install python-pip\n#安装ss\nsudo pip install shadowsocks\n#配置ss\nsudo vim /etc/shadowsocks.json\n# shadowsocks.json\n{\n    \"server\": \"同3.2.1服务器公网ip\",\n    \"server_port\": 同3.2.1服务器端口,\n    \"local_address\": \"127.0.0.1\",\n    \"local_port\": 1080,\n    \"password\": \"同3.2.1SS密码\",\n    \"method\": \"aes-256-cfb\",\n    \"fast_open\": true,\n    \"timeout\":300\n}\n#启动SS\nsudo sslocal -c /etc/shadowsocks.json \n```\n上述命令执行后，此终端不能关闭，可通过`nohup/setsid`实现后台运行，通过rc.local实现开机自启(此处考虑日常访问实际未采用)。\n\n#### 3.2.2.1 privoxy配置\nprivoxy实现将sock5代理映射为http代理\n```sh\n#安装privoxy\nsudo apt-get install privoxy\n#配置privoxy\nsudo chmod 666 /etc/privoxy/config # 只读改可写\nvim /etc/privoxy/config\n# config：\n#4.1节取消注释`listen-address localhost:8118`\n#5.2节末尾加入 `forward-socks5 / 127.0.0.1:1080 .`\n#重启privoxy服务\nsudo /etc/init.d/privoxy restart\n#开机自启privoxy服务\nsystemctl enable privoxy\n#查看privoxy服务状态\nsystemctl status privoxy\n```\n\n#### 3.2.2.2 代理配置\n实现终端内可访问\n1.  终端代理\n    将以下代码追加到`/etc/profile`中或者`~/.bashrc`中\n```sh\nexport http_proxy=\"127.0.0.1:8118\"\nexport https_proxy=\"127.0.0.1:8118\"\nexport ftp_proxy=\"127.0.0.1:8118\"\n```\n接着执行`source /etc/profile`或者`source ~/.bashrc`\n2. 浏览器代理\n在浏览器的proxy settings中手动配置如下：firefox为例\n\n| Http Proxy        | 127.0.0.1 | 8118  |\n| ------------- |:-------------:| -----:|\n| SSL Proxy  | 127.0.0.1 | 8118 |\n| ftp Proxy  | 127.0.0.1 | 8118 |\n| sockets Proxy| 127.0.0.1 | 8118|\n\n勾选Use this proxy server for all protocols\n\n3. 全局代理\n在ubuntu setting->Network->Network proxy,method选择Manual，代理配置项与上述浏览器一致。\n开启3代理后即终端或是浏览器上网均走代理，可根据访问位置选择代理方式。\n\n# 四、测试\n终端内开启后可wget一个 foreign domain检验其index.html是否可下载，浏览器访问网站请求时，shadowsocks服务窗口会显示当前请求信息\nandriod或pc点击开启后，浏览器访问foreign domain测试\n\n# 五、进阶\n通过使用[shadowsocks-manager](https://github.com/shadowsocks/shadowsocks-manager)构建多用户管理和流量控制界面,普通用户可直接通过[https://vpn.makergyt.com](https://vpn.makergyt.com)注册使用，省去配置服务端工作，也可为维护者带来一定收益。\n\n# Reference\n\n<small>[1]Geyh.[Ubuntu系统SS搭建配置](http://blog.51cto.com/13589319/2068374).51CTO.2018.\n[2]EXP.[Centos + Shadowsocks客户端 + Privoxy实现外网访问](http://exp-blog.com/2018/07/04/pid-1591/).exp-blog.2018.\n[3]苏黎世1995.ubuntu18.0.4搭建ss服务器步骤及问题.https://blog.51cto.com/13544424/2314396dra</small>","source":"_posts/zh-CN/网络代理初探记录.md","raw":"---\ntitle: 网络代理初探记录\ndate: 2018-12-24 17:30:30\ntags:\n    - shadowsocks\ncategories: record\n---\n\n# 一、概述：\n主要由两部分组成:服务端(中介)和客户端\n<!-- more -->\n# 二、准备材料：\n- 资金：>=$10\n- Paypal账户：绑定信用卡\n- 本地工具：ubuntu terminal(用到ssh,ftp,git) \n\n# 三、开工：\n\n## 3.1 服务端配置\n\n### 3.1.1 注册vultr账户\n\n> Vultr, founded in 2014, is on a mission to empower developers and businesses by simplifying the deployment of infrastructure via its advanced cloud platform. \n\n<a href=\"https://www.vultr.com/?ref=7910710-4F\"><img src=\"https://www.vultr.com/media/banners/banner_728x90.png\" width=\"728\" height=\"90\"></a>\n\n[注册](https://www.vultr.com/?ref=7533527)\n\n该服务商采用的是先[充值](https://www.vultr.com/?ref=7910710-4F)后消费，按量计费。然后deploy一台服务器，规格如下：\n\n| Server Location        | New York (NJ) | \n| ------------- |:-------------:| \n| Server Type     | Ubuntu 16.04 x64 | \n| Server Size  | 25 GB  `SSD` 1 `CPU` 1024MB `Memory` 1000GB `Bandwidth` （ $5/month）|   \n| Other options | Temporary default |  \n\n完成后会生成随机密码（不支持直接修改），通过提供的console或远程shell工具登录服务器后修改root用户密码(`sudo passwd root`)。\n\n### 3.1.2 安装\n\n安装SS\n\n```python\n#install basic pip dependency:\napt-get install python-pip #default 8.1.1\npip install --upgrade pip #to 18.1 close current terminal and restart\napt-get install python-setuptools\n#start core work\npip install shadowsocks\n```\n或者\n```linux\n#install:shadowsocks-libev\nsudo apt-get install software-properties-common -y\nsudo add-apt-repository ppa:max-c-lv/shadowsocks-libev -y\nsudo apt-get update\nsudo apt install shadowsocks-libev\n```\n在`/etc`下新建一个配置文件\n```\nvim /etc/shadowsocks.json\n```\n配置内容如下：\n```python\n {\n \"server\": \"3.1.1中server的公网ip\",\n \"server_port\": 8388,#注册端口范围1024~65535内均可\n \"local_address\": \"127.0.0.1\",\n \"local_port\": 1080,\n \"password\": \"客户端用来连接的密码\",\n \"timeout\": 300,\n \"method\": \"aes-256-cfb\",\n \"fast_open\": false\n }\n```\n\n{% note primary %}\n如需多人使用，配置内容如下\n端口1和端口2填两个不同的端口，如8388 8389\n密码1和密码2是两个端口对应的登录密码，可不同\n```python\n{\n\"server\": \"服务器ip\",\n\"port_password\": {\n\"端口1\": \"密码1\",\n\"端口2\": \"密码2\"\n},\n\"timeout\": 300,\n\"method\": \"aes-256-cfb\",\n\"fast_open\": false\n}\n```\n{% endnote %}\n\n保存配置文件后，启动服务端\n```\nssserver -c /etc/shadowsocks.json -d start\n```\n``AttributeError: /usr/lib/x86_64-linux-gnu/libcrypto.so.1.1: undefined symbol: EVP_CIPHER_CTX_cleanup``\n```sh\nvim /usr/local/lib/python2.7/dist-packages/shadowsocks/crypto/openssl.py\n# /usr/local/lib/python2.7/dist-packages/shadowsocks/crypto/openssl.py\nline52 libcrypto.EVP_CIPHER_CTX_cleanup.argtypes = (c_void_p,) -> libcrypto.EVP_CIPHER_CTX_reset.argtypes = (c_void_p,)\nline111 libcrypto.EVP_CIPHER_CTX_cleanup(self._ctx) -> libcrypto.EVP_CIPHER_CTX_reset(self._ctx) \n```\n本地测试服务端是否可连接`telnet ip地址 8388`，若不通需在服务器中配置防火墙，永久开启此TCP端口，官方安全组配置无效。\n\n### 3.1.3 bbr 加速\n\n#### 3.1.3.1 升级内核\n\n#### 3.1.3.2 修改系统变量：\n```sh\nsudo echo \"net.core.default_qdisc=fq\" >> /etc/sysctl.conf\nsudo echo \"net.ipv4.tcp_congestion_control=bbr\" >> /etc/sysctl.conf\n#保存生效\nsysctl -p\n#测试\nsysctl net.ipv4.tcp_available_congestion_control\n#如果返回结果，则开启成功\nnet.ipv4.tcp_available_congestion_control = bbr cubic reno\n```\n\n## 3.2 客户端配置\n\n### 3.2.1 GUI客户端:Windows、Mac、Android、iOS版本\n[https://github.com/shadowsocks/shadowsocks/wiki/Ports-and-Clients](https://github.com/shadowsocks/shadowsocks/wiki/Ports-and-Clients)\n### 3.2.2 ubuntu客户端\n\n#### 3.2.2.1 基础配置\n\n```sh\n#首先需要保证网络是畅通的，然后更新软件源：\nsudo apt-get update\n#安装python-pip\nsudo apt-get install python-pip\n#安装ss\nsudo pip install shadowsocks\n#配置ss\nsudo vim /etc/shadowsocks.json\n# shadowsocks.json\n{\n    \"server\": \"同3.2.1服务器公网ip\",\n    \"server_port\": 同3.2.1服务器端口,\n    \"local_address\": \"127.0.0.1\",\n    \"local_port\": 1080,\n    \"password\": \"同3.2.1SS密码\",\n    \"method\": \"aes-256-cfb\",\n    \"fast_open\": true,\n    \"timeout\":300\n}\n#启动SS\nsudo sslocal -c /etc/shadowsocks.json \n```\n上述命令执行后，此终端不能关闭，可通过`nohup/setsid`实现后台运行，通过rc.local实现开机自启(此处考虑日常访问实际未采用)。\n\n#### 3.2.2.1 privoxy配置\nprivoxy实现将sock5代理映射为http代理\n```sh\n#安装privoxy\nsudo apt-get install privoxy\n#配置privoxy\nsudo chmod 666 /etc/privoxy/config # 只读改可写\nvim /etc/privoxy/config\n# config：\n#4.1节取消注释`listen-address localhost:8118`\n#5.2节末尾加入 `forward-socks5 / 127.0.0.1:1080 .`\n#重启privoxy服务\nsudo /etc/init.d/privoxy restart\n#开机自启privoxy服务\nsystemctl enable privoxy\n#查看privoxy服务状态\nsystemctl status privoxy\n```\n\n#### 3.2.2.2 代理配置\n实现终端内可访问\n1.  终端代理\n    将以下代码追加到`/etc/profile`中或者`~/.bashrc`中\n```sh\nexport http_proxy=\"127.0.0.1:8118\"\nexport https_proxy=\"127.0.0.1:8118\"\nexport ftp_proxy=\"127.0.0.1:8118\"\n```\n接着执行`source /etc/profile`或者`source ~/.bashrc`\n2. 浏览器代理\n在浏览器的proxy settings中手动配置如下：firefox为例\n\n| Http Proxy        | 127.0.0.1 | 8118  |\n| ------------- |:-------------:| -----:|\n| SSL Proxy  | 127.0.0.1 | 8118 |\n| ftp Proxy  | 127.0.0.1 | 8118 |\n| sockets Proxy| 127.0.0.1 | 8118|\n\n勾选Use this proxy server for all protocols\n\n3. 全局代理\n在ubuntu setting->Network->Network proxy,method选择Manual，代理配置项与上述浏览器一致。\n开启3代理后即终端或是浏览器上网均走代理，可根据访问位置选择代理方式。\n\n# 四、测试\n终端内开启后可wget一个 foreign domain检验其index.html是否可下载，浏览器访问网站请求时，shadowsocks服务窗口会显示当前请求信息\nandriod或pc点击开启后，浏览器访问foreign domain测试\n\n# 五、进阶\n通过使用[shadowsocks-manager](https://github.com/shadowsocks/shadowsocks-manager)构建多用户管理和流量控制界面,普通用户可直接通过[https://vpn.makergyt.com](https://vpn.makergyt.com)注册使用，省去配置服务端工作，也可为维护者带来一定收益。\n\n# Reference\n\n<small>[1]Geyh.[Ubuntu系统SS搭建配置](http://blog.51cto.com/13589319/2068374).51CTO.2018.\n[2]EXP.[Centos + Shadowsocks客户端 + Privoxy实现外网访问](http://exp-blog.com/2018/07/04/pid-1591/).exp-blog.2018.\n[3]苏黎世1995.ubuntu18.0.4搭建ss服务器步骤及问题.https://blog.51cto.com/13544424/2314396dra</small>","slug":"网络代理初探记录","published":1,"lang":"zh-CN","updated":"2019-12-29T08:21:16.000Z","_id":"cjvnq7zav002i7jjxh7qsh9xm","comments":1,"layout":"post","photos":[],"link":"","content":"<link rel=\"stylesheet\" class=\"aplayer-secondary-style-marker\" href=\"/assets/css/APlayer.min.css\"><script src=\"/assets/js/APlayer.min.js\" class=\"aplayer-secondary-script-marker\"></script><script class=\"meting-secondary-script-marker\" src=\"/assets/js/Meting.min.js\"></script><link rel=\"stylesheet\" type=\"text/css\" href=\"https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css\"><h1 id=\"一、概述：\"><a href=\"#一、概述：\" class=\"headerlink\" title=\"一、概述：\"></a>一、概述：</h1><p>主要由两部分组成:服务端(中介)和客户端<br><a id=\"more\"></a></p>\n<h1 id=\"二、准备材料：\"><a href=\"#二、准备材料：\" class=\"headerlink\" title=\"二、准备材料：\"></a>二、准备材料：</h1><ul>\n<li>资金：&gt;=$10</li>\n<li>Paypal账户：绑定信用卡</li>\n<li>本地工具：ubuntu terminal(用到ssh,ftp,git) </li>\n</ul>\n<h1 id=\"三、开工：\"><a href=\"#三、开工：\" class=\"headerlink\" title=\"三、开工：\"></a>三、开工：</h1><h2 id=\"3-1-服务端配置\"><a href=\"#3-1-服务端配置\" class=\"headerlink\" title=\"3.1 服务端配置\"></a>3.1 服务端配置</h2><h3 id=\"3-1-1-注册vultr账户\"><a href=\"#3-1-1-注册vultr账户\" class=\"headerlink\" title=\"3.1.1 注册vultr账户\"></a>3.1.1 注册vultr账户</h3><blockquote>\n<p>Vultr, founded in 2014, is on a mission to empower developers and businesses by simplifying the deployment of infrastructure via its advanced cloud platform. </p>\n</blockquote>\n<p><a href=\"https://www.vultr.com/?ref=7910710-4F\" target=\"_blank\" rel=\"noopener\"><img src=\"https://www.vultr.com/media/banners/banner_728x90.png\" width=\"728\" height=\"90\"></a></p>\n<p><a href=\"https://www.vultr.com/?ref=7533527\" target=\"_blank\" rel=\"noopener\">注册</a></p>\n<p>该服务商采用的是先<a href=\"https://www.vultr.com/?ref=7910710-4F\" target=\"_blank\" rel=\"noopener\">充值</a>后消费，按量计费。然后deploy一台服务器，规格如下：</p>\n<table>\n<thead>\n<tr>\n<th>Server Location</th>\n<th style=\"text-align:center\">New York (NJ)</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>Server Type</td>\n<td style=\"text-align:center\">Ubuntu 16.04 x64</td>\n</tr>\n<tr>\n<td>Server Size</td>\n<td style=\"text-align:center\">25 GB  <code>SSD</code> 1 <code>CPU</code> 1024MB <code>Memory</code> 1000GB <code>Bandwidth</code> （ $5/month）</td>\n</tr>\n<tr>\n<td>Other options</td>\n<td style=\"text-align:center\">Temporary default</td>\n</tr>\n</tbody>\n</table>\n<p>完成后会生成随机密码（不支持直接修改），通过提供的console或远程shell工具登录服务器后修改root用户密码(<code>sudo passwd root</code>)。</p>\n<h3 id=\"3-1-2-安装\"><a href=\"#3-1-2-安装\" class=\"headerlink\" title=\"3.1.2 安装\"></a>3.1.2 安装</h3><p>安装SS</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#install basic pip dependency:</span></span><br><span class=\"line\">apt-get install python-pip <span class=\"comment\">#default 8.1.1</span></span><br><span class=\"line\">pip install --upgrade pip <span class=\"comment\">#to 18.1 close current terminal and restart</span></span><br><span class=\"line\">apt-get install python-setuptools</span><br><span class=\"line\"><span class=\"comment\">#start core work</span></span><br><span class=\"line\">pip install shadowsocks</span><br></pre></td></tr></table></figure>\n<p>或者<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#install:shadowsocks-libev</span><br><span class=\"line\">sudo apt-get install software-properties-common -y</span><br><span class=\"line\">sudo add-apt-repository ppa:max-c-lv/shadowsocks-libev -y</span><br><span class=\"line\">sudo apt-get update</span><br><span class=\"line\">sudo apt install shadowsocks-libev</span><br></pre></td></tr></table></figure></p>\n<p>在<code>/etc</code>下新建一个配置文件<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vim /etc/shadowsocks.json</span><br></pre></td></tr></table></figure></p>\n<p>配置内容如下：<br><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\"><span class=\"string\">\"server\"</span>: <span class=\"string\">\"3.1.1中server的公网ip\"</span>,</span><br><span class=\"line\"><span class=\"string\">\"server_port\"</span>: <span class=\"number\">8388</span>,<span class=\"comment\">#注册端口范围1024~65535内均可</span></span><br><span class=\"line\"><span class=\"string\">\"local_address\"</span>: <span class=\"string\">\"127.0.0.1\"</span>,</span><br><span class=\"line\"><span class=\"string\">\"local_port\"</span>: <span class=\"number\">1080</span>,</span><br><span class=\"line\"><span class=\"string\">\"password\"</span>: <span class=\"string\">\"客户端用来连接的密码\"</span>,</span><br><span class=\"line\"><span class=\"string\">\"timeout\"</span>: <span class=\"number\">300</span>,</span><br><span class=\"line\"><span class=\"string\">\"method\"</span>: <span class=\"string\">\"aes-256-cfb\"</span>,</span><br><span class=\"line\"><span class=\"string\">\"fast_open\"</span>: false</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<div class=\"note primary\">\n            <p>如需多人使用，配置内容如下<br>端口1和端口2填两个不同的端口，如8388 8389<br>密码1和密码2是两个端口对应的登录密码，可不同<br>undefined</p>\n          </div>\n<p>保存配置文件后，启动服务端<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ssserver -c /etc/shadowsocks.json -d start</span><br></pre></td></tr></table></figure></p>\n<p><code>AttributeError: /usr/lib/x86_64-linux-gnu/libcrypto.so.1.1: undefined symbol: EVP_CIPHER_CTX_cleanup</code><br><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vim /usr/<span class=\"built_in\">local</span>/lib/python2.7/dist-packages/shadowsocks/crypto/openssl.py</span><br><span class=\"line\"><span class=\"comment\"># /usr/local/lib/python2.7/dist-packages/shadowsocks/crypto/openssl.py</span></span><br><span class=\"line\">line52 libcrypto.EVP_CIPHER_CTX_cleanup.argtypes = (c_void_p,) -&gt; libcrypto.EVP_CIPHER_CTX_reset.argtypes = (c_void_p,)</span><br><span class=\"line\">line111 libcrypto.EVP_CIPHER_CTX_cleanup(self._ctx) -&gt; libcrypto.EVP_CIPHER_CTX_reset(self._ctx)</span><br></pre></td></tr></table></figure></p>\n<p>本地测试服务端是否可连接<code>telnet ip地址 8388</code>，若不通需在服务器中配置防火墙，永久开启此TCP端口，官方安全组配置无效。</p>\n<h3 id=\"3-1-3-bbr-加速\"><a href=\"#3-1-3-bbr-加速\" class=\"headerlink\" title=\"3.1.3 bbr 加速\"></a>3.1.3 bbr 加速</h3><h4 id=\"3-1-3-1-升级内核\"><a href=\"#3-1-3-1-升级内核\" class=\"headerlink\" title=\"3.1.3.1 升级内核\"></a>3.1.3.1 升级内核</h4><h4 id=\"3-1-3-2-修改系统变量：\"><a href=\"#3-1-3-2-修改系统变量：\" class=\"headerlink\" title=\"3.1.3.2 修改系统变量：\"></a>3.1.3.2 修改系统变量：</h4><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo <span class=\"built_in\">echo</span> <span class=\"string\">\"net.core.default_qdisc=fq\"</span> &gt;&gt; /etc/sysctl.conf</span><br><span class=\"line\">sudo <span class=\"built_in\">echo</span> <span class=\"string\">\"net.ipv4.tcp_congestion_control=bbr\"</span> &gt;&gt; /etc/sysctl.conf</span><br><span class=\"line\"><span class=\"comment\">#保存生效</span></span><br><span class=\"line\">sysctl -p</span><br><span class=\"line\"><span class=\"comment\">#测试</span></span><br><span class=\"line\">sysctl net.ipv4.tcp_available_congestion_control</span><br><span class=\"line\"><span class=\"comment\">#如果返回结果，则开启成功</span></span><br><span class=\"line\">net.ipv4.tcp_available_congestion_control = bbr cubic reno</span><br></pre></td></tr></table></figure>\n<h2 id=\"3-2-客户端配置\"><a href=\"#3-2-客户端配置\" class=\"headerlink\" title=\"3.2 客户端配置\"></a>3.2 客户端配置</h2><h3 id=\"3-2-1-GUI客户端-Windows、Mac、Android、iOS版本\"><a href=\"#3-2-1-GUI客户端-Windows、Mac、Android、iOS版本\" class=\"headerlink\" title=\"3.2.1 GUI客户端:Windows、Mac、Android、iOS版本\"></a>3.2.1 GUI客户端:Windows、Mac、Android、iOS版本</h3><p><a href=\"https://github.com/shadowsocks/shadowsocks/wiki/Ports-and-Clients\" target=\"_blank\" rel=\"noopener\">https://github.com/shadowsocks/shadowsocks/wiki/Ports-and-Clients</a></p>\n<h3 id=\"3-2-2-ubuntu客户端\"><a href=\"#3-2-2-ubuntu客户端\" class=\"headerlink\" title=\"3.2.2 ubuntu客户端\"></a>3.2.2 ubuntu客户端</h3><h4 id=\"3-2-2-1-基础配置\"><a href=\"#3-2-2-1-基础配置\" class=\"headerlink\" title=\"3.2.2.1 基础配置\"></a>3.2.2.1 基础配置</h4><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#首先需要保证网络是畅通的，然后更新软件源：</span></span><br><span class=\"line\">sudo apt-get update</span><br><span class=\"line\"><span class=\"comment\">#安装python-pip</span></span><br><span class=\"line\">sudo apt-get install python-pip</span><br><span class=\"line\"><span class=\"comment\">#安装ss</span></span><br><span class=\"line\">sudo pip install shadowsocks</span><br><span class=\"line\"><span class=\"comment\">#配置ss</span></span><br><span class=\"line\">sudo vim /etc/shadowsocks.json</span><br><span class=\"line\"><span class=\"comment\"># shadowsocks.json</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"string\">\"server\"</span>: <span class=\"string\">\"同3.2.1服务器公网ip\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"server_port\"</span>: 同3.2.1服务器端口,</span><br><span class=\"line\">    <span class=\"string\">\"local_address\"</span>: <span class=\"string\">\"127.0.0.1\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"local_port\"</span>: 1080,</span><br><span class=\"line\">    <span class=\"string\">\"password\"</span>: <span class=\"string\">\"同3.2.1SS密码\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"method\"</span>: <span class=\"string\">\"aes-256-cfb\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"fast_open\"</span>: <span class=\"literal\">true</span>,</span><br><span class=\"line\">    <span class=\"string\">\"timeout\"</span>:300</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">#启动SS</span></span><br><span class=\"line\">sudo sslocal -c /etc/shadowsocks.json</span><br></pre></td></tr></table></figure>\n<p>上述命令执行后，此终端不能关闭，可通过<code>nohup/setsid</code>实现后台运行，通过rc.local实现开机自启(此处考虑日常访问实际未采用)。</p>\n<h4 id=\"3-2-2-1-privoxy配置\"><a href=\"#3-2-2-1-privoxy配置\" class=\"headerlink\" title=\"3.2.2.1 privoxy配置\"></a>3.2.2.1 privoxy配置</h4><p>privoxy实现将sock5代理映射为http代理<br><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#安装privoxy</span></span><br><span class=\"line\">sudo apt-get install privoxy</span><br><span class=\"line\"><span class=\"comment\">#配置privoxy</span></span><br><span class=\"line\">sudo chmod 666 /etc/privoxy/config <span class=\"comment\"># 只读改可写</span></span><br><span class=\"line\">vim /etc/privoxy/config</span><br><span class=\"line\"><span class=\"comment\"># config：</span></span><br><span class=\"line\"><span class=\"comment\">#4.1节取消注释`listen-address localhost:8118`</span></span><br><span class=\"line\"><span class=\"comment\">#5.2节末尾加入 `forward-socks5 / 127.0.0.1:1080 .`</span></span><br><span class=\"line\"><span class=\"comment\">#重启privoxy服务</span></span><br><span class=\"line\">sudo /etc/init.d/privoxy restart</span><br><span class=\"line\"><span class=\"comment\">#开机自启privoxy服务</span></span><br><span class=\"line\">systemctl <span class=\"built_in\">enable</span> privoxy</span><br><span class=\"line\"><span class=\"comment\">#查看privoxy服务状态</span></span><br><span class=\"line\">systemctl status privoxy</span><br></pre></td></tr></table></figure></p>\n<h4 id=\"3-2-2-2-代理配置\"><a href=\"#3-2-2-2-代理配置\" class=\"headerlink\" title=\"3.2.2.2 代理配置\"></a>3.2.2.2 代理配置</h4><p>实现终端内可访问</p>\n<ol>\n<li>终端代理<br>将以下代码追加到<code>/etc/profile</code>中或者<code>~/.bashrc</code>中<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">export</span> http_proxy=<span class=\"string\">\"127.0.0.1:8118\"</span></span><br><span class=\"line\"><span class=\"built_in\">export</span> https_proxy=<span class=\"string\">\"127.0.0.1:8118\"</span></span><br><span class=\"line\"><span class=\"built_in\">export</span> ftp_proxy=<span class=\"string\">\"127.0.0.1:8118\"</span></span><br></pre></td></tr></table></figure>\n</li>\n</ol>\n<p>接着执行<code>source /etc/profile</code>或者<code>source ~/.bashrc</code></p>\n<ol start=\"2\">\n<li>浏览器代理<br>在浏览器的proxy settings中手动配置如下：firefox为例</li>\n</ol>\n<table>\n<thead>\n<tr>\n<th>Http Proxy</th>\n<th style=\"text-align:center\">127.0.0.1</th>\n<th style=\"text-align:right\">8118</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>SSL Proxy</td>\n<td style=\"text-align:center\">127.0.0.1</td>\n<td style=\"text-align:right\">8118</td>\n</tr>\n<tr>\n<td>ftp Proxy</td>\n<td style=\"text-align:center\">127.0.0.1</td>\n<td style=\"text-align:right\">8118</td>\n</tr>\n<tr>\n<td>sockets Proxy</td>\n<td style=\"text-align:center\">127.0.0.1</td>\n<td style=\"text-align:right\">8118</td>\n</tr>\n</tbody>\n</table>\n<p>勾选Use this proxy server for all protocols</p>\n<ol start=\"3\">\n<li>全局代理<br>在ubuntu setting-&gt;Network-&gt;Network proxy,method选择Manual，代理配置项与上述浏览器一致。<br>开启3代理后即终端或是浏览器上网均走代理，可根据访问位置选择代理方式。</li>\n</ol>\n<h1 id=\"四、测试\"><a href=\"#四、测试\" class=\"headerlink\" title=\"四、测试\"></a>四、测试</h1><p>终端内开启后可wget一个 foreign domain检验其index.html是否可下载，浏览器访问网站请求时，shadowsocks服务窗口会显示当前请求信息<br>andriod或pc点击开启后，浏览器访问foreign domain测试</p>\n<h1 id=\"五、进阶\"><a href=\"#五、进阶\" class=\"headerlink\" title=\"五、进阶\"></a>五、进阶</h1><p>通过使用<a href=\"https://github.com/shadowsocks/shadowsocks-manager\" target=\"_blank\" rel=\"noopener\">shadowsocks-manager</a>构建多用户管理和流量控制界面,普通用户可直接通过<a href=\"https://vpn.makergyt.com\" target=\"_blank\" rel=\"noopener\">https://vpn.makergyt.com</a>注册使用，省去配置服务端工作，也可为维护者带来一定收益。</p>\n<h1 id=\"Reference\"><a href=\"#Reference\" class=\"headerlink\" title=\"Reference\"></a>Reference</h1><p><small>[1]Geyh.<a href=\"http://blog.51cto.com/13589319/2068374\" target=\"_blank\" rel=\"noopener\">Ubuntu系统SS搭建配置</a>.51CTO.2018.<br>[2]EXP.<a href=\"http://exp-blog.com/2018/07/04/pid-1591/\" target=\"_blank\" rel=\"noopener\">Centos + Shadowsocks客户端 + Privoxy实现外网访问</a>.exp-blog.2018.<br>[3]苏黎世1995.ubuntu18.0.4搭建ss服务器步骤及问题.<a href=\"https://blog.51cto.com/13544424/2314396dra\" target=\"_blank\" rel=\"noopener\">https://blog.51cto.com/13544424/2314396dra</a></small></p>\n","site":{"data":{}},"excerpt":"<h1 id=\"一、概述：\"><a href=\"#一、概述：\" class=\"headerlink\" title=\"一、概述：\"></a>一、概述：</h1><p>主要由两部分组成:服务端(中介)和客户端<br>","more":"</p>\n<h1 id=\"二、准备材料：\"><a href=\"#二、准备材料：\" class=\"headerlink\" title=\"二、准备材料：\"></a>二、准备材料：</h1><ul>\n<li>资金：&gt;=$10</li>\n<li>Paypal账户：绑定信用卡</li>\n<li>本地工具：ubuntu terminal(用到ssh,ftp,git) </li>\n</ul>\n<h1 id=\"三、开工：\"><a href=\"#三、开工：\" class=\"headerlink\" title=\"三、开工：\"></a>三、开工：</h1><h2 id=\"3-1-服务端配置\"><a href=\"#3-1-服务端配置\" class=\"headerlink\" title=\"3.1 服务端配置\"></a>3.1 服务端配置</h2><h3 id=\"3-1-1-注册vultr账户\"><a href=\"#3-1-1-注册vultr账户\" class=\"headerlink\" title=\"3.1.1 注册vultr账户\"></a>3.1.1 注册vultr账户</h3><blockquote>\n<p>Vultr, founded in 2014, is on a mission to empower developers and businesses by simplifying the deployment of infrastructure via its advanced cloud platform. </p>\n</blockquote>\n<p><a href=\"https://www.vultr.com/?ref=7910710-4F\" target=\"_blank\" rel=\"noopener\"><img src=\"https://www.vultr.com/media/banners/banner_728x90.png\" width=\"728\" height=\"90\"></a></p>\n<p><a href=\"https://www.vultr.com/?ref=7533527\" target=\"_blank\" rel=\"noopener\">注册</a></p>\n<p>该服务商采用的是先<a href=\"https://www.vultr.com/?ref=7910710-4F\" target=\"_blank\" rel=\"noopener\">充值</a>后消费，按量计费。然后deploy一台服务器，规格如下：</p>\n<table>\n<thead>\n<tr>\n<th>Server Location</th>\n<th style=\"text-align:center\">New York (NJ)</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>Server Type</td>\n<td style=\"text-align:center\">Ubuntu 16.04 x64</td>\n</tr>\n<tr>\n<td>Server Size</td>\n<td style=\"text-align:center\">25 GB  <code>SSD</code> 1 <code>CPU</code> 1024MB <code>Memory</code> 1000GB <code>Bandwidth</code> （ $5/month）</td>\n</tr>\n<tr>\n<td>Other options</td>\n<td style=\"text-align:center\">Temporary default</td>\n</tr>\n</tbody>\n</table>\n<p>完成后会生成随机密码（不支持直接修改），通过提供的console或远程shell工具登录服务器后修改root用户密码(<code>sudo passwd root</code>)。</p>\n<h3 id=\"3-1-2-安装\"><a href=\"#3-1-2-安装\" class=\"headerlink\" title=\"3.1.2 安装\"></a>3.1.2 安装</h3><p>安装SS</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#install basic pip dependency:</span></span><br><span class=\"line\">apt-get install python-pip <span class=\"comment\">#default 8.1.1</span></span><br><span class=\"line\">pip install --upgrade pip <span class=\"comment\">#to 18.1 close current terminal and restart</span></span><br><span class=\"line\">apt-get install python-setuptools</span><br><span class=\"line\"><span class=\"comment\">#start core work</span></span><br><span class=\"line\">pip install shadowsocks</span><br></pre></td></tr></table></figure>\n<p>或者<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#install:shadowsocks-libev</span><br><span class=\"line\">sudo apt-get install software-properties-common -y</span><br><span class=\"line\">sudo add-apt-repository ppa:max-c-lv/shadowsocks-libev -y</span><br><span class=\"line\">sudo apt-get update</span><br><span class=\"line\">sudo apt install shadowsocks-libev</span><br></pre></td></tr></table></figure></p>\n<p>在<code>/etc</code>下新建一个配置文件<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vim /etc/shadowsocks.json</span><br></pre></td></tr></table></figure></p>\n<p>配置内容如下：<br><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\"><span class=\"string\">\"server\"</span>: <span class=\"string\">\"3.1.1中server的公网ip\"</span>,</span><br><span class=\"line\"><span class=\"string\">\"server_port\"</span>: <span class=\"number\">8388</span>,<span class=\"comment\">#注册端口范围1024~65535内均可</span></span><br><span class=\"line\"><span class=\"string\">\"local_address\"</span>: <span class=\"string\">\"127.0.0.1\"</span>,</span><br><span class=\"line\"><span class=\"string\">\"local_port\"</span>: <span class=\"number\">1080</span>,</span><br><span class=\"line\"><span class=\"string\">\"password\"</span>: <span class=\"string\">\"客户端用来连接的密码\"</span>,</span><br><span class=\"line\"><span class=\"string\">\"timeout\"</span>: <span class=\"number\">300</span>,</span><br><span class=\"line\"><span class=\"string\">\"method\"</span>: <span class=\"string\">\"aes-256-cfb\"</span>,</span><br><span class=\"line\"><span class=\"string\">\"fast_open\"</span>: false</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<div class=\"note primary\">\n            <p>如需多人使用，配置内容如下<br>端口1和端口2填两个不同的端口，如8388 8389<br>密码1和密码2是两个端口对应的登录密码，可不同<br>undefined</p>\n          </div>\n<p>保存配置文件后，启动服务端<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ssserver -c /etc/shadowsocks.json -d start</span><br></pre></td></tr></table></figure></p>\n<p><code>AttributeError: /usr/lib/x86_64-linux-gnu/libcrypto.so.1.1: undefined symbol: EVP_CIPHER_CTX_cleanup</code><br><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vim /usr/<span class=\"built_in\">local</span>/lib/python2.7/dist-packages/shadowsocks/crypto/openssl.py</span><br><span class=\"line\"><span class=\"comment\"># /usr/local/lib/python2.7/dist-packages/shadowsocks/crypto/openssl.py</span></span><br><span class=\"line\">line52 libcrypto.EVP_CIPHER_CTX_cleanup.argtypes = (c_void_p,) -&gt; libcrypto.EVP_CIPHER_CTX_reset.argtypes = (c_void_p,)</span><br><span class=\"line\">line111 libcrypto.EVP_CIPHER_CTX_cleanup(self._ctx) -&gt; libcrypto.EVP_CIPHER_CTX_reset(self._ctx)</span><br></pre></td></tr></table></figure></p>\n<p>本地测试服务端是否可连接<code>telnet ip地址 8388</code>，若不通需在服务器中配置防火墙，永久开启此TCP端口，官方安全组配置无效。</p>\n<h3 id=\"3-1-3-bbr-加速\"><a href=\"#3-1-3-bbr-加速\" class=\"headerlink\" title=\"3.1.3 bbr 加速\"></a>3.1.3 bbr 加速</h3><h4 id=\"3-1-3-1-升级内核\"><a href=\"#3-1-3-1-升级内核\" class=\"headerlink\" title=\"3.1.3.1 升级内核\"></a>3.1.3.1 升级内核</h4><h4 id=\"3-1-3-2-修改系统变量：\"><a href=\"#3-1-3-2-修改系统变量：\" class=\"headerlink\" title=\"3.1.3.2 修改系统变量：\"></a>3.1.3.2 修改系统变量：</h4><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo <span class=\"built_in\">echo</span> <span class=\"string\">\"net.core.default_qdisc=fq\"</span> &gt;&gt; /etc/sysctl.conf</span><br><span class=\"line\">sudo <span class=\"built_in\">echo</span> <span class=\"string\">\"net.ipv4.tcp_congestion_control=bbr\"</span> &gt;&gt; /etc/sysctl.conf</span><br><span class=\"line\"><span class=\"comment\">#保存生效</span></span><br><span class=\"line\">sysctl -p</span><br><span class=\"line\"><span class=\"comment\">#测试</span></span><br><span class=\"line\">sysctl net.ipv4.tcp_available_congestion_control</span><br><span class=\"line\"><span class=\"comment\">#如果返回结果，则开启成功</span></span><br><span class=\"line\">net.ipv4.tcp_available_congestion_control = bbr cubic reno</span><br></pre></td></tr></table></figure>\n<h2 id=\"3-2-客户端配置\"><a href=\"#3-2-客户端配置\" class=\"headerlink\" title=\"3.2 客户端配置\"></a>3.2 客户端配置</h2><h3 id=\"3-2-1-GUI客户端-Windows、Mac、Android、iOS版本\"><a href=\"#3-2-1-GUI客户端-Windows、Mac、Android、iOS版本\" class=\"headerlink\" title=\"3.2.1 GUI客户端:Windows、Mac、Android、iOS版本\"></a>3.2.1 GUI客户端:Windows、Mac、Android、iOS版本</h3><p><a href=\"https://github.com/shadowsocks/shadowsocks/wiki/Ports-and-Clients\" target=\"_blank\" rel=\"noopener\">https://github.com/shadowsocks/shadowsocks/wiki/Ports-and-Clients</a></p>\n<h3 id=\"3-2-2-ubuntu客户端\"><a href=\"#3-2-2-ubuntu客户端\" class=\"headerlink\" title=\"3.2.2 ubuntu客户端\"></a>3.2.2 ubuntu客户端</h3><h4 id=\"3-2-2-1-基础配置\"><a href=\"#3-2-2-1-基础配置\" class=\"headerlink\" title=\"3.2.2.1 基础配置\"></a>3.2.2.1 基础配置</h4><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#首先需要保证网络是畅通的，然后更新软件源：</span></span><br><span class=\"line\">sudo apt-get update</span><br><span class=\"line\"><span class=\"comment\">#安装python-pip</span></span><br><span class=\"line\">sudo apt-get install python-pip</span><br><span class=\"line\"><span class=\"comment\">#安装ss</span></span><br><span class=\"line\">sudo pip install shadowsocks</span><br><span class=\"line\"><span class=\"comment\">#配置ss</span></span><br><span class=\"line\">sudo vim /etc/shadowsocks.json</span><br><span class=\"line\"><span class=\"comment\"># shadowsocks.json</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"string\">\"server\"</span>: <span class=\"string\">\"同3.2.1服务器公网ip\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"server_port\"</span>: 同3.2.1服务器端口,</span><br><span class=\"line\">    <span class=\"string\">\"local_address\"</span>: <span class=\"string\">\"127.0.0.1\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"local_port\"</span>: 1080,</span><br><span class=\"line\">    <span class=\"string\">\"password\"</span>: <span class=\"string\">\"同3.2.1SS密码\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"method\"</span>: <span class=\"string\">\"aes-256-cfb\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"fast_open\"</span>: <span class=\"literal\">true</span>,</span><br><span class=\"line\">    <span class=\"string\">\"timeout\"</span>:300</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">#启动SS</span></span><br><span class=\"line\">sudo sslocal -c /etc/shadowsocks.json</span><br></pre></td></tr></table></figure>\n<p>上述命令执行后，此终端不能关闭，可通过<code>nohup/setsid</code>实现后台运行，通过rc.local实现开机自启(此处考虑日常访问实际未采用)。</p>\n<h4 id=\"3-2-2-1-privoxy配置\"><a href=\"#3-2-2-1-privoxy配置\" class=\"headerlink\" title=\"3.2.2.1 privoxy配置\"></a>3.2.2.1 privoxy配置</h4><p>privoxy实现将sock5代理映射为http代理<br><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#安装privoxy</span></span><br><span class=\"line\">sudo apt-get install privoxy</span><br><span class=\"line\"><span class=\"comment\">#配置privoxy</span></span><br><span class=\"line\">sudo chmod 666 /etc/privoxy/config <span class=\"comment\"># 只读改可写</span></span><br><span class=\"line\">vim /etc/privoxy/config</span><br><span class=\"line\"><span class=\"comment\"># config：</span></span><br><span class=\"line\"><span class=\"comment\">#4.1节取消注释`listen-address localhost:8118`</span></span><br><span class=\"line\"><span class=\"comment\">#5.2节末尾加入 `forward-socks5 / 127.0.0.1:1080 .`</span></span><br><span class=\"line\"><span class=\"comment\">#重启privoxy服务</span></span><br><span class=\"line\">sudo /etc/init.d/privoxy restart</span><br><span class=\"line\"><span class=\"comment\">#开机自启privoxy服务</span></span><br><span class=\"line\">systemctl <span class=\"built_in\">enable</span> privoxy</span><br><span class=\"line\"><span class=\"comment\">#查看privoxy服务状态</span></span><br><span class=\"line\">systemctl status privoxy</span><br></pre></td></tr></table></figure></p>\n<h4 id=\"3-2-2-2-代理配置\"><a href=\"#3-2-2-2-代理配置\" class=\"headerlink\" title=\"3.2.2.2 代理配置\"></a>3.2.2.2 代理配置</h4><p>实现终端内可访问</p>\n<ol>\n<li>终端代理<br>将以下代码追加到<code>/etc/profile</code>中或者<code>~/.bashrc</code>中<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">export</span> http_proxy=<span class=\"string\">\"127.0.0.1:8118\"</span></span><br><span class=\"line\"><span class=\"built_in\">export</span> https_proxy=<span class=\"string\">\"127.0.0.1:8118\"</span></span><br><span class=\"line\"><span class=\"built_in\">export</span> ftp_proxy=<span class=\"string\">\"127.0.0.1:8118\"</span></span><br></pre></td></tr></table></figure>\n</li>\n</ol>\n<p>接着执行<code>source /etc/profile</code>或者<code>source ~/.bashrc</code></p>\n<ol start=\"2\">\n<li>浏览器代理<br>在浏览器的proxy settings中手动配置如下：firefox为例</li>\n</ol>\n<table>\n<thead>\n<tr>\n<th>Http Proxy</th>\n<th style=\"text-align:center\">127.0.0.1</th>\n<th style=\"text-align:right\">8118</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>SSL Proxy</td>\n<td style=\"text-align:center\">127.0.0.1</td>\n<td style=\"text-align:right\">8118</td>\n</tr>\n<tr>\n<td>ftp Proxy</td>\n<td style=\"text-align:center\">127.0.0.1</td>\n<td style=\"text-align:right\">8118</td>\n</tr>\n<tr>\n<td>sockets Proxy</td>\n<td style=\"text-align:center\">127.0.0.1</td>\n<td style=\"text-align:right\">8118</td>\n</tr>\n</tbody>\n</table>\n<p>勾选Use this proxy server for all protocols</p>\n<ol start=\"3\">\n<li>全局代理<br>在ubuntu setting-&gt;Network-&gt;Network proxy,method选择Manual，代理配置项与上述浏览器一致。<br>开启3代理后即终端或是浏览器上网均走代理，可根据访问位置选择代理方式。</li>\n</ol>\n<h1 id=\"四、测试\"><a href=\"#四、测试\" class=\"headerlink\" title=\"四、测试\"></a>四、测试</h1><p>终端内开启后可wget一个 foreign domain检验其index.html是否可下载，浏览器访问网站请求时，shadowsocks服务窗口会显示当前请求信息<br>andriod或pc点击开启后，浏览器访问foreign domain测试</p>\n<h1 id=\"五、进阶\"><a href=\"#五、进阶\" class=\"headerlink\" title=\"五、进阶\"></a>五、进阶</h1><p>通过使用<a href=\"https://github.com/shadowsocks/shadowsocks-manager\" target=\"_blank\" rel=\"noopener\">shadowsocks-manager</a>构建多用户管理和流量控制界面,普通用户可直接通过<a href=\"https://vpn.makergyt.com\" target=\"_blank\" rel=\"noopener\">https://vpn.makergyt.com</a>注册使用，省去配置服务端工作，也可为维护者带来一定收益。</p>\n<h1 id=\"Reference\"><a href=\"#Reference\" class=\"headerlink\" title=\"Reference\"></a>Reference</h1><p><small>[1]Geyh.<a href=\"http://blog.51cto.com/13589319/2068374\" target=\"_blank\" rel=\"noopener\">Ubuntu系统SS搭建配置</a>.51CTO.2018.<br>[2]EXP.<a href=\"http://exp-blog.com/2018/07/04/pid-1591/\" target=\"_blank\" rel=\"noopener\">Centos + Shadowsocks客户端 + Privoxy实现外网访问</a>.exp-blog.2018.<br>[3]苏黎世1995.ubuntu18.0.4搭建ss服务器步骤及问题.<a href=\"https://blog.51cto.com/13544424/2314396dra\" target=\"_blank\" rel=\"noopener\">https://blog.51cto.com/13544424/2314396dra</a></small></p>"},{"title":"观影《新世界》","date":"2018-12-25T14:01:52.000Z","_content":">新世界 신세계 (2013)\n导演: 朴勋政 编剧: 朴勋政 主演: 李政宰\nIMDb: [http://www.imdb.com/title/tt2625030](http://www.imdb.com/title/tt2625030)\n\n绕过主人公，有几个点值得讨论：\n<!-- more -->\n#### 1.民族性：\n\n这部影片有几处提到了金门内部有几位重要人物是华侨，特别是两次介绍男主履历时。而且在结尾姜科长在派遣李子成卧底任务时，提到“华侨身份正合适”，看到这里不由得猜想影片似乎有意诱导观众去思考为什么总是华侨。从一定层面来说，外来者、偷渡者往往也是社会不安的因素之一，那么这里是不是在解释或是转嫁形成这些势力的原因呢？\n另一方面就是延边杀手这一形象，极尽讽刺意味，在遇到一些不干净的“处理”任务时，丁青和后来的李子成都选择了“延边的棒子”。在其出场时充满戏谑，不合身的阔绰服装，奇怪丑陋的面相，愚钝的仪态，尤其是在丁青葬礼上的吃相，很难将他们与这种刀口舔血的生意联系在一起。他们没有金门人的头脑，或许是简单到原始社会的生存方式，将这种差事视为挣钱本领，动手时丝毫没有美国大片中那种冷血， 却也毫无顾忌甚至于搞笑，这一点在灭口局长时尤其突出。\n这样看来，似乎有意无意的传达出了一种信号。\n#### 2.姜科长\n这一角色塑造自认为及其成功，甚至胜于主人公，既表现其周旋的阴谋心理，也有正人君子的一面，既像工作狂人也期望早点辞职。这一形象让我想起在国内电视剧《夜奔》中杜志国饰演的骆迦山，他们的工作方式完全脱离“组织原则”，用接近流氓的方式对付流氓，最终也不幸都倒在流氓的刀下。姜科长在这样的局面下，也陷入了极度不信任，为保证卧底安全性更重要的是可靠，他不断将更多的人编织进这张深渊中的网。那么他期望的真的是能够达到力量平衡服从管制而不是一网打尽？在这种周而复始、此消彼长的势力斗争中，或许已经麻木而渴望平衡的牵制局面，正如《夜奔》中张所长在前期处理火并的态度上一致，长期没有强有力的力量介入解决，一线的他们无力也无奈。当然，这部影片最终没有迎合观众邪不压正的思维，我们可以也有理由认为这一切是源自资本主义制度的腐朽。\n#### 3.丁青\n起初出场时认为这是一个纨绔公子或者就是个流氓混混，轻浮粗鲁，然而排行老三的他对局势有着自己一定的把控，并非表面上的无能之辈，在警方想将其作为傀儡是，他说“真以为我无能？”。而后便手脚麻利的查出身边卧底并暴露其凶狠本性。\n电影多次提到“大哥“，但直到最后这一称呼才有了深刻内涵，明知李子成身份却想着设法保全其性命，已经完全超出了利益与自身考量，不过影片末尾也解释了这种情义的来源。\n或许观看不细致，产生几点问题：\n`1.谁杀死了会长`\n`2.是哪一根稻草压垮了李子成的信念，妻子流产吗？`\n`3.李子成有实力坐稳吗`\n`4.卧底在面对犯罪任务时，按原则该如何处理。如《无间道》中倪永孝旁边的张耀扬在处理”任务“时，显得”干练“而毫无犹豫`。\n\n*二手翻译，难免与原作理解产生出入*\n","source":"_posts/zh-CN/观影《新世界》.md","raw":"---\ntitle: 观影《新世界》\ndate: 2018-12-25 22:01:52\ntags:\n- 电影\n---\n>新世界 신세계 (2013)\n导演: 朴勋政 编剧: 朴勋政 主演: 李政宰\nIMDb: [http://www.imdb.com/title/tt2625030](http://www.imdb.com/title/tt2625030)\n\n绕过主人公，有几个点值得讨论：\n<!-- more -->\n#### 1.民族性：\n\n这部影片有几处提到了金门内部有几位重要人物是华侨，特别是两次介绍男主履历时。而且在结尾姜科长在派遣李子成卧底任务时，提到“华侨身份正合适”，看到这里不由得猜想影片似乎有意诱导观众去思考为什么总是华侨。从一定层面来说，外来者、偷渡者往往也是社会不安的因素之一，那么这里是不是在解释或是转嫁形成这些势力的原因呢？\n另一方面就是延边杀手这一形象，极尽讽刺意味，在遇到一些不干净的“处理”任务时，丁青和后来的李子成都选择了“延边的棒子”。在其出场时充满戏谑，不合身的阔绰服装，奇怪丑陋的面相，愚钝的仪态，尤其是在丁青葬礼上的吃相，很难将他们与这种刀口舔血的生意联系在一起。他们没有金门人的头脑，或许是简单到原始社会的生存方式，将这种差事视为挣钱本领，动手时丝毫没有美国大片中那种冷血， 却也毫无顾忌甚至于搞笑，这一点在灭口局长时尤其突出。\n这样看来，似乎有意无意的传达出了一种信号。\n#### 2.姜科长\n这一角色塑造自认为及其成功，甚至胜于主人公，既表现其周旋的阴谋心理，也有正人君子的一面，既像工作狂人也期望早点辞职。这一形象让我想起在国内电视剧《夜奔》中杜志国饰演的骆迦山，他们的工作方式完全脱离“组织原则”，用接近流氓的方式对付流氓，最终也不幸都倒在流氓的刀下。姜科长在这样的局面下，也陷入了极度不信任，为保证卧底安全性更重要的是可靠，他不断将更多的人编织进这张深渊中的网。那么他期望的真的是能够达到力量平衡服从管制而不是一网打尽？在这种周而复始、此消彼长的势力斗争中，或许已经麻木而渴望平衡的牵制局面，正如《夜奔》中张所长在前期处理火并的态度上一致，长期没有强有力的力量介入解决，一线的他们无力也无奈。当然，这部影片最终没有迎合观众邪不压正的思维，我们可以也有理由认为这一切是源自资本主义制度的腐朽。\n#### 3.丁青\n起初出场时认为这是一个纨绔公子或者就是个流氓混混，轻浮粗鲁，然而排行老三的他对局势有着自己一定的把控，并非表面上的无能之辈，在警方想将其作为傀儡是，他说“真以为我无能？”。而后便手脚麻利的查出身边卧底并暴露其凶狠本性。\n电影多次提到“大哥“，但直到最后这一称呼才有了深刻内涵，明知李子成身份却想着设法保全其性命，已经完全超出了利益与自身考量，不过影片末尾也解释了这种情义的来源。\n或许观看不细致，产生几点问题：\n`1.谁杀死了会长`\n`2.是哪一根稻草压垮了李子成的信念，妻子流产吗？`\n`3.李子成有实力坐稳吗`\n`4.卧底在面对犯罪任务时，按原则该如何处理。如《无间道》中倪永孝旁边的张耀扬在处理”任务“时，显得”干练“而毫无犹豫`。\n\n*二手翻译，难免与原作理解产生出入*\n","slug":"观影《新世界》","published":1,"lang":"zh-CN","updated":"2019-04-29T01:07:50.660Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjvnq7zaw002l7jjx5uzwi4br","content":"<link rel=\"stylesheet\" class=\"aplayer-secondary-style-marker\" href=\"/assets/css/APlayer.min.css\"><script src=\"/assets/js/APlayer.min.js\" class=\"aplayer-secondary-script-marker\"></script><script class=\"meting-secondary-script-marker\" src=\"/assets/js/Meting.min.js\"></script><link rel=\"stylesheet\" type=\"text/css\" href=\"https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css\"><blockquote>\n<p>新世界 신세계 (2013)<br>导演: 朴勋政 编剧: 朴勋政 主演: 李政宰<br>IMDb: <a href=\"http://www.imdb.com/title/tt2625030\" target=\"_blank\" rel=\"noopener\">http://www.imdb.com/title/tt2625030</a></p>\n</blockquote>\n<p>绕过主人公，有几个点值得讨论：<br><a id=\"more\"></a></p>\n<h4 id=\"1-民族性：\"><a href=\"#1-民族性：\" class=\"headerlink\" title=\"1.民族性：\"></a>1.民族性：</h4><p>这部影片有几处提到了金门内部有几位重要人物是华侨，特别是两次介绍男主履历时。而且在结尾姜科长在派遣李子成卧底任务时，提到“华侨身份正合适”，看到这里不由得猜想影片似乎有意诱导观众去思考为什么总是华侨。从一定层面来说，外来者、偷渡者往往也是社会不安的因素之一，那么这里是不是在解释或是转嫁形成这些势力的原因呢？<br>另一方面就是延边杀手这一形象，极尽讽刺意味，在遇到一些不干净的“处理”任务时，丁青和后来的李子成都选择了“延边的棒子”。在其出场时充满戏谑，不合身的阔绰服装，奇怪丑陋的面相，愚钝的仪态，尤其是在丁青葬礼上的吃相，很难将他们与这种刀口舔血的生意联系在一起。他们没有金门人的头脑，或许是简单到原始社会的生存方式，将这种差事视为挣钱本领，动手时丝毫没有美国大片中那种冷血， 却也毫无顾忌甚至于搞笑，这一点在灭口局长时尤其突出。<br>这样看来，似乎有意无意的传达出了一种信号。</p>\n<h4 id=\"2-姜科长\"><a href=\"#2-姜科长\" class=\"headerlink\" title=\"2.姜科长\"></a>2.姜科长</h4><p>这一角色塑造自认为及其成功，甚至胜于主人公，既表现其周旋的阴谋心理，也有正人君子的一面，既像工作狂人也期望早点辞职。这一形象让我想起在国内电视剧《夜奔》中杜志国饰演的骆迦山，他们的工作方式完全脱离“组织原则”，用接近流氓的方式对付流氓，最终也不幸都倒在流氓的刀下。姜科长在这样的局面下，也陷入了极度不信任，为保证卧底安全性更重要的是可靠，他不断将更多的人编织进这张深渊中的网。那么他期望的真的是能够达到力量平衡服从管制而不是一网打尽？在这种周而复始、此消彼长的势力斗争中，或许已经麻木而渴望平衡的牵制局面，正如《夜奔》中张所长在前期处理火并的态度上一致，长期没有强有力的力量介入解决，一线的他们无力也无奈。当然，这部影片最终没有迎合观众邪不压正的思维，我们可以也有理由认为这一切是源自资本主义制度的腐朽。</p>\n<h4 id=\"3-丁青\"><a href=\"#3-丁青\" class=\"headerlink\" title=\"3.丁青\"></a>3.丁青</h4><p>起初出场时认为这是一个纨绔公子或者就是个流氓混混，轻浮粗鲁，然而排行老三的他对局势有着自己一定的把控，并非表面上的无能之辈，在警方想将其作为傀儡是，他说“真以为我无能？”。而后便手脚麻利的查出身边卧底并暴露其凶狠本性。<br>电影多次提到“大哥“，但直到最后这一称呼才有了深刻内涵，明知李子成身份却想着设法保全其性命，已经完全超出了利益与自身考量，不过影片末尾也解释了这种情义的来源。<br>或许观看不细致，产生几点问题：<br><code>1.谁杀死了会长</code><br><code>2.是哪一根稻草压垮了李子成的信念，妻子流产吗？</code><br><code>3.李子成有实力坐稳吗</code><br><code>4.卧底在面对犯罪任务时，按原则该如何处理。如《无间道》中倪永孝旁边的张耀扬在处理”任务“时，显得”干练“而毫无犹豫</code>。</p>\n<p><em>二手翻译，难免与原作理解产生出入</em></p>\n","site":{"data":{}},"excerpt":"<blockquote>\n<p>新世界 신세계 (2013)<br>导演: 朴勋政 编剧: 朴勋政 主演: 李政宰<br>IMDb: <a href=\"http://www.imdb.com/title/tt2625030\" target=\"_blank\" rel=\"noopener\">http://www.imdb.com/title/tt2625030</a></p>\n</blockquote>\n<p>绕过主人公，有几个点值得讨论：<br>","more":"</p>\n<h4 id=\"1-民族性：\"><a href=\"#1-民族性：\" class=\"headerlink\" title=\"1.民族性：\"></a>1.民族性：</h4><p>这部影片有几处提到了金门内部有几位重要人物是华侨，特别是两次介绍男主履历时。而且在结尾姜科长在派遣李子成卧底任务时，提到“华侨身份正合适”，看到这里不由得猜想影片似乎有意诱导观众去思考为什么总是华侨。从一定层面来说，外来者、偷渡者往往也是社会不安的因素之一，那么这里是不是在解释或是转嫁形成这些势力的原因呢？<br>另一方面就是延边杀手这一形象，极尽讽刺意味，在遇到一些不干净的“处理”任务时，丁青和后来的李子成都选择了“延边的棒子”。在其出场时充满戏谑，不合身的阔绰服装，奇怪丑陋的面相，愚钝的仪态，尤其是在丁青葬礼上的吃相，很难将他们与这种刀口舔血的生意联系在一起。他们没有金门人的头脑，或许是简单到原始社会的生存方式，将这种差事视为挣钱本领，动手时丝毫没有美国大片中那种冷血， 却也毫无顾忌甚至于搞笑，这一点在灭口局长时尤其突出。<br>这样看来，似乎有意无意的传达出了一种信号。</p>\n<h4 id=\"2-姜科长\"><a href=\"#2-姜科长\" class=\"headerlink\" title=\"2.姜科长\"></a>2.姜科长</h4><p>这一角色塑造自认为及其成功，甚至胜于主人公，既表现其周旋的阴谋心理，也有正人君子的一面，既像工作狂人也期望早点辞职。这一形象让我想起在国内电视剧《夜奔》中杜志国饰演的骆迦山，他们的工作方式完全脱离“组织原则”，用接近流氓的方式对付流氓，最终也不幸都倒在流氓的刀下。姜科长在这样的局面下，也陷入了极度不信任，为保证卧底安全性更重要的是可靠，他不断将更多的人编织进这张深渊中的网。那么他期望的真的是能够达到力量平衡服从管制而不是一网打尽？在这种周而复始、此消彼长的势力斗争中，或许已经麻木而渴望平衡的牵制局面，正如《夜奔》中张所长在前期处理火并的态度上一致，长期没有强有力的力量介入解决，一线的他们无力也无奈。当然，这部影片最终没有迎合观众邪不压正的思维，我们可以也有理由认为这一切是源自资本主义制度的腐朽。</p>\n<h4 id=\"3-丁青\"><a href=\"#3-丁青\" class=\"headerlink\" title=\"3.丁青\"></a>3.丁青</h4><p>起初出场时认为这是一个纨绔公子或者就是个流氓混混，轻浮粗鲁，然而排行老三的他对局势有着自己一定的把控，并非表面上的无能之辈，在警方想将其作为傀儡是，他说“真以为我无能？”。而后便手脚麻利的查出身边卧底并暴露其凶狠本性。<br>电影多次提到“大哥“，但直到最后这一称呼才有了深刻内涵，明知李子成身份却想着设法保全其性命，已经完全超出了利益与自身考量，不过影片末尾也解释了这种情义的来源。<br>或许观看不细致，产生几点问题：<br><code>1.谁杀死了会长</code><br><code>2.是哪一根稻草压垮了李子成的信念，妻子流产吗？</code><br><code>3.李子成有实力坐稳吗</code><br><code>4.卧底在面对犯罪任务时，按原则该如何处理。如《无间道》中倪永孝旁边的张耀扬在处理”任务“时，显得”干练“而毫无犹豫</code>。</p>\n<p><em>二手翻译，难免与原作理解产生出入</em></p>"},{"title":"观《独行》","date":"2019-04-03T12:44:59.000Z","_content":"\n\n{% fi https://pic4.zhimg.com/80/v2-fa04196228d3dc6ad1343ce29e7c4afb_hd.jpg, 独行, 独行海报 %}\n\n<!-- more -->\n\n{% note info %}\n这部纪录片已经看过有段时间了，当时深有体会，但是不知作何表达。而往往随着时间推移，一些情景一些思考与会片中人物不断耦合，这些随想零零碎碎，逐渐照进现实。\n{% endnote%}\n独立游戏在维基百科的定义是\n>指电子游戏开发者没有游戏公司或游戏发行商提供的薪资，必须独力负担开发过程中的所有花费；相对地，开发者可以决定游戏的走向，做自己想做的游戏，往往可以推出崭新观点的作品，而不用受制于游戏公司或市场。游戏行业如同电影行业，大型游戏的开发需要资金雄厚的发行商赞助，因此发行商对游戏有很大的决定权。大部分发行商不愿尝试创新，希望制作风险低、受大众欢迎的游戏；只要开发出一款成功的作品，接下来就会延续这品牌继续推出资料片、扩展包等。\n\n我不是独立游戏的开发者，也不是重度体验者，然而表面上这是一部介绍游戏创业者的纪录片，实际上不只是这样,对于这种以人物为中心的纪录片，观看者往往不经意会去比对自己的影迹，或者说以其中某个人为假想。其实，虽然我们永远不可能找到完全与自己相像的映照，但是正如有句话说\n{% cq %}历史不会重演，但总会有惊人的相似。{% endcq %}\n经历的人事不同，但轨迹总会有一致的地方：\n{% fi https://pic2.zhimg.com/80/v2-51b204ea6dc65ab9da76515da0f1fd05_hd.jpg, 独行, 独行海报 %}\n从车库宅男打造英雄般的传奇色彩作响个人品牌到用 理想主义的光芒拉起一支庞大的队伍，\n从发展到鼎盛到因为某些很扯的原因不得不解散团队\n经历着无法自拔到愈挫愈勇\n开始向着这个“还没做起来的市场”注入一剂兴奋剂\n而即便站住了脚跟，也要将夜不归宿地加班变得习以为常\n当然，不是以这样的叙事线判定片中人物的创业状况，而是正如片中 仿佛就是有一个编剧，今天以这样的时间线组织状态，或许明天将换血重来，每个人只是奋斗在不同阶段或区域内，随时会被市场重新编排校色\n{% fi https://pic1.zhimg.com/80/v2-215c1135bc668f6ffeb19445f4ebbb78_hd.jpg, 独行, 独行海报 %}\n没有渲染式的主题采访，那样的采访会有很多包装、排斥的成分，就比如十三邀里许知远\n总是带着一种想深度挖掘对话的“偏见”，然而却不由得提高了论调，使得人物想方设法来掩盖柔弱面，成熟的包装自己的严谨、高尚与深邃。对话的矛与盾相交那一刻，双方突然束甲归山\n没有一条完整的能让观众情绪起伏的故事线\n\n\n# Reference\n\n<small>[1] Wikipedia.独立游戏[EB/OL].https://zh.wikipedia.org/wiki/%E7%8B%AC%E7%AB%8B%E6%B8%B8%E6%88%8F .2019.</small> ","source":"_posts/zh-CN/观《独行》.md","raw":"---\ntitle: 观《独行》\ndate: 2019-04-03 20:44:59\ntags:\ncategories: documentary\n---\n\n\n{% fi https://pic4.zhimg.com/80/v2-fa04196228d3dc6ad1343ce29e7c4afb_hd.jpg, 独行, 独行海报 %}\n\n<!-- more -->\n\n{% note info %}\n这部纪录片已经看过有段时间了，当时深有体会，但是不知作何表达。而往往随着时间推移，一些情景一些思考与会片中人物不断耦合，这些随想零零碎碎，逐渐照进现实。\n{% endnote%}\n独立游戏在维基百科的定义是\n>指电子游戏开发者没有游戏公司或游戏发行商提供的薪资，必须独力负担开发过程中的所有花费；相对地，开发者可以决定游戏的走向，做自己想做的游戏，往往可以推出崭新观点的作品，而不用受制于游戏公司或市场。游戏行业如同电影行业，大型游戏的开发需要资金雄厚的发行商赞助，因此发行商对游戏有很大的决定权。大部分发行商不愿尝试创新，希望制作风险低、受大众欢迎的游戏；只要开发出一款成功的作品，接下来就会延续这品牌继续推出资料片、扩展包等。\n\n我不是独立游戏的开发者，也不是重度体验者，然而表面上这是一部介绍游戏创业者的纪录片，实际上不只是这样,对于这种以人物为中心的纪录片，观看者往往不经意会去比对自己的影迹，或者说以其中某个人为假想。其实，虽然我们永远不可能找到完全与自己相像的映照，但是正如有句话说\n{% cq %}历史不会重演，但总会有惊人的相似。{% endcq %}\n经历的人事不同，但轨迹总会有一致的地方：\n{% fi https://pic2.zhimg.com/80/v2-51b204ea6dc65ab9da76515da0f1fd05_hd.jpg, 独行, 独行海报 %}\n从车库宅男打造英雄般的传奇色彩作响个人品牌到用 理想主义的光芒拉起一支庞大的队伍，\n从发展到鼎盛到因为某些很扯的原因不得不解散团队\n经历着无法自拔到愈挫愈勇\n开始向着这个“还没做起来的市场”注入一剂兴奋剂\n而即便站住了脚跟，也要将夜不归宿地加班变得习以为常\n当然，不是以这样的叙事线判定片中人物的创业状况，而是正如片中 仿佛就是有一个编剧，今天以这样的时间线组织状态，或许明天将换血重来，每个人只是奋斗在不同阶段或区域内，随时会被市场重新编排校色\n{% fi https://pic1.zhimg.com/80/v2-215c1135bc668f6ffeb19445f4ebbb78_hd.jpg, 独行, 独行海报 %}\n没有渲染式的主题采访，那样的采访会有很多包装、排斥的成分，就比如十三邀里许知远\n总是带着一种想深度挖掘对话的“偏见”，然而却不由得提高了论调，使得人物想方设法来掩盖柔弱面，成熟的包装自己的严谨、高尚与深邃。对话的矛与盾相交那一刻，双方突然束甲归山\n没有一条完整的能让观众情绪起伏的故事线\n\n\n# Reference\n\n<small>[1] Wikipedia.独立游戏[EB/OL].https://zh.wikipedia.org/wiki/%E7%8B%AC%E7%AB%8B%E6%B8%B8%E6%88%8F .2019.</small> ","slug":"观《独行》","published":1,"lang":"zh-CN","updated":"2019-04-29T01:07:50.660Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjvnq7zay002o7jjxhovgcem6","content":"<link rel=\"stylesheet\" class=\"aplayer-secondary-style-marker\" href=\"/assets/css/APlayer.min.css\"><script src=\"/assets/js/APlayer.min.js\" class=\"aplayer-secondary-script-marker\"></script><script class=\"meting-secondary-script-marker\" src=\"/assets/js/Meting.min.js\"></script><link rel=\"stylesheet\" type=\"text/css\" href=\"https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css\"><span itemprop=\"image\" itemscope itemtype=\"http://schema.org/ImageObject\"><img itemprop=\"url image\" src=\"https://pic4.zhimg.com/80/v2-fa04196228d3dc6ad1343ce29e7c4afb_hd.jpg\" class=\"full-image\" alt=\"独行\" title=\"独行海报\"><meta itemprop=\"width\" content=\"auto\"><meta itemprop=\"height\" content=\"auto\"></span>\n<a id=\"more\"></a>\n<div class=\"note info\">\n            <p>这部纪录片已经看过有段时间了，当时深有体会，但是不知作何表达。而往往随着时间推移，一些情景一些思考与会片中人物不断耦合，这些随想零零碎碎，逐渐照进现实。</p>\n          </div>\n<p>独立游戏在维基百科的定义是</p>\n<blockquote>\n<p>指电子游戏开发者没有游戏公司或游戏发行商提供的薪资，必须独力负担开发过程中的所有花费；相对地，开发者可以决定游戏的走向，做自己想做的游戏，往往可以推出崭新观点的作品，而不用受制于游戏公司或市场。游戏行业如同电影行业，大型游戏的开发需要资金雄厚的发行商赞助，因此发行商对游戏有很大的决定权。大部分发行商不愿尝试创新，希望制作风险低、受大众欢迎的游戏；只要开发出一款成功的作品，接下来就会延续这品牌继续推出资料片、扩展包等。</p>\n</blockquote>\n<p>我不是独立游戏的开发者，也不是重度体验者，然而表面上这是一部介绍游戏创业者的纪录片，实际上不只是这样,对于这种以人物为中心的纪录片，观看者往往不经意会去比对自己的影迹，或者说以其中某个人为假想。其实，虽然我们永远不可能找到完全与自己相像的映照，但是正如有句话说<br><blockquote class=\"blockquote-center\"><p>历史不会重演，但总会有惊人的相似。</p>\n</blockquote><br>经历的人事不同，但轨迹总会有一致的地方：<br><span itemprop=\"image\" itemscope itemtype=\"http://schema.org/ImageObject\"><img itemprop=\"url image\" src=\"https://pic2.zhimg.com/80/v2-51b204ea6dc65ab9da76515da0f1fd05_hd.jpg\" class=\"full-image\" alt=\"独行\" title=\"独行海报\"><meta itemprop=\"width\" content=\"auto\"><meta itemprop=\"height\" content=\"auto\"></span><br>从车库宅男打造英雄般的传奇色彩作响个人品牌到用 理想主义的光芒拉起一支庞大的队伍，<br>从发展到鼎盛到因为某些很扯的原因不得不解散团队<br>经历着无法自拔到愈挫愈勇<br>开始向着这个“还没做起来的市场”注入一剂兴奋剂<br>而即便站住了脚跟，也要将夜不归宿地加班变得习以为常<br>当然，不是以这样的叙事线判定片中人物的创业状况，而是正如片中 仿佛就是有一个编剧，今天以这样的时间线组织状态，或许明天将换血重来，每个人只是奋斗在不同阶段或区域内，随时会被市场重新编排校色<br><span itemprop=\"image\" itemscope itemtype=\"http://schema.org/ImageObject\"><img itemprop=\"url image\" src=\"https://pic1.zhimg.com/80/v2-215c1135bc668f6ffeb19445f4ebbb78_hd.jpg\" class=\"full-image\" alt=\"独行\" title=\"独行海报\"><meta itemprop=\"width\" content=\"auto\"><meta itemprop=\"height\" content=\"auto\"></span><br>没有渲染式的主题采访，那样的采访会有很多包装、排斥的成分，就比如十三邀里许知远<br>总是带着一种想深度挖掘对话的“偏见”，然而却不由得提高了论调，使得人物想方设法来掩盖柔弱面，成熟的包装自己的严谨、高尚与深邃。对话的矛与盾相交那一刻，双方突然束甲归山<br>没有一条完整的能让观众情绪起伏的故事线</p>\n<h1 id=\"Reference\"><a href=\"#Reference\" class=\"headerlink\" title=\"Reference\"></a>Reference</h1><p><small>[1] Wikipedia.独立游戏[EB/OL].<a href=\"https://zh.wikipedia.org/wiki/%E7%8B%AC%E7%AB%8B%E6%B8%B8%E6%88%8F\" target=\"_blank\" rel=\"noopener\">https://zh.wikipedia.org/wiki/%E7%8B%AC%E7%AB%8B%E6%B8%B8%E6%88%8F</a> .2019.</small> </p>\n","site":{"data":{}},"excerpt":"<span itemprop=\"image\" itemscope itemtype=\"http://schema.org/ImageObject\"><img itemprop=\"url image\" src=\"https://pic4.zhimg.com/80/v2-fa04196228d3dc6ad1343ce29e7c4afb_hd.jpg\" class=\"full-image\" alt=\"独行\" title=\"独行海报\"><meta itemprop=\"width\" content=\"auto\"><meta itemprop=\"height\" content=\"auto\"></span>","more":"<div class=\"note info\">\n            <p>这部纪录片已经看过有段时间了，当时深有体会，但是不知作何表达。而往往随着时间推移，一些情景一些思考与会片中人物不断耦合，这些随想零零碎碎，逐渐照进现实。</p>\n          </div>\n<p>独立游戏在维基百科的定义是</p>\n<blockquote>\n<p>指电子游戏开发者没有游戏公司或游戏发行商提供的薪资，必须独力负担开发过程中的所有花费；相对地，开发者可以决定游戏的走向，做自己想做的游戏，往往可以推出崭新观点的作品，而不用受制于游戏公司或市场。游戏行业如同电影行业，大型游戏的开发需要资金雄厚的发行商赞助，因此发行商对游戏有很大的决定权。大部分发行商不愿尝试创新，希望制作风险低、受大众欢迎的游戏；只要开发出一款成功的作品，接下来就会延续这品牌继续推出资料片、扩展包等。</p>\n</blockquote>\n<p>我不是独立游戏的开发者，也不是重度体验者，然而表面上这是一部介绍游戏创业者的纪录片，实际上不只是这样,对于这种以人物为中心的纪录片，观看者往往不经意会去比对自己的影迹，或者说以其中某个人为假想。其实，虽然我们永远不可能找到完全与自己相像的映照，但是正如有句话说<br><blockquote class=\"blockquote-center\"><p>历史不会重演，但总会有惊人的相似。</p>\n</blockquote><br>经历的人事不同，但轨迹总会有一致的地方：<br><span itemprop=\"image\" itemscope itemtype=\"http://schema.org/ImageObject\"><img itemprop=\"url image\" src=\"https://pic2.zhimg.com/80/v2-51b204ea6dc65ab9da76515da0f1fd05_hd.jpg\" class=\"full-image\" alt=\"独行\" title=\"独行海报\"><meta itemprop=\"width\" content=\"auto\"><meta itemprop=\"height\" content=\"auto\"></span><br>从车库宅男打造英雄般的传奇色彩作响个人品牌到用 理想主义的光芒拉起一支庞大的队伍，<br>从发展到鼎盛到因为某些很扯的原因不得不解散团队<br>经历着无法自拔到愈挫愈勇<br>开始向着这个“还没做起来的市场”注入一剂兴奋剂<br>而即便站住了脚跟，也要将夜不归宿地加班变得习以为常<br>当然，不是以这样的叙事线判定片中人物的创业状况，而是正如片中 仿佛就是有一个编剧，今天以这样的时间线组织状态，或许明天将换血重来，每个人只是奋斗在不同阶段或区域内，随时会被市场重新编排校色<br><span itemprop=\"image\" itemscope itemtype=\"http://schema.org/ImageObject\"><img itemprop=\"url image\" src=\"https://pic1.zhimg.com/80/v2-215c1135bc668f6ffeb19445f4ebbb78_hd.jpg\" class=\"full-image\" alt=\"独行\" title=\"独行海报\"><meta itemprop=\"width\" content=\"auto\"><meta itemprop=\"height\" content=\"auto\"></span><br>没有渲染式的主题采访，那样的采访会有很多包装、排斥的成分，就比如十三邀里许知远<br>总是带着一种想深度挖掘对话的“偏见”，然而却不由得提高了论调，使得人物想方设法来掩盖柔弱面，成熟的包装自己的严谨、高尚与深邃。对话的矛与盾相交那一刻，双方突然束甲归山<br>没有一条完整的能让观众情绪起伏的故事线</p>\n<h1 id=\"Reference\"><a href=\"#Reference\" class=\"headerlink\" title=\"Reference\"></a>Reference</h1><p><small>[1] Wikipedia.独立游戏[EB/OL].<a href=\"https://zh.wikipedia.org/wiki/%E7%8B%AC%E7%AB%8B%E6%B8%B8%E6%88%8F\" target=\"_blank\" rel=\"noopener\">https://zh.wikipedia.org/wiki/%E7%8B%AC%E7%AB%8B%E6%B8%B8%E6%88%8F</a> .2019.</small> </p>"},{"title":"越是进入一个深度，越是觉得能力撑不起野心。","date":"2017-11-29T02:52:16.000Z","password":960119,"abstract":"Welcome to my blog, enter password to read.","message":"Welcome to my blog, enter password to read.","_content":"\n小学时我读人物传记，人物的形象隐约形成我思维的脉络，虽然当时不清楚它时一种价值观；那时的我可以趴在窗台，“卧看满天云不动，不知云与我俱东”。\n中学时我读小说，一气呵成贯穿始终的“精气神”引发我的思考，开始萦绕不绝，主导思维的走向；尽管当时的环境现在看来很艰苦，但依然在追求光风霁月，和而不流。\n高三时我读杂志，在日复一日的时期渴望注入一点新事物的思考，尽管如此，我依然能保持独立思考而接纳万物，甚至有一种“飘飘乎如遗世独立”的神态。\n而现在，我一贫如洗，\n在这样一个言论爆发的时代，我不幸的被湮没，\n我开始浮躁，因为我停不下来，怕错过这个转瞬即逝的风口，\n我的“思维热度”，姑且这样形容吧，一段时间总会被看过的一段文字“浸染”（或者侵袭？），总会在生活中找到映照而再次联想去思考。而现在，几乎是在被几个“大V号”牵引着，我不再关注真实，而更关注其中的一两个金句。\n跑得再快，也成不了领头羊，况且，领头羊是最清楚方向的吗？\n于是，我开始环视人群，当初我也在这样环视，希望遇到一种人，但是不可名状，后来我看到程颐形容程颢的一段话：\n> 视其色，其接物也如春阳之温；听其言，其入人也如时雨之润。胸怀洞然，彻视无间；测其蕴，则浩乎若沧溟之无际；极其德，美言盖不足以形容\n这几句话表达的十分精致，曾经十分向往“谈笑有鸿儒，往来无白丁”的景象，这种景象在西方正如《福楼拜家的星期天》中那样智者云集的情形。","source":"_posts/zh-CN/越是进入一个深度，越是觉得能力撑不起野心。.md","raw":"---\ntitle: 越是进入一个深度，越是觉得能力撑不起野心。\ndate: 2017-11-29 10:52:16\ntags:\npassword: 960119\nabstract: Welcome to my blog, enter password to read.\nmessage: Welcome to my blog, enter password to read.\n---\n\n小学时我读人物传记，人物的形象隐约形成我思维的脉络，虽然当时不清楚它时一种价值观；那时的我可以趴在窗台，“卧看满天云不动，不知云与我俱东”。\n中学时我读小说，一气呵成贯穿始终的“精气神”引发我的思考，开始萦绕不绝，主导思维的走向；尽管当时的环境现在看来很艰苦，但依然在追求光风霁月，和而不流。\n高三时我读杂志，在日复一日的时期渴望注入一点新事物的思考，尽管如此，我依然能保持独立思考而接纳万物，甚至有一种“飘飘乎如遗世独立”的神态。\n而现在，我一贫如洗，\n在这样一个言论爆发的时代，我不幸的被湮没，\n我开始浮躁，因为我停不下来，怕错过这个转瞬即逝的风口，\n我的“思维热度”，姑且这样形容吧，一段时间总会被看过的一段文字“浸染”（或者侵袭？），总会在生活中找到映照而再次联想去思考。而现在，几乎是在被几个“大V号”牵引着，我不再关注真实，而更关注其中的一两个金句。\n跑得再快，也成不了领头羊，况且，领头羊是最清楚方向的吗？\n于是，我开始环视人群，当初我也在这样环视，希望遇到一种人，但是不可名状，后来我看到程颐形容程颢的一段话：\n> 视其色，其接物也如春阳之温；听其言，其入人也如时雨之润。胸怀洞然，彻视无间；测其蕴，则浩乎若沧溟之无际；极其德，美言盖不足以形容\n这几句话表达的十分精致，曾经十分向往“谈笑有鸿儒，往来无白丁”的景象，这种景象在西方正如《福楼拜家的星期天》中那样智者云集的情形。","slug":"越是进入一个深度，越是觉得能力撑不起野心。","published":1,"lang":"zh-CN","updated":"2019-04-29T01:07:50.660Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjvnq7zb0002r7jjxxjaqmd5s","content":"<link rel=\"stylesheet\" class=\"aplayer-secondary-style-marker\" href=\"/assets/css/APlayer.min.css\"><script src=\"/assets/js/APlayer.min.js\" class=\"aplayer-secondary-script-marker\"></script><script class=\"meting-secondary-script-marker\" src=\"/assets/js/Meting.min.js\"></script><link rel=\"stylesheet\" type=\"text/css\" href=\"https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css\"><script src=\"https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js\"></script>\n<div id=\"hbe-security\">\n  <div class=\"hbe-input-container\">\n  <input type=\"password\" class=\"hbe-form-control\" id=\"pass\" placeholder=\"Welcome to my blog, enter password to read.\" />\n    <label for=\"pass\">Welcome to my blog, enter password to read.</label>\n    <div class=\"bottom-line\"></div>\n  </div>\n</div>\n<div id=\"decryptionError\" style=\"display: none;\">Incorrect Password!</div>\n<div id=\"noContentError\" style=\"display: none;\">No content to display!</div>\n<div id=\"encrypt-blog\" style=\"display:none\">\nU2FsdGVkX18/l9d1lMBQzYcN5SF/tr8dn4+ZwST5KfvWVEXjwdSpEVfFtm1YukVS9f0JZydSLgTO1Ar5kNxS9UuzMZ4V4mgj8eMG5neCv+Vd1iu2Csu8DpjHXytAhyVhpzrc6ZEYbI0I2u2wXZ/+qcKzxTMpFHRUXTyjg6pyH3Jw5mLkrujx/9mKKCpmX4diMG+jC63y81o5CIqDJyAQ8PIt6qQWu1uK5sfhjZ13nPef0wxdkYjFFlQPo8NKJ/OKIuSZKsn1YkGSuuQByH+ARFYcfjsmLuUiRH/jiKT7wC5TFcXJnkM4wr+Hz/rjJvsLWBrvYjq62KwQMxRHpyKmJh1202mdXcKzajoabCZstiNK6DbWiPaRAjnd43r/xvchqPQ5OYOWoQRP0fay+RMFWUtxfWTYFOje9VYqu8GCIiWmnNMy0SzLl0EfsEWaQpy59v2aqtxJBXO/wP6lgGRFMAJSx9m7dhvKnCpjeWMHT4e/Zyg9mmFopGhqYcU08WWxyzQNIG15t5ZGcCKddp/sYCvvE5lnTZOSuZIqfvChCzJY6Iqc4yWI4YrE63MSwa4uMKwHl10fp0m9nVQewLXyvPQY3Ld2lvLrnjH/1tT6LWcKJWYNQ/ZPPYyMwBeqNGnV4zin7QPleqt4tudqlzri+BnC6JDkGpsAhw40Xa4woydc8rRk5BptlP5XmqYcTf7VX0v7x9VdjrYknpx75jY0E2pi5cYeAnUAnWpc40ksKnlD7MeiTZcMT4WTpmgwBWOl73dc4uscODuphi0WT+/VysPYTZEdlESycatUvELQwOQpn5C9gBtvJBcFl9XPCq8YIWO/gs9whbgc+TlqVuSEW/9/h2wqW7s6hzfBU+loMHZStADg1zwWQh3sqTDMz1vWCCfklyH/rPbF2q400crqgysQH5qH0IVsrZYB76e+A66yzI03jyCgg3fFciNmEGdAR+/XaVsKpI3lgCx28+pSiH9Ai8LIAu0o+mf1+4+jcIGAPTxx/Q9vcZ83Oy1aOzXQCXX3jI9v8IMT0NljlW953tR5mIt9wqkUIWXayf0MgzYNWOl2zO1Y6DM9HFMH/ha5Y3CPo7R9Z6e3VV9pDus768m7LV0pj1Nm5w7QjGyyAfpWTjWSCinCGj7//DZPQlfrLoVrk54Ds//akgEsv/zgT1B/TbqiDCTj041BhxJ4t7/Qr2AJz0ZsVzB16Hr+OngVpcYtGgyeadFj1TIfTUGYUwyxcG4qPGMDW/J5D8nuT8yL5OfDN3OJXnkPi8TwmVXqF0zbNzIjvO08DdDjx7ORJfcKJYArbbp8wkm63s3lQr9Hl2Hggs4U9Uet22bAMUqXBscmTWmSBt1P+IdNX7xJQcMFluye3OgRlcjwNfjngPXSsegjaUhq4S8+s1UPv8RzszmKgfygVCUJ88jIbKCA9Jc/cSkrgbCGVYbNziXpno2OSGDhvwKH0EgwgzAzP+ti74TCHXvZytsUEcVx73wUQ+0NwqO+ij6jBHhkuiaERMQEU9xvgyXZgd65Jkf7tu/FV2kxqmsLu4e9Pp5YKPliVWKzKv37EWxyfs7kK+VpO/uJMwbQM7H5brfehm9Xl29BDWRQ/b+CmFr9vZzFaPKwq4khN3jIn7RmPSyIu599LVYn1JIV5kXrQz6Fj/9/6XFwFujggALHXrWXz3rtGK0/5Gon5QTnDVauew+xCU6wrenOMVVHS5ZakZILCBI/AboAiVyIOMI8d+1rh5TXd4W3XzOPEkD3z/9IsFT56yOfrS24RQTnmJl+LpEofRbRKzyZDt9E8NoFWI9pbRpm5Wxog9Vf4IDNwT2V/t/XPUONtG71vnCCG/UaLhjUAiFj0OCTP4GG4+g/hCaf07Bd5NNtLUI+bsa7Cai6Hro4ATHDt9eS1wlRzNbL/VHep8UA+8FrgoICpPoPimu32oYxplJBMOqxkOZkyLYSU6t3LJ2a1dxM2tFShry7OaPJYDVuMbGqBERKz5SHWf+lN60WT/yuQfkp2Q1EYnjojavvz8MaKo3shkxzVilKarYdxrUYkh764cAWtKbfbjYlP9Mq7KBZ9QBjJbK4Gvy2FQ/VSw8flFFnPO+2emy69Sn8yBJfAc7yC16C3dGrey/e3Lg3DuBG7kmr9aVv5lPVNHRVwjIugnIx2IISE1je/WTfgUhhd0vpVY+EfXq/9sk80agKKPvSi6b50wwFNE4HI/nhEU061kav47Uu1EMgamyxrrDf8gx3BqNkV5nsPfugEGmG/N2p27oqpQB7HkXUhkwww50SqEkPvHYqBoIHGXs4wLmiNt9nDwGCJ87FHEhrg9MyKaD3yQeYpQOugEW5jlAxTuiDd/dH86tt7hIdpZBJyFU57n4fQF3upvORSFydkOk0vpCkFWOqmsoK+tJHs3N+Z1jjMXp1h4+Lxh2LotRRIMnSAo20vgCtIXyZMCt7Bw7QCk6KsA2rtzU5an42O5V8IPD61imxUn0rQEp+YxIjS1CSkx1wPef0q+ysyCo92N6LttPv2HQrrXMWgI47gFej/2lSEaRbIwaJNedp37hKuOENQN0HpZbn2kusi2RZNXkA5QOU6BZEGe8r+wrZh1Xx0pouB6yuGnUq8CyWFnL9GJWkHnvMs9TzvGxvUb5w23/GR3JKOkthkXGfxwKR0LWS54vS/xNUjsnpPgCjFkYVZ9FfvO9iW/tNwIXBM938Z+SF9IRBVzLgnQrq2zdQbuIwPxsBUvpvh6fscPEclUE5cmqVosOekB8U4Rqjup+Jm9bmncWKcJ0SxDTU1QGvtjM/gjkUtIY+W92ZswiRCju10YiIQAGDvwt9NOek826HN8U9AAWy8HcUjBJnaZ9Qbu/urU03H+IMNILnn4/jD+1FFIcc9azSORLYff1lqC8eGvtdZtcHzU6ADETp8a5+77fC4xybd2163AzQprssVwYRMzLRK6RJWTMMwU/Uc3GH9Z/N4YrUzALc3QpFs4nn9G54U7boxkB4XxBlcnOtIbalTqd2MR2shhwOiPgVrDQVrdWrlfRabZ84ehxDWNtdwtmGV2lM+Y47eE4rYfNiml23Y0+juqPmIZif1DRKzRZA/vM06fIac95qIuYAZXk1zmKkBsTyZ0nvy149ODbFzEPeY/7V1C86lMZ0UgdqwOPjpTsBSEWj9YDIqE6Gr1k0+KEEGYCDV44BROr98KnlvxLc4uNkw6QBqEck4WJKopu4HVfyzUoaHSyaoeGESnrS5xHiXQ+O6nsMMVOrPcW5ZUmLYf4Zn0yQvamnguUmAoDfn8grfE8meQtk5wHREFiB5rF3dB+Sn583YkrufDcJOfsx3hji3Wb+7SJwegx+ZT/1b02HXj34rploFhqvDAhGN0ibQz+H2+d4uCzgUuXdYi5G08eEtCKkKNhrFTjrF/mRTwntQ9qmdjMQQYIt3G1CCcjYawfUq0vvfHwmzWN4V7Wc7CzJs1DPs74RDnotn4peEwC5V06JIqW+Iy+O3x0OkA93u93Q9Ux9SGjBXWRx23EwJsXgVFlANREcwq30XqZEuAD0nSv5Ot5aWR7tu6Pl02ThUS+hLBjC12Ej236cnCfpTf+eAGi3K67e9VTDYf0KuUkZxEV0foCmbFHyMviR02qJVHIL1BHG4Kns6EUUasUS3gpucQdVLoqxCa6g8jo5y6MO/0pOMMtRmQXdofvLQB6u7BAzxrxKHTBMR+rsfCsDMCGDqbzDEqpU0PgWEpzM93AMb7zjMk1OhKJeISm3yM96ks00s/ayy7fzgOfN1VCCiJiI0dy+prr+TfmqoIJ5eF5ceJAYkS+TigQ7U8AM9VuSQAKrBxVLUI8CoGEpVcu7MokHFYuq+cMF3NcJPaJYPCdAAkrmdQ9Zf145vHo8yybQby7TLTapT5oJIGPHElF8df7XM5+qaUzylTufoU8kJTaK4F2Rhu4s5sHdeq8zOZVmPzE6Z0g81nMnMBpvRiGjjL3CSKNNmjryU/DTHM99ats3FhE7CJO/hMcVrXwDxwALgR3f7i1wjO629A0GdQ222depwF4nJMClD9RBye8uAnO3jFKFqbcIf+VZIrwZSRuin9xtr2LW761an7MxtL09NbXsLvVpnW0bMFuxMLxVEToJAF49uvMB4IoUQlv3U87T9rGRWT6Ay/oITTJYG+mWLFjQu7T2U2RlJpxTHJaAc+LidXkf/DbKtRlz86ibensqO9LUJVh/5ib3YYtyCLc2II+BcxTcK5b8tCk2iBGuYYein55B6ncuRwroGyVVUmnAHk7AT+58UwrWpUTZPxVF2s2MGzAdJK+CAMpn2xqlT2nyI0+/Cn4qjq9hgrOppKZz+2AZjJMl3Rru/mqLodq1gR0TAgFgQB0dPjRGJGQZOythJP0tVmYcnvDd/hK3wkS9plGtvQQLEG2kqqLRwkG1efWt5/ONKI95qFCNqMuUmJSWIGfGwS2ffH850Cw3EKBlRVnTuLEisyPuystFXK9lqZORBRjM9l1jrSmNvnFT/63EORqOYXMQHt3dIJacd8QWXS+pfJsYmkpo/rHBTZl+6Px21yDEz8KA+cI3QoxsOrRq1c6yRrzSv1oEGEQIJ4qObvJWkamN47zRHiVv7eEMyLkTAtoNoOFzgf0fz+aSJFZOEXwx2GNvw51nDKKoIQNXd9ScgSFT7SK9d77eCerwu7/prawpx/JkGHv83mlxYFZt6dh/YH/ajTQX44v8yIQDvF3sRegJcbBl9I/f9NUybEE6uAXm8sUWZZG4lEqeKro9TrLFZJhHlk9I1EiQ3vrZKC66qhB5SnwcghESZlyKIrypo92RdgR5Wlq9BDPFtA8PTr6vLvf7654SH18Nxungniccg+JSJp+1qAY4HedKNSC5pXRBi5jlQT8mtBoQNpgOt9fEkVrZdFrBXeuRuiFjzb3mnYQ4t0Pd/rYWzpSgyR10KvLGCDfM3ujKaFA2djVrHU8TYiiXFElmM7dkmrV75eZ1twcO3TMyhQ5XYFzHqQoDmo+K1aoJPypG3ItYfMA1XA76jd09FYWwNwY4PbNtNR9RIJ4STC2sieW1Tiv+4IFBjXve0sBg4AdQ9lXEfbOYHIRZi/6V/17geZ8+LV9XUK8BohxjrXTvyE/qGan+lDKa05txFHIsmxwsd/VrRY8SSbYPaJwF2G7chuHTMnT3dVzT6jyk2ZakmbDYr5QVNnUKYmKIUd/qrT8jhE3mWLwAb1ltjzdywSYDAfV9U6u50L1Vli0WqNfJ+sxNf3DMWZyqdpLLF9lPtAuNQo3eDyqUOaQA2OdkACJN6Jon25cs8TlLhequ+4DQa8BqPhYgbVaylpoAcAFpulIBVTPruVZ1onVdh+8mVlyBuhOqdWvtvdcLX65xi3+Uo9KB8o4AnhRxn3V26S1dq3pKIHwAYQqY+YuBw72WkUDe3hKYh9f4sPq2OxEqJ9QQu6zUFkVJeMgYRdq4yAgNC+Wz9XLz5zTJHD9tmCUMbjZFI0/s70xnHQADKzYtYU0SqScCQwFp1eEVJ3zeLbfN++z3b2wzIt4RPT+SMRQqXt2rIuV/b/5B6aouuGxnHVdRU6ktv6s3UPguRqLqlQczpij+YT6Bzly8OrjpTYw9uu5HBBdaOB+ubfQDzhUFP9EDxEPgv+YkqkDhCvYxbpq5VQ3mNIzK2Ijyue2zliLb/Ibf1Uv6gVrdHGlKiwpCi5yIgNciLUQCHgSVEXSMdhMGRdo5WGbaF9K/FXZtN/jl60MswcpZ+gYjMaTmtyOCNjVR4ZnHhHWITfnu5YfLRfhoDFKwp8zUNf3Oi716IgQWSNd7hxaVaYv5rsr8VR1rNlGRlE38wt25l1jz4DeVbEIW6JAXohPKRsWBz+HnKgAtHM+7GzZ2CxlllcG42sM9oi60TaFlSGG3QX4+3Z1UwCx2TRMkyZ1u12lsbqd5+e7CeDpCvGEd1CM5kYtQmz4L0FZD56XS9cGgKN9jc023NUwqk2o1c0F91wX3F3cUN8MrmRiQtXr14WeIbKfYVviE7YducOv3YAd3C6upgAJGjEP0EX/X7FgT48mteAlPYngXC964IrkSeTWafvlUmRGGzzhkhuaohOdODqe5GOK/NdROuaEEpQYYqVJPqasiOilxfTZu87TEFKb9PFbuDC79Qht89kmagUblhbRJSURSXW068Q7QMuY6MmgaexDAgYjOBMjycAsvphpcjdQbluj9RCyEYTTfNB12+KPWgGqGKt/8WQlqm0X/EaQ3CoBw/HaFiu4hQl6VrBiN8bhQufwgqdHbYZzq9hK10x10p3Co3kB+3gNfOWGL8ex4GYSBEuK4ZO+ZOuGDKZKFQjfneR+oNNO7XJdoATdz6IqsD+8dgp2grlAYP+TjqEnTOJxfOj9HzIsAPuTLTW0SECfXkRYwlVke9NHIgx120WyMLdBMYsCquNiEDMC5tK8llgaOAuVjH1HbLxmQeYUQx1mHfzpSsJV48tUXWyAApf3tn0U+5Nv8BS6MJXRcmSp2FzN0+Ui4HU1Yp7Cy43qXbYMChY5CF2d3oxhn3jdzhRC8UKyS\n</div>\n<script src=\"/lib/crypto-js.js\"></script><script src=\"/lib/blog-encrypt.js\"></script><link href=\"/css/blog-encrypt.css\" rel=\"stylesheet\" type=\"text/css\">","site":{"data":{}},"excerpt":"Welcome to my blog, enter password to read.","more":"Welcome to my blog, enter password to read.","origin":"<p>小学时我读人物传记，人物的形象隐约形成我思维的脉络，虽然当时不清楚它时一种价值观；那时的我可以趴在窗台，“卧看满天云不动，不知云与我俱东”。<br>中学时我读小说，一气呵成贯穿始终的“精气神”引发我的思考，开始萦绕不绝，主导思维的走向；尽管当时的环境现在看来很艰苦，但依然在追求光风霁月，和而不流。<br>高三时我读杂志，在日复一日的时期渴望注入一点新事物的思考，尽管如此，我依然能保持独立思考而接纳万物，甚至有一种“飘飘乎如遗世独立”的神态。<br>而现在，我一贫如洗，<br>在这样一个言论爆发的时代，我不幸的被湮没，<br>我开始浮躁，因为我停不下来，怕错过这个转瞬即逝的风口，<br>我的“思维热度”，姑且这样形容吧，一段时间总会被看过的一段文字“浸染”（或者侵袭？），总会在生活中找到映照而再次联想去思考。而现在，几乎是在被几个“大V号”牵引着，我不再关注真实，而更关注其中的一两个金句。<br>跑得再快，也成不了领头羊，况且，领头羊是最清楚方向的吗？<br>于是，我开始环视人群，当初我也在这样环视，希望遇到一种人，但是不可名状，后来我看到程颐形容程颢的一段话：</p>\n<blockquote>\n<p>视其色，其接物也如春阳之温；听其言，其入人也如时雨之润。胸怀洞然，彻视无间；测其蕴，则浩乎若沧溟之无际；极其德，美言盖不足以形容<br>这几句话表达的十分精致，曾经十分向往“谈笑有鸿儒，往来无白丁”的景象，这种景象在西方正如《福楼拜家的星期天》中那样智者云集的情形。</p>\n</blockquote>\n","encrypt":true,"template":"<script src=\"https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js\"></script>\n<div id=\"hbe-security\">\n  <div class=\"hbe-input-container\">\n  <input type=\"password\" class=\"hbe-form-control\" id=\"pass\" placeholder=\"Welcome to my blog, enter password to read.\" />\n    <label for=\"pass\">Welcome to my blog, enter password to read.</label>\n    <div class=\"bottom-line\"></div>\n  </div>\n</div>\n<div id=\"decryptionError\" style=\"display: none;\">Incorrect Password!</div>\n<div id=\"noContentError\" style=\"display: none;\">No content to display!</div>\n<div id=\"encrypt-blog\" style=\"display:none\">\nU2FsdGVkX18/l9d1lMBQzYcN5SF/tr8dn4+ZwST5KfvWVEXjwdSpEVfFtm1YukVS9f0JZydSLgTO1Ar5kNxS9UuzMZ4V4mgj8eMG5neCv+Vd1iu2Csu8DpjHXytAhyVhpzrc6ZEYbI0I2u2wXZ/+qcKzxTMpFHRUXTyjg6pyH3Jw5mLkrujx/9mKKCpmX4diMG+jC63y81o5CIqDJyAQ8PIt6qQWu1uK5sfhjZ13nPef0wxdkYjFFlQPo8NKJ/OKIuSZKsn1YkGSuuQByH+ARFYcfjsmLuUiRH/jiKT7wC5TFcXJnkM4wr+Hz/rjJvsLWBrvYjq62KwQMxRHpyKmJh1202mdXcKzajoabCZstiNK6DbWiPaRAjnd43r/xvchqPQ5OYOWoQRP0fay+RMFWUtxfWTYFOje9VYqu8GCIiWmnNMy0SzLl0EfsEWaQpy59v2aqtxJBXO/wP6lgGRFMAJSx9m7dhvKnCpjeWMHT4e/Zyg9mmFopGhqYcU08WWxyzQNIG15t5ZGcCKddp/sYCvvE5lnTZOSuZIqfvChCzJY6Iqc4yWI4YrE63MSwa4uMKwHl10fp0m9nVQewLXyvPQY3Ld2lvLrnjH/1tT6LWcKJWYNQ/ZPPYyMwBeqNGnV4zin7QPleqt4tudqlzri+BnC6JDkGpsAhw40Xa4woydc8rRk5BptlP5XmqYcTf7VX0v7x9VdjrYknpx75jY0E2pi5cYeAnUAnWpc40ksKnlD7MeiTZcMT4WTpmgwBWOl73dc4uscODuphi0WT+/VysPYTZEdlESycatUvELQwOQpn5C9gBtvJBcFl9XPCq8YIWO/gs9whbgc+TlqVuSEW/9/h2wqW7s6hzfBU+loMHZStADg1zwWQh3sqTDMz1vWCCfklyH/rPbF2q400crqgysQH5qH0IVsrZYB76e+A66yzI03jyCgg3fFciNmEGdAR+/XaVsKpI3lgCx28+pSiH9Ai8LIAu0o+mf1+4+jcIGAPTxx/Q9vcZ83Oy1aOzXQCXX3jI9v8IMT0NljlW953tR5mIt9wqkUIWXayf0MgzYNWOl2zO1Y6DM9HFMH/ha5Y3CPo7R9Z6e3VV9pDus768m7LV0pj1Nm5w7QjGyyAfpWTjWSCinCGj7//DZPQlfrLoVrk54Ds//akgEsv/zgT1B/TbqiDCTj041BhxJ4t7/Qr2AJz0ZsVzB16Hr+OngVpcYtGgyeadFj1TIfTUGYUwyxcG4qPGMDW/J5D8nuT8yL5OfDN3OJXnkPi8TwmVXqF0zbNzIjvO08DdDjx7ORJfcKJYArbbp8wkm63s3lQr9Hl2Hggs4U9Uet22bAMUqXBscmTWmSBt1P+IdNX7xJQcMFluye3OgRlcjwNfjngPXSsegjaUhq4S8+s1UPv8RzszmKgfygVCUJ88jIbKCA9Jc/cSkrgbCGVYbNziXpno2OSGDhvwKH0EgwgzAzP+ti74TCHXvZytsUEcVx73wUQ+0NwqO+ij6jBHhkuiaERMQEU9xvgyXZgd65Jkf7tu/FV2kxqmsLu4e9Pp5YKPliVWKzKv37EWxyfs7kK+VpO/uJMwbQM7H5brfehm9Xl29BDWRQ/b+CmFr9vZzFaPKwq4khN3jIn7RmPSyIu599LVYn1JIV5kXrQz6Fj/9/6XFwFujggALHXrWXz3rtGK0/5Gon5QTnDVauew+xCU6wrenOMVVHS5ZakZILCBI/AboAiVyIOMI8d+1rh5TXd4W3XzOPEkD3z/9IsFT56yOfrS24RQTnmJl+LpEofRbRKzyZDt9E8NoFWI9pbRpm5Wxog9Vf4IDNwT2V/t/XPUONtG71vnCCG/UaLhjUAiFj0OCTP4GG4+g/hCaf07Bd5NNtLUI+bsa7Cai6Hro4ATHDt9eS1wlRzNbL/VHep8UA+8FrgoICpPoPimu32oYxplJBMOqxkOZkyLYSU6t3LJ2a1dxM2tFShry7OaPJYDVuMbGqBERKz5SHWf+lN60WT/yuQfkp2Q1EYnjojavvz8MaKo3shkxzVilKarYdxrUYkh764cAWtKbfbjYlP9Mq7KBZ9QBjJbK4Gvy2FQ/VSw8flFFnPO+2emy69Sn8yBJfAc7yC16C3dGrey/e3Lg3DuBG7kmr9aVv5lPVNHRVwjIugnIx2IISE1je/WTfgUhhd0vpVY+EfXq/9sk80agKKPvSi6b50wwFNE4HI/nhEU061kav47Uu1EMgamyxrrDf8gx3BqNkV5nsPfugEGmG/N2p27oqpQB7HkXUhkwww50SqEkPvHYqBoIHGXs4wLmiNt9nDwGCJ87FHEhrg9MyKaD3yQeYpQOugEW5jlAxTuiDd/dH86tt7hIdpZBJyFU57n4fQF3upvORSFydkOk0vpCkFWOqmsoK+tJHs3N+Z1jjMXp1h4+Lxh2LotRRIMnSAo20vgCtIXyZMCt7Bw7QCk6KsA2rtzU5an42O5V8IPD61imxUn0rQEp+YxIjS1CSkx1wPef0q+ysyCo92N6LttPv2HQrrXMWgI47gFej/2lSEaRbIwaJNedp37hKuOENQN0HpZbn2kusi2RZNXkA5QOU6BZEGe8r+wrZh1Xx0pouB6yuGnUq8CyWFnL9GJWkHnvMs9TzvGxvUb5w23/GR3JKOkthkXGfxwKR0LWS54vS/xNUjsnpPgCjFkYVZ9FfvO9iW/tNwIXBM938Z+SF9IRBVzLgnQrq2zdQbuIwPxsBUvpvh6fscPEclUE5cmqVosOekB8U4Rqjup+Jm9bmncWKcJ0SxDTU1QGvtjM/gjkUtIY+W92ZswiRCju10YiIQAGDvwt9NOek826HN8U9AAWy8HcUjBJnaZ9Qbu/urU03H+IMNILnn4/jD+1FFIcc9azSORLYff1lqC8eGvtdZtcHzU6ADETp8a5+77fC4xybd2163AzQprssVwYRMzLRK6RJWTMMwU/Uc3GH9Z/N4YrUzALc3QpFs4nn9G54U7boxkB4XxBlcnOtIbalTqd2MR2shhwOiPgVrDQVrdWrlfRabZ84ehxDWNtdwtmGV2lM+Y47eE4rYfNiml23Y0+juqPmIZif1DRKzRZA/vM06fIac95qIuYAZXk1zmKkBsTyZ0nvy149ODbFzEPeY/7V1C86lMZ0UgdqwOPjpTsBSEWj9YDIqE6Gr1k0+KEEGYCDV44BROr98KnlvxLc4uNkw6QBqEck4WJKopu4HVfyzUoaHSyaoeGESnrS5xHiXQ+O6nsMMVOrPcW5ZUmLYf4Zn0yQvamnguUmAoDfn8grfE8meQtk5wHREFiB5rF3dB+Sn583YkrufDcJOfsx3hji3Wb+7SJwegx+ZT/1b02HXj34rploFhqvDAhGN0ibQz+H2+d4uCzgUuXdYi5G08eEtCKkKNhrFTjrF/mRTwntQ9qmdjMQQYIt3G1CCcjYawfUq0vvfHwmzWN4V7Wc7CzJs1DPs74RDnotn4peEwC5V06JIqW+Iy+O3x0OkA93u93Q9Ux9SGjBXWRx23EwJsXgVFlANREcwq30XqZEuAD0nSv5Ot5aWR7tu6Pl02ThUS+hLBjC12Ej236cnCfpTf+eAGi3K67e9VTDYf0KuUkZxEV0foCmbFHyMviR02qJVHIL1BHG4Kns6EUUasUS3gpucQdVLoqxCa6g8jo5y6MO/0pOMMtRmQXdofvLQB6u7BAzxrxKHTBMR+rsfCsDMCGDqbzDEqpU0PgWEpzM93AMb7zjMk1OhKJeISm3yM96ks00s/ayy7fzgOfN1VCCiJiI0dy+prr+TfmqoIJ5eF5ceJAYkS+TigQ7U8AM9VuSQAKrBxVLUI8CoGEpVcu7MokHFYuq+cMF3NcJPaJYPCdAAkrmdQ9Zf145vHo8yybQby7TLTapT5oJIGPHElF8df7XM5+qaUzylTufoU8kJTaK4F2Rhu4s5sHdeq8zOZVmPzE6Z0g81nMnMBpvRiGjjL3CSKNNmjryU/DTHM99ats3FhE7CJO/hMcVrXwDxwALgR3f7i1wjO629A0GdQ222depwF4nJMClD9RBye8uAnO3jFKFqbcIf+VZIrwZSRuin9xtr2LW761an7MxtL09NbXsLvVpnW0bMFuxMLxVEToJAF49uvMB4IoUQlv3U87T9rGRWT6Ay/oITTJYG+mWLFjQu7T2U2RlJpxTHJaAc+LidXkf/DbKtRlz86ibensqO9LUJVh/5ib3YYtyCLc2II+BcxTcK5b8tCk2iBGuYYein55B6ncuRwroGyVVUmnAHk7AT+58UwrWpUTZPxVF2s2MGzAdJK+CAMpn2xqlT2nyI0+/Cn4qjq9hgrOppKZz+2AZjJMl3Rru/mqLodq1gR0TAgFgQB0dPjRGJGQZOythJP0tVmYcnvDd/hK3wkS9plGtvQQLEG2kqqLRwkG1efWt5/ONKI95qFCNqMuUmJSWIGfGwS2ffH850Cw3EKBlRVnTuLEisyPuystFXK9lqZORBRjM9l1jrSmNvnFT/63EORqOYXMQHt3dIJacd8QWXS+pfJsYmkpo/rHBTZl+6Px21yDEz8KA+cI3QoxsOrRq1c6yRrzSv1oEGEQIJ4qObvJWkamN47zRHiVv7eEMyLkTAtoNoOFzgf0fz+aSJFZOEXwx2GNvw51nDKKoIQNXd9ScgSFT7SK9d77eCerwu7/prawpx/JkGHv83mlxYFZt6dh/YH/ajTQX44v8yIQDvF3sRegJcbBl9I/f9NUybEE6uAXm8sUWZZG4lEqeKro9TrLFZJhHlk9I1EiQ3vrZKC66qhB5SnwcghESZlyKIrypo92RdgR5Wlq9BDPFtA8PTr6vLvf7654SH18Nxungniccg+JSJp+1qAY4HedKNSC5pXRBi5jlQT8mtBoQNpgOt9fEkVrZdFrBXeuRuiFjzb3mnYQ4t0Pd/rYWzpSgyR10KvLGCDfM3ujKaFA2djVrHU8TYiiXFElmM7dkmrV75eZ1twcO3TMyhQ5XYFzHqQoDmo+K1aoJPypG3ItYfMA1XA76jd09FYWwNwY4PbNtNR9RIJ4STC2sieW1Tiv+4IFBjXve0sBg4AdQ9lXEfbOYHIRZi/6V/17geZ8+LV9XUK8BohxjrXTvyE/qGan+lDKa05txFHIsmxwsd/VrRY8SSbYPaJwF2G7chuHTMnT3dVzT6jyk2ZakmbDYr5QVNnUKYmKIUd/qrT8jhE3mWLwAb1ltjzdywSYDAfV9U6u50L1Vli0WqNfJ+sxNf3DMWZyqdpLLF9lPtAuNQo3eDyqUOaQA2OdkACJN6Jon25cs8TlLhequ+4DQa8BqPhYgbVaylpoAcAFpulIBVTPruVZ1onVdh+8mVlyBuhOqdWvtvdcLX65xi3+Uo9KB8o4AnhRxn3V26S1dq3pKIHwAYQqY+YuBw72WkUDe3hKYh9f4sPq2OxEqJ9QQu6zUFkVJeMgYRdq4yAgNC+Wz9XLz5zTJHD9tmCUMbjZFI0/s70xnHQADKzYtYU0SqScCQwFp1eEVJ3zeLbfN++z3b2wzIt4RPT+SMRQqXt2rIuV/b/5B6aouuGxnHVdRU6ktv6s3UPguRqLqlQczpij+YT6Bzly8OrjpTYw9uu5HBBdaOB+ubfQDzhUFP9EDxEPgv+YkqkDhCvYxbpq5VQ3mNIzK2Ijyue2zliLb/Ibf1Uv6gVrdHGlKiwpCi5yIgNciLUQCHgSVEXSMdhMGRdo5WGbaF9K/FXZtN/jl60MswcpZ+gYjMaTmtyOCNjVR4ZnHhHWITfnu5YfLRfhoDFKwp8zUNf3Oi716IgQWSNd7hxaVaYv5rsr8VR1rNlGRlE38wt25l1jz4DeVbEIW6JAXohPKRsWBz+HnKgAtHM+7GzZ2CxlllcG42sM9oi60TaFlSGG3QX4+3Z1UwCx2TRMkyZ1u12lsbqd5+e7CeDpCvGEd1CM5kYtQmz4L0FZD56XS9cGgKN9jc023NUwqk2o1c0F91wX3F3cUN8MrmRiQtXr14WeIbKfYVviE7YducOv3YAd3C6upgAJGjEP0EX/X7FgT48mteAlPYngXC964IrkSeTWafvlUmRGGzzhkhuaohOdODqe5GOK/NdROuaEEpQYYqVJPqasiOilxfTZu87TEFKb9PFbuDC79Qht89kmagUblhbRJSURSXW068Q7QMuY6MmgaexDAgYjOBMjycAsvphpcjdQbluj9RCyEYTTfNB12+KPWgGqGKt/8WQlqm0X/EaQ3CoBw/HaFiu4hQl6VrBiN8bhQufwgqdHbYZzq9hK10x10p3Co3kB+3gNfOWGL8ex4GYSBEuK4ZO+ZOuGDKZKFQjfneR+oNNO7XJdoATdz6IqsD+8dgp2grlAYP+TjqEnTOJxfOj9HzIsAPuTLTW0SECfXkRYwlVke9NHIgx120WyMLdBMYsCquNiEDMC5tK8llgaOAuVjH1HbLxmQeYUQx1mHfzpSsJV48tUXWyAApf3tn0U+5Nv8BS6MJXRcmSp2FzN0+Ui4HU1Yp7Cy43qXbYMChY5CF2d3oxhn3jdzhRC8UKyS\n</div>\n","decryptionError":"Incorrect Password!","noContentError":"No content to display!"},{"title":"面试总结","date":"2019-04-05T00:20:11.000Z","_content":"# 1. 阿里巴巴\n{% note info no-icon %}\n岗位:前端工程师（实习）\n{% endnote %}\n<!-- more -->\n1. CSS的display属性\n2. Bootstrap的栅格化布局，响应式原理 \n3. Javascript闭包\n4. Ajax原理实现\n5. 防SQL注入\n6. React原理，重要的生命周期\n7. Webpack原理\n8. GET&POST\n9. SESSION&COOKIE,客户端禁用COOKIE后...\n10. JSON&JSONP\n11. HTTP&HTTPS\n12. 对前端的认识\n13. TCP/IP\n14. 对Node.js的认识\n15. 计算机科学与技术所学对前端技术...\n\n# 2 多益\n# 3 课观教育 \n# 总结\n## 项目经验\nSTAR 职务职责、内容成果、问题方案\n## 学科基础\n|操作系统|计算机网络|数据结构|\n|--|--|--|\n|进程线程|TCP/IP协议族|二叉树|\n||http和https||\n## 基本知识\n操作：字符串操作、数组操作、正则匹配\n## 进阶\n|面向对象思想|数据结构与算法|数据库内容|设计模式|框架原理\n|--|--|--|--|--|\n|继承组合|排序算法|事务、隔离、锁、索引||bootstrap响应式\n## 高阶\nLNMP架构优化、高并发分布式、负载均衡、分库分表","source":"_posts/zh-CN/面试总结.md","raw":"---\ntitle: 面试总结\ndate: 2019-04-05 08:20:11\ntags: \n  - 面试\n---\n# 1. 阿里巴巴\n{% note info no-icon %}\n岗位:前端工程师（实习）\n{% endnote %}\n<!-- more -->\n1. CSS的display属性\n2. Bootstrap的栅格化布局，响应式原理 \n3. Javascript闭包\n4. Ajax原理实现\n5. 防SQL注入\n6. React原理，重要的生命周期\n7. Webpack原理\n8. GET&POST\n9. SESSION&COOKIE,客户端禁用COOKIE后...\n10. JSON&JSONP\n11. HTTP&HTTPS\n12. 对前端的认识\n13. TCP/IP\n14. 对Node.js的认识\n15. 计算机科学与技术所学对前端技术...\n\n# 2 多益\n# 3 课观教育 \n# 总结\n## 项目经验\nSTAR 职务职责、内容成果、问题方案\n## 学科基础\n|操作系统|计算机网络|数据结构|\n|--|--|--|\n|进程线程|TCP/IP协议族|二叉树|\n||http和https||\n## 基本知识\n操作：字符串操作、数组操作、正则匹配\n## 进阶\n|面向对象思想|数据结构与算法|数据库内容|设计模式|框架原理\n|--|--|--|--|--|\n|继承组合|排序算法|事务、隔离、锁、索引||bootstrap响应式\n## 高阶\nLNMP架构优化、高并发分布式、负载均衡、分库分表","slug":"面试总结","published":1,"lang":"zh-CN","updated":"2019-07-21T06:50:38.389Z","_id":"cjvnq7zb2002v7jjxuxfl34fw","comments":1,"layout":"post","photos":[],"link":"","content":"<link rel=\"stylesheet\" class=\"aplayer-secondary-style-marker\" href=\"/assets/css/APlayer.min.css\"><script src=\"/assets/js/APlayer.min.js\" class=\"aplayer-secondary-script-marker\"></script><script class=\"meting-secondary-script-marker\" src=\"/assets/js/Meting.min.js\"></script><link rel=\"stylesheet\" type=\"text/css\" href=\"https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css\"><h1 id=\"1-阿里巴巴\"><a href=\"#1-阿里巴巴\" class=\"headerlink\" title=\"1. 阿里巴巴\"></a>1. 阿里巴巴</h1><div class=\"note info no-icon\">\n            <p>岗位:前端工程师（实习）</p>\n          </div>\n<a id=\"more\"></a>\n<ol>\n<li>CSS的display属性</li>\n<li>Bootstrap的栅格化布局，响应式原理 </li>\n<li>Javascript闭包</li>\n<li>Ajax原理实现</li>\n<li>防SQL注入</li>\n<li>React原理，重要的生命周期</li>\n<li>Webpack原理</li>\n<li>GET&amp;POST</li>\n<li>SESSION&amp;COOKIE,客户端禁用COOKIE后…</li>\n<li>JSON&amp;JSONP</li>\n<li>HTTP&amp;HTTPS</li>\n<li>对前端的认识</li>\n<li>TCP/IP</li>\n<li>对Node.js的认识</li>\n<li>计算机科学与技术所学对前端技术…</li>\n</ol>\n<h1 id=\"2-多益\"><a href=\"#2-多益\" class=\"headerlink\" title=\"2 多益\"></a>2 多益</h1><h1 id=\"3-课观教育\"><a href=\"#3-课观教育\" class=\"headerlink\" title=\"3 课观教育\"></a>3 课观教育</h1><h1 id=\"总结\"><a href=\"#总结\" class=\"headerlink\" title=\"总结\"></a>总结</h1><h2 id=\"项目经验\"><a href=\"#项目经验\" class=\"headerlink\" title=\"项目经验\"></a>项目经验</h2><p>STAR 职务职责、内容成果、问题方案</p>\n<h2 id=\"学科基础\"><a href=\"#学科基础\" class=\"headerlink\" title=\"学科基础\"></a>学科基础</h2><table>\n<thead>\n<tr>\n<th>操作系统</th>\n<th>计算机网络</th>\n<th>数据结构</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>进程线程</td>\n<td>TCP/IP协议族</td>\n<td>二叉树</td>\n</tr>\n<tr>\n<td></td>\n<td>http和https</td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"基本知识\"><a href=\"#基本知识\" class=\"headerlink\" title=\"基本知识\"></a>基本知识</h2><p>操作：字符串操作、数组操作、正则匹配</p>\n<h2 id=\"进阶\"><a href=\"#进阶\" class=\"headerlink\" title=\"进阶\"></a>进阶</h2><table>\n<thead>\n<tr>\n<th>面向对象思想</th>\n<th>数据结构与算法</th>\n<th>数据库内容</th>\n<th>设计模式</th>\n<th>框架原理</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>继承组合</td>\n<td>排序算法</td>\n<td>事务、隔离、锁、索引</td>\n<td></td>\n<td>bootstrap响应式</td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"高阶\"><a href=\"#高阶\" class=\"headerlink\" title=\"高阶\"></a>高阶</h2><p>LNMP架构优化、高并发分布式、负载均衡、分库分表</p>\n","site":{"data":{}},"excerpt":"<h1 id=\"1-阿里巴巴\"><a href=\"#1-阿里巴巴\" class=\"headerlink\" title=\"1. 阿里巴巴\"></a>1. 阿里巴巴</h1><div class=\"note info no-icon\">\n            <p>岗位:前端工程师（实习）</p>\n          </div>","more":"<ol>\n<li>CSS的display属性</li>\n<li>Bootstrap的栅格化布局，响应式原理 </li>\n<li>Javascript闭包</li>\n<li>Ajax原理实现</li>\n<li>防SQL注入</li>\n<li>React原理，重要的生命周期</li>\n<li>Webpack原理</li>\n<li>GET&amp;POST</li>\n<li>SESSION&amp;COOKIE,客户端禁用COOKIE后…</li>\n<li>JSON&amp;JSONP</li>\n<li>HTTP&amp;HTTPS</li>\n<li>对前端的认识</li>\n<li>TCP/IP</li>\n<li>对Node.js的认识</li>\n<li>计算机科学与技术所学对前端技术…</li>\n</ol>\n<h1 id=\"2-多益\"><a href=\"#2-多益\" class=\"headerlink\" title=\"2 多益\"></a>2 多益</h1><h1 id=\"3-课观教育\"><a href=\"#3-课观教育\" class=\"headerlink\" title=\"3 课观教育\"></a>3 课观教育</h1><h1 id=\"总结\"><a href=\"#总结\" class=\"headerlink\" title=\"总结\"></a>总结</h1><h2 id=\"项目经验\"><a href=\"#项目经验\" class=\"headerlink\" title=\"项目经验\"></a>项目经验</h2><p>STAR 职务职责、内容成果、问题方案</p>\n<h2 id=\"学科基础\"><a href=\"#学科基础\" class=\"headerlink\" title=\"学科基础\"></a>学科基础</h2><table>\n<thead>\n<tr>\n<th>操作系统</th>\n<th>计算机网络</th>\n<th>数据结构</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>进程线程</td>\n<td>TCP/IP协议族</td>\n<td>二叉树</td>\n</tr>\n<tr>\n<td></td>\n<td>http和https</td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"基本知识\"><a href=\"#基本知识\" class=\"headerlink\" title=\"基本知识\"></a>基本知识</h2><p>操作：字符串操作、数组操作、正则匹配</p>\n<h2 id=\"进阶\"><a href=\"#进阶\" class=\"headerlink\" title=\"进阶\"></a>进阶</h2><table>\n<thead>\n<tr>\n<th>面向对象思想</th>\n<th>数据结构与算法</th>\n<th>数据库内容</th>\n<th>设计模式</th>\n<th>框架原理</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>继承组合</td>\n<td>排序算法</td>\n<td>事务、隔离、锁、索引</td>\n<td></td>\n<td>bootstrap响应式</td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"高阶\"><a href=\"#高阶\" class=\"headerlink\" title=\"高阶\"></a>高阶</h2><p>LNMP架构优化、高并发分布式、负载均衡、分库分表</p>"},{"title":"LNMP","date":"2019-01-07T10:24:23.000Z","_content":"\n# 1 nginx\n传统基于线程提交请求\n可扩展的事件异步驱动\n反向代理服务器（邮件代理、通用TCP/UDP代理服务器）\n<!-- more -->\n## 1.1 intall nginx \n### 1.1.1 Prebuilt Packages\n#### 1.1.1.1 try\n```sh\n# can install directly\nsudo apt-get install nginx\n# install the latest version as follows\nsudo vim /etc/apt/sources.list\n# append to the end\ndeb http://nginx.org/packages/ubuntu/ xenial nginx\ndeb-src http://nginx.org/packages/ubuntu/ xenial nginx\n# update sources\nsudo apt-get update\n```\n``W: GPG error: http://nginx.org/packages/ubuntu xenial InRelease: The following signatures couldn't be verified because the public key is not available: NO_PUBKEY ABF5BD827BD9BF62``\n\n```sh\n# refer:https://www.nginx.com/resources/wiki/start/topics/tutorials/install/\nsudo apt-key adv --keyserver keyserver.ubuntu.com --recv-keys $key\nsudo apt-get update # Warning again\n```\n```sh\nwget http://nginx.org/keys/nginx_signing.key\nsudo apt-key add nginx_signing.key\nsudo apt-get update # OK\n# install\nsudo apt-get install nginx\n# test\nservice nginx start\nservice nginx status\n```\nAvailable [install_nginx.sh](https://github.com/MakerGYT/ubuntu-sh/blob/master/install_nginx.sh)\n#### 1.1.1.2 uninstall\n```sh\nsudo service nginx stop\nsudo apt-get remove nginx\nsudo apt-get --purge remove nginx\nsudo apt-get autoremove\n# test\nsudo service nginx status\nwhich nginx\ndpkg --get-selections|grep nginx\n```\n### Building from Sources\n```sh\nwget https://nginx.org/download/nginx-1.16.0.tar.gz\ntar -zxvf nginx-1.16.0.tar.gz\n./configure --prefix=/etc/nginx\n```\n{% note danger %}\n./configure: error: the HTTP rewrite module requires the PCRE library.\nYou can either disable the module by using --without-http_rewrite_module\noption, or install the PCRE library into the system, or build the PCRE library\nstatically from the source with nginx by using --with-pcre=<path> option.\n{% endnote%}\n```sh\nwget wget https://ftp.pcre.org/pub/pcre/pcre2-10.33.tar.gz\ntar -zxvf pcre2-10.33.tar.gz\ncd nginx-1.16.0\n./configure --prefix=/etc/nginx --with-pcre=../pcre2-10.33\n```\n{% note danger %}\n./configure: error: the HTTP gzip module requires the zlib library.\nYou can either disable the module by using --without-http_gzip_module\noption, or install the zlib library into the system, or build the zlib library\nstatically from the source with nginx by using --with-zlib=<path> option.\n{% endnote%}\n```sh\nwget http://www.zlib.net/zlib-1.2.11.tar.gz\ntar -zxvf zlib-1.2.11.tar.gz\ncd nginx-1.16.0 && ./configure --prefix=/etc/nginx --with-pcre=../pcre2-10.33 --with-zlib=../zlib-1.2.11\n```\n{% note info %}\nConfiguration summary\n  + using PCRE library: ../pcre2-10.33\n  + OpenSSL library is not used\n  + using zlib library: ../zlib-1.2.11\n{% endnote%}\n```sh\nwget https://www.openssl.org/source/openssl-1.1.1b.tar.gz\ntar -zxvf openssl-1.1.1b.tar.gz\ncd nginx-1.16.0 &&  ./configure --prefix=/etc/nginx --with-pcre=../pcre2-10.33 --with-zlib=../zlib-1.2.11 --with-http_ssl_module --with-openssl=../openssl-1.1.1b # ok\n```\n{% note danger %}\nsrc/core/ngx_regex.h:15:18: fatal error: pcre.h: No such file or directory\ncompilation terminated.\nobjs/Makefile:383: recipe for target 'objs/src/core/nginx.o' failed\nmake[1]: *** [objs/src/core/nginx.o] Error 1\nmake[1]: Leaving directory '/root/nginx-1.16.0'\nMakefile:8: recipe for target 'build' failed\n{% endnote %}\nneed to install libpcre3-dev_8.x, so pcre 8.x series maybe works,but\n{% note info no-icon %}\nThe older, but still widely deployed PCRE library, originally released in 1997, is at version 8.43. Its API and feature set are stable—future releases will be for bugfixes only. Any new features will be added to PCRE2, and not to the PCRE 8.x series.\n{% endnote%}\nChange pcre version(8.43) and reinstall,OK\n```sh\nmake install\n# test\n/etc/sbin/nginx start\n```\nuninstall\n```sh\nsudo rm -rf /nginx-1.16.0\nsudo rm -rf /etc/nginx\n```\n## configure nginx\n### default\n```sh\n# etc/nginx/nginx.conf\nuser  nginx;\nworker_processes  1;\nerror_log  /var/log/nginx/error.log warn;\npid        /var/run/nginx.pid;\nevents {\n    worker_connections  1024;\n}\nhttp {\n    include       /etc/nginx/mime.types;\n    default_type  application/octet-stream;\n    log_format  main  '$remote_addr - $remote_user [$time_local] \"$request\" '\n                      '$status $body_bytes_sent \"$http_referer\" '\n                      '\"$http_user_agent\" \"$http_x_forwarded_for\"';\n    access_log  /var/log/nginx/access.log  main;\n    sendfile        on;\n    #tcp_nopush     on;\n    keepalive_timeout  65;\n    #gzip  on;\n    include /etc/nginx/conf.d/*.conf;\n}\n# etc/nginx/conf.d/default.conf\nserver {\n    listen       80;\n    server_name  localhost;\n\n    #charset koi8-r;\n    #access_log  /var/log/nginx/host.access.log  main;\n\n    location / {\n        root   /usr/share/nginx/html;\n        index  index.html index.htm;\n    }\n\n    #error_page  404              /404.html;\n\n    # redirect server error pages to the static page /50x.html\n    #\n    error_page   500 502 503 504  /50x.html;\n    location = /50x.html {\n        root   /usr/share/nginx/html;\n    }\n\n    # proxy the PHP scripts to Apache listening on 127.0.0.1:80\n    #\n    #location ~ \\.php$ {\n    #    proxy_pass   http://127.0.0.1;\n    #}\n\n    # pass the PHP scripts to FastCGI server listening on 127.0.0.1:9000\n    #\n    #location ~ \\.php$ {\n    #    root           html;\n    #    fastcgi_pass   127.0.0.1:9000;\n    #    fastcgi_index  index.php;\n    #    fastcgi_param  SCRIPT_FILENAME  /scripts$fastcgi_script_name;\n    #    include        fastcgi_params;\n    #}\n\n    # deny access to .htaccess files, if Apache's document root\n    # concurs with nginx's one\n    #\n    #location ~ /\\.ht {\n    #    deny  all;\n    #}\n}\n```\n### Setting Up a Simple Proxy Server,8080->80\n```sh\n# /etc/nginx/conf.d/test.conf\nserver {\n    listen 80;\n    location / {\n        proxy_pass http://localhost:8080/;\n    }\n    location ~ \\.(gif|jpg|png)$ {\n        root /data/images;\n    }\n}\nserver {\n    listen 8080;\n    root /data/up1;\n    location / {\n    }\n}\n```\nnew a html\n```sh\ncd /data/up1\nvim index.html\n```\n```\nsudo nginx -t\nsudo nginx -s reload \n```\naccess content correctly through intranet IP\n### Setting Up FastCGI Proxying\n```\ncat /etc/nginx/nginx.conf\nuser  nginx;\nworker_processes  1;\n\nerror_log  /var/log/nginx/error.log warn;\npid        /var/run/nginx.pid;\n\nhttp {\n    server {\n        location / {\n            fastcgi_pass  localhost:9000;\n            fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;\n            fastcgi_param QUERY_STRING    $query_string;\n        }\n        location ~ \\.(gif|jpg|png)$ {\n            root /data/images;\n        }\n    }\n}\n\nevents {\n    worker_connections  1024;\n}\n```\n\n# php\n## install php\n```sh\n# 1.Obtain and unpack the PHP source:\nwget http://cn.php.net/distributions/php-7.2.13.tar.gz\ntar zxf php*\n# 2.Configure and build PHP.\ncd php*\n./configure --enable-fpm --with-mysqli\n```\n``checking for cc... no\nchecking for gcc... no\nconfigure: error: in `/home/vagrant/php-7.2.13':\nconfigure: error: no acceptable C compiler found in $PATH``\n```sh\nwget https://mirrors.ustc.edu.cn/gnu/gcc/gcc-8.2.0/gcc-8.2.0.tar.gz \n# need to take more steps in the official way above and try again another day.\nsudo apt-get install gcc # Not necessarily up-to-date\n./configure --enable-fpm --with-mysqli\n```\n``configure: error: libxml2 not found. Please check your libxml2 installation.``\n```sh\nsudo apt-get install libxml2 # do not work\n# If you want to compile software from source based on libxml2 you need the development files:\nsudo apt-get install libxml2-dev # OK\nsudo apt-get install make\nmake -v\nmake\nsudo make test\n```\nFAILED TEST SUMMARY\nTimeout within function [tests/basic/timeout_variation_1.phpt]\nTimeout within shutdown function, variation [tests/basic/timeout_variation_10.phpt]\nTimeout within eval [tests/basic/timeout_variation_3.phpt]\nTimeout within call_user_func [tests/basic/timeout_variation_4.phpt]\nTimeout within function containing exception [tests/basic/timeout_variation_5.phpt]\nTimeout within shutdown function [tests/basic/timeout_variation_9.phpt]\nTimeout again inside register_shutdown_function [tests/lang/045.phpt]\n\n```sh\nsudo make install\nInstalling shared extensions:     /usr/local/lib/php/extensions/no-debug-non-zts-20170718/\nInstalling PHP CLI binary:        /usr/local/bin/\nInstalling PHP CLI man page:      /usr/local/php/man/man1/\nInstalling PHP FPM binary:        /usr/local/sbin/\nInstalling PHP FPM defconfig:     /usr/local/etc/\nInstalling PHP FPM man page:      /usr/local/php/man/man8/\nInstalling PHP FPM status page:   /usr/local/php/php/fpm/\nInstalling phpdbg binary:         /usr/local/bin/\nInstalling phpdbg man page:       /usr/local/php/man/man1/\nInstalling PHP CGI binary:        /usr/local/bin/\nInstalling PHP CGI man page:      /usr/local/php/man/man1/\nInstalling build environment:     /usr/local/lib/php/build/\nInstalling header files:          /usr/local/include/php/\nInstalling helper programs:       /usr/local/bin/\n  program: phpize\n  program: php-config\nInstalling man pages:             /usr/local/php/man/man1/\n  page: phpize.1\n  page: php-config.1\nInstalling PEAR environment:      /usr/local/lib/php/\nInstalling PDO headers:           /usr/local/include/php/ext/pdo/\n```\nYou may want to add: /usr/local/lib/php to your php.ini include_path\n## configure php\n```sh\n# 3.Obtain and move configuration files to their correct locations\nsudo cp php.ini-development /usr/local/php/php.ini\nsudo cp /usr/local/etc/php-fpm.conf.default /usr/local/etc/php-fpm.conf\nsudo cp sapi/fpm/php-fpm /usr/local/bin\n# 4.prevent arbitrarily script injection\nsudo vim /usr/local/php/php.ini\ncgi.fix_pathinfo=0 # line 769\n# 5.php-fpm.conf\nsudo vim /usr/local/etc/php-fpm.conf\n# append in the end\n; Unix user/group of processes\n; Note: The user is mandatory. If the group is not set, the default user's group\n;       will be used.\nuser = www-data\ngroup = www-data\n```\n```sh\n# start php-fpm\n/usr/local/bin/php-fpm\n```\n``ERROR: Unable to globalize '/usr/local/NONE/etc/php-fpm.d/*.conf' (ret=2) from /usr/local/etc/php-fpm.conf at line 125.``\nThe official error here should be changed to:\n```sh\ncd /usr/local/etc\nsudo vim php-fpm.conf\n# modify in the end\ninclude=/usr/local/etc/php-fpm.d/*.conf\n# sudo cp php-fpm.d/www.conf.default php-fpm.d/www.conf\nsudo vim php-fpm.d/www.conf\n# line 23\nuser = www-data\ngroup = www-data\n```\n```sh\nsudo /usr/local/bin/php-fpm # OK\n```\n## configure  nginx to support php\n```\n# 6.nginx.conf\nsudo vim /etc/nginx/nginx.conf\nhttp {\n    server {\n        listen 80;\n        server_name learn.lea;\n        location / {\n            root /data/www;\n            index index.php index.html index.htm;\n        }\n        location ~* \\.php$ {\n            fastcgi_index index.php;\n            fastcgi_pass  127.0.0.1:9000;\n            include       fastcgi_params;\n            fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;\n            fastcgi_param SCRIPT_NAME     $fastcgi_script_name;\n        }\n        location ~ \\.(gif|jpg|png)$ {\n            root /data/images;\n        }\n    }\n}\n\nevents {\n    worker_connections  1024;\n}\n```\n# test\n```sh\nsudo echo \"<?php phpinfo(); ?>\" >> /usr/local/nginx/html/index.php\n# navigate to http://learn.lea\n```\n``File not found``\n```sh\nsudo vim /etc/nginx/nginx.conf\n# add \"root /data/www\" directive to PHP location block\nsudo nginx -s reload # OK\n```\nrestart the machine:\n\n``nginx start automaticlly``\n``php-fpm need to start``\n\n# mysql\n>version: `8.0`\n\n```sh\nwget https://dev.mysql.com/get/mysql-apt-config_0.8.12-1_all.deb\nsudo dpkg -i mysql-apt-config_0.8.12-1_all.deb\nsudo apt-get update\nsudo apt-get install mysql-server\nsudo service mysql status\nmysql -u root -p\n```\n\n# Reference\n<small>\n[1] Martin Fjordvald.NGINX CONFIGURATION PRIMER.http://blog.martinfjordvald.com/2010/07/nginx-primer/ [EB/OL] 2010\n[2] debian.Nginx.https://wiki.debian.org/Nginx [EB/OL] 2016\n</small>","source":"_posts/en/LNMP.md","raw":"---\ntitle: LNMP\ndate: 2019-01-07 18:24:23\ncategories: config\ntags:\n  - nginx\n  - php\n  - mysql\n---\n\n# 1 nginx\n传统基于线程提交请求\n可扩展的事件异步驱动\n反向代理服务器（邮件代理、通用TCP/UDP代理服务器）\n<!-- more -->\n## 1.1 intall nginx \n### 1.1.1 Prebuilt Packages\n#### 1.1.1.1 try\n```sh\n# can install directly\nsudo apt-get install nginx\n# install the latest version as follows\nsudo vim /etc/apt/sources.list\n# append to the end\ndeb http://nginx.org/packages/ubuntu/ xenial nginx\ndeb-src http://nginx.org/packages/ubuntu/ xenial nginx\n# update sources\nsudo apt-get update\n```\n``W: GPG error: http://nginx.org/packages/ubuntu xenial InRelease: The following signatures couldn't be verified because the public key is not available: NO_PUBKEY ABF5BD827BD9BF62``\n\n```sh\n# refer:https://www.nginx.com/resources/wiki/start/topics/tutorials/install/\nsudo apt-key adv --keyserver keyserver.ubuntu.com --recv-keys $key\nsudo apt-get update # Warning again\n```\n```sh\nwget http://nginx.org/keys/nginx_signing.key\nsudo apt-key add nginx_signing.key\nsudo apt-get update # OK\n# install\nsudo apt-get install nginx\n# test\nservice nginx start\nservice nginx status\n```\nAvailable [install_nginx.sh](https://github.com/MakerGYT/ubuntu-sh/blob/master/install_nginx.sh)\n#### 1.1.1.2 uninstall\n```sh\nsudo service nginx stop\nsudo apt-get remove nginx\nsudo apt-get --purge remove nginx\nsudo apt-get autoremove\n# test\nsudo service nginx status\nwhich nginx\ndpkg --get-selections|grep nginx\n```\n### Building from Sources\n```sh\nwget https://nginx.org/download/nginx-1.16.0.tar.gz\ntar -zxvf nginx-1.16.0.tar.gz\n./configure --prefix=/etc/nginx\n```\n{% note danger %}\n./configure: error: the HTTP rewrite module requires the PCRE library.\nYou can either disable the module by using --without-http_rewrite_module\noption, or install the PCRE library into the system, or build the PCRE library\nstatically from the source with nginx by using --with-pcre=<path> option.\n{% endnote%}\n```sh\nwget wget https://ftp.pcre.org/pub/pcre/pcre2-10.33.tar.gz\ntar -zxvf pcre2-10.33.tar.gz\ncd nginx-1.16.0\n./configure --prefix=/etc/nginx --with-pcre=../pcre2-10.33\n```\n{% note danger %}\n./configure: error: the HTTP gzip module requires the zlib library.\nYou can either disable the module by using --without-http_gzip_module\noption, or install the zlib library into the system, or build the zlib library\nstatically from the source with nginx by using --with-zlib=<path> option.\n{% endnote%}\n```sh\nwget http://www.zlib.net/zlib-1.2.11.tar.gz\ntar -zxvf zlib-1.2.11.tar.gz\ncd nginx-1.16.0 && ./configure --prefix=/etc/nginx --with-pcre=../pcre2-10.33 --with-zlib=../zlib-1.2.11\n```\n{% note info %}\nConfiguration summary\n  + using PCRE library: ../pcre2-10.33\n  + OpenSSL library is not used\n  + using zlib library: ../zlib-1.2.11\n{% endnote%}\n```sh\nwget https://www.openssl.org/source/openssl-1.1.1b.tar.gz\ntar -zxvf openssl-1.1.1b.tar.gz\ncd nginx-1.16.0 &&  ./configure --prefix=/etc/nginx --with-pcre=../pcre2-10.33 --with-zlib=../zlib-1.2.11 --with-http_ssl_module --with-openssl=../openssl-1.1.1b # ok\n```\n{% note danger %}\nsrc/core/ngx_regex.h:15:18: fatal error: pcre.h: No such file or directory\ncompilation terminated.\nobjs/Makefile:383: recipe for target 'objs/src/core/nginx.o' failed\nmake[1]: *** [objs/src/core/nginx.o] Error 1\nmake[1]: Leaving directory '/root/nginx-1.16.0'\nMakefile:8: recipe for target 'build' failed\n{% endnote %}\nneed to install libpcre3-dev_8.x, so pcre 8.x series maybe works,but\n{% note info no-icon %}\nThe older, but still widely deployed PCRE library, originally released in 1997, is at version 8.43. Its API and feature set are stable—future releases will be for bugfixes only. Any new features will be added to PCRE2, and not to the PCRE 8.x series.\n{% endnote%}\nChange pcre version(8.43) and reinstall,OK\n```sh\nmake install\n# test\n/etc/sbin/nginx start\n```\nuninstall\n```sh\nsudo rm -rf /nginx-1.16.0\nsudo rm -rf /etc/nginx\n```\n## configure nginx\n### default\n```sh\n# etc/nginx/nginx.conf\nuser  nginx;\nworker_processes  1;\nerror_log  /var/log/nginx/error.log warn;\npid        /var/run/nginx.pid;\nevents {\n    worker_connections  1024;\n}\nhttp {\n    include       /etc/nginx/mime.types;\n    default_type  application/octet-stream;\n    log_format  main  '$remote_addr - $remote_user [$time_local] \"$request\" '\n                      '$status $body_bytes_sent \"$http_referer\" '\n                      '\"$http_user_agent\" \"$http_x_forwarded_for\"';\n    access_log  /var/log/nginx/access.log  main;\n    sendfile        on;\n    #tcp_nopush     on;\n    keepalive_timeout  65;\n    #gzip  on;\n    include /etc/nginx/conf.d/*.conf;\n}\n# etc/nginx/conf.d/default.conf\nserver {\n    listen       80;\n    server_name  localhost;\n\n    #charset koi8-r;\n    #access_log  /var/log/nginx/host.access.log  main;\n\n    location / {\n        root   /usr/share/nginx/html;\n        index  index.html index.htm;\n    }\n\n    #error_page  404              /404.html;\n\n    # redirect server error pages to the static page /50x.html\n    #\n    error_page   500 502 503 504  /50x.html;\n    location = /50x.html {\n        root   /usr/share/nginx/html;\n    }\n\n    # proxy the PHP scripts to Apache listening on 127.0.0.1:80\n    #\n    #location ~ \\.php$ {\n    #    proxy_pass   http://127.0.0.1;\n    #}\n\n    # pass the PHP scripts to FastCGI server listening on 127.0.0.1:9000\n    #\n    #location ~ \\.php$ {\n    #    root           html;\n    #    fastcgi_pass   127.0.0.1:9000;\n    #    fastcgi_index  index.php;\n    #    fastcgi_param  SCRIPT_FILENAME  /scripts$fastcgi_script_name;\n    #    include        fastcgi_params;\n    #}\n\n    # deny access to .htaccess files, if Apache's document root\n    # concurs with nginx's one\n    #\n    #location ~ /\\.ht {\n    #    deny  all;\n    #}\n}\n```\n### Setting Up a Simple Proxy Server,8080->80\n```sh\n# /etc/nginx/conf.d/test.conf\nserver {\n    listen 80;\n    location / {\n        proxy_pass http://localhost:8080/;\n    }\n    location ~ \\.(gif|jpg|png)$ {\n        root /data/images;\n    }\n}\nserver {\n    listen 8080;\n    root /data/up1;\n    location / {\n    }\n}\n```\nnew a html\n```sh\ncd /data/up1\nvim index.html\n```\n```\nsudo nginx -t\nsudo nginx -s reload \n```\naccess content correctly through intranet IP\n### Setting Up FastCGI Proxying\n```\ncat /etc/nginx/nginx.conf\nuser  nginx;\nworker_processes  1;\n\nerror_log  /var/log/nginx/error.log warn;\npid        /var/run/nginx.pid;\n\nhttp {\n    server {\n        location / {\n            fastcgi_pass  localhost:9000;\n            fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;\n            fastcgi_param QUERY_STRING    $query_string;\n        }\n        location ~ \\.(gif|jpg|png)$ {\n            root /data/images;\n        }\n    }\n}\n\nevents {\n    worker_connections  1024;\n}\n```\n\n# php\n## install php\n```sh\n# 1.Obtain and unpack the PHP source:\nwget http://cn.php.net/distributions/php-7.2.13.tar.gz\ntar zxf php*\n# 2.Configure and build PHP.\ncd php*\n./configure --enable-fpm --with-mysqli\n```\n``checking for cc... no\nchecking for gcc... no\nconfigure: error: in `/home/vagrant/php-7.2.13':\nconfigure: error: no acceptable C compiler found in $PATH``\n```sh\nwget https://mirrors.ustc.edu.cn/gnu/gcc/gcc-8.2.0/gcc-8.2.0.tar.gz \n# need to take more steps in the official way above and try again another day.\nsudo apt-get install gcc # Not necessarily up-to-date\n./configure --enable-fpm --with-mysqli\n```\n``configure: error: libxml2 not found. Please check your libxml2 installation.``\n```sh\nsudo apt-get install libxml2 # do not work\n# If you want to compile software from source based on libxml2 you need the development files:\nsudo apt-get install libxml2-dev # OK\nsudo apt-get install make\nmake -v\nmake\nsudo make test\n```\nFAILED TEST SUMMARY\nTimeout within function [tests/basic/timeout_variation_1.phpt]\nTimeout within shutdown function, variation [tests/basic/timeout_variation_10.phpt]\nTimeout within eval [tests/basic/timeout_variation_3.phpt]\nTimeout within call_user_func [tests/basic/timeout_variation_4.phpt]\nTimeout within function containing exception [tests/basic/timeout_variation_5.phpt]\nTimeout within shutdown function [tests/basic/timeout_variation_9.phpt]\nTimeout again inside register_shutdown_function [tests/lang/045.phpt]\n\n```sh\nsudo make install\nInstalling shared extensions:     /usr/local/lib/php/extensions/no-debug-non-zts-20170718/\nInstalling PHP CLI binary:        /usr/local/bin/\nInstalling PHP CLI man page:      /usr/local/php/man/man1/\nInstalling PHP FPM binary:        /usr/local/sbin/\nInstalling PHP FPM defconfig:     /usr/local/etc/\nInstalling PHP FPM man page:      /usr/local/php/man/man8/\nInstalling PHP FPM status page:   /usr/local/php/php/fpm/\nInstalling phpdbg binary:         /usr/local/bin/\nInstalling phpdbg man page:       /usr/local/php/man/man1/\nInstalling PHP CGI binary:        /usr/local/bin/\nInstalling PHP CGI man page:      /usr/local/php/man/man1/\nInstalling build environment:     /usr/local/lib/php/build/\nInstalling header files:          /usr/local/include/php/\nInstalling helper programs:       /usr/local/bin/\n  program: phpize\n  program: php-config\nInstalling man pages:             /usr/local/php/man/man1/\n  page: phpize.1\n  page: php-config.1\nInstalling PEAR environment:      /usr/local/lib/php/\nInstalling PDO headers:           /usr/local/include/php/ext/pdo/\n```\nYou may want to add: /usr/local/lib/php to your php.ini include_path\n## configure php\n```sh\n# 3.Obtain and move configuration files to their correct locations\nsudo cp php.ini-development /usr/local/php/php.ini\nsudo cp /usr/local/etc/php-fpm.conf.default /usr/local/etc/php-fpm.conf\nsudo cp sapi/fpm/php-fpm /usr/local/bin\n# 4.prevent arbitrarily script injection\nsudo vim /usr/local/php/php.ini\ncgi.fix_pathinfo=0 # line 769\n# 5.php-fpm.conf\nsudo vim /usr/local/etc/php-fpm.conf\n# append in the end\n; Unix user/group of processes\n; Note: The user is mandatory. If the group is not set, the default user's group\n;       will be used.\nuser = www-data\ngroup = www-data\n```\n```sh\n# start php-fpm\n/usr/local/bin/php-fpm\n```\n``ERROR: Unable to globalize '/usr/local/NONE/etc/php-fpm.d/*.conf' (ret=2) from /usr/local/etc/php-fpm.conf at line 125.``\nThe official error here should be changed to:\n```sh\ncd /usr/local/etc\nsudo vim php-fpm.conf\n# modify in the end\ninclude=/usr/local/etc/php-fpm.d/*.conf\n# sudo cp php-fpm.d/www.conf.default php-fpm.d/www.conf\nsudo vim php-fpm.d/www.conf\n# line 23\nuser = www-data\ngroup = www-data\n```\n```sh\nsudo /usr/local/bin/php-fpm # OK\n```\n## configure  nginx to support php\n```\n# 6.nginx.conf\nsudo vim /etc/nginx/nginx.conf\nhttp {\n    server {\n        listen 80;\n        server_name learn.lea;\n        location / {\n            root /data/www;\n            index index.php index.html index.htm;\n        }\n        location ~* \\.php$ {\n            fastcgi_index index.php;\n            fastcgi_pass  127.0.0.1:9000;\n            include       fastcgi_params;\n            fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;\n            fastcgi_param SCRIPT_NAME     $fastcgi_script_name;\n        }\n        location ~ \\.(gif|jpg|png)$ {\n            root /data/images;\n        }\n    }\n}\n\nevents {\n    worker_connections  1024;\n}\n```\n# test\n```sh\nsudo echo \"<?php phpinfo(); ?>\" >> /usr/local/nginx/html/index.php\n# navigate to http://learn.lea\n```\n``File not found``\n```sh\nsudo vim /etc/nginx/nginx.conf\n# add \"root /data/www\" directive to PHP location block\nsudo nginx -s reload # OK\n```\nrestart the machine:\n\n``nginx start automaticlly``\n``php-fpm need to start``\n\n# mysql\n>version: `8.0`\n\n```sh\nwget https://dev.mysql.com/get/mysql-apt-config_0.8.12-1_all.deb\nsudo dpkg -i mysql-apt-config_0.8.12-1_all.deb\nsudo apt-get update\nsudo apt-get install mysql-server\nsudo service mysql status\nmysql -u root -p\n```\n\n# Reference\n<small>\n[1] Martin Fjordvald.NGINX CONFIGURATION PRIMER.http://blog.martinfjordvald.com/2010/07/nginx-primer/ [EB/OL] 2010\n[2] debian.Nginx.https://wiki.debian.org/Nginx [EB/OL] 2016\n</small>","slug":"LNMP","published":1,"lang":"en","updated":"2019-05-14T01:53:15.042Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjvnq7zbk003a7jjxyojyiuds","content":"<link rel=\"stylesheet\" class=\"aplayer-secondary-style-marker\" href=\"/assets/css/APlayer.min.css\"><script src=\"/assets/js/APlayer.min.js\" class=\"aplayer-secondary-script-marker\"></script><script class=\"meting-secondary-script-marker\" src=\"/assets/js/Meting.min.js\"></script><link rel=\"stylesheet\" type=\"text/css\" href=\"https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css\"><h1 id=\"1-nginx\"><a href=\"#1-nginx\" class=\"headerlink\" title=\"1 nginx\"></a>1 nginx</h1><p>传统基于线程提交请求<br>可扩展的事件异步驱动<br>反向代理服务器（邮件代理、通用TCP/UDP代理服务器）<br><a id=\"more\"></a></p>\n<h2 id=\"1-1-intall-nginx\"><a href=\"#1-1-intall-nginx\" class=\"headerlink\" title=\"1.1 intall nginx\"></a>1.1 intall nginx</h2><h3 id=\"1-1-1-Prebuilt-Packages\"><a href=\"#1-1-1-Prebuilt-Packages\" class=\"headerlink\" title=\"1.1.1 Prebuilt Packages\"></a>1.1.1 Prebuilt Packages</h3><h4 id=\"1-1-1-1-try\"><a href=\"#1-1-1-1-try\" class=\"headerlink\" title=\"1.1.1.1 try\"></a>1.1.1.1 try</h4><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># can install directly</span></span><br><span class=\"line\">sudo apt-get install nginx</span><br><span class=\"line\"><span class=\"comment\"># install the latest version as follows</span></span><br><span class=\"line\">sudo vim /etc/apt/sources.list</span><br><span class=\"line\"><span class=\"comment\"># append to the end</span></span><br><span class=\"line\">deb http://nginx.org/packages/ubuntu/ xenial nginx</span><br><span class=\"line\">deb-src http://nginx.org/packages/ubuntu/ xenial nginx</span><br><span class=\"line\"><span class=\"comment\"># update sources</span></span><br><span class=\"line\">sudo apt-get update</span><br></pre></td></tr></table></figure>\n<p><code>W: GPG error: http://nginx.org/packages/ubuntu xenial InRelease: The following signatures couldn&#39;t be verified because the public key is not available: NO_PUBKEY ABF5BD827BD9BF62</code></p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># refer:https://www.nginx.com/resources/wiki/start/topics/tutorials/install/</span></span><br><span class=\"line\">sudo apt-key adv --keyserver keyserver.ubuntu.com --recv-keys <span class=\"variable\">$key</span></span><br><span class=\"line\">sudo apt-get update <span class=\"comment\"># Warning again</span></span><br></pre></td></tr></table></figure>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">wget http://nginx.org/keys/nginx_signing.key</span><br><span class=\"line\">sudo apt-key add nginx_signing.key</span><br><span class=\"line\">sudo apt-get update <span class=\"comment\"># OK</span></span><br><span class=\"line\"><span class=\"comment\"># install</span></span><br><span class=\"line\">sudo apt-get install nginx</span><br><span class=\"line\"><span class=\"comment\"># test</span></span><br><span class=\"line\">service nginx start</span><br><span class=\"line\">service nginx status</span><br></pre></td></tr></table></figure>\n<p>Available <a href=\"https://github.com/MakerGYT/ubuntu-sh/blob/master/install_nginx.sh\" target=\"_blank\" rel=\"noopener\">install_nginx.sh</a></p>\n<h4 id=\"1-1-1-2-uninstall\"><a href=\"#1-1-1-2-uninstall\" class=\"headerlink\" title=\"1.1.1.2 uninstall\"></a>1.1.1.2 uninstall</h4><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo service nginx stop</span><br><span class=\"line\">sudo apt-get remove nginx</span><br><span class=\"line\">sudo apt-get --purge remove nginx</span><br><span class=\"line\">sudo apt-get autoremove</span><br><span class=\"line\"><span class=\"comment\"># test</span></span><br><span class=\"line\">sudo service nginx status</span><br><span class=\"line\"><span class=\"built_in\">which</span> nginx</span><br><span class=\"line\">dpkg --get-selections|grep nginx</span><br></pre></td></tr></table></figure>\n<h3 id=\"Building-from-Sources\"><a href=\"#Building-from-Sources\" class=\"headerlink\" title=\"Building from Sources\"></a>Building from Sources</h3><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">wget https://nginx.org/download/nginx-1.16.0.tar.gz</span><br><span class=\"line\">tar -zxvf nginx-1.16.0.tar.gz</span><br><span class=\"line\">./configure --prefix=/etc/nginx</span><br></pre></td></tr></table></figure>\n<div class=\"note danger\">\n            <p>./configure: error: the HTTP rewrite module requires the PCRE library.<br>You can either disable the module by using –without-http_rewrite_module<br>option, or install the PCRE library into the system, or build the PCRE library<br>statically from the source with nginx by using –with-pcre=<path> option.</path></p>\n          </div>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">wget wget https://ftp.pcre.org/pub/pcre/pcre2-10.33.tar.gz</span><br><span class=\"line\">tar -zxvf pcre2-10.33.tar.gz</span><br><span class=\"line\"><span class=\"built_in\">cd</span> nginx-1.16.0</span><br><span class=\"line\">./configure --prefix=/etc/nginx --with-pcre=../pcre2-10.33</span><br></pre></td></tr></table></figure>\n<div class=\"note danger\">\n            <p>./configure: error: the HTTP gzip module requires the zlib library.<br>You can either disable the module by using –without-http_gzip_module<br>option, or install the zlib library into the system, or build the zlib library<br>statically from the source with nginx by using –with-zlib=<path> option.</path></p>\n          </div>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">wget http://www.zlib.net/zlib-1.2.11.tar.gz</span><br><span class=\"line\">tar -zxvf zlib-1.2.11.tar.gz</span><br><span class=\"line\"><span class=\"built_in\">cd</span> nginx-1.16.0 &amp;&amp; ./configure --prefix=/etc/nginx --with-pcre=../pcre2-10.33 --with-zlib=../zlib-1.2.11</span><br></pre></td></tr></table></figure>\n<div class=\"note info\">\n            <p>Configuration summary</p><ul><li>using PCRE library: ../pcre2-10.33</li><li>OpenSSL library is not used</li><li>using zlib library: ../zlib-1.2.11</li></ul>\n          </div>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">wget https://www.openssl.org/<span class=\"built_in\">source</span>/openssl-1.1.1b.tar.gz</span><br><span class=\"line\">tar -zxvf openssl-1.1.1b.tar.gz</span><br><span class=\"line\"><span class=\"built_in\">cd</span> nginx-1.16.0 &amp;&amp;  ./configure --prefix=/etc/nginx --with-pcre=../pcre2-10.33 --with-zlib=../zlib-1.2.11 --with-http_ssl_module --with-openssl=../openssl-1.1.1b <span class=\"comment\"># ok</span></span><br></pre></td></tr></table></figure>\n<div class=\"note danger\">\n            <p>src/core/ngx_regex.h:15:18: fatal error: pcre.h: No such file or directory<br>compilation terminated.<br>objs/Makefile:383: recipe for target ‘objs/src/core/nginx.o’ failed<br>make[1]: *** [objs/src/core/nginx.o] Error 1<br>make[1]: Leaving directory ‘/root/nginx-1.16.0’<br>Makefile:8: recipe for target ‘build’ failed</p>\n          </div>\n<p>need to install libpcre3-dev_8.x, so pcre 8.x series maybe works,but<br><div class=\"note info no-icon\">\n            <p>The older, but still widely deployed PCRE library, originally released in 1997, is at version 8.43. Its API and feature set are stable—future releases will be for bugfixes only. Any new features will be added to PCRE2, and not to the PCRE 8.x series.</p>\n          </div><br>Change pcre version(8.43) and reinstall,OK<br><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">make install</span><br><span class=\"line\"><span class=\"comment\"># test</span></span><br><span class=\"line\">/etc/sbin/nginx start</span><br></pre></td></tr></table></figure></p>\n<p>uninstall<br><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo rm -rf /nginx-1.16.0</span><br><span class=\"line\">sudo rm -rf /etc/nginx</span><br></pre></td></tr></table></figure></p>\n<h2 id=\"configure-nginx\"><a href=\"#configure-nginx\" class=\"headerlink\" title=\"configure nginx\"></a>configure nginx</h2><h3 id=\"default\"><a href=\"#default\" class=\"headerlink\" title=\"default\"></a>default</h3><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># etc/nginx/nginx.conf</span></span><br><span class=\"line\">user  nginx;</span><br><span class=\"line\">worker_processes  1;</span><br><span class=\"line\">error_log  /var/<span class=\"built_in\">log</span>/nginx/error.log warn;</span><br><span class=\"line\">pid        /var/run/nginx.pid;</span><br><span class=\"line\">events &#123;</span><br><span class=\"line\">    worker_connections  1024;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">http &#123;</span><br><span class=\"line\">    include       /etc/nginx/mime.types;</span><br><span class=\"line\">    default_type  application/octet-stream;</span><br><span class=\"line\">    log_format  main  <span class=\"string\">'$remote_addr - $remote_user [$time_local] \"$request\" '</span></span><br><span class=\"line\">                      <span class=\"string\">'$status $body_bytes_sent \"$http_referer\" '</span></span><br><span class=\"line\">                      <span class=\"string\">'\"$http_user_agent\" \"$http_x_forwarded_for\"'</span>;</span><br><span class=\"line\">    access_log  /var/<span class=\"built_in\">log</span>/nginx/access.log  main;</span><br><span class=\"line\">    sendfile        on;</span><br><span class=\"line\">    <span class=\"comment\">#tcp_nopush     on;</span></span><br><span class=\"line\">    keepalive_timeout  65;</span><br><span class=\"line\">    <span class=\"comment\">#gzip  on;</span></span><br><span class=\"line\">    include /etc/nginx/conf.d/*.conf;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\"># etc/nginx/conf.d/default.conf</span></span><br><span class=\"line\">server &#123;</span><br><span class=\"line\">    listen       80;</span><br><span class=\"line\">    server_name  localhost;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">#charset koi8-r;</span></span><br><span class=\"line\">    <span class=\"comment\">#access_log  /var/log/nginx/host.access.log  main;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    location / &#123;</span><br><span class=\"line\">        root   /usr/share/nginx/html;</span><br><span class=\"line\">        index  index.html index.htm;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">#error_page  404              /404.html;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># redirect server error pages to the static page /50x.html</span></span><br><span class=\"line\">    <span class=\"comment\">#</span></span><br><span class=\"line\">    error_page   500 502 503 504  /50x.html;</span><br><span class=\"line\">    location = /50x.html &#123;</span><br><span class=\"line\">        root   /usr/share/nginx/html;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># proxy the PHP scripts to Apache listening on 127.0.0.1:80</span></span><br><span class=\"line\">    <span class=\"comment\">#</span></span><br><span class=\"line\">    <span class=\"comment\">#location ~ \\.php$ &#123;</span></span><br><span class=\"line\">    <span class=\"comment\">#    proxy_pass   http://127.0.0.1;</span></span><br><span class=\"line\">    <span class=\"comment\">#&#125;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># pass the PHP scripts to FastCGI server listening on 127.0.0.1:9000</span></span><br><span class=\"line\">    <span class=\"comment\">#</span></span><br><span class=\"line\">    <span class=\"comment\">#location ~ \\.php$ &#123;</span></span><br><span class=\"line\">    <span class=\"comment\">#    root           html;</span></span><br><span class=\"line\">    <span class=\"comment\">#    fastcgi_pass   127.0.0.1:9000;</span></span><br><span class=\"line\">    <span class=\"comment\">#    fastcgi_index  index.php;</span></span><br><span class=\"line\">    <span class=\"comment\">#    fastcgi_param  SCRIPT_FILENAME  /scripts$fastcgi_script_name;</span></span><br><span class=\"line\">    <span class=\"comment\">#    include        fastcgi_params;</span></span><br><span class=\"line\">    <span class=\"comment\">#&#125;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># deny access to .htaccess files, if Apache's document root</span></span><br><span class=\"line\">    <span class=\"comment\"># concurs with nginx's one</span></span><br><span class=\"line\">    <span class=\"comment\">#</span></span><br><span class=\"line\">    <span class=\"comment\">#location ~ /\\.ht &#123;</span></span><br><span class=\"line\">    <span class=\"comment\">#    deny  all;</span></span><br><span class=\"line\">    <span class=\"comment\">#&#125;</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"Setting-Up-a-Simple-Proxy-Server-8080-gt-80\"><a href=\"#Setting-Up-a-Simple-Proxy-Server-8080-gt-80\" class=\"headerlink\" title=\"Setting Up a Simple Proxy Server,8080-&gt;80\"></a>Setting Up a Simple Proxy Server,8080-&gt;80</h3><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># /etc/nginx/conf.d/test.conf</span></span><br><span class=\"line\">server &#123;</span><br><span class=\"line\">    listen 80;</span><br><span class=\"line\">    location / &#123;</span><br><span class=\"line\">        proxy_pass http://localhost:8080/;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    location ~ \\.(gif|jpg|png)$ &#123;</span><br><span class=\"line\">        root /data/images;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">server &#123;</span><br><span class=\"line\">    listen 8080;</span><br><span class=\"line\">    root /data/up1;</span><br><span class=\"line\">    location / &#123;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>new a html<br><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">cd</span> /data/up1</span><br><span class=\"line\">vim index.html</span><br></pre></td></tr></table></figure></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo nginx -t</span><br><span class=\"line\">sudo nginx -s reload</span><br></pre></td></tr></table></figure>\n<p>access content correctly through intranet IP</p>\n<h3 id=\"Setting-Up-FastCGI-Proxying\"><a href=\"#Setting-Up-FastCGI-Proxying\" class=\"headerlink\" title=\"Setting Up FastCGI Proxying\"></a>Setting Up FastCGI Proxying</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cat /etc/nginx/nginx.conf</span><br><span class=\"line\">user  nginx;</span><br><span class=\"line\">worker_processes  1;</span><br><span class=\"line\"></span><br><span class=\"line\">error_log  /var/log/nginx/error.log warn;</span><br><span class=\"line\">pid        /var/run/nginx.pid;</span><br><span class=\"line\"></span><br><span class=\"line\">http &#123;</span><br><span class=\"line\">    server &#123;</span><br><span class=\"line\">        location / &#123;</span><br><span class=\"line\">            fastcgi_pass  localhost:9000;</span><br><span class=\"line\">            fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;</span><br><span class=\"line\">            fastcgi_param QUERY_STRING    $query_string;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        location ~ \\.(gif|jpg|png)$ &#123;</span><br><span class=\"line\">            root /data/images;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">events &#123;</span><br><span class=\"line\">    worker_connections  1024;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h1 id=\"php\"><a href=\"#php\" class=\"headerlink\" title=\"php\"></a>php</h1><h2 id=\"install-php\"><a href=\"#install-php\" class=\"headerlink\" title=\"install php\"></a>install php</h2><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 1.Obtain and unpack the PHP source:</span></span><br><span class=\"line\">wget http://cn.php.net/distributions/php-7.2.13.tar.gz</span><br><span class=\"line\">tar zxf php*</span><br><span class=\"line\"><span class=\"comment\"># 2.Configure and build PHP.</span></span><br><span class=\"line\"><span class=\"built_in\">cd</span> php*</span><br><span class=\"line\">./configure --<span class=\"built_in\">enable</span>-fpm --with-mysqli</span><br></pre></td></tr></table></figure>\n<p><code>checking for cc... no\nchecking for gcc... no\nconfigure: error: in `/home/vagrant/php-7.2.13&#39;:\nconfigure: error: no acceptable C compiler found in $PATH</code><br><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">wget https://mirrors.ustc.edu.cn/gnu/gcc/gcc-8.2.0/gcc-8.2.0.tar.gz </span><br><span class=\"line\"><span class=\"comment\"># need to take more steps in the official way above and try again another day.</span></span><br><span class=\"line\">sudo apt-get install gcc <span class=\"comment\"># Not necessarily up-to-date</span></span><br><span class=\"line\">./configure --<span class=\"built_in\">enable</span>-fpm --with-mysqli</span><br></pre></td></tr></table></figure></p>\n<p><code>configure: error: libxml2 not found. Please check your libxml2 installation.</code><br><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo apt-get install libxml2 <span class=\"comment\"># do not work</span></span><br><span class=\"line\"><span class=\"comment\"># If you want to compile software from source based on libxml2 you need the development files:</span></span><br><span class=\"line\">sudo apt-get install libxml2-dev <span class=\"comment\"># OK</span></span><br><span class=\"line\">sudo apt-get install make</span><br><span class=\"line\">make -v</span><br><span class=\"line\">make</span><br><span class=\"line\">sudo make <span class=\"built_in\">test</span></span><br></pre></td></tr></table></figure></p>\n<p>FAILED TEST SUMMARY<br>Timeout within function [tests/basic/timeout_variation_1.phpt]<br>Timeout within shutdown function, variation [tests/basic/timeout_variation_10.phpt]<br>Timeout within eval [tests/basic/timeout_variation_3.phpt]<br>Timeout within call_user_func [tests/basic/timeout_variation_4.phpt]<br>Timeout within function containing exception [tests/basic/timeout_variation_5.phpt]<br>Timeout within shutdown function [tests/basic/timeout_variation_9.phpt]<br>Timeout again inside register_shutdown_function [tests/lang/045.phpt]</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo make install</span><br><span class=\"line\">Installing shared extensions:     /usr/<span class=\"built_in\">local</span>/lib/php/extensions/no-debug-non-zts-20170718/</span><br><span class=\"line\">Installing PHP CLI binary:        /usr/<span class=\"built_in\">local</span>/bin/</span><br><span class=\"line\">Installing PHP CLI man page:      /usr/<span class=\"built_in\">local</span>/php/man/man1/</span><br><span class=\"line\">Installing PHP FPM binary:        /usr/<span class=\"built_in\">local</span>/sbin/</span><br><span class=\"line\">Installing PHP FPM defconfig:     /usr/<span class=\"built_in\">local</span>/etc/</span><br><span class=\"line\">Installing PHP FPM man page:      /usr/<span class=\"built_in\">local</span>/php/man/man8/</span><br><span class=\"line\">Installing PHP FPM status page:   /usr/<span class=\"built_in\">local</span>/php/php/fpm/</span><br><span class=\"line\">Installing phpdbg binary:         /usr/<span class=\"built_in\">local</span>/bin/</span><br><span class=\"line\">Installing phpdbg man page:       /usr/<span class=\"built_in\">local</span>/php/man/man1/</span><br><span class=\"line\">Installing PHP CGI binary:        /usr/<span class=\"built_in\">local</span>/bin/</span><br><span class=\"line\">Installing PHP CGI man page:      /usr/<span class=\"built_in\">local</span>/php/man/man1/</span><br><span class=\"line\">Installing build environment:     /usr/<span class=\"built_in\">local</span>/lib/php/build/</span><br><span class=\"line\">Installing header files:          /usr/<span class=\"built_in\">local</span>/include/php/</span><br><span class=\"line\">Installing helper programs:       /usr/<span class=\"built_in\">local</span>/bin/</span><br><span class=\"line\">  program: phpize</span><br><span class=\"line\">  program: php-config</span><br><span class=\"line\">Installing man pages:             /usr/<span class=\"built_in\">local</span>/php/man/man1/</span><br><span class=\"line\">  page: phpize.1</span><br><span class=\"line\">  page: php-config.1</span><br><span class=\"line\">Installing PEAR environment:      /usr/<span class=\"built_in\">local</span>/lib/php/</span><br><span class=\"line\">Installing PDO headers:           /usr/<span class=\"built_in\">local</span>/include/php/ext/pdo/</span><br></pre></td></tr></table></figure>\n<p>You may want to add: /usr/local/lib/php to your php.ini include_path</p>\n<h2 id=\"configure-php\"><a href=\"#configure-php\" class=\"headerlink\" title=\"configure php\"></a>configure php</h2><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 3.Obtain and move configuration files to their correct locations</span></span><br><span class=\"line\">sudo cp php.ini-development /usr/<span class=\"built_in\">local</span>/php/php.ini</span><br><span class=\"line\">sudo cp /usr/<span class=\"built_in\">local</span>/etc/php-fpm.conf.default /usr/<span class=\"built_in\">local</span>/etc/php-fpm.conf</span><br><span class=\"line\">sudo cp sapi/fpm/php-fpm /usr/<span class=\"built_in\">local</span>/bin</span><br><span class=\"line\"><span class=\"comment\"># 4.prevent arbitrarily script injection</span></span><br><span class=\"line\">sudo vim /usr/<span class=\"built_in\">local</span>/php/php.ini</span><br><span class=\"line\">cgi.fix_pathinfo=0 <span class=\"comment\"># line 769</span></span><br><span class=\"line\"><span class=\"comment\"># 5.php-fpm.conf</span></span><br><span class=\"line\">sudo vim /usr/<span class=\"built_in\">local</span>/etc/php-fpm.conf</span><br><span class=\"line\"><span class=\"comment\"># append in the end</span></span><br><span class=\"line\">; Unix user/group of processes</span><br><span class=\"line\">; Note: The user is mandatory. If the group is not <span class=\"built_in\">set</span>, the default user<span class=\"string\">'s group</span></span><br><span class=\"line\"><span class=\"string\">;       will be used.</span></span><br><span class=\"line\"><span class=\"string\">user = www-data</span></span><br><span class=\"line\"><span class=\"string\">group = www-data</span></span><br></pre></td></tr></table></figure>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># start php-fpm</span></span><br><span class=\"line\">/usr/<span class=\"built_in\">local</span>/bin/php-fpm</span><br></pre></td></tr></table></figure>\n<p><code>ERROR: Unable to globalize &#39;/usr/local/NONE/etc/php-fpm.d/*.conf&#39; (ret=2) from /usr/local/etc/php-fpm.conf at line 125.</code><br>The official error here should be changed to:<br><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">cd</span> /usr/<span class=\"built_in\">local</span>/etc</span><br><span class=\"line\">sudo vim php-fpm.conf</span><br><span class=\"line\"><span class=\"comment\"># modify in the end</span></span><br><span class=\"line\">include=/usr/<span class=\"built_in\">local</span>/etc/php-fpm.d/*.conf</span><br><span class=\"line\"><span class=\"comment\"># sudo cp php-fpm.d/www.conf.default php-fpm.d/www.conf</span></span><br><span class=\"line\">sudo vim php-fpm.d/www.conf</span><br><span class=\"line\"><span class=\"comment\"># line 23</span></span><br><span class=\"line\">user = www-data</span><br><span class=\"line\">group = www-data</span><br></pre></td></tr></table></figure></p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo /usr/<span class=\"built_in\">local</span>/bin/php-fpm <span class=\"comment\"># OK</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"configure-nginx-to-support-php\"><a href=\"#configure-nginx-to-support-php\" class=\"headerlink\" title=\"configure  nginx to support php\"></a>configure  nginx to support php</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># 6.nginx.conf</span><br><span class=\"line\">sudo vim /etc/nginx/nginx.conf</span><br><span class=\"line\">http &#123;</span><br><span class=\"line\">    server &#123;</span><br><span class=\"line\">        listen 80;</span><br><span class=\"line\">        server_name learn.lea;</span><br><span class=\"line\">        location / &#123;</span><br><span class=\"line\">            root /data/www;</span><br><span class=\"line\">            index index.php index.html index.htm;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        location ~* \\.php$ &#123;</span><br><span class=\"line\">            fastcgi_index index.php;</span><br><span class=\"line\">            fastcgi_pass  127.0.0.1:9000;</span><br><span class=\"line\">            include       fastcgi_params;</span><br><span class=\"line\">            fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;</span><br><span class=\"line\">            fastcgi_param SCRIPT_NAME     $fastcgi_script_name;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        location ~ \\.(gif|jpg|png)$ &#123;</span><br><span class=\"line\">            root /data/images;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">events &#123;</span><br><span class=\"line\">    worker_connections  1024;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h1 id=\"test\"><a href=\"#test\" class=\"headerlink\" title=\"test\"></a>test</h1><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo <span class=\"built_in\">echo</span> <span class=\"string\">\"&lt;?php phpinfo(); ?&gt;\"</span> &gt;&gt; /usr/<span class=\"built_in\">local</span>/nginx/html/index.php</span><br><span class=\"line\"><span class=\"comment\"># navigate to http://learn.lea</span></span><br></pre></td></tr></table></figure>\n<p><code>File not found</code><br><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo vim /etc/nginx/nginx.conf</span><br><span class=\"line\"><span class=\"comment\"># add \"root /data/www\" directive to PHP location block</span></span><br><span class=\"line\">sudo nginx -s reload <span class=\"comment\"># OK</span></span><br></pre></td></tr></table></figure></p>\n<p>restart the machine:</p>\n<p><code>nginx start automaticlly</code><br><code>php-fpm need to start</code></p>\n<h1 id=\"mysql\"><a href=\"#mysql\" class=\"headerlink\" title=\"mysql\"></a>mysql</h1><blockquote>\n<p>version: <code>8.0</code></p>\n</blockquote>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">wget https://dev.mysql.com/get/mysql-apt-config_0.8.12-1_all.deb</span><br><span class=\"line\">sudo dpkg -i mysql-apt-config_0.8.12-1_all.deb</span><br><span class=\"line\">sudo apt-get update</span><br><span class=\"line\">sudo apt-get install mysql-server</span><br><span class=\"line\">sudo service mysql status</span><br><span class=\"line\">mysql -u root -p</span><br></pre></td></tr></table></figure>\n<h1 id=\"Reference\"><a href=\"#Reference\" class=\"headerlink\" title=\"Reference\"></a>Reference</h1><p><small><br>[1] Martin Fjordvald.NGINX CONFIGURATION PRIMER.<a href=\"http://blog.martinfjordvald.com/2010/07/nginx-primer/\" target=\"_blank\" rel=\"noopener\">http://blog.martinfjordvald.com/2010/07/nginx-primer/</a> [EB/OL] 2010<br>[2] debian.Nginx.<a href=\"https://wiki.debian.org/Nginx\" target=\"_blank\" rel=\"noopener\">https://wiki.debian.org/Nginx</a> [EB/OL] 2016<br></small></p>\n","site":{"data":{}},"excerpt":"<h1 id=\"1-nginx\"><a href=\"#1-nginx\" class=\"headerlink\" title=\"1 nginx\"></a>1 nginx</h1><p>传统基于线程提交请求<br>可扩展的事件异步驱动<br>反向代理服务器（邮件代理、通用TCP/UDP代理服务器）<br>","more":"</p>\n<h2 id=\"1-1-intall-nginx\"><a href=\"#1-1-intall-nginx\" class=\"headerlink\" title=\"1.1 intall nginx\"></a>1.1 intall nginx</h2><h3 id=\"1-1-1-Prebuilt-Packages\"><a href=\"#1-1-1-Prebuilt-Packages\" class=\"headerlink\" title=\"1.1.1 Prebuilt Packages\"></a>1.1.1 Prebuilt Packages</h3><h4 id=\"1-1-1-1-try\"><a href=\"#1-1-1-1-try\" class=\"headerlink\" title=\"1.1.1.1 try\"></a>1.1.1.1 try</h4><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># can install directly</span></span><br><span class=\"line\">sudo apt-get install nginx</span><br><span class=\"line\"><span class=\"comment\"># install the latest version as follows</span></span><br><span class=\"line\">sudo vim /etc/apt/sources.list</span><br><span class=\"line\"><span class=\"comment\"># append to the end</span></span><br><span class=\"line\">deb http://nginx.org/packages/ubuntu/ xenial nginx</span><br><span class=\"line\">deb-src http://nginx.org/packages/ubuntu/ xenial nginx</span><br><span class=\"line\"><span class=\"comment\"># update sources</span></span><br><span class=\"line\">sudo apt-get update</span><br></pre></td></tr></table></figure>\n<p><code>W: GPG error: http://nginx.org/packages/ubuntu xenial InRelease: The following signatures couldn&#39;t be verified because the public key is not available: NO_PUBKEY ABF5BD827BD9BF62</code></p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># refer:https://www.nginx.com/resources/wiki/start/topics/tutorials/install/</span></span><br><span class=\"line\">sudo apt-key adv --keyserver keyserver.ubuntu.com --recv-keys <span class=\"variable\">$key</span></span><br><span class=\"line\">sudo apt-get update <span class=\"comment\"># Warning again</span></span><br></pre></td></tr></table></figure>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">wget http://nginx.org/keys/nginx_signing.key</span><br><span class=\"line\">sudo apt-key add nginx_signing.key</span><br><span class=\"line\">sudo apt-get update <span class=\"comment\"># OK</span></span><br><span class=\"line\"><span class=\"comment\"># install</span></span><br><span class=\"line\">sudo apt-get install nginx</span><br><span class=\"line\"><span class=\"comment\"># test</span></span><br><span class=\"line\">service nginx start</span><br><span class=\"line\">service nginx status</span><br></pre></td></tr></table></figure>\n<p>Available <a href=\"https://github.com/MakerGYT/ubuntu-sh/blob/master/install_nginx.sh\" target=\"_blank\" rel=\"noopener\">install_nginx.sh</a></p>\n<h4 id=\"1-1-1-2-uninstall\"><a href=\"#1-1-1-2-uninstall\" class=\"headerlink\" title=\"1.1.1.2 uninstall\"></a>1.1.1.2 uninstall</h4><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo service nginx stop</span><br><span class=\"line\">sudo apt-get remove nginx</span><br><span class=\"line\">sudo apt-get --purge remove nginx</span><br><span class=\"line\">sudo apt-get autoremove</span><br><span class=\"line\"><span class=\"comment\"># test</span></span><br><span class=\"line\">sudo service nginx status</span><br><span class=\"line\"><span class=\"built_in\">which</span> nginx</span><br><span class=\"line\">dpkg --get-selections|grep nginx</span><br></pre></td></tr></table></figure>\n<h3 id=\"Building-from-Sources\"><a href=\"#Building-from-Sources\" class=\"headerlink\" title=\"Building from Sources\"></a>Building from Sources</h3><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">wget https://nginx.org/download/nginx-1.16.0.tar.gz</span><br><span class=\"line\">tar -zxvf nginx-1.16.0.tar.gz</span><br><span class=\"line\">./configure --prefix=/etc/nginx</span><br></pre></td></tr></table></figure>\n<div class=\"note danger\">\n            <p>./configure: error: the HTTP rewrite module requires the PCRE library.<br>You can either disable the module by using –without-http_rewrite_module<br>option, or install the PCRE library into the system, or build the PCRE library<br>statically from the source with nginx by using –with-pcre=<path> option.</path></p>\n          </div>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">wget wget https://ftp.pcre.org/pub/pcre/pcre2-10.33.tar.gz</span><br><span class=\"line\">tar -zxvf pcre2-10.33.tar.gz</span><br><span class=\"line\"><span class=\"built_in\">cd</span> nginx-1.16.0</span><br><span class=\"line\">./configure --prefix=/etc/nginx --with-pcre=../pcre2-10.33</span><br></pre></td></tr></table></figure>\n<div class=\"note danger\">\n            <p>./configure: error: the HTTP gzip module requires the zlib library.<br>You can either disable the module by using –without-http_gzip_module<br>option, or install the zlib library into the system, or build the zlib library<br>statically from the source with nginx by using –with-zlib=<path> option.</path></p>\n          </div>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">wget http://www.zlib.net/zlib-1.2.11.tar.gz</span><br><span class=\"line\">tar -zxvf zlib-1.2.11.tar.gz</span><br><span class=\"line\"><span class=\"built_in\">cd</span> nginx-1.16.0 &amp;&amp; ./configure --prefix=/etc/nginx --with-pcre=../pcre2-10.33 --with-zlib=../zlib-1.2.11</span><br></pre></td></tr></table></figure>\n<div class=\"note info\">\n            <p>Configuration summary</p><ul><li>using PCRE library: ../pcre2-10.33</li><li>OpenSSL library is not used</li><li>using zlib library: ../zlib-1.2.11</li></ul>\n          </div>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">wget https://www.openssl.org/<span class=\"built_in\">source</span>/openssl-1.1.1b.tar.gz</span><br><span class=\"line\">tar -zxvf openssl-1.1.1b.tar.gz</span><br><span class=\"line\"><span class=\"built_in\">cd</span> nginx-1.16.0 &amp;&amp;  ./configure --prefix=/etc/nginx --with-pcre=../pcre2-10.33 --with-zlib=../zlib-1.2.11 --with-http_ssl_module --with-openssl=../openssl-1.1.1b <span class=\"comment\"># ok</span></span><br></pre></td></tr></table></figure>\n<div class=\"note danger\">\n            <p>src/core/ngx_regex.h:15:18: fatal error: pcre.h: No such file or directory<br>compilation terminated.<br>objs/Makefile:383: recipe for target ‘objs/src/core/nginx.o’ failed<br>make[1]: *** [objs/src/core/nginx.o] Error 1<br>make[1]: Leaving directory ‘/root/nginx-1.16.0’<br>Makefile:8: recipe for target ‘build’ failed</p>\n          </div>\n<p>need to install libpcre3-dev_8.x, so pcre 8.x series maybe works,but<br><div class=\"note info no-icon\">\n            <p>The older, but still widely deployed PCRE library, originally released in 1997, is at version 8.43. Its API and feature set are stable—future releases will be for bugfixes only. Any new features will be added to PCRE2, and not to the PCRE 8.x series.</p>\n          </div><br>Change pcre version(8.43) and reinstall,OK<br><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">make install</span><br><span class=\"line\"><span class=\"comment\"># test</span></span><br><span class=\"line\">/etc/sbin/nginx start</span><br></pre></td></tr></table></figure></p>\n<p>uninstall<br><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo rm -rf /nginx-1.16.0</span><br><span class=\"line\">sudo rm -rf /etc/nginx</span><br></pre></td></tr></table></figure></p>\n<h2 id=\"configure-nginx\"><a href=\"#configure-nginx\" class=\"headerlink\" title=\"configure nginx\"></a>configure nginx</h2><h3 id=\"default\"><a href=\"#default\" class=\"headerlink\" title=\"default\"></a>default</h3><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># etc/nginx/nginx.conf</span></span><br><span class=\"line\">user  nginx;</span><br><span class=\"line\">worker_processes  1;</span><br><span class=\"line\">error_log  /var/<span class=\"built_in\">log</span>/nginx/error.log warn;</span><br><span class=\"line\">pid        /var/run/nginx.pid;</span><br><span class=\"line\">events &#123;</span><br><span class=\"line\">    worker_connections  1024;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">http &#123;</span><br><span class=\"line\">    include       /etc/nginx/mime.types;</span><br><span class=\"line\">    default_type  application/octet-stream;</span><br><span class=\"line\">    log_format  main  <span class=\"string\">'$remote_addr - $remote_user [$time_local] \"$request\" '</span></span><br><span class=\"line\">                      <span class=\"string\">'$status $body_bytes_sent \"$http_referer\" '</span></span><br><span class=\"line\">                      <span class=\"string\">'\"$http_user_agent\" \"$http_x_forwarded_for\"'</span>;</span><br><span class=\"line\">    access_log  /var/<span class=\"built_in\">log</span>/nginx/access.log  main;</span><br><span class=\"line\">    sendfile        on;</span><br><span class=\"line\">    <span class=\"comment\">#tcp_nopush     on;</span></span><br><span class=\"line\">    keepalive_timeout  65;</span><br><span class=\"line\">    <span class=\"comment\">#gzip  on;</span></span><br><span class=\"line\">    include /etc/nginx/conf.d/*.conf;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\"># etc/nginx/conf.d/default.conf</span></span><br><span class=\"line\">server &#123;</span><br><span class=\"line\">    listen       80;</span><br><span class=\"line\">    server_name  localhost;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">#charset koi8-r;</span></span><br><span class=\"line\">    <span class=\"comment\">#access_log  /var/log/nginx/host.access.log  main;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    location / &#123;</span><br><span class=\"line\">        root   /usr/share/nginx/html;</span><br><span class=\"line\">        index  index.html index.htm;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">#error_page  404              /404.html;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># redirect server error pages to the static page /50x.html</span></span><br><span class=\"line\">    <span class=\"comment\">#</span></span><br><span class=\"line\">    error_page   500 502 503 504  /50x.html;</span><br><span class=\"line\">    location = /50x.html &#123;</span><br><span class=\"line\">        root   /usr/share/nginx/html;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># proxy the PHP scripts to Apache listening on 127.0.0.1:80</span></span><br><span class=\"line\">    <span class=\"comment\">#</span></span><br><span class=\"line\">    <span class=\"comment\">#location ~ \\.php$ &#123;</span></span><br><span class=\"line\">    <span class=\"comment\">#    proxy_pass   http://127.0.0.1;</span></span><br><span class=\"line\">    <span class=\"comment\">#&#125;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># pass the PHP scripts to FastCGI server listening on 127.0.0.1:9000</span></span><br><span class=\"line\">    <span class=\"comment\">#</span></span><br><span class=\"line\">    <span class=\"comment\">#location ~ \\.php$ &#123;</span></span><br><span class=\"line\">    <span class=\"comment\">#    root           html;</span></span><br><span class=\"line\">    <span class=\"comment\">#    fastcgi_pass   127.0.0.1:9000;</span></span><br><span class=\"line\">    <span class=\"comment\">#    fastcgi_index  index.php;</span></span><br><span class=\"line\">    <span class=\"comment\">#    fastcgi_param  SCRIPT_FILENAME  /scripts$fastcgi_script_name;</span></span><br><span class=\"line\">    <span class=\"comment\">#    include        fastcgi_params;</span></span><br><span class=\"line\">    <span class=\"comment\">#&#125;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># deny access to .htaccess files, if Apache's document root</span></span><br><span class=\"line\">    <span class=\"comment\"># concurs with nginx's one</span></span><br><span class=\"line\">    <span class=\"comment\">#</span></span><br><span class=\"line\">    <span class=\"comment\">#location ~ /\\.ht &#123;</span></span><br><span class=\"line\">    <span class=\"comment\">#    deny  all;</span></span><br><span class=\"line\">    <span class=\"comment\">#&#125;</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"Setting-Up-a-Simple-Proxy-Server-8080-gt-80\"><a href=\"#Setting-Up-a-Simple-Proxy-Server-8080-gt-80\" class=\"headerlink\" title=\"Setting Up a Simple Proxy Server,8080-&gt;80\"></a>Setting Up a Simple Proxy Server,8080-&gt;80</h3><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># /etc/nginx/conf.d/test.conf</span></span><br><span class=\"line\">server &#123;</span><br><span class=\"line\">    listen 80;</span><br><span class=\"line\">    location / &#123;</span><br><span class=\"line\">        proxy_pass http://localhost:8080/;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    location ~ \\.(gif|jpg|png)$ &#123;</span><br><span class=\"line\">        root /data/images;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">server &#123;</span><br><span class=\"line\">    listen 8080;</span><br><span class=\"line\">    root /data/up1;</span><br><span class=\"line\">    location / &#123;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>new a html<br><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">cd</span> /data/up1</span><br><span class=\"line\">vim index.html</span><br></pre></td></tr></table></figure></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo nginx -t</span><br><span class=\"line\">sudo nginx -s reload</span><br></pre></td></tr></table></figure>\n<p>access content correctly through intranet IP</p>\n<h3 id=\"Setting-Up-FastCGI-Proxying\"><a href=\"#Setting-Up-FastCGI-Proxying\" class=\"headerlink\" title=\"Setting Up FastCGI Proxying\"></a>Setting Up FastCGI Proxying</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cat /etc/nginx/nginx.conf</span><br><span class=\"line\">user  nginx;</span><br><span class=\"line\">worker_processes  1;</span><br><span class=\"line\"></span><br><span class=\"line\">error_log  /var/log/nginx/error.log warn;</span><br><span class=\"line\">pid        /var/run/nginx.pid;</span><br><span class=\"line\"></span><br><span class=\"line\">http &#123;</span><br><span class=\"line\">    server &#123;</span><br><span class=\"line\">        location / &#123;</span><br><span class=\"line\">            fastcgi_pass  localhost:9000;</span><br><span class=\"line\">            fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;</span><br><span class=\"line\">            fastcgi_param QUERY_STRING    $query_string;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        location ~ \\.(gif|jpg|png)$ &#123;</span><br><span class=\"line\">            root /data/images;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">events &#123;</span><br><span class=\"line\">    worker_connections  1024;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h1 id=\"php\"><a href=\"#php\" class=\"headerlink\" title=\"php\"></a>php</h1><h2 id=\"install-php\"><a href=\"#install-php\" class=\"headerlink\" title=\"install php\"></a>install php</h2><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 1.Obtain and unpack the PHP source:</span></span><br><span class=\"line\">wget http://cn.php.net/distributions/php-7.2.13.tar.gz</span><br><span class=\"line\">tar zxf php*</span><br><span class=\"line\"><span class=\"comment\"># 2.Configure and build PHP.</span></span><br><span class=\"line\"><span class=\"built_in\">cd</span> php*</span><br><span class=\"line\">./configure --<span class=\"built_in\">enable</span>-fpm --with-mysqli</span><br></pre></td></tr></table></figure>\n<p><code>checking for cc... no\nchecking for gcc... no\nconfigure: error: in `/home/vagrant/php-7.2.13&#39;:\nconfigure: error: no acceptable C compiler found in $PATH</code><br><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">wget https://mirrors.ustc.edu.cn/gnu/gcc/gcc-8.2.0/gcc-8.2.0.tar.gz </span><br><span class=\"line\"><span class=\"comment\"># need to take more steps in the official way above and try again another day.</span></span><br><span class=\"line\">sudo apt-get install gcc <span class=\"comment\"># Not necessarily up-to-date</span></span><br><span class=\"line\">./configure --<span class=\"built_in\">enable</span>-fpm --with-mysqli</span><br></pre></td></tr></table></figure></p>\n<p><code>configure: error: libxml2 not found. Please check your libxml2 installation.</code><br><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo apt-get install libxml2 <span class=\"comment\"># do not work</span></span><br><span class=\"line\"><span class=\"comment\"># If you want to compile software from source based on libxml2 you need the development files:</span></span><br><span class=\"line\">sudo apt-get install libxml2-dev <span class=\"comment\"># OK</span></span><br><span class=\"line\">sudo apt-get install make</span><br><span class=\"line\">make -v</span><br><span class=\"line\">make</span><br><span class=\"line\">sudo make <span class=\"built_in\">test</span></span><br></pre></td></tr></table></figure></p>\n<p>FAILED TEST SUMMARY<br>Timeout within function [tests/basic/timeout_variation_1.phpt]<br>Timeout within shutdown function, variation [tests/basic/timeout_variation_10.phpt]<br>Timeout within eval [tests/basic/timeout_variation_3.phpt]<br>Timeout within call_user_func [tests/basic/timeout_variation_4.phpt]<br>Timeout within function containing exception [tests/basic/timeout_variation_5.phpt]<br>Timeout within shutdown function [tests/basic/timeout_variation_9.phpt]<br>Timeout again inside register_shutdown_function [tests/lang/045.phpt]</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo make install</span><br><span class=\"line\">Installing shared extensions:     /usr/<span class=\"built_in\">local</span>/lib/php/extensions/no-debug-non-zts-20170718/</span><br><span class=\"line\">Installing PHP CLI binary:        /usr/<span class=\"built_in\">local</span>/bin/</span><br><span class=\"line\">Installing PHP CLI man page:      /usr/<span class=\"built_in\">local</span>/php/man/man1/</span><br><span class=\"line\">Installing PHP FPM binary:        /usr/<span class=\"built_in\">local</span>/sbin/</span><br><span class=\"line\">Installing PHP FPM defconfig:     /usr/<span class=\"built_in\">local</span>/etc/</span><br><span class=\"line\">Installing PHP FPM man page:      /usr/<span class=\"built_in\">local</span>/php/man/man8/</span><br><span class=\"line\">Installing PHP FPM status page:   /usr/<span class=\"built_in\">local</span>/php/php/fpm/</span><br><span class=\"line\">Installing phpdbg binary:         /usr/<span class=\"built_in\">local</span>/bin/</span><br><span class=\"line\">Installing phpdbg man page:       /usr/<span class=\"built_in\">local</span>/php/man/man1/</span><br><span class=\"line\">Installing PHP CGI binary:        /usr/<span class=\"built_in\">local</span>/bin/</span><br><span class=\"line\">Installing PHP CGI man page:      /usr/<span class=\"built_in\">local</span>/php/man/man1/</span><br><span class=\"line\">Installing build environment:     /usr/<span class=\"built_in\">local</span>/lib/php/build/</span><br><span class=\"line\">Installing header files:          /usr/<span class=\"built_in\">local</span>/include/php/</span><br><span class=\"line\">Installing helper programs:       /usr/<span class=\"built_in\">local</span>/bin/</span><br><span class=\"line\">  program: phpize</span><br><span class=\"line\">  program: php-config</span><br><span class=\"line\">Installing man pages:             /usr/<span class=\"built_in\">local</span>/php/man/man1/</span><br><span class=\"line\">  page: phpize.1</span><br><span class=\"line\">  page: php-config.1</span><br><span class=\"line\">Installing PEAR environment:      /usr/<span class=\"built_in\">local</span>/lib/php/</span><br><span class=\"line\">Installing PDO headers:           /usr/<span class=\"built_in\">local</span>/include/php/ext/pdo/</span><br></pre></td></tr></table></figure>\n<p>You may want to add: /usr/local/lib/php to your php.ini include_path</p>\n<h2 id=\"configure-php\"><a href=\"#configure-php\" class=\"headerlink\" title=\"configure php\"></a>configure php</h2><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 3.Obtain and move configuration files to their correct locations</span></span><br><span class=\"line\">sudo cp php.ini-development /usr/<span class=\"built_in\">local</span>/php/php.ini</span><br><span class=\"line\">sudo cp /usr/<span class=\"built_in\">local</span>/etc/php-fpm.conf.default /usr/<span class=\"built_in\">local</span>/etc/php-fpm.conf</span><br><span class=\"line\">sudo cp sapi/fpm/php-fpm /usr/<span class=\"built_in\">local</span>/bin</span><br><span class=\"line\"><span class=\"comment\"># 4.prevent arbitrarily script injection</span></span><br><span class=\"line\">sudo vim /usr/<span class=\"built_in\">local</span>/php/php.ini</span><br><span class=\"line\">cgi.fix_pathinfo=0 <span class=\"comment\"># line 769</span></span><br><span class=\"line\"><span class=\"comment\"># 5.php-fpm.conf</span></span><br><span class=\"line\">sudo vim /usr/<span class=\"built_in\">local</span>/etc/php-fpm.conf</span><br><span class=\"line\"><span class=\"comment\"># append in the end</span></span><br><span class=\"line\">; Unix user/group of processes</span><br><span class=\"line\">; Note: The user is mandatory. If the group is not <span class=\"built_in\">set</span>, the default user<span class=\"string\">'s group</span></span><br><span class=\"line\"><span class=\"string\">;       will be used.</span></span><br><span class=\"line\"><span class=\"string\">user = www-data</span></span><br><span class=\"line\"><span class=\"string\">group = www-data</span></span><br></pre></td></tr></table></figure>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># start php-fpm</span></span><br><span class=\"line\">/usr/<span class=\"built_in\">local</span>/bin/php-fpm</span><br></pre></td></tr></table></figure>\n<p><code>ERROR: Unable to globalize &#39;/usr/local/NONE/etc/php-fpm.d/*.conf&#39; (ret=2) from /usr/local/etc/php-fpm.conf at line 125.</code><br>The official error here should be changed to:<br><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">cd</span> /usr/<span class=\"built_in\">local</span>/etc</span><br><span class=\"line\">sudo vim php-fpm.conf</span><br><span class=\"line\"><span class=\"comment\"># modify in the end</span></span><br><span class=\"line\">include=/usr/<span class=\"built_in\">local</span>/etc/php-fpm.d/*.conf</span><br><span class=\"line\"><span class=\"comment\"># sudo cp php-fpm.d/www.conf.default php-fpm.d/www.conf</span></span><br><span class=\"line\">sudo vim php-fpm.d/www.conf</span><br><span class=\"line\"><span class=\"comment\"># line 23</span></span><br><span class=\"line\">user = www-data</span><br><span class=\"line\">group = www-data</span><br></pre></td></tr></table></figure></p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo /usr/<span class=\"built_in\">local</span>/bin/php-fpm <span class=\"comment\"># OK</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"configure-nginx-to-support-php\"><a href=\"#configure-nginx-to-support-php\" class=\"headerlink\" title=\"configure  nginx to support php\"></a>configure  nginx to support php</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># 6.nginx.conf</span><br><span class=\"line\">sudo vim /etc/nginx/nginx.conf</span><br><span class=\"line\">http &#123;</span><br><span class=\"line\">    server &#123;</span><br><span class=\"line\">        listen 80;</span><br><span class=\"line\">        server_name learn.lea;</span><br><span class=\"line\">        location / &#123;</span><br><span class=\"line\">            root /data/www;</span><br><span class=\"line\">            index index.php index.html index.htm;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        location ~* \\.php$ &#123;</span><br><span class=\"line\">            fastcgi_index index.php;</span><br><span class=\"line\">            fastcgi_pass  127.0.0.1:9000;</span><br><span class=\"line\">            include       fastcgi_params;</span><br><span class=\"line\">            fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;</span><br><span class=\"line\">            fastcgi_param SCRIPT_NAME     $fastcgi_script_name;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        location ~ \\.(gif|jpg|png)$ &#123;</span><br><span class=\"line\">            root /data/images;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">events &#123;</span><br><span class=\"line\">    worker_connections  1024;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h1 id=\"test\"><a href=\"#test\" class=\"headerlink\" title=\"test\"></a>test</h1><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo <span class=\"built_in\">echo</span> <span class=\"string\">\"&lt;?php phpinfo(); ?&gt;\"</span> &gt;&gt; /usr/<span class=\"built_in\">local</span>/nginx/html/index.php</span><br><span class=\"line\"><span class=\"comment\"># navigate to http://learn.lea</span></span><br></pre></td></tr></table></figure>\n<p><code>File not found</code><br><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo vim /etc/nginx/nginx.conf</span><br><span class=\"line\"><span class=\"comment\"># add \"root /data/www\" directive to PHP location block</span></span><br><span class=\"line\">sudo nginx -s reload <span class=\"comment\"># OK</span></span><br></pre></td></tr></table></figure></p>\n<p>restart the machine:</p>\n<p><code>nginx start automaticlly</code><br><code>php-fpm need to start</code></p>\n<h1 id=\"mysql\"><a href=\"#mysql\" class=\"headerlink\" title=\"mysql\"></a>mysql</h1><blockquote>\n<p>version: <code>8.0</code></p>\n</blockquote>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">wget https://dev.mysql.com/get/mysql-apt-config_0.8.12-1_all.deb</span><br><span class=\"line\">sudo dpkg -i mysql-apt-config_0.8.12-1_all.deb</span><br><span class=\"line\">sudo apt-get update</span><br><span class=\"line\">sudo apt-get install mysql-server</span><br><span class=\"line\">sudo service mysql status</span><br><span class=\"line\">mysql -u root -p</span><br></pre></td></tr></table></figure>\n<h1 id=\"Reference\"><a href=\"#Reference\" class=\"headerlink\" title=\"Reference\"></a>Reference</h1><p><small><br>[1] Martin Fjordvald.NGINX CONFIGURATION PRIMER.<a href=\"http://blog.martinfjordvald.com/2010/07/nginx-primer/\" target=\"_blank\" rel=\"noopener\">http://blog.martinfjordvald.com/2010/07/nginx-primer/</a> [EB/OL] 2010<br>[2] debian.Nginx.<a href=\"https://wiki.debian.org/Nginx\" target=\"_blank\" rel=\"noopener\">https://wiki.debian.org/Nginx</a> [EB/OL] 2016<br></small></p>"},{"title":"Python 初探","date":"2017-10-20T23:06:36.000Z","_content":"\n{% cq %}Life is short,I use Python!{% endcq %}\n\n# 1 学习准备\n## 1.1 环境\n\n<!-- more -->\n\n\n+ 学习环境：[Anaconda 5.0.0](https://repo.continuum.io/archive/Anaconda3-5.0.0.1-Linux-x86_64.sh)\n+ 编辑器：[sublime text 3143](https://www.sublimetext.com/)\n+ 虚拟机：[VMwarePro 12](http://sw.bos.baidu.com/sw-search-sp/software/aff3469fe5f99/VMware-workstation-full-12.5.7.20721.exe)\n+ Linux镜像：[Ubuntu 16.04](http://blog.csdn.net/zhu_xun/article/details/16921413)\n\n\n\n## 1.2 基础知识\n+ Python介绍:[中](https://baike.baidu.com/item/Python/407313)     [英](https://en.wikipedia.org/wiki/Python_%28programming_language%29)\n+ 计算机语言类型：[编译型和解释型的区别](http://blog.csdn.net/zhu_xun/article/details/16921413)\n\n## 1.3 学习目标\n\n+ 配置Python运行环境，在Anaconda下运行python\n+ 了解Python的基础知识及与其他语言的区别及优势\n+ 学会配置虚拟机，在linux默认环境下运行python\n+ 练习用Python写一个贪吃蛇游戏\n\n## 1.4 学习资源\n+ 慕课：[嵩天](http://www.icourse163.org/u/1732151471?userId=4462001)\n+ 教程：[廖雪峰](https://www.liaoxuefeng.com/wiki/0014316089557264a6b348958f449949df42a6d3a2e542c000)\n+ 参考：[官方文档](https://docs.python.org/3/)\n## 1.5 一个Python实例代码\n\n```python\n#Fibonacci series up to n\n>>> def fib(n):\n>>>     a, b = 0, 1\n>>>     while a < n:\n>>>         print(a, end=' ')\n>>>         a, b = b, a+b\n>>>     print()\n>>> fib(1000)\n```\n\n# 2 开始\n\n## 2.1 前言\n\n现在切入正题，首先为什么是要学习python？\n\n首先因为这是个讲求效率的时代，当然这里Python的效率在于其开发效率，可以试下用其他语言写上面的斐波那契数列。在运行效率上依然C/C++是首位，这是毋庸置疑的。然而在计算资源不再是问题的现在，开发效率显得极其重要。Python没有复杂晦涩的语法概念，它更像是为人类语言设计的，更多的面向算法实现而不是考虑底层实现机制，这与C++或者Java有很大不同。就语言本身来看，它始终基于自身不断迭代而不像其他语言不断新增各种各样的库或者包，让开发者应接不暇。当然也由于要“脱胎换骨“，不得不壮士断腕，于是形成2.7和3.x版本不兼容的”脾气“，这一点也让很多人苦恼。\n\n其次，Python现在太受欢迎了。在今年10月10日召开的[Github Universe](https://octoverse.github.com/)大会上，根据发布的Github Octoverse报告显示，Python已代替Java从去年的第三突进到了第二（第一是js），新增了40%的Pull。不是我们追风，而是在很多开源项目中，越来越多的开发者选择使用Python，尤其是一些大公司(联盟)主导的开源项目，例如被fork最多的TensorFlow（谷歌开发的深度学习平台），开发者不可避免的要去使用进而也就必须要学习。这是一个提高语言热度的良性循环。\n![语言排行](http://upload-images.jianshu.io/upload_images/3234038-ceab477152c9aa36.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)\n因而，正如本文开始提到的，越来越多的开发者在感慨”人生苦短“了。\n\n然后是Python能干什么？\n\n在此之前，听说过爬虫、图像处理，对，如果使用python编写，这将变得十分容易。在研究领域，Python可以很快的将算法付诸实现，从而让研究者有更多精力去测试并改进算法而不必把时间耗费在语言工具上，这也正是在机器学习领域python更受欢迎的原因。\n\n## 2.1 准备\n\n### 2.1.1 安装环境\n主要分为两种，\n+ 在windows64平台上,集成了`python3.6`的[Anaconda](https://docs.anaconda.com/anaconda/install/windows)。点击查看安装步骤，也可以参考[这个](https://jingyan.baidu.com/article/7908e85c9e4725af481ad2e2.html)不过不全面。\n**注意**：不用勾选add to environment path和register to ...,安装路径不要含中文、空格(这些都在官方文档有所说明)\n+ 在Ubuntu16.04平台上，内置的`python2.7`。在此之前需要先安装[VMware](https://jingyan.baidu.com/article/c275f6ba07e269e33d756714.html),一个虚拟机软件，便于在win平台上运行ubuntu系统。或者也可以选择安装双系统，~~当然目前不推荐~~。**注意**：一般会遇到两个问题，[安装VMtools](https://jingyan.baidu.com/article/3065b3b6e8dedabecff8a435.html)用于与主机的文件交互，[网络无法连接](http://blog.csdn.net/jjmjeffrey/article/details/54972676)。\n\n其实也可以在一个平台上配置两种版本的环境，不过在当前只是入门的情况下，还是隔离开学习比较好。使用Ubuntu也可以顺便学习linux的基本操作\n\n测试已正确安装\n+ win:找到Anaconda prompt右键管理员运行，键入`python`,出现欢迎语和版本，前面提示符变为>>,试一下：\n```python\n>>>print \"hello python\"\n#有结果即安装成功。\n```\n+ linux:左上方找到terminal，键入`python`,出现欢迎语和版本,前面提示符变为>>,试一下：\n```python\n>>>print \"hello ubuntu\"\n#有结果即安装成功。\n```\n### 2.1.2 安装sublime\n+ win:直接下载安装，默认到底\n+ linux:通过apt方式安装\n\n```linux\n~$ wget -qO - https://download.sublimetext.com/sublimehq-pub.gpg | sudo apt-key add -\n~$ sudo apt-get install apt-transport-https\n~$ echo \"deb https://download.sublimetext.com/ apt/stable/\" | sudo tee /etc/apt/sources.list.d/sublime-text.list\n~$ sudo apt-get update\n~$ sudo apt-get install sublime-text\n```\n## 2.2 学习基本知识\n一般学习一门语言，都会从运行机制然后是基础语法入手。为了便于语言选择的迁移，几乎所有语言的基础语法都是类似的，如变量类型、逻辑关系、逻辑式等等，接着是函数定义。因此如果已经系统学习过一门语言，上手其他是很容易的。\n学习基础语法还是要参考[官方文档](https://docs.python.org/3/tutorial/index.html),更加细致权威，读取差异即可。\n## 2.3练手\n+ 爬虫:一个[系列](http://www.ehcoblog.ml/post/1/)\n+ web编程:一个[专栏](https://zhuanlan.zhihu.com/p/29685446)\n+ 游戏：实现[贪吃蛇游戏](http://eyehere.net/2011/python-pygame-novice-professional-index/)\n\n以贪吃蛇游戏为实现样例。\n### 2.3.1 基本环境\n\n+ 系统：Ubuntu16.04\n+ 版本：Python2.7\n+ 第三方库：pygame1.9.3\n+ 编辑器：sublime text3143\n+ 效果如图\n\n![贪吃蛇](http://upload-images.jianshu.io/upload_images/3234038-53f09a7f69439dc5.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)\n\n+ 操作方法：\n  上下左右键或wsad键控制\nESC键退出游戏\n\n### 2.3.2 练习\n**注意**：安装库需要pip方式，打开terminal,键入：\n```linux\n~$ sudo apt-get install python-pip\n~$ sudo apt-get install python-pip python-dev\n~$ sudo pip install --upgrade pip\n#确认安装好pip：\n~$ pip -V\n#会出现版本号即pip安装成功\n~$ pip install pygame\n```\n进入python终端\n```python\n>>>import pygame\n>>>print pygame.ver\n##可看到版本号成功\n```\n可以继续在解释器终端编写；也可以先写好snake.py脚本（用sublime,也可以用vim，推荐前者），然后在命令行用`python snake.py`执行\n```python\n# snake.py\nimport pygame,sys,time,random\nfrom pygame.locals import *\n\nredColour = pygame.Color(255,0,0)\nblackColour = pygame.Color(0,0,0)\nwhiteColour = pygame.Color(255,255,255)\ngreyColour = pygame.Color(150,150,150)\n\ndef gameOver(playSurface):\n    gameOverFont = font = pygame.font.SysFont(None, 48)\n    gameOverSurf = gameOverFont.render('Game Over', True, greyColour)\n    gameOverRect = gameOverSurf.get_rect()\n    gameOverRect.midtop = (320, 10)\n    playSurface.blit(gameOverSurf, gameOverRect)\n    pygame.display.flip()\n    time.sleep(5)\n    pygame.quit()\n    sys.exit()\n\ndef main():\n  \n    pygame.init()\n    pygame.font.init()\n    fpsClock = pygame.time.Clock()\n   \n    playSurface = pygame.display.set_mode((640,480))\n    pygame.display.set_caption('Raspberry Snake')\n\n    snakePosition = [100,100]\n    snakeSegments = [[100,100],[80,100],[60,100]]\n    raspberryPosition = [300,300]\n    raspberrySpawned = 1\n    direction = 'right'\n    changeDirection = direction\n    while True:\n        \n        for event in pygame.event.get():\n            if event.type == QUIT:\n                pygame.quit()\n                sys.exit()\n            elif event.type == KEYDOWN:\n                \n                if event.key == K_RIGHT or event.key == ord('d'):\n                    changeDirection = 'right'\n                if event.key == K_LEFT or event.key == ord('a'):\n                    changeDirection = 'left'\n                if event.key == K_UP or event.key == ord('w'):\n                    changeDirection = 'up'\n                if event.key == K_DOWN or event.key == ord('s'):\n                    changeDirection = 'down'\n                if event.key == K_ESCAPE:\n                    pygame.event.post(pygame.event.Event(QUIT))\n       \n        if changeDirection == 'right' and not direction == 'left':\n            direction = changeDirection\n        if changeDirection == 'left' and not direction == 'right':\n            direction = changeDirection\n        if changeDirection == 'up' and not direction == 'down':\n            direction = changeDirection\n        if changeDirection == 'down' and not direction == 'up':\n            direction = changeDirection\n        \n        if direction == 'right':\n            snakePosition[0] += 20\n        if direction == 'left':\n            snakePosition[0] -= 20\n        if direction == 'up':\n            snakePosition[1] -= 20\n        if direction == 'down':\n            snakePosition[1] += 20\n      \n        snakeSegments.insert(0,list(snakePosition))\n       \n        if snakePosition[0] == raspberryPosition[0] and snakePosition[1] == raspberryPosition[1]:\n            raspberrySpawned = 0\n        else:\n            snakeSegments.pop()\n       \n        if raspberrySpawned == 0:\n            x = random.randrange(1,32)\n            y = random.randrange(1,24)\n            raspberryPosition = [int(x*20),int(y*20)]\n            raspberrySpawned = 1\n      \n        playSurface.fill(blackColour)\n        for position in snakeSegments:\n            pygame.draw.rect(playSurface,whiteColour,Rect(position[0],position[1],20,20))\n            pygame.draw.rect(playSurface,redColour,Rect(raspberryPosition[0], raspberryPosition[1],20,20))\n\n        pygame.display.flip()\n       \n        if snakePosition[0] > 620 or snakePosition[0] < 0:\n            gameOver(playSurface)\n        if snakePosition[1] > 460 or snakePosition[1] < 0:\n            for snakeBody in snakeSegments[1:]:\n                if snakePosition[0] == snakeBody[0] and snakePosition[1] == snakeBody[1]:\n                    gameOver(playSurface)\n       \n        fpsClock.tick(5)\n\nif __name__ == \"__main__\":\n    main()\n```","source":"_posts/zh-CN/Python初探.md","raw":"---\ntitle: Python 初探\ndate: 2017-10-21 07:06:36\ntags:\n  - python\ncategories: study\n---\n\n{% cq %}Life is short,I use Python!{% endcq %}\n\n# 1 学习准备\n## 1.1 环境\n\n<!-- more -->\n\n\n+ 学习环境：[Anaconda 5.0.0](https://repo.continuum.io/archive/Anaconda3-5.0.0.1-Linux-x86_64.sh)\n+ 编辑器：[sublime text 3143](https://www.sublimetext.com/)\n+ 虚拟机：[VMwarePro 12](http://sw.bos.baidu.com/sw-search-sp/software/aff3469fe5f99/VMware-workstation-full-12.5.7.20721.exe)\n+ Linux镜像：[Ubuntu 16.04](http://blog.csdn.net/zhu_xun/article/details/16921413)\n\n\n\n## 1.2 基础知识\n+ Python介绍:[中](https://baike.baidu.com/item/Python/407313)     [英](https://en.wikipedia.org/wiki/Python_%28programming_language%29)\n+ 计算机语言类型：[编译型和解释型的区别](http://blog.csdn.net/zhu_xun/article/details/16921413)\n\n## 1.3 学习目标\n\n+ 配置Python运行环境，在Anaconda下运行python\n+ 了解Python的基础知识及与其他语言的区别及优势\n+ 学会配置虚拟机，在linux默认环境下运行python\n+ 练习用Python写一个贪吃蛇游戏\n\n## 1.4 学习资源\n+ 慕课：[嵩天](http://www.icourse163.org/u/1732151471?userId=4462001)\n+ 教程：[廖雪峰](https://www.liaoxuefeng.com/wiki/0014316089557264a6b348958f449949df42a6d3a2e542c000)\n+ 参考：[官方文档](https://docs.python.org/3/)\n## 1.5 一个Python实例代码\n\n```python\n#Fibonacci series up to n\n>>> def fib(n):\n>>>     a, b = 0, 1\n>>>     while a < n:\n>>>         print(a, end=' ')\n>>>         a, b = b, a+b\n>>>     print()\n>>> fib(1000)\n```\n\n# 2 开始\n\n## 2.1 前言\n\n现在切入正题，首先为什么是要学习python？\n\n首先因为这是个讲求效率的时代，当然这里Python的效率在于其开发效率，可以试下用其他语言写上面的斐波那契数列。在运行效率上依然C/C++是首位，这是毋庸置疑的。然而在计算资源不再是问题的现在，开发效率显得极其重要。Python没有复杂晦涩的语法概念，它更像是为人类语言设计的，更多的面向算法实现而不是考虑底层实现机制，这与C++或者Java有很大不同。就语言本身来看，它始终基于自身不断迭代而不像其他语言不断新增各种各样的库或者包，让开发者应接不暇。当然也由于要“脱胎换骨“，不得不壮士断腕，于是形成2.7和3.x版本不兼容的”脾气“，这一点也让很多人苦恼。\n\n其次，Python现在太受欢迎了。在今年10月10日召开的[Github Universe](https://octoverse.github.com/)大会上，根据发布的Github Octoverse报告显示，Python已代替Java从去年的第三突进到了第二（第一是js），新增了40%的Pull。不是我们追风，而是在很多开源项目中，越来越多的开发者选择使用Python，尤其是一些大公司(联盟)主导的开源项目，例如被fork最多的TensorFlow（谷歌开发的深度学习平台），开发者不可避免的要去使用进而也就必须要学习。这是一个提高语言热度的良性循环。\n![语言排行](http://upload-images.jianshu.io/upload_images/3234038-ceab477152c9aa36.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)\n因而，正如本文开始提到的，越来越多的开发者在感慨”人生苦短“了。\n\n然后是Python能干什么？\n\n在此之前，听说过爬虫、图像处理，对，如果使用python编写，这将变得十分容易。在研究领域，Python可以很快的将算法付诸实现，从而让研究者有更多精力去测试并改进算法而不必把时间耗费在语言工具上，这也正是在机器学习领域python更受欢迎的原因。\n\n## 2.1 准备\n\n### 2.1.1 安装环境\n主要分为两种，\n+ 在windows64平台上,集成了`python3.6`的[Anaconda](https://docs.anaconda.com/anaconda/install/windows)。点击查看安装步骤，也可以参考[这个](https://jingyan.baidu.com/article/7908e85c9e4725af481ad2e2.html)不过不全面。\n**注意**：不用勾选add to environment path和register to ...,安装路径不要含中文、空格(这些都在官方文档有所说明)\n+ 在Ubuntu16.04平台上，内置的`python2.7`。在此之前需要先安装[VMware](https://jingyan.baidu.com/article/c275f6ba07e269e33d756714.html),一个虚拟机软件，便于在win平台上运行ubuntu系统。或者也可以选择安装双系统，~~当然目前不推荐~~。**注意**：一般会遇到两个问题，[安装VMtools](https://jingyan.baidu.com/article/3065b3b6e8dedabecff8a435.html)用于与主机的文件交互，[网络无法连接](http://blog.csdn.net/jjmjeffrey/article/details/54972676)。\n\n其实也可以在一个平台上配置两种版本的环境，不过在当前只是入门的情况下，还是隔离开学习比较好。使用Ubuntu也可以顺便学习linux的基本操作\n\n测试已正确安装\n+ win:找到Anaconda prompt右键管理员运行，键入`python`,出现欢迎语和版本，前面提示符变为>>,试一下：\n```python\n>>>print \"hello python\"\n#有结果即安装成功。\n```\n+ linux:左上方找到terminal，键入`python`,出现欢迎语和版本,前面提示符变为>>,试一下：\n```python\n>>>print \"hello ubuntu\"\n#有结果即安装成功。\n```\n### 2.1.2 安装sublime\n+ win:直接下载安装，默认到底\n+ linux:通过apt方式安装\n\n```linux\n~$ wget -qO - https://download.sublimetext.com/sublimehq-pub.gpg | sudo apt-key add -\n~$ sudo apt-get install apt-transport-https\n~$ echo \"deb https://download.sublimetext.com/ apt/stable/\" | sudo tee /etc/apt/sources.list.d/sublime-text.list\n~$ sudo apt-get update\n~$ sudo apt-get install sublime-text\n```\n## 2.2 学习基本知识\n一般学习一门语言，都会从运行机制然后是基础语法入手。为了便于语言选择的迁移，几乎所有语言的基础语法都是类似的，如变量类型、逻辑关系、逻辑式等等，接着是函数定义。因此如果已经系统学习过一门语言，上手其他是很容易的。\n学习基础语法还是要参考[官方文档](https://docs.python.org/3/tutorial/index.html),更加细致权威，读取差异即可。\n## 2.3练手\n+ 爬虫:一个[系列](http://www.ehcoblog.ml/post/1/)\n+ web编程:一个[专栏](https://zhuanlan.zhihu.com/p/29685446)\n+ 游戏：实现[贪吃蛇游戏](http://eyehere.net/2011/python-pygame-novice-professional-index/)\n\n以贪吃蛇游戏为实现样例。\n### 2.3.1 基本环境\n\n+ 系统：Ubuntu16.04\n+ 版本：Python2.7\n+ 第三方库：pygame1.9.3\n+ 编辑器：sublime text3143\n+ 效果如图\n\n![贪吃蛇](http://upload-images.jianshu.io/upload_images/3234038-53f09a7f69439dc5.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)\n\n+ 操作方法：\n  上下左右键或wsad键控制\nESC键退出游戏\n\n### 2.3.2 练习\n**注意**：安装库需要pip方式，打开terminal,键入：\n```linux\n~$ sudo apt-get install python-pip\n~$ sudo apt-get install python-pip python-dev\n~$ sudo pip install --upgrade pip\n#确认安装好pip：\n~$ pip -V\n#会出现版本号即pip安装成功\n~$ pip install pygame\n```\n进入python终端\n```python\n>>>import pygame\n>>>print pygame.ver\n##可看到版本号成功\n```\n可以继续在解释器终端编写；也可以先写好snake.py脚本（用sublime,也可以用vim，推荐前者），然后在命令行用`python snake.py`执行\n```python\n# snake.py\nimport pygame,sys,time,random\nfrom pygame.locals import *\n\nredColour = pygame.Color(255,0,0)\nblackColour = pygame.Color(0,0,0)\nwhiteColour = pygame.Color(255,255,255)\ngreyColour = pygame.Color(150,150,150)\n\ndef gameOver(playSurface):\n    gameOverFont = font = pygame.font.SysFont(None, 48)\n    gameOverSurf = gameOverFont.render('Game Over', True, greyColour)\n    gameOverRect = gameOverSurf.get_rect()\n    gameOverRect.midtop = (320, 10)\n    playSurface.blit(gameOverSurf, gameOverRect)\n    pygame.display.flip()\n    time.sleep(5)\n    pygame.quit()\n    sys.exit()\n\ndef main():\n  \n    pygame.init()\n    pygame.font.init()\n    fpsClock = pygame.time.Clock()\n   \n    playSurface = pygame.display.set_mode((640,480))\n    pygame.display.set_caption('Raspberry Snake')\n\n    snakePosition = [100,100]\n    snakeSegments = [[100,100],[80,100],[60,100]]\n    raspberryPosition = [300,300]\n    raspberrySpawned = 1\n    direction = 'right'\n    changeDirection = direction\n    while True:\n        \n        for event in pygame.event.get():\n            if event.type == QUIT:\n                pygame.quit()\n                sys.exit()\n            elif event.type == KEYDOWN:\n                \n                if event.key == K_RIGHT or event.key == ord('d'):\n                    changeDirection = 'right'\n                if event.key == K_LEFT or event.key == ord('a'):\n                    changeDirection = 'left'\n                if event.key == K_UP or event.key == ord('w'):\n                    changeDirection = 'up'\n                if event.key == K_DOWN or event.key == ord('s'):\n                    changeDirection = 'down'\n                if event.key == K_ESCAPE:\n                    pygame.event.post(pygame.event.Event(QUIT))\n       \n        if changeDirection == 'right' and not direction == 'left':\n            direction = changeDirection\n        if changeDirection == 'left' and not direction == 'right':\n            direction = changeDirection\n        if changeDirection == 'up' and not direction == 'down':\n            direction = changeDirection\n        if changeDirection == 'down' and not direction == 'up':\n            direction = changeDirection\n        \n        if direction == 'right':\n            snakePosition[0] += 20\n        if direction == 'left':\n            snakePosition[0] -= 20\n        if direction == 'up':\n            snakePosition[1] -= 20\n        if direction == 'down':\n            snakePosition[1] += 20\n      \n        snakeSegments.insert(0,list(snakePosition))\n       \n        if snakePosition[0] == raspberryPosition[0] and snakePosition[1] == raspberryPosition[1]:\n            raspberrySpawned = 0\n        else:\n            snakeSegments.pop()\n       \n        if raspberrySpawned == 0:\n            x = random.randrange(1,32)\n            y = random.randrange(1,24)\n            raspberryPosition = [int(x*20),int(y*20)]\n            raspberrySpawned = 1\n      \n        playSurface.fill(blackColour)\n        for position in snakeSegments:\n            pygame.draw.rect(playSurface,whiteColour,Rect(position[0],position[1],20,20))\n            pygame.draw.rect(playSurface,redColour,Rect(raspberryPosition[0], raspberryPosition[1],20,20))\n\n        pygame.display.flip()\n       \n        if snakePosition[0] > 620 or snakePosition[0] < 0:\n            gameOver(playSurface)\n        if snakePosition[1] > 460 or snakePosition[1] < 0:\n            for snakeBody in snakeSegments[1:]:\n                if snakePosition[0] == snakeBody[0] and snakePosition[1] == snakeBody[1]:\n                    gameOver(playSurface)\n       \n        fpsClock.tick(5)\n\nif __name__ == \"__main__\":\n    main()\n```","slug":"Python初探","published":1,"lang":"zh-CN","updated":"2019-07-21T06:31:24.214Z","_id":"cjvnq7zbl003b7jjxtnt12sti","comments":1,"layout":"post","photos":[],"link":"","content":"<link rel=\"stylesheet\" class=\"aplayer-secondary-style-marker\" href=\"/assets/css/APlayer.min.css\"><script src=\"/assets/js/APlayer.min.js\" class=\"aplayer-secondary-script-marker\"></script><script class=\"meting-secondary-script-marker\" src=\"/assets/js/Meting.min.js\"></script><link rel=\"stylesheet\" type=\"text/css\" href=\"https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css\"><blockquote class=\"blockquote-center\"><p>Life is short,I use Python!</p>\n</blockquote>\n<h1 id=\"1-学习准备\"><a href=\"#1-学习准备\" class=\"headerlink\" title=\"1 学习准备\"></a>1 学习准备</h1><h2 id=\"1-1-环境\"><a href=\"#1-1-环境\" class=\"headerlink\" title=\"1.1 环境\"></a>1.1 环境</h2><a id=\"more\"></a>\n<ul>\n<li>学习环境：<a href=\"https://repo.continuum.io/archive/Anaconda3-5.0.0.1-Linux-x86_64.sh\" target=\"_blank\" rel=\"noopener\">Anaconda 5.0.0</a></li>\n<li>编辑器：<a href=\"https://www.sublimetext.com/\" target=\"_blank\" rel=\"noopener\">sublime text 3143</a></li>\n<li>虚拟机：<a href=\"http://sw.bos.baidu.com/sw-search-sp/software/aff3469fe5f99/VMware-workstation-full-12.5.7.20721.exe\" target=\"_blank\" rel=\"noopener\">VMwarePro 12</a></li>\n<li>Linux镜像：<a href=\"http://blog.csdn.net/zhu_xun/article/details/16921413\" target=\"_blank\" rel=\"noopener\">Ubuntu 16.04</a></li>\n</ul>\n<h2 id=\"1-2-基础知识\"><a href=\"#1-2-基础知识\" class=\"headerlink\" title=\"1.2 基础知识\"></a>1.2 基础知识</h2><ul>\n<li>Python介绍:<a href=\"https://baike.baidu.com/item/Python/407313\" target=\"_blank\" rel=\"noopener\">中</a>     <a href=\"https://en.wikipedia.org/wiki/Python_%28programming_language%29\" target=\"_blank\" rel=\"noopener\">英</a></li>\n<li>计算机语言类型：<a href=\"http://blog.csdn.net/zhu_xun/article/details/16921413\" target=\"_blank\" rel=\"noopener\">编译型和解释型的区别</a></li>\n</ul>\n<h2 id=\"1-3-学习目标\"><a href=\"#1-3-学习目标\" class=\"headerlink\" title=\"1.3 学习目标\"></a>1.3 学习目标</h2><ul>\n<li>配置Python运行环境，在Anaconda下运行python</li>\n<li>了解Python的基础知识及与其他语言的区别及优势</li>\n<li>学会配置虚拟机，在linux默认环境下运行python</li>\n<li>练习用Python写一个贪吃蛇游戏</li>\n</ul>\n<h2 id=\"1-4-学习资源\"><a href=\"#1-4-学习资源\" class=\"headerlink\" title=\"1.4 学习资源\"></a>1.4 学习资源</h2><ul>\n<li>慕课：<a href=\"http://www.icourse163.org/u/1732151471?userId=4462001\" target=\"_blank\" rel=\"noopener\">嵩天</a></li>\n<li>教程：<a href=\"https://www.liaoxuefeng.com/wiki/0014316089557264a6b348958f449949df42a6d3a2e542c000\" target=\"_blank\" rel=\"noopener\">廖雪峰</a></li>\n<li>参考：<a href=\"https://docs.python.org/3/\" target=\"_blank\" rel=\"noopener\">官方文档</a><h2 id=\"1-5-一个Python实例代码\"><a href=\"#1-5-一个Python实例代码\" class=\"headerlink\" title=\"1.5 一个Python实例代码\"></a>1.5 一个Python实例代码</h2></li>\n</ul>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#Fibonacci series up to n</span></span><br><span class=\"line\"><span class=\"meta\">&gt;&gt;&gt; </span><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">fib</span><span class=\"params\">(n)</span>:</span></span><br><span class=\"line\"><span class=\"meta\">&gt;&gt;&gt; </span>    a, b = <span class=\"number\">0</span>, <span class=\"number\">1</span></span><br><span class=\"line\"><span class=\"meta\">&gt;&gt;&gt; </span>    <span class=\"keyword\">while</span> a &lt; n:</span><br><span class=\"line\"><span class=\"meta\">&gt;&gt;&gt; </span>        print(a, end=<span class=\"string\">' '</span>)</span><br><span class=\"line\"><span class=\"meta\">&gt;&gt;&gt; </span>        a, b = b, a+b</span><br><span class=\"line\"><span class=\"meta\">&gt;&gt;&gt; </span>    print()</span><br><span class=\"line\"><span class=\"meta\">&gt;&gt;&gt; </span>fib(<span class=\"number\">1000</span>)</span><br></pre></td></tr></table></figure>\n<h1 id=\"2-开始\"><a href=\"#2-开始\" class=\"headerlink\" title=\"2 开始\"></a>2 开始</h1><h2 id=\"2-1-前言\"><a href=\"#2-1-前言\" class=\"headerlink\" title=\"2.1 前言\"></a>2.1 前言</h2><p>现在切入正题，首先为什么是要学习python？</p>\n<p>首先因为这是个讲求效率的时代，当然这里Python的效率在于其开发效率，可以试下用其他语言写上面的斐波那契数列。在运行效率上依然C/C++是首位，这是毋庸置疑的。然而在计算资源不再是问题的现在，开发效率显得极其重要。Python没有复杂晦涩的语法概念，它更像是为人类语言设计的，更多的面向算法实现而不是考虑底层实现机制，这与C++或者Java有很大不同。就语言本身来看，它始终基于自身不断迭代而不像其他语言不断新增各种各样的库或者包，让开发者应接不暇。当然也由于要“脱胎换骨“，不得不壮士断腕，于是形成2.7和3.x版本不兼容的”脾气“，这一点也让很多人苦恼。</p>\n<p>其次，Python现在太受欢迎了。在今年10月10日召开的<a href=\"https://octoverse.github.com/\" target=\"_blank\" rel=\"noopener\">Github Universe</a>大会上，根据发布的Github Octoverse报告显示，Python已代替Java从去年的第三突进到了第二（第一是js），新增了40%的Pull。不是我们追风，而是在很多开源项目中，越来越多的开发者选择使用Python，尤其是一些大公司(联盟)主导的开源项目，例如被fork最多的TensorFlow（谷歌开发的深度学习平台），开发者不可避免的要去使用进而也就必须要学习。这是一个提高语言热度的良性循环。<br><img src=\"http://upload-images.jianshu.io/upload_images/3234038-ceab477152c9aa36.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240\" alt=\"语言排行\"><br>因而，正如本文开始提到的，越来越多的开发者在感慨”人生苦短“了。</p>\n<p>然后是Python能干什么？</p>\n<p>在此之前，听说过爬虫、图像处理，对，如果使用python编写，这将变得十分容易。在研究领域，Python可以很快的将算法付诸实现，从而让研究者有更多精力去测试并改进算法而不必把时间耗费在语言工具上，这也正是在机器学习领域python更受欢迎的原因。</p>\n<h2 id=\"2-1-准备\"><a href=\"#2-1-准备\" class=\"headerlink\" title=\"2.1 准备\"></a>2.1 准备</h2><h3 id=\"2-1-1-安装环境\"><a href=\"#2-1-1-安装环境\" class=\"headerlink\" title=\"2.1.1 安装环境\"></a>2.1.1 安装环境</h3><p>主要分为两种，</p>\n<ul>\n<li>在windows64平台上,集成了<code>python3.6</code>的<a href=\"https://docs.anaconda.com/anaconda/install/windows\" target=\"_blank\" rel=\"noopener\">Anaconda</a>。点击查看安装步骤，也可以参考<a href=\"https://jingyan.baidu.com/article/7908e85c9e4725af481ad2e2.html\" target=\"_blank\" rel=\"noopener\">这个</a>不过不全面。<br><strong>注意</strong>：不用勾选add to environment path和register to …,安装路径不要含中文、空格(这些都在官方文档有所说明)</li>\n<li>在Ubuntu16.04平台上，内置的<code>python2.7</code>。在此之前需要先安装<a href=\"https://jingyan.baidu.com/article/c275f6ba07e269e33d756714.html\" target=\"_blank\" rel=\"noopener\">VMware</a>,一个虚拟机软件，便于在win平台上运行ubuntu系统。或者也可以选择安装双系统，<del>当然目前不推荐</del>。<strong>注意</strong>：一般会遇到两个问题，<a href=\"https://jingyan.baidu.com/article/3065b3b6e8dedabecff8a435.html\" target=\"_blank\" rel=\"noopener\">安装VMtools</a>用于与主机的文件交互，<a href=\"http://blog.csdn.net/jjmjeffrey/article/details/54972676\" target=\"_blank\" rel=\"noopener\">网络无法连接</a>。</li>\n</ul>\n<p>其实也可以在一个平台上配置两种版本的环境，不过在当前只是入门的情况下，还是隔离开学习比较好。使用Ubuntu也可以顺便学习linux的基本操作</p>\n<p>测试已正确安装</p>\n<ul>\n<li><p>win:找到Anaconda prompt右键管理员运行，键入<code>python</code>,出现欢迎语和版本，前面提示符变为&gt;&gt;,试一下：</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&gt;&gt;&gt;<span class=\"keyword\">print</span> <span class=\"string\">\"hello python\"</span></span><br><span class=\"line\"><span class=\"comment\">#有结果即安装成功。</span></span><br></pre></td></tr></table></figure>\n</li>\n<li><p>linux:左上方找到terminal，键入<code>python</code>,出现欢迎语和版本,前面提示符变为&gt;&gt;,试一下：</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&gt;&gt;&gt;<span class=\"keyword\">print</span> <span class=\"string\">\"hello ubuntu\"</span></span><br><span class=\"line\"><span class=\"comment\">#有结果即安装成功。</span></span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<h3 id=\"2-1-2-安装sublime\"><a href=\"#2-1-2-安装sublime\" class=\"headerlink\" title=\"2.1.2 安装sublime\"></a>2.1.2 安装sublime</h3><ul>\n<li>win:直接下载安装，默认到底</li>\n<li>linux:通过apt方式安装</li>\n</ul>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">~$ wget -qO - https://download.sublimetext.com/sublimehq-pub.gpg | sudo apt-key add -</span><br><span class=\"line\">~$ sudo apt-get install apt-transport-https</span><br><span class=\"line\">~$ echo &quot;deb https://download.sublimetext.com/ apt/stable/&quot; | sudo tee /etc/apt/sources.list.d/sublime-text.list</span><br><span class=\"line\">~$ sudo apt-get update</span><br><span class=\"line\">~$ sudo apt-get install sublime-text</span><br></pre></td></tr></table></figure>\n<h2 id=\"2-2-学习基本知识\"><a href=\"#2-2-学习基本知识\" class=\"headerlink\" title=\"2.2 学习基本知识\"></a>2.2 学习基本知识</h2><p>一般学习一门语言，都会从运行机制然后是基础语法入手。为了便于语言选择的迁移，几乎所有语言的基础语法都是类似的，如变量类型、逻辑关系、逻辑式等等，接着是函数定义。因此如果已经系统学习过一门语言，上手其他是很容易的。<br>学习基础语法还是要参考<a href=\"https://docs.python.org/3/tutorial/index.html\" target=\"_blank\" rel=\"noopener\">官方文档</a>,更加细致权威，读取差异即可。</p>\n<h2 id=\"2-3练手\"><a href=\"#2-3练手\" class=\"headerlink\" title=\"2.3练手\"></a>2.3练手</h2><ul>\n<li>爬虫:一个<a href=\"http://www.ehcoblog.ml/post/1/\" target=\"_blank\" rel=\"noopener\">系列</a></li>\n<li>web编程:一个<a href=\"https://zhuanlan.zhihu.com/p/29685446\" target=\"_blank\" rel=\"noopener\">专栏</a></li>\n<li>游戏：实现<a href=\"http://eyehere.net/2011/python-pygame-novice-professional-index/\" target=\"_blank\" rel=\"noopener\">贪吃蛇游戏</a></li>\n</ul>\n<p>以贪吃蛇游戏为实现样例。</p>\n<h3 id=\"2-3-1-基本环境\"><a href=\"#2-3-1-基本环境\" class=\"headerlink\" title=\"2.3.1 基本环境\"></a>2.3.1 基本环境</h3><ul>\n<li>系统：Ubuntu16.04</li>\n<li>版本：Python2.7</li>\n<li>第三方库：pygame1.9.3</li>\n<li>编辑器：sublime text3143</li>\n<li>效果如图</li>\n</ul>\n<p><img src=\"http://upload-images.jianshu.io/upload_images/3234038-53f09a7f69439dc5.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240\" alt=\"贪吃蛇\"></p>\n<ul>\n<li>操作方法：<br>上下左右键或wsad键控制<br>ESC键退出游戏</li>\n</ul>\n<h3 id=\"2-3-2-练习\"><a href=\"#2-3-2-练习\" class=\"headerlink\" title=\"2.3.2 练习\"></a>2.3.2 练习</h3><p><strong>注意</strong>：安装库需要pip方式，打开terminal,键入：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">~$ sudo apt-get install python-pip</span><br><span class=\"line\">~$ sudo apt-get install python-pip python-dev</span><br><span class=\"line\">~$ sudo pip install --upgrade pip</span><br><span class=\"line\">#确认安装好pip：</span><br><span class=\"line\">~$ pip -V</span><br><span class=\"line\">#会出现版本号即pip安装成功</span><br><span class=\"line\">~$ pip install pygame</span><br></pre></td></tr></table></figure></p>\n<p>进入python终端<br><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&gt;&gt;&gt;<span class=\"keyword\">import</span> pygame</span><br><span class=\"line\">&gt;&gt;&gt;<span class=\"keyword\">print</span> pygame.ver</span><br><span class=\"line\"><span class=\"comment\">##可看到版本号成功</span></span><br></pre></td></tr></table></figure></p>\n<p>可以继续在解释器终端编写；也可以先写好snake.py脚本（用sublime,也可以用vim，推荐前者），然后在命令行用<code>python snake.py</code>执行<br><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># snake.py</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> pygame,sys,time,random</span><br><span class=\"line\"><span class=\"keyword\">from</span> pygame.locals <span class=\"keyword\">import</span> *</span><br><span class=\"line\"></span><br><span class=\"line\">redColour = pygame.Color(<span class=\"number\">255</span>,<span class=\"number\">0</span>,<span class=\"number\">0</span>)</span><br><span class=\"line\">blackColour = pygame.Color(<span class=\"number\">0</span>,<span class=\"number\">0</span>,<span class=\"number\">0</span>)</span><br><span class=\"line\">whiteColour = pygame.Color(<span class=\"number\">255</span>,<span class=\"number\">255</span>,<span class=\"number\">255</span>)</span><br><span class=\"line\">greyColour = pygame.Color(<span class=\"number\">150</span>,<span class=\"number\">150</span>,<span class=\"number\">150</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">gameOver</span><span class=\"params\">(playSurface)</span>:</span></span><br><span class=\"line\">    gameOverFont = font = pygame.font.SysFont(<span class=\"literal\">None</span>, <span class=\"number\">48</span>)</span><br><span class=\"line\">    gameOverSurf = gameOverFont.render(<span class=\"string\">'Game Over'</span>, <span class=\"literal\">True</span>, greyColour)</span><br><span class=\"line\">    gameOverRect = gameOverSurf.get_rect()</span><br><span class=\"line\">    gameOverRect.midtop = (<span class=\"number\">320</span>, <span class=\"number\">10</span>)</span><br><span class=\"line\">    playSurface.blit(gameOverSurf, gameOverRect)</span><br><span class=\"line\">    pygame.display.flip()</span><br><span class=\"line\">    time.sleep(<span class=\"number\">5</span>)</span><br><span class=\"line\">    pygame.quit()</span><br><span class=\"line\">    sys.exit()</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">main</span><span class=\"params\">()</span>:</span></span><br><span class=\"line\">  </span><br><span class=\"line\">    pygame.init()</span><br><span class=\"line\">    pygame.font.init()</span><br><span class=\"line\">    fpsClock = pygame.time.Clock()</span><br><span class=\"line\">   </span><br><span class=\"line\">    playSurface = pygame.display.set_mode((<span class=\"number\">640</span>,<span class=\"number\">480</span>))</span><br><span class=\"line\">    pygame.display.set_caption(<span class=\"string\">'Raspberry Snake'</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">    snakePosition = [<span class=\"number\">100</span>,<span class=\"number\">100</span>]</span><br><span class=\"line\">    snakeSegments = [[<span class=\"number\">100</span>,<span class=\"number\">100</span>],[<span class=\"number\">80</span>,<span class=\"number\">100</span>],[<span class=\"number\">60</span>,<span class=\"number\">100</span>]]</span><br><span class=\"line\">    raspberryPosition = [<span class=\"number\">300</span>,<span class=\"number\">300</span>]</span><br><span class=\"line\">    raspberrySpawned = <span class=\"number\">1</span></span><br><span class=\"line\">    direction = <span class=\"string\">'right'</span></span><br><span class=\"line\">    changeDirection = direction</span><br><span class=\"line\">    <span class=\"keyword\">while</span> <span class=\"literal\">True</span>:</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"keyword\">for</span> event <span class=\"keyword\">in</span> pygame.event.get():</span><br><span class=\"line\">            <span class=\"keyword\">if</span> event.type == QUIT:</span><br><span class=\"line\">                pygame.quit()</span><br><span class=\"line\">                sys.exit()</span><br><span class=\"line\">            <span class=\"keyword\">elif</span> event.type == KEYDOWN:</span><br><span class=\"line\">                </span><br><span class=\"line\">                <span class=\"keyword\">if</span> event.key == K_RIGHT <span class=\"keyword\">or</span> event.key == ord(<span class=\"string\">'d'</span>):</span><br><span class=\"line\">                    changeDirection = <span class=\"string\">'right'</span></span><br><span class=\"line\">                <span class=\"keyword\">if</span> event.key == K_LEFT <span class=\"keyword\">or</span> event.key == ord(<span class=\"string\">'a'</span>):</span><br><span class=\"line\">                    changeDirection = <span class=\"string\">'left'</span></span><br><span class=\"line\">                <span class=\"keyword\">if</span> event.key == K_UP <span class=\"keyword\">or</span> event.key == ord(<span class=\"string\">'w'</span>):</span><br><span class=\"line\">                    changeDirection = <span class=\"string\">'up'</span></span><br><span class=\"line\">                <span class=\"keyword\">if</span> event.key == K_DOWN <span class=\"keyword\">or</span> event.key == ord(<span class=\"string\">'s'</span>):</span><br><span class=\"line\">                    changeDirection = <span class=\"string\">'down'</span></span><br><span class=\"line\">                <span class=\"keyword\">if</span> event.key == K_ESCAPE:</span><br><span class=\"line\">                    pygame.event.post(pygame.event.Event(QUIT))</span><br><span class=\"line\">       </span><br><span class=\"line\">        <span class=\"keyword\">if</span> changeDirection == <span class=\"string\">'right'</span> <span class=\"keyword\">and</span> <span class=\"keyword\">not</span> direction == <span class=\"string\">'left'</span>:</span><br><span class=\"line\">            direction = changeDirection</span><br><span class=\"line\">        <span class=\"keyword\">if</span> changeDirection == <span class=\"string\">'left'</span> <span class=\"keyword\">and</span> <span class=\"keyword\">not</span> direction == <span class=\"string\">'right'</span>:</span><br><span class=\"line\">            direction = changeDirection</span><br><span class=\"line\">        <span class=\"keyword\">if</span> changeDirection == <span class=\"string\">'up'</span> <span class=\"keyword\">and</span> <span class=\"keyword\">not</span> direction == <span class=\"string\">'down'</span>:</span><br><span class=\"line\">            direction = changeDirection</span><br><span class=\"line\">        <span class=\"keyword\">if</span> changeDirection == <span class=\"string\">'down'</span> <span class=\"keyword\">and</span> <span class=\"keyword\">not</span> direction == <span class=\"string\">'up'</span>:</span><br><span class=\"line\">            direction = changeDirection</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"keyword\">if</span> direction == <span class=\"string\">'right'</span>:</span><br><span class=\"line\">            snakePosition[<span class=\"number\">0</span>] += <span class=\"number\">20</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> direction == <span class=\"string\">'left'</span>:</span><br><span class=\"line\">            snakePosition[<span class=\"number\">0</span>] -= <span class=\"number\">20</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> direction == <span class=\"string\">'up'</span>:</span><br><span class=\"line\">            snakePosition[<span class=\"number\">1</span>] -= <span class=\"number\">20</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> direction == <span class=\"string\">'down'</span>:</span><br><span class=\"line\">            snakePosition[<span class=\"number\">1</span>] += <span class=\"number\">20</span></span><br><span class=\"line\">      </span><br><span class=\"line\">        snakeSegments.insert(<span class=\"number\">0</span>,list(snakePosition))</span><br><span class=\"line\">       </span><br><span class=\"line\">        <span class=\"keyword\">if</span> snakePosition[<span class=\"number\">0</span>] == raspberryPosition[<span class=\"number\">0</span>] <span class=\"keyword\">and</span> snakePosition[<span class=\"number\">1</span>] == raspberryPosition[<span class=\"number\">1</span>]:</span><br><span class=\"line\">            raspberrySpawned = <span class=\"number\">0</span></span><br><span class=\"line\">        <span class=\"keyword\">else</span>:</span><br><span class=\"line\">            snakeSegments.pop()</span><br><span class=\"line\">       </span><br><span class=\"line\">        <span class=\"keyword\">if</span> raspberrySpawned == <span class=\"number\">0</span>:</span><br><span class=\"line\">            x = random.randrange(<span class=\"number\">1</span>,<span class=\"number\">32</span>)</span><br><span class=\"line\">            y = random.randrange(<span class=\"number\">1</span>,<span class=\"number\">24</span>)</span><br><span class=\"line\">            raspberryPosition = [int(x*<span class=\"number\">20</span>),int(y*<span class=\"number\">20</span>)]</span><br><span class=\"line\">            raspberrySpawned = <span class=\"number\">1</span></span><br><span class=\"line\">      </span><br><span class=\"line\">        playSurface.fill(blackColour)</span><br><span class=\"line\">        <span class=\"keyword\">for</span> position <span class=\"keyword\">in</span> snakeSegments:</span><br><span class=\"line\">            pygame.draw.rect(playSurface,whiteColour,Rect(position[<span class=\"number\">0</span>],position[<span class=\"number\">1</span>],<span class=\"number\">20</span>,<span class=\"number\">20</span>))</span><br><span class=\"line\">            pygame.draw.rect(playSurface,redColour,Rect(raspberryPosition[<span class=\"number\">0</span>], raspberryPosition[<span class=\"number\">1</span>],<span class=\"number\">20</span>,<span class=\"number\">20</span>))</span><br><span class=\"line\"></span><br><span class=\"line\">        pygame.display.flip()</span><br><span class=\"line\">       </span><br><span class=\"line\">        <span class=\"keyword\">if</span> snakePosition[<span class=\"number\">0</span>] &gt; <span class=\"number\">620</span> <span class=\"keyword\">or</span> snakePosition[<span class=\"number\">0</span>] &lt; <span class=\"number\">0</span>:</span><br><span class=\"line\">            gameOver(playSurface)</span><br><span class=\"line\">        <span class=\"keyword\">if</span> snakePosition[<span class=\"number\">1</span>] &gt; <span class=\"number\">460</span> <span class=\"keyword\">or</span> snakePosition[<span class=\"number\">1</span>] &lt; <span class=\"number\">0</span>:</span><br><span class=\"line\">            <span class=\"keyword\">for</span> snakeBody <span class=\"keyword\">in</span> snakeSegments[<span class=\"number\">1</span>:]:</span><br><span class=\"line\">                <span class=\"keyword\">if</span> snakePosition[<span class=\"number\">0</span>] == snakeBody[<span class=\"number\">0</span>] <span class=\"keyword\">and</span> snakePosition[<span class=\"number\">1</span>] == snakeBody[<span class=\"number\">1</span>]:</span><br><span class=\"line\">                    gameOver(playSurface)</span><br><span class=\"line\">       </span><br><span class=\"line\">        fpsClock.tick(<span class=\"number\">5</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">if</span> __name__ == <span class=\"string\">\"__main__\"</span>:</span><br><span class=\"line\">    main()</span><br></pre></td></tr></table></figure></p>\n","site":{"data":{}},"excerpt":"<blockquote class=\"blockquote-center\"><p>Life is short,I use Python!</p>\n</blockquote>\n<h1 id=\"1-学习准备\"><a href=\"#1-学习准备\" class=\"headerlink\" title=\"1 学习准备\"></a>1 学习准备</h1><h2 id=\"1-1-环境\"><a href=\"#1-1-环境\" class=\"headerlink\" title=\"1.1 环境\"></a>1.1 环境</h2>","more":"<ul>\n<li>学习环境：<a href=\"https://repo.continuum.io/archive/Anaconda3-5.0.0.1-Linux-x86_64.sh\" target=\"_blank\" rel=\"noopener\">Anaconda 5.0.0</a></li>\n<li>编辑器：<a href=\"https://www.sublimetext.com/\" target=\"_blank\" rel=\"noopener\">sublime text 3143</a></li>\n<li>虚拟机：<a href=\"http://sw.bos.baidu.com/sw-search-sp/software/aff3469fe5f99/VMware-workstation-full-12.5.7.20721.exe\" target=\"_blank\" rel=\"noopener\">VMwarePro 12</a></li>\n<li>Linux镜像：<a href=\"http://blog.csdn.net/zhu_xun/article/details/16921413\" target=\"_blank\" rel=\"noopener\">Ubuntu 16.04</a></li>\n</ul>\n<h2 id=\"1-2-基础知识\"><a href=\"#1-2-基础知识\" class=\"headerlink\" title=\"1.2 基础知识\"></a>1.2 基础知识</h2><ul>\n<li>Python介绍:<a href=\"https://baike.baidu.com/item/Python/407313\" target=\"_blank\" rel=\"noopener\">中</a>     <a href=\"https://en.wikipedia.org/wiki/Python_%28programming_language%29\" target=\"_blank\" rel=\"noopener\">英</a></li>\n<li>计算机语言类型：<a href=\"http://blog.csdn.net/zhu_xun/article/details/16921413\" target=\"_blank\" rel=\"noopener\">编译型和解释型的区别</a></li>\n</ul>\n<h2 id=\"1-3-学习目标\"><a href=\"#1-3-学习目标\" class=\"headerlink\" title=\"1.3 学习目标\"></a>1.3 学习目标</h2><ul>\n<li>配置Python运行环境，在Anaconda下运行python</li>\n<li>了解Python的基础知识及与其他语言的区别及优势</li>\n<li>学会配置虚拟机，在linux默认环境下运行python</li>\n<li>练习用Python写一个贪吃蛇游戏</li>\n</ul>\n<h2 id=\"1-4-学习资源\"><a href=\"#1-4-学习资源\" class=\"headerlink\" title=\"1.4 学习资源\"></a>1.4 学习资源</h2><ul>\n<li>慕课：<a href=\"http://www.icourse163.org/u/1732151471?userId=4462001\" target=\"_blank\" rel=\"noopener\">嵩天</a></li>\n<li>教程：<a href=\"https://www.liaoxuefeng.com/wiki/0014316089557264a6b348958f449949df42a6d3a2e542c000\" target=\"_blank\" rel=\"noopener\">廖雪峰</a></li>\n<li>参考：<a href=\"https://docs.python.org/3/\" target=\"_blank\" rel=\"noopener\">官方文档</a><h2 id=\"1-5-一个Python实例代码\"><a href=\"#1-5-一个Python实例代码\" class=\"headerlink\" title=\"1.5 一个Python实例代码\"></a>1.5 一个Python实例代码</h2></li>\n</ul>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#Fibonacci series up to n</span></span><br><span class=\"line\"><span class=\"meta\">&gt;&gt;&gt; </span><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">fib</span><span class=\"params\">(n)</span>:</span></span><br><span class=\"line\"><span class=\"meta\">&gt;&gt;&gt; </span>    a, b = <span class=\"number\">0</span>, <span class=\"number\">1</span></span><br><span class=\"line\"><span class=\"meta\">&gt;&gt;&gt; </span>    <span class=\"keyword\">while</span> a &lt; n:</span><br><span class=\"line\"><span class=\"meta\">&gt;&gt;&gt; </span>        print(a, end=<span class=\"string\">' '</span>)</span><br><span class=\"line\"><span class=\"meta\">&gt;&gt;&gt; </span>        a, b = b, a+b</span><br><span class=\"line\"><span class=\"meta\">&gt;&gt;&gt; </span>    print()</span><br><span class=\"line\"><span class=\"meta\">&gt;&gt;&gt; </span>fib(<span class=\"number\">1000</span>)</span><br></pre></td></tr></table></figure>\n<h1 id=\"2-开始\"><a href=\"#2-开始\" class=\"headerlink\" title=\"2 开始\"></a>2 开始</h1><h2 id=\"2-1-前言\"><a href=\"#2-1-前言\" class=\"headerlink\" title=\"2.1 前言\"></a>2.1 前言</h2><p>现在切入正题，首先为什么是要学习python？</p>\n<p>首先因为这是个讲求效率的时代，当然这里Python的效率在于其开发效率，可以试下用其他语言写上面的斐波那契数列。在运行效率上依然C/C++是首位，这是毋庸置疑的。然而在计算资源不再是问题的现在，开发效率显得极其重要。Python没有复杂晦涩的语法概念，它更像是为人类语言设计的，更多的面向算法实现而不是考虑底层实现机制，这与C++或者Java有很大不同。就语言本身来看，它始终基于自身不断迭代而不像其他语言不断新增各种各样的库或者包，让开发者应接不暇。当然也由于要“脱胎换骨“，不得不壮士断腕，于是形成2.7和3.x版本不兼容的”脾气“，这一点也让很多人苦恼。</p>\n<p>其次，Python现在太受欢迎了。在今年10月10日召开的<a href=\"https://octoverse.github.com/\" target=\"_blank\" rel=\"noopener\">Github Universe</a>大会上，根据发布的Github Octoverse报告显示，Python已代替Java从去年的第三突进到了第二（第一是js），新增了40%的Pull。不是我们追风，而是在很多开源项目中，越来越多的开发者选择使用Python，尤其是一些大公司(联盟)主导的开源项目，例如被fork最多的TensorFlow（谷歌开发的深度学习平台），开发者不可避免的要去使用进而也就必须要学习。这是一个提高语言热度的良性循环。<br><img src=\"http://upload-images.jianshu.io/upload_images/3234038-ceab477152c9aa36.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240\" alt=\"语言排行\"><br>因而，正如本文开始提到的，越来越多的开发者在感慨”人生苦短“了。</p>\n<p>然后是Python能干什么？</p>\n<p>在此之前，听说过爬虫、图像处理，对，如果使用python编写，这将变得十分容易。在研究领域，Python可以很快的将算法付诸实现，从而让研究者有更多精力去测试并改进算法而不必把时间耗费在语言工具上，这也正是在机器学习领域python更受欢迎的原因。</p>\n<h2 id=\"2-1-准备\"><a href=\"#2-1-准备\" class=\"headerlink\" title=\"2.1 准备\"></a>2.1 准备</h2><h3 id=\"2-1-1-安装环境\"><a href=\"#2-1-1-安装环境\" class=\"headerlink\" title=\"2.1.1 安装环境\"></a>2.1.1 安装环境</h3><p>主要分为两种，</p>\n<ul>\n<li>在windows64平台上,集成了<code>python3.6</code>的<a href=\"https://docs.anaconda.com/anaconda/install/windows\" target=\"_blank\" rel=\"noopener\">Anaconda</a>。点击查看安装步骤，也可以参考<a href=\"https://jingyan.baidu.com/article/7908e85c9e4725af481ad2e2.html\" target=\"_blank\" rel=\"noopener\">这个</a>不过不全面。<br><strong>注意</strong>：不用勾选add to environment path和register to …,安装路径不要含中文、空格(这些都在官方文档有所说明)</li>\n<li>在Ubuntu16.04平台上，内置的<code>python2.7</code>。在此之前需要先安装<a href=\"https://jingyan.baidu.com/article/c275f6ba07e269e33d756714.html\" target=\"_blank\" rel=\"noopener\">VMware</a>,一个虚拟机软件，便于在win平台上运行ubuntu系统。或者也可以选择安装双系统，<del>当然目前不推荐</del>。<strong>注意</strong>：一般会遇到两个问题，<a href=\"https://jingyan.baidu.com/article/3065b3b6e8dedabecff8a435.html\" target=\"_blank\" rel=\"noopener\">安装VMtools</a>用于与主机的文件交互，<a href=\"http://blog.csdn.net/jjmjeffrey/article/details/54972676\" target=\"_blank\" rel=\"noopener\">网络无法连接</a>。</li>\n</ul>\n<p>其实也可以在一个平台上配置两种版本的环境，不过在当前只是入门的情况下，还是隔离开学习比较好。使用Ubuntu也可以顺便学习linux的基本操作</p>\n<p>测试已正确安装</p>\n<ul>\n<li><p>win:找到Anaconda prompt右键管理员运行，键入<code>python</code>,出现欢迎语和版本，前面提示符变为&gt;&gt;,试一下：</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&gt;&gt;&gt;<span class=\"keyword\">print</span> <span class=\"string\">\"hello python\"</span></span><br><span class=\"line\"><span class=\"comment\">#有结果即安装成功。</span></span><br></pre></td></tr></table></figure>\n</li>\n<li><p>linux:左上方找到terminal，键入<code>python</code>,出现欢迎语和版本,前面提示符变为&gt;&gt;,试一下：</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&gt;&gt;&gt;<span class=\"keyword\">print</span> <span class=\"string\">\"hello ubuntu\"</span></span><br><span class=\"line\"><span class=\"comment\">#有结果即安装成功。</span></span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<h3 id=\"2-1-2-安装sublime\"><a href=\"#2-1-2-安装sublime\" class=\"headerlink\" title=\"2.1.2 安装sublime\"></a>2.1.2 安装sublime</h3><ul>\n<li>win:直接下载安装，默认到底</li>\n<li>linux:通过apt方式安装</li>\n</ul>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">~$ wget -qO - https://download.sublimetext.com/sublimehq-pub.gpg | sudo apt-key add -</span><br><span class=\"line\">~$ sudo apt-get install apt-transport-https</span><br><span class=\"line\">~$ echo &quot;deb https://download.sublimetext.com/ apt/stable/&quot; | sudo tee /etc/apt/sources.list.d/sublime-text.list</span><br><span class=\"line\">~$ sudo apt-get update</span><br><span class=\"line\">~$ sudo apt-get install sublime-text</span><br></pre></td></tr></table></figure>\n<h2 id=\"2-2-学习基本知识\"><a href=\"#2-2-学习基本知识\" class=\"headerlink\" title=\"2.2 学习基本知识\"></a>2.2 学习基本知识</h2><p>一般学习一门语言，都会从运行机制然后是基础语法入手。为了便于语言选择的迁移，几乎所有语言的基础语法都是类似的，如变量类型、逻辑关系、逻辑式等等，接着是函数定义。因此如果已经系统学习过一门语言，上手其他是很容易的。<br>学习基础语法还是要参考<a href=\"https://docs.python.org/3/tutorial/index.html\" target=\"_blank\" rel=\"noopener\">官方文档</a>,更加细致权威，读取差异即可。</p>\n<h2 id=\"2-3练手\"><a href=\"#2-3练手\" class=\"headerlink\" title=\"2.3练手\"></a>2.3练手</h2><ul>\n<li>爬虫:一个<a href=\"http://www.ehcoblog.ml/post/1/\" target=\"_blank\" rel=\"noopener\">系列</a></li>\n<li>web编程:一个<a href=\"https://zhuanlan.zhihu.com/p/29685446\" target=\"_blank\" rel=\"noopener\">专栏</a></li>\n<li>游戏：实现<a href=\"http://eyehere.net/2011/python-pygame-novice-professional-index/\" target=\"_blank\" rel=\"noopener\">贪吃蛇游戏</a></li>\n</ul>\n<p>以贪吃蛇游戏为实现样例。</p>\n<h3 id=\"2-3-1-基本环境\"><a href=\"#2-3-1-基本环境\" class=\"headerlink\" title=\"2.3.1 基本环境\"></a>2.3.1 基本环境</h3><ul>\n<li>系统：Ubuntu16.04</li>\n<li>版本：Python2.7</li>\n<li>第三方库：pygame1.9.3</li>\n<li>编辑器：sublime text3143</li>\n<li>效果如图</li>\n</ul>\n<p><img src=\"http://upload-images.jianshu.io/upload_images/3234038-53f09a7f69439dc5.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240\" alt=\"贪吃蛇\"></p>\n<ul>\n<li>操作方法：<br>上下左右键或wsad键控制<br>ESC键退出游戏</li>\n</ul>\n<h3 id=\"2-3-2-练习\"><a href=\"#2-3-2-练习\" class=\"headerlink\" title=\"2.3.2 练习\"></a>2.3.2 练习</h3><p><strong>注意</strong>：安装库需要pip方式，打开terminal,键入：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">~$ sudo apt-get install python-pip</span><br><span class=\"line\">~$ sudo apt-get install python-pip python-dev</span><br><span class=\"line\">~$ sudo pip install --upgrade pip</span><br><span class=\"line\">#确认安装好pip：</span><br><span class=\"line\">~$ pip -V</span><br><span class=\"line\">#会出现版本号即pip安装成功</span><br><span class=\"line\">~$ pip install pygame</span><br></pre></td></tr></table></figure></p>\n<p>进入python终端<br><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&gt;&gt;&gt;<span class=\"keyword\">import</span> pygame</span><br><span class=\"line\">&gt;&gt;&gt;<span class=\"keyword\">print</span> pygame.ver</span><br><span class=\"line\"><span class=\"comment\">##可看到版本号成功</span></span><br></pre></td></tr></table></figure></p>\n<p>可以继续在解释器终端编写；也可以先写好snake.py脚本（用sublime,也可以用vim，推荐前者），然后在命令行用<code>python snake.py</code>执行<br><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># snake.py</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> pygame,sys,time,random</span><br><span class=\"line\"><span class=\"keyword\">from</span> pygame.locals <span class=\"keyword\">import</span> *</span><br><span class=\"line\"></span><br><span class=\"line\">redColour = pygame.Color(<span class=\"number\">255</span>,<span class=\"number\">0</span>,<span class=\"number\">0</span>)</span><br><span class=\"line\">blackColour = pygame.Color(<span class=\"number\">0</span>,<span class=\"number\">0</span>,<span class=\"number\">0</span>)</span><br><span class=\"line\">whiteColour = pygame.Color(<span class=\"number\">255</span>,<span class=\"number\">255</span>,<span class=\"number\">255</span>)</span><br><span class=\"line\">greyColour = pygame.Color(<span class=\"number\">150</span>,<span class=\"number\">150</span>,<span class=\"number\">150</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">gameOver</span><span class=\"params\">(playSurface)</span>:</span></span><br><span class=\"line\">    gameOverFont = font = pygame.font.SysFont(<span class=\"literal\">None</span>, <span class=\"number\">48</span>)</span><br><span class=\"line\">    gameOverSurf = gameOverFont.render(<span class=\"string\">'Game Over'</span>, <span class=\"literal\">True</span>, greyColour)</span><br><span class=\"line\">    gameOverRect = gameOverSurf.get_rect()</span><br><span class=\"line\">    gameOverRect.midtop = (<span class=\"number\">320</span>, <span class=\"number\">10</span>)</span><br><span class=\"line\">    playSurface.blit(gameOverSurf, gameOverRect)</span><br><span class=\"line\">    pygame.display.flip()</span><br><span class=\"line\">    time.sleep(<span class=\"number\">5</span>)</span><br><span class=\"line\">    pygame.quit()</span><br><span class=\"line\">    sys.exit()</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">main</span><span class=\"params\">()</span>:</span></span><br><span class=\"line\">  </span><br><span class=\"line\">    pygame.init()</span><br><span class=\"line\">    pygame.font.init()</span><br><span class=\"line\">    fpsClock = pygame.time.Clock()</span><br><span class=\"line\">   </span><br><span class=\"line\">    playSurface = pygame.display.set_mode((<span class=\"number\">640</span>,<span class=\"number\">480</span>))</span><br><span class=\"line\">    pygame.display.set_caption(<span class=\"string\">'Raspberry Snake'</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">    snakePosition = [<span class=\"number\">100</span>,<span class=\"number\">100</span>]</span><br><span class=\"line\">    snakeSegments = [[<span class=\"number\">100</span>,<span class=\"number\">100</span>],[<span class=\"number\">80</span>,<span class=\"number\">100</span>],[<span class=\"number\">60</span>,<span class=\"number\">100</span>]]</span><br><span class=\"line\">    raspberryPosition = [<span class=\"number\">300</span>,<span class=\"number\">300</span>]</span><br><span class=\"line\">    raspberrySpawned = <span class=\"number\">1</span></span><br><span class=\"line\">    direction = <span class=\"string\">'right'</span></span><br><span class=\"line\">    changeDirection = direction</span><br><span class=\"line\">    <span class=\"keyword\">while</span> <span class=\"literal\">True</span>:</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"keyword\">for</span> event <span class=\"keyword\">in</span> pygame.event.get():</span><br><span class=\"line\">            <span class=\"keyword\">if</span> event.type == QUIT:</span><br><span class=\"line\">                pygame.quit()</span><br><span class=\"line\">                sys.exit()</span><br><span class=\"line\">            <span class=\"keyword\">elif</span> event.type == KEYDOWN:</span><br><span class=\"line\">                </span><br><span class=\"line\">                <span class=\"keyword\">if</span> event.key == K_RIGHT <span class=\"keyword\">or</span> event.key == ord(<span class=\"string\">'d'</span>):</span><br><span class=\"line\">                    changeDirection = <span class=\"string\">'right'</span></span><br><span class=\"line\">                <span class=\"keyword\">if</span> event.key == K_LEFT <span class=\"keyword\">or</span> event.key == ord(<span class=\"string\">'a'</span>):</span><br><span class=\"line\">                    changeDirection = <span class=\"string\">'left'</span></span><br><span class=\"line\">                <span class=\"keyword\">if</span> event.key == K_UP <span class=\"keyword\">or</span> event.key == ord(<span class=\"string\">'w'</span>):</span><br><span class=\"line\">                    changeDirection = <span class=\"string\">'up'</span></span><br><span class=\"line\">                <span class=\"keyword\">if</span> event.key == K_DOWN <span class=\"keyword\">or</span> event.key == ord(<span class=\"string\">'s'</span>):</span><br><span class=\"line\">                    changeDirection = <span class=\"string\">'down'</span></span><br><span class=\"line\">                <span class=\"keyword\">if</span> event.key == K_ESCAPE:</span><br><span class=\"line\">                    pygame.event.post(pygame.event.Event(QUIT))</span><br><span class=\"line\">       </span><br><span class=\"line\">        <span class=\"keyword\">if</span> changeDirection == <span class=\"string\">'right'</span> <span class=\"keyword\">and</span> <span class=\"keyword\">not</span> direction == <span class=\"string\">'left'</span>:</span><br><span class=\"line\">            direction = changeDirection</span><br><span class=\"line\">        <span class=\"keyword\">if</span> changeDirection == <span class=\"string\">'left'</span> <span class=\"keyword\">and</span> <span class=\"keyword\">not</span> direction == <span class=\"string\">'right'</span>:</span><br><span class=\"line\">            direction = changeDirection</span><br><span class=\"line\">        <span class=\"keyword\">if</span> changeDirection == <span class=\"string\">'up'</span> <span class=\"keyword\">and</span> <span class=\"keyword\">not</span> direction == <span class=\"string\">'down'</span>:</span><br><span class=\"line\">            direction = changeDirection</span><br><span class=\"line\">        <span class=\"keyword\">if</span> changeDirection == <span class=\"string\">'down'</span> <span class=\"keyword\">and</span> <span class=\"keyword\">not</span> direction == <span class=\"string\">'up'</span>:</span><br><span class=\"line\">            direction = changeDirection</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"keyword\">if</span> direction == <span class=\"string\">'right'</span>:</span><br><span class=\"line\">            snakePosition[<span class=\"number\">0</span>] += <span class=\"number\">20</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> direction == <span class=\"string\">'left'</span>:</span><br><span class=\"line\">            snakePosition[<span class=\"number\">0</span>] -= <span class=\"number\">20</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> direction == <span class=\"string\">'up'</span>:</span><br><span class=\"line\">            snakePosition[<span class=\"number\">1</span>] -= <span class=\"number\">20</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> direction == <span class=\"string\">'down'</span>:</span><br><span class=\"line\">            snakePosition[<span class=\"number\">1</span>] += <span class=\"number\">20</span></span><br><span class=\"line\">      </span><br><span class=\"line\">        snakeSegments.insert(<span class=\"number\">0</span>,list(snakePosition))</span><br><span class=\"line\">       </span><br><span class=\"line\">        <span class=\"keyword\">if</span> snakePosition[<span class=\"number\">0</span>] == raspberryPosition[<span class=\"number\">0</span>] <span class=\"keyword\">and</span> snakePosition[<span class=\"number\">1</span>] == raspberryPosition[<span class=\"number\">1</span>]:</span><br><span class=\"line\">            raspberrySpawned = <span class=\"number\">0</span></span><br><span class=\"line\">        <span class=\"keyword\">else</span>:</span><br><span class=\"line\">            snakeSegments.pop()</span><br><span class=\"line\">       </span><br><span class=\"line\">        <span class=\"keyword\">if</span> raspberrySpawned == <span class=\"number\">0</span>:</span><br><span class=\"line\">            x = random.randrange(<span class=\"number\">1</span>,<span class=\"number\">32</span>)</span><br><span class=\"line\">            y = random.randrange(<span class=\"number\">1</span>,<span class=\"number\">24</span>)</span><br><span class=\"line\">            raspberryPosition = [int(x*<span class=\"number\">20</span>),int(y*<span class=\"number\">20</span>)]</span><br><span class=\"line\">            raspberrySpawned = <span class=\"number\">1</span></span><br><span class=\"line\">      </span><br><span class=\"line\">        playSurface.fill(blackColour)</span><br><span class=\"line\">        <span class=\"keyword\">for</span> position <span class=\"keyword\">in</span> snakeSegments:</span><br><span class=\"line\">            pygame.draw.rect(playSurface,whiteColour,Rect(position[<span class=\"number\">0</span>],position[<span class=\"number\">1</span>],<span class=\"number\">20</span>,<span class=\"number\">20</span>))</span><br><span class=\"line\">            pygame.draw.rect(playSurface,redColour,Rect(raspberryPosition[<span class=\"number\">0</span>], raspberryPosition[<span class=\"number\">1</span>],<span class=\"number\">20</span>,<span class=\"number\">20</span>))</span><br><span class=\"line\"></span><br><span class=\"line\">        pygame.display.flip()</span><br><span class=\"line\">       </span><br><span class=\"line\">        <span class=\"keyword\">if</span> snakePosition[<span class=\"number\">0</span>] &gt; <span class=\"number\">620</span> <span class=\"keyword\">or</span> snakePosition[<span class=\"number\">0</span>] &lt; <span class=\"number\">0</span>:</span><br><span class=\"line\">            gameOver(playSurface)</span><br><span class=\"line\">        <span class=\"keyword\">if</span> snakePosition[<span class=\"number\">1</span>] &gt; <span class=\"number\">460</span> <span class=\"keyword\">or</span> snakePosition[<span class=\"number\">1</span>] &lt; <span class=\"number\">0</span>:</span><br><span class=\"line\">            <span class=\"keyword\">for</span> snakeBody <span class=\"keyword\">in</span> snakeSegments[<span class=\"number\">1</span>:]:</span><br><span class=\"line\">                <span class=\"keyword\">if</span> snakePosition[<span class=\"number\">0</span>] == snakeBody[<span class=\"number\">0</span>] <span class=\"keyword\">and</span> snakePosition[<span class=\"number\">1</span>] == snakeBody[<span class=\"number\">1</span>]:</span><br><span class=\"line\">                    gameOver(playSurface)</span><br><span class=\"line\">       </span><br><span class=\"line\">        fpsClock.tick(<span class=\"number\">5</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">if</span> __name__ == <span class=\"string\">\"__main__\"</span>:</span><br><span class=\"line\">    main()</span><br></pre></td></tr></table></figure></p>"},{"title":"laravel环境配置过程记录","date":"2018-12-26T16:03:00.000Z","_content":"\n## 一、环境配置过程\n### 1.开发环境\n**基本环境:**\n\n本地主机：[![ubuntu](https://img.shields.io/badge/ubuntu-16.04-orange.svg)](https://www.ubuntu.com//)  (amd64 8G RAM)\n<!-- more -->\n已安装环境：\n[![node](https://img.shields.io/badge/npm-6.4.1-orange.png)](https://nodejs.org/zh-cn/) [![git](https://img.shields.io/badge/git-2.7.4-orange.svg)](https://git-scm.com/)[![sublime](https://img.shields.io/badge/sublime-3176-blue.svg)](http://www.sublimetext.com/)\n\n#### 1.1 一点认识：\n开发时会出现本地环境的不确定变数，且一般是唯一的，不利于版本切换。在团队协同中，环境的差异可能导致配合的巨大问题。于是，基于vitual box产生了vagrant,而laravel官方又基于vagrant推出homestead，从而在开发时基于虚拟机工作，本地程序工程映射到虚拟机内，随时可以撤销、共享环境，不会对本地产生影响。这一点认为与python的virtualenv功能类似,也与我《[本地“模拟”一台服务器](https://blog.makergyt.com/2017/11/19/%E6%9C%AC%E5%9C%B0%E2%80%9C%E6%A8%A1%E6%8B%9F%E2%80%9D%E4%B8%80%E5%8F%B0%E6%9C%8D%E5%8A%A1%E5%99%A8/)》中的方式类似。\n\n\n#### 1.2 homestead的安装过程\n根据其依赖关系，需要依次完成vitualbox、vagrant、homestead的安装与配置，由于ubuntu系统基于Debian GNU/Linux，基本可通过deb安装包进行：\n- vitualbox:https://www.virtualbox.org/wiki/Downloads\n- vagrant:https://releases.hashicorp.com/vagrant/2.2.2/vagrant_2.2.2_x86_64.deb\n\n 刚开始采用大部分教程中的`apt-get`方式，但到后边发现这样安装的版本是1.8.1，与homestead不匹配(require >=2.1.0)，于是采用官方的deb。然后加入laravel的盒子:\n```\nvagrant box add laravel/homestead\n```\n\n- homestead:\n```\ngit clone https://github.com/laravel/homestead.git \ncd ~/Homestead \ngit checkout v7.18.0\nbash init.sh\n```\n\n以上是第一次时采用官方的安装文档，但是由于不可避免的网络问题，更重要的是在并不熟悉laravel的情况下，需要将环境过程尽可能简化与透明，于是采用了适用于国情的 Homestead 安装包：http://download.fsdhub.com/lc-homestead-6.1.1-2018090400.zip 。在回滚上述环境后，重新开始安装：【[参考](https://laravel-china.org/index.php/docs/laravel-development-environment/5.7/development-environment-macos/2901#a3c561)】\n```\nvagrant box remove laravel/homestead\n#完全清理上述环境及文件\nwget http://download.fsdhub.com/lc-homestead-6.1.1-2018090400.zip\nunzip lc-homestead-6.1.1-2018090400.zip\ncd lc-homestead-6.1.1-2018090400\nvagrant box add metadata.json\ncd ~\ngit clone https://git.coding.net/summerblue/homestead.git Homestead\ncd ~/Homestead\ngit checkout v7.8.0\nbash init.sh\n```\n#### 1.3 配置homestead.yaml\n```\nsubl ~/Homestead/Homestead.yaml\n```\n- 虚拟机设置：为了便于在同一局域网下在手机端查看效果，这里在配置IP时选择与内网同一网段的，`ifconfig`查得在192.168.0.104，于是设置为`192.168.0.100`，其他默认.\n修改网络设置：\n```\nsudo vim /Homestead/scripts/homestead.rb\n#在第20行改为：\nconfig.vm.network :public_network, ip: settings[\"ip\"] ||= \"192.168.0.100\"\n```\n\n- SSH 秘钥登录：\n```\nls -al ~/.ssh\n-rw-------  1 makergyt makergyt 1679 Nov 30 23:56 id_rsa\n-rw-r--r--  1 makergyt makergyt  406 Nov 30 23:56 id_rsa.pub\n#不需要再生成，如没有需ssh-keygen -t rsa -C \"email\"\n```\n于是补充 `-  ~/.ssh/id_rsa.pub`到`key`\n\n- 共享文件夹配置\n默认后在本地主机上新建code文件夹:\n```\ncd ~\nmkdir code\n```\n\n- 站点配置：\n```\nsites:\n    - map: homestead.test\n      to: /home/vagrant/Code/Laravel/public\n```\n在主机内将域名与IP绑定(即同DNS的作用):\n```\nsudo /etc/hosts\n#最后一行追加：\n192.168.0.100  homestead.test\n```\n\n- 数据库配置：默认，对应的用户名/密码是`homestead/secret`,其实可自行在虚拟机命令行新建\n\n其他均默认\n\n#### 1.4 运行vagrant\n```\npwd\n/home/makergyt/Homestead\nvagrant up\n#开始一段时间根据配置文件新建主机\n#登录\nvagrant ssh\n#退出\nexit\n#关闭homestead(相当于虚拟机关机)\nvagrant halt\n```\n### 2.生产环境\n\n**基本环境**\n\nAliyun ECS：[![ubuntu](https://img.shields.io/badge/ubuntu-16.04-orange.svg)](https://www.ubuntu.com//)  (amd64 1G RAM 1 core CPU)\n\n已安装环境：\n[![node](https://img.shields.io/badge/npm-6.4.1-orange.svg)](https://nodejs.org/zh-cn/) \n[![git](https://img.shields.io/badge/git-2.7.4-orange.svg)](https://git-scm.com/)\n#### 2.1 一点认识\n生产环境与开发环境相反，需要非常稳定，部署后一般不变更。首先需要lnmp配置，这里采用针对laravel的脚本，速度很快，然后需要完成ssl证书安装，这里采用certbort\n#### 2.2 过程\n- 密钥连接：\n```\n# 赋予权限\nchmod 400 xxx.pem\n# 删除旧信息\nssh-keygen -f \"/home/makergyt/.ssh/known_hosts\" -R 112.74.41.209\n# 连接 \nssh -i /makergyt.pem root@112.74.41.209\n```\n- 脚本安装：\n```\nwget -qO- https://raw.githubusercontent.com/summerblue/laravel-ubuntu-init/master/download.sh - | bash\n# 完成后\ncd laravel-ubuntu-init\n./16.04/nginx_add_site.sh\n#项目名即工程文件夹名，会在/var/www下新建\n```\n域名即对应访问此虚拟主机的域名，手头有一台云服务器，一个已经备案的`com`顶级域名,考虑到今后的项目需求，采取解析不同二级域名至同一ECS IP,然后在ECS中新建相应虚拟主机来绑定二级域名。\n\n- ssl证书安装\n```\n$ sudo apt-get update\n$ sudo apt-get install software-properties-common\n$ sudo add-apt-repository universe\n$ sudo add-apt-repository ppa:certbot/certbot\n$ sudo apt-get update\n$ sudo apt-get install python-certbot-nginx \n$ sudo certbot --nginx #这里可检测到已经新建的多个主机并同时安装\n$ sudo certbot renew --dry-run #日后更新\n```\n修改nginx配置文件,,开启80(http)强转443(https)：\n```\npwd \n/etc/nginx/sites-enabled\nsudo vim cloud-doc.conf\n```\n文件如下：\n\n```\nserver{\n    listen 80;\n    server_name cloud-doc.makergyt.com;\n    rewrite ^(.*)$ https://${server_name}$1 permanent; \n}\nserver {\n    listen 443;\n    server_name cloud-doc.makergyt.com;\n    ssl on;\n    ssl_certificate   /etc/letsencrypt/live/makergyt.com/fullchain.pem;\n    ssl_certificate_key  /etc/letsencrypt/live/makergyt.com/privkey.pem;\n    ssl_session_timeout 5m;\n    ssl_ciphers ECDHE-RSA-AES128-GCM-SHA256:ECDHE:ECDH:AES:HIGH:!NULL:!aNULL:!MD5:!ADH:!RC4;\n    ssl_protocols TLSv1 TLSv1.1 TLSv1.2;\n    ssl_prefer_server_ciphers on;\n    index index.html index.htm index.php;\n    charset utf-8;\n    location / {\n        root  /var/www/cloud-doc/public;\n        try_files $uri $uri/ /index.php?$query_string;\n    }\n    location = /favicon.ico { access_log off; log_not_found off; }\n    location = /robots.txt  { access_log off; log_not_found off; }\n    access_log /var/log/nginx/cloud-doc.log;\n    error_log /var/log/nginx/cloud-doc-error.log error;\n    sendfile off;\n    client_max_body_size 100m;\n    location ~ \\.php$ {\n        root  /var/www/cloud-doc/public;\n        fastcgi_split_path_info ^(.+\\.php)(/.+)$;\n        fastcgi_pass unix:/var/run/php/php7.2-fpm.sock;\n        fastcgi_index index.php;\n        include fastcgi_params;\n        fastcgi_param SCRIPT_FILENAME $realpath_root$fastcgi_script_name;\n        fastcgi_param DOCUMENT_ROOT $realpath_root;\n        fastcgi_intercept_errors off;\n        fastcgi_buffer_size 16k;\n        fastcgi_buffers 4 16k;\n        fastcgi_connect_timeout 300;\n        fastcgi_send_timeout 300;\n        fastcgi_read_timeout 300;\n    }\n    location ~ /\\.ht {\n        deny all;\n    }\n}\n\n```\n\n## 二、部署项目\n这里部署一个微信小程序项目【[云文档](https://github.com/MakerGYT/cloud-doc)】\n### 1. 本地测试\n- 新增网站到vagrant主机\n在homestead.yaml中新增site:\n```\nmap: cloud-doc.test\n      to: /home/vagrant/code/cloud-doc/public\n```\n在主机`/etc/hosts`后追加：\n```\n192.168.0.100 cloud-doc.test\n```\n启动vagrant并登录：\n```\nvagrant provision\nvagrant up\nvagrant ssh\n```\n- 在虚拟主机内完成源码下载，数据库相应工作：\n```\ngit clond https://github.com/SmallRuralDog/cloud-doc-server.git /code/cloud-doc\ncd /code/cloudoc\nunzip cloud_doc_server.zip\nmysql -u root -p\nmysql> create database cloudoc; #创建数据库\nmysql> create user 'cloud-doc'@'%' identified by 'cloud-doc';  #创建用户\nmysql> grant all on cloudoc.* to  'cloud-doc'@'%';  #授权\nmysql> flush privileges;\nmysql> use cloudoc;\nmysql> source cloud_doc_server.sql\n```\n修改源码，【[参考](https://github.com/SmallRuralDog/cloud-doc-server)】\n```\nsudo vim /config/database.php\n#采用本地，修改app.php,admin.php中url:\n'http://cloud-doc.test'\n#修改wx.php\n```\n\n- 赋予根目录 storage 目录可写权限：\n```\nchmod -R 777 storage\n```\n在主机访问cloud-doc.test和同局域网下终端访问192.168.100\n\n### 2.部署上线\n\n将修改后的源码传至服务器\n```\nscp -r -i makergyt.pem cloud-doc root@112.74.41.209:/var/www\n```\n在服务器配置数据库、赋予根目录 storage 目录可写权限过程完全一致\n\n### 3.小程序配置\n- 下载源码并修改\n```\ngit clone https://github.com/MakerGYT/cloud-doc.git miniprogram\ncd miniprogram \nsudo vim app.js\n#修改请求域名\nconst HOST = \"https://cloud-doc.makergyt.com\";\n```\n同时将此域名在小程序平台开发设置中更新修改\n\n### 4.测试\n小程序可正常通过请求api获取文档信息，但是用户无法登录，经检查，提示错误：\n```\nCall to undefined function App\\Extend\\WxApp\\mcrypt_module_open()\n```\n是因为mcrypt_module_open()函数在7.1中被贬低，将在7.2中被移除，要用openssl_decrypt()函数代替，参考https://blog.csdn.net/haibo_j/article/details/80759706 将`app/Extend/WxApp/Prpcrypt.php`中第35~42行修改为：\n```\n$decrypted = openssl_decrypt($aesCipher, 'AES-256-CBC', $this->key, OPENSSL_RAW_DATA|OPENSSL_ZERO_PADDING, $aesIV);\n```\n不再报错，但仍无法登录，需进一步检查源码","source":"_posts/zh-CN/laravel环境配置过程记录.md","raw":"---\ntitle: laravel环境配置过程记录\ntags:\n  - php\n  - Laravel\ncategories: record\ndate: 2018-12-27 00:03:00\n---\n\n## 一、环境配置过程\n### 1.开发环境\n**基本环境:**\n\n本地主机：[![ubuntu](https://img.shields.io/badge/ubuntu-16.04-orange.svg)](https://www.ubuntu.com//)  (amd64 8G RAM)\n<!-- more -->\n已安装环境：\n[![node](https://img.shields.io/badge/npm-6.4.1-orange.png)](https://nodejs.org/zh-cn/) [![git](https://img.shields.io/badge/git-2.7.4-orange.svg)](https://git-scm.com/)[![sublime](https://img.shields.io/badge/sublime-3176-blue.svg)](http://www.sublimetext.com/)\n\n#### 1.1 一点认识：\n开发时会出现本地环境的不确定变数，且一般是唯一的，不利于版本切换。在团队协同中，环境的差异可能导致配合的巨大问题。于是，基于vitual box产生了vagrant,而laravel官方又基于vagrant推出homestead，从而在开发时基于虚拟机工作，本地程序工程映射到虚拟机内，随时可以撤销、共享环境，不会对本地产生影响。这一点认为与python的virtualenv功能类似,也与我《[本地“模拟”一台服务器](https://blog.makergyt.com/2017/11/19/%E6%9C%AC%E5%9C%B0%E2%80%9C%E6%A8%A1%E6%8B%9F%E2%80%9D%E4%B8%80%E5%8F%B0%E6%9C%8D%E5%8A%A1%E5%99%A8/)》中的方式类似。\n\n\n#### 1.2 homestead的安装过程\n根据其依赖关系，需要依次完成vitualbox、vagrant、homestead的安装与配置，由于ubuntu系统基于Debian GNU/Linux，基本可通过deb安装包进行：\n- vitualbox:https://www.virtualbox.org/wiki/Downloads\n- vagrant:https://releases.hashicorp.com/vagrant/2.2.2/vagrant_2.2.2_x86_64.deb\n\n 刚开始采用大部分教程中的`apt-get`方式，但到后边发现这样安装的版本是1.8.1，与homestead不匹配(require >=2.1.0)，于是采用官方的deb。然后加入laravel的盒子:\n```\nvagrant box add laravel/homestead\n```\n\n- homestead:\n```\ngit clone https://github.com/laravel/homestead.git \ncd ~/Homestead \ngit checkout v7.18.0\nbash init.sh\n```\n\n以上是第一次时采用官方的安装文档，但是由于不可避免的网络问题，更重要的是在并不熟悉laravel的情况下，需要将环境过程尽可能简化与透明，于是采用了适用于国情的 Homestead 安装包：http://download.fsdhub.com/lc-homestead-6.1.1-2018090400.zip 。在回滚上述环境后，重新开始安装：【[参考](https://laravel-china.org/index.php/docs/laravel-development-environment/5.7/development-environment-macos/2901#a3c561)】\n```\nvagrant box remove laravel/homestead\n#完全清理上述环境及文件\nwget http://download.fsdhub.com/lc-homestead-6.1.1-2018090400.zip\nunzip lc-homestead-6.1.1-2018090400.zip\ncd lc-homestead-6.1.1-2018090400\nvagrant box add metadata.json\ncd ~\ngit clone https://git.coding.net/summerblue/homestead.git Homestead\ncd ~/Homestead\ngit checkout v7.8.0\nbash init.sh\n```\n#### 1.3 配置homestead.yaml\n```\nsubl ~/Homestead/Homestead.yaml\n```\n- 虚拟机设置：为了便于在同一局域网下在手机端查看效果，这里在配置IP时选择与内网同一网段的，`ifconfig`查得在192.168.0.104，于是设置为`192.168.0.100`，其他默认.\n修改网络设置：\n```\nsudo vim /Homestead/scripts/homestead.rb\n#在第20行改为：\nconfig.vm.network :public_network, ip: settings[\"ip\"] ||= \"192.168.0.100\"\n```\n\n- SSH 秘钥登录：\n```\nls -al ~/.ssh\n-rw-------  1 makergyt makergyt 1679 Nov 30 23:56 id_rsa\n-rw-r--r--  1 makergyt makergyt  406 Nov 30 23:56 id_rsa.pub\n#不需要再生成，如没有需ssh-keygen -t rsa -C \"email\"\n```\n于是补充 `-  ~/.ssh/id_rsa.pub`到`key`\n\n- 共享文件夹配置\n默认后在本地主机上新建code文件夹:\n```\ncd ~\nmkdir code\n```\n\n- 站点配置：\n```\nsites:\n    - map: homestead.test\n      to: /home/vagrant/Code/Laravel/public\n```\n在主机内将域名与IP绑定(即同DNS的作用):\n```\nsudo /etc/hosts\n#最后一行追加：\n192.168.0.100  homestead.test\n```\n\n- 数据库配置：默认，对应的用户名/密码是`homestead/secret`,其实可自行在虚拟机命令行新建\n\n其他均默认\n\n#### 1.4 运行vagrant\n```\npwd\n/home/makergyt/Homestead\nvagrant up\n#开始一段时间根据配置文件新建主机\n#登录\nvagrant ssh\n#退出\nexit\n#关闭homestead(相当于虚拟机关机)\nvagrant halt\n```\n### 2.生产环境\n\n**基本环境**\n\nAliyun ECS：[![ubuntu](https://img.shields.io/badge/ubuntu-16.04-orange.svg)](https://www.ubuntu.com//)  (amd64 1G RAM 1 core CPU)\n\n已安装环境：\n[![node](https://img.shields.io/badge/npm-6.4.1-orange.svg)](https://nodejs.org/zh-cn/) \n[![git](https://img.shields.io/badge/git-2.7.4-orange.svg)](https://git-scm.com/)\n#### 2.1 一点认识\n生产环境与开发环境相反，需要非常稳定，部署后一般不变更。首先需要lnmp配置，这里采用针对laravel的脚本，速度很快，然后需要完成ssl证书安装，这里采用certbort\n#### 2.2 过程\n- 密钥连接：\n```\n# 赋予权限\nchmod 400 xxx.pem\n# 删除旧信息\nssh-keygen -f \"/home/makergyt/.ssh/known_hosts\" -R 112.74.41.209\n# 连接 \nssh -i /makergyt.pem root@112.74.41.209\n```\n- 脚本安装：\n```\nwget -qO- https://raw.githubusercontent.com/summerblue/laravel-ubuntu-init/master/download.sh - | bash\n# 完成后\ncd laravel-ubuntu-init\n./16.04/nginx_add_site.sh\n#项目名即工程文件夹名，会在/var/www下新建\n```\n域名即对应访问此虚拟主机的域名，手头有一台云服务器，一个已经备案的`com`顶级域名,考虑到今后的项目需求，采取解析不同二级域名至同一ECS IP,然后在ECS中新建相应虚拟主机来绑定二级域名。\n\n- ssl证书安装\n```\n$ sudo apt-get update\n$ sudo apt-get install software-properties-common\n$ sudo add-apt-repository universe\n$ sudo add-apt-repository ppa:certbot/certbot\n$ sudo apt-get update\n$ sudo apt-get install python-certbot-nginx \n$ sudo certbot --nginx #这里可检测到已经新建的多个主机并同时安装\n$ sudo certbot renew --dry-run #日后更新\n```\n修改nginx配置文件,,开启80(http)强转443(https)：\n```\npwd \n/etc/nginx/sites-enabled\nsudo vim cloud-doc.conf\n```\n文件如下：\n\n```\nserver{\n    listen 80;\n    server_name cloud-doc.makergyt.com;\n    rewrite ^(.*)$ https://${server_name}$1 permanent; \n}\nserver {\n    listen 443;\n    server_name cloud-doc.makergyt.com;\n    ssl on;\n    ssl_certificate   /etc/letsencrypt/live/makergyt.com/fullchain.pem;\n    ssl_certificate_key  /etc/letsencrypt/live/makergyt.com/privkey.pem;\n    ssl_session_timeout 5m;\n    ssl_ciphers ECDHE-RSA-AES128-GCM-SHA256:ECDHE:ECDH:AES:HIGH:!NULL:!aNULL:!MD5:!ADH:!RC4;\n    ssl_protocols TLSv1 TLSv1.1 TLSv1.2;\n    ssl_prefer_server_ciphers on;\n    index index.html index.htm index.php;\n    charset utf-8;\n    location / {\n        root  /var/www/cloud-doc/public;\n        try_files $uri $uri/ /index.php?$query_string;\n    }\n    location = /favicon.ico { access_log off; log_not_found off; }\n    location = /robots.txt  { access_log off; log_not_found off; }\n    access_log /var/log/nginx/cloud-doc.log;\n    error_log /var/log/nginx/cloud-doc-error.log error;\n    sendfile off;\n    client_max_body_size 100m;\n    location ~ \\.php$ {\n        root  /var/www/cloud-doc/public;\n        fastcgi_split_path_info ^(.+\\.php)(/.+)$;\n        fastcgi_pass unix:/var/run/php/php7.2-fpm.sock;\n        fastcgi_index index.php;\n        include fastcgi_params;\n        fastcgi_param SCRIPT_FILENAME $realpath_root$fastcgi_script_name;\n        fastcgi_param DOCUMENT_ROOT $realpath_root;\n        fastcgi_intercept_errors off;\n        fastcgi_buffer_size 16k;\n        fastcgi_buffers 4 16k;\n        fastcgi_connect_timeout 300;\n        fastcgi_send_timeout 300;\n        fastcgi_read_timeout 300;\n    }\n    location ~ /\\.ht {\n        deny all;\n    }\n}\n\n```\n\n## 二、部署项目\n这里部署一个微信小程序项目【[云文档](https://github.com/MakerGYT/cloud-doc)】\n### 1. 本地测试\n- 新增网站到vagrant主机\n在homestead.yaml中新增site:\n```\nmap: cloud-doc.test\n      to: /home/vagrant/code/cloud-doc/public\n```\n在主机`/etc/hosts`后追加：\n```\n192.168.0.100 cloud-doc.test\n```\n启动vagrant并登录：\n```\nvagrant provision\nvagrant up\nvagrant ssh\n```\n- 在虚拟主机内完成源码下载，数据库相应工作：\n```\ngit clond https://github.com/SmallRuralDog/cloud-doc-server.git /code/cloud-doc\ncd /code/cloudoc\nunzip cloud_doc_server.zip\nmysql -u root -p\nmysql> create database cloudoc; #创建数据库\nmysql> create user 'cloud-doc'@'%' identified by 'cloud-doc';  #创建用户\nmysql> grant all on cloudoc.* to  'cloud-doc'@'%';  #授权\nmysql> flush privileges;\nmysql> use cloudoc;\nmysql> source cloud_doc_server.sql\n```\n修改源码，【[参考](https://github.com/SmallRuralDog/cloud-doc-server)】\n```\nsudo vim /config/database.php\n#采用本地，修改app.php,admin.php中url:\n'http://cloud-doc.test'\n#修改wx.php\n```\n\n- 赋予根目录 storage 目录可写权限：\n```\nchmod -R 777 storage\n```\n在主机访问cloud-doc.test和同局域网下终端访问192.168.100\n\n### 2.部署上线\n\n将修改后的源码传至服务器\n```\nscp -r -i makergyt.pem cloud-doc root@112.74.41.209:/var/www\n```\n在服务器配置数据库、赋予根目录 storage 目录可写权限过程完全一致\n\n### 3.小程序配置\n- 下载源码并修改\n```\ngit clone https://github.com/MakerGYT/cloud-doc.git miniprogram\ncd miniprogram \nsudo vim app.js\n#修改请求域名\nconst HOST = \"https://cloud-doc.makergyt.com\";\n```\n同时将此域名在小程序平台开发设置中更新修改\n\n### 4.测试\n小程序可正常通过请求api获取文档信息，但是用户无法登录，经检查，提示错误：\n```\nCall to undefined function App\\Extend\\WxApp\\mcrypt_module_open()\n```\n是因为mcrypt_module_open()函数在7.1中被贬低，将在7.2中被移除，要用openssl_decrypt()函数代替，参考https://blog.csdn.net/haibo_j/article/details/80759706 将`app/Extend/WxApp/Prpcrypt.php`中第35~42行修改为：\n```\n$decrypted = openssl_decrypt($aesCipher, 'AES-256-CBC', $this->key, OPENSSL_RAW_DATA|OPENSSL_ZERO_PADDING, $aesIV);\n```\n不再报错，但仍无法登录，需进一步检查源码","slug":"laravel环境配置过程记录","published":1,"lang":"zh-CN","updated":"2019-04-29T01:07:50.656Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjvnq7zbm003d7jjx4l1s0ooe","content":"<link rel=\"stylesheet\" class=\"aplayer-secondary-style-marker\" href=\"/assets/css/APlayer.min.css\"><script src=\"/assets/js/APlayer.min.js\" class=\"aplayer-secondary-script-marker\"></script><script class=\"meting-secondary-script-marker\" src=\"/assets/js/Meting.min.js\"></script><link rel=\"stylesheet\" type=\"text/css\" href=\"https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css\"><h2 id=\"一、环境配置过程\"><a href=\"#一、环境配置过程\" class=\"headerlink\" title=\"一、环境配置过程\"></a>一、环境配置过程</h2><h3 id=\"1-开发环境\"><a href=\"#1-开发环境\" class=\"headerlink\" title=\"1.开发环境\"></a>1.开发环境</h3><p><strong>基本环境:</strong></p>\n<p>本地主机：<a href=\"https://www.ubuntu.com//\" target=\"_blank\" rel=\"noopener\"><img src=\"https://img.shields.io/badge/ubuntu-16.04-orange.svg\" alt=\"ubuntu\"></a>  (amd64 8G RAM)<br><a id=\"more\"></a><br>已安装环境：<br><a href=\"https://nodejs.org/zh-cn/\" target=\"_blank\" rel=\"noopener\"><img src=\"https://img.shields.io/badge/npm-6.4.1-orange.png\" alt=\"node\"></a> <a href=\"https://git-scm.com/\" target=\"_blank\" rel=\"noopener\"><img src=\"https://img.shields.io/badge/git-2.7.4-orange.svg\" alt=\"git\"></a><a href=\"http://www.sublimetext.com/\" target=\"_blank\" rel=\"noopener\"><img src=\"https://img.shields.io/badge/sublime-3176-blue.svg\" alt=\"sublime\"></a></p>\n<h4 id=\"1-1-一点认识：\"><a href=\"#1-1-一点认识：\" class=\"headerlink\" title=\"1.1 一点认识：\"></a>1.1 一点认识：</h4><p>开发时会出现本地环境的不确定变数，且一般是唯一的，不利于版本切换。在团队协同中，环境的差异可能导致配合的巨大问题。于是，基于vitual box产生了vagrant,而laravel官方又基于vagrant推出homestead，从而在开发时基于虚拟机工作，本地程序工程映射到虚拟机内，随时可以撤销、共享环境，不会对本地产生影响。这一点认为与python的virtualenv功能类似,也与我《<a href=\"https://blog.makergyt.com/2017/11/19/%E6%9C%AC%E5%9C%B0%E2%80%9C%E6%A8%A1%E6%8B%9F%E2%80%9D%E4%B8%80%E5%8F%B0%E6%9C%8D%E5%8A%A1%E5%99%A8/\">本地“模拟”一台服务器</a>》中的方式类似。</p>\n<h4 id=\"1-2-homestead的安装过程\"><a href=\"#1-2-homestead的安装过程\" class=\"headerlink\" title=\"1.2 homestead的安装过程\"></a>1.2 homestead的安装过程</h4><p>根据其依赖关系，需要依次完成vitualbox、vagrant、homestead的安装与配置，由于ubuntu系统基于Debian GNU/Linux，基本可通过deb安装包进行：</p>\n<ul>\n<li>vitualbox:<a href=\"https://www.virtualbox.org/wiki/Downloads\" target=\"_blank\" rel=\"noopener\">https://www.virtualbox.org/wiki/Downloads</a></li>\n<li><p>vagrant:<a href=\"https://releases.hashicorp.com/vagrant/2.2.2/vagrant_2.2.2_x86_64.deb\" target=\"_blank\" rel=\"noopener\">https://releases.hashicorp.com/vagrant/2.2.2/vagrant_2.2.2_x86_64.deb</a></p>\n<p>刚开始采用大部分教程中的<code>apt-get</code>方式，但到后边发现这样安装的版本是1.8.1，与homestead不匹配(require &gt;=2.1.0)，于是采用官方的deb。然后加入laravel的盒子:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vagrant box add laravel/homestead</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>homestead:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git clone https://github.com/laravel/homestead.git </span><br><span class=\"line\">cd ~/Homestead </span><br><span class=\"line\">git checkout v7.18.0</span><br><span class=\"line\">bash init.sh</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<p>以上是第一次时采用官方的安装文档，但是由于不可避免的网络问题，更重要的是在并不熟悉laravel的情况下，需要将环境过程尽可能简化与透明，于是采用了适用于国情的 Homestead 安装包：<a href=\"http://download.fsdhub.com/lc-homestead-6.1.1-2018090400.zip\" target=\"_blank\" rel=\"noopener\">http://download.fsdhub.com/lc-homestead-6.1.1-2018090400.zip</a> 。在回滚上述环境后，重新开始安装：【<a href=\"https://laravel-china.org/index.php/docs/laravel-development-environment/5.7/development-environment-macos/2901#a3c561\" target=\"_blank\" rel=\"noopener\">参考</a>】<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vagrant box remove laravel/homestead</span><br><span class=\"line\">#完全清理上述环境及文件</span><br><span class=\"line\">wget http://download.fsdhub.com/lc-homestead-6.1.1-2018090400.zip</span><br><span class=\"line\">unzip lc-homestead-6.1.1-2018090400.zip</span><br><span class=\"line\">cd lc-homestead-6.1.1-2018090400</span><br><span class=\"line\">vagrant box add metadata.json</span><br><span class=\"line\">cd ~</span><br><span class=\"line\">git clone https://git.coding.net/summerblue/homestead.git Homestead</span><br><span class=\"line\">cd ~/Homestead</span><br><span class=\"line\">git checkout v7.8.0</span><br><span class=\"line\">bash init.sh</span><br></pre></td></tr></table></figure></p>\n<h4 id=\"1-3-配置homestead-yaml\"><a href=\"#1-3-配置homestead-yaml\" class=\"headerlink\" title=\"1.3 配置homestead.yaml\"></a>1.3 配置homestead.yaml</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">subl ~/Homestead/Homestead.yaml</span><br></pre></td></tr></table></figure>\n<ul>\n<li><p>虚拟机设置：为了便于在同一局域网下在手机端查看效果，这里在配置IP时选择与内网同一网段的，<code>ifconfig</code>查得在192.168.0.104，于是设置为<code>192.168.0.100</code>，其他默认.<br>修改网络设置：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo vim /Homestead/scripts/homestead.rb</span><br><span class=\"line\">#在第20行改为：</span><br><span class=\"line\">config.vm.network :public_network, ip: settings[&quot;ip&quot;] ||= &quot;192.168.0.100&quot;</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>SSH 秘钥登录：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ls -al ~/.ssh</span><br><span class=\"line\">-rw-------  1 makergyt makergyt 1679 Nov 30 23:56 id_rsa</span><br><span class=\"line\">-rw-r--r--  1 makergyt makergyt  406 Nov 30 23:56 id_rsa.pub</span><br><span class=\"line\">#不需要再生成，如没有需ssh-keygen -t rsa -C &quot;email&quot;</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<p>于是补充 <code>-  ~/.ssh/id_rsa.pub</code>到<code>key</code></p>\n<ul>\n<li><p>共享文件夹配置<br>默认后在本地主机上新建code文件夹:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cd ~</span><br><span class=\"line\">mkdir code</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>站点配置：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sites:</span><br><span class=\"line\">    - map: homestead.test</span><br><span class=\"line\">      to: /home/vagrant/Code/Laravel/public</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<p>在主机内将域名与IP绑定(即同DNS的作用):<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo /etc/hosts</span><br><span class=\"line\">#最后一行追加：</span><br><span class=\"line\">192.168.0.100  homestead.test</span><br></pre></td></tr></table></figure></p>\n<ul>\n<li>数据库配置：默认，对应的用户名/密码是<code>homestead/secret</code>,其实可自行在虚拟机命令行新建</li>\n</ul>\n<p>其他均默认</p>\n<h4 id=\"1-4-运行vagrant\"><a href=\"#1-4-运行vagrant\" class=\"headerlink\" title=\"1.4 运行vagrant\"></a>1.4 运行vagrant</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pwd</span><br><span class=\"line\">/home/makergyt/Homestead</span><br><span class=\"line\">vagrant up</span><br><span class=\"line\">#开始一段时间根据配置文件新建主机</span><br><span class=\"line\">#登录</span><br><span class=\"line\">vagrant ssh</span><br><span class=\"line\">#退出</span><br><span class=\"line\">exit</span><br><span class=\"line\">#关闭homestead(相当于虚拟机关机)</span><br><span class=\"line\">vagrant halt</span><br></pre></td></tr></table></figure>\n<h3 id=\"2-生产环境\"><a href=\"#2-生产环境\" class=\"headerlink\" title=\"2.生产环境\"></a>2.生产环境</h3><p><strong>基本环境</strong></p>\n<p>Aliyun ECS：<a href=\"https://www.ubuntu.com//\" target=\"_blank\" rel=\"noopener\"><img src=\"https://img.shields.io/badge/ubuntu-16.04-orange.svg\" alt=\"ubuntu\"></a>  (amd64 1G RAM 1 core CPU)</p>\n<p>已安装环境：<br><a href=\"https://nodejs.org/zh-cn/\" target=\"_blank\" rel=\"noopener\"><img src=\"https://img.shields.io/badge/npm-6.4.1-orange.svg\" alt=\"node\"></a><br><a href=\"https://git-scm.com/\" target=\"_blank\" rel=\"noopener\"><img src=\"https://img.shields.io/badge/git-2.7.4-orange.svg\" alt=\"git\"></a></p>\n<h4 id=\"2-1-一点认识\"><a href=\"#2-1-一点认识\" class=\"headerlink\" title=\"2.1 一点认识\"></a>2.1 一点认识</h4><p>生产环境与开发环境相反，需要非常稳定，部署后一般不变更。首先需要lnmp配置，这里采用针对laravel的脚本，速度很快，然后需要完成ssl证书安装，这里采用certbort</p>\n<h4 id=\"2-2-过程\"><a href=\"#2-2-过程\" class=\"headerlink\" title=\"2.2 过程\"></a>2.2 过程</h4><ul>\n<li><p>密钥连接：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># 赋予权限</span><br><span class=\"line\">chmod 400 xxx.pem</span><br><span class=\"line\"># 删除旧信息</span><br><span class=\"line\">ssh-keygen -f &quot;/home/makergyt/.ssh/known_hosts&quot; -R 112.74.41.209</span><br><span class=\"line\"># 连接 </span><br><span class=\"line\">ssh -i /makergyt.pem root@112.74.41.209</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>脚本安装：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">wget -qO- https://raw.githubusercontent.com/summerblue/laravel-ubuntu-init/master/download.sh - | bash</span><br><span class=\"line\"># 完成后</span><br><span class=\"line\">cd laravel-ubuntu-init</span><br><span class=\"line\">./16.04/nginx_add_site.sh</span><br><span class=\"line\">#项目名即工程文件夹名，会在/var/www下新建</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<p>域名即对应访问此虚拟主机的域名，手头有一台云服务器，一个已经备案的<code>com</code>顶级域名,考虑到今后的项目需求，采取解析不同二级域名至同一ECS IP,然后在ECS中新建相应虚拟主机来绑定二级域名。</p>\n<ul>\n<li>ssl证书安装<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ sudo apt-get update</span><br><span class=\"line\">$ sudo apt-get install software-properties-common</span><br><span class=\"line\">$ sudo add-apt-repository universe</span><br><span class=\"line\">$ sudo add-apt-repository ppa:certbot/certbot</span><br><span class=\"line\">$ sudo apt-get update</span><br><span class=\"line\">$ sudo apt-get install python-certbot-nginx </span><br><span class=\"line\">$ sudo certbot --nginx #这里可检测到已经新建的多个主机并同时安装</span><br><span class=\"line\">$ sudo certbot renew --dry-run #日后更新</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<p>修改nginx配置文件,,开启80(http)强转443(https)：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pwd </span><br><span class=\"line\">/etc/nginx/sites-enabled</span><br><span class=\"line\">sudo vim cloud-doc.conf</span><br></pre></td></tr></table></figure></p>\n<p>文件如下：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">server&#123;</span><br><span class=\"line\">    listen 80;</span><br><span class=\"line\">    server_name cloud-doc.makergyt.com;</span><br><span class=\"line\">    rewrite ^(.*)$ https://$&#123;server_name&#125;$1 permanent; </span><br><span class=\"line\">&#125;</span><br><span class=\"line\">server &#123;</span><br><span class=\"line\">    listen 443;</span><br><span class=\"line\">    server_name cloud-doc.makergyt.com;</span><br><span class=\"line\">    ssl on;</span><br><span class=\"line\">    ssl_certificate   /etc/letsencrypt/live/makergyt.com/fullchain.pem;</span><br><span class=\"line\">    ssl_certificate_key  /etc/letsencrypt/live/makergyt.com/privkey.pem;</span><br><span class=\"line\">    ssl_session_timeout 5m;</span><br><span class=\"line\">    ssl_ciphers ECDHE-RSA-AES128-GCM-SHA256:ECDHE:ECDH:AES:HIGH:!NULL:!aNULL:!MD5:!ADH:!RC4;</span><br><span class=\"line\">    ssl_protocols TLSv1 TLSv1.1 TLSv1.2;</span><br><span class=\"line\">    ssl_prefer_server_ciphers on;</span><br><span class=\"line\">    index index.html index.htm index.php;</span><br><span class=\"line\">    charset utf-8;</span><br><span class=\"line\">    location / &#123;</span><br><span class=\"line\">        root  /var/www/cloud-doc/public;</span><br><span class=\"line\">        try_files $uri $uri/ /index.php?$query_string;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    location = /favicon.ico &#123; access_log off; log_not_found off; &#125;</span><br><span class=\"line\">    location = /robots.txt  &#123; access_log off; log_not_found off; &#125;</span><br><span class=\"line\">    access_log /var/log/nginx/cloud-doc.log;</span><br><span class=\"line\">    error_log /var/log/nginx/cloud-doc-error.log error;</span><br><span class=\"line\">    sendfile off;</span><br><span class=\"line\">    client_max_body_size 100m;</span><br><span class=\"line\">    location ~ \\.php$ &#123;</span><br><span class=\"line\">        root  /var/www/cloud-doc/public;</span><br><span class=\"line\">        fastcgi_split_path_info ^(.+\\.php)(/.+)$;</span><br><span class=\"line\">        fastcgi_pass unix:/var/run/php/php7.2-fpm.sock;</span><br><span class=\"line\">        fastcgi_index index.php;</span><br><span class=\"line\">        include fastcgi_params;</span><br><span class=\"line\">        fastcgi_param SCRIPT_FILENAME $realpath_root$fastcgi_script_name;</span><br><span class=\"line\">        fastcgi_param DOCUMENT_ROOT $realpath_root;</span><br><span class=\"line\">        fastcgi_intercept_errors off;</span><br><span class=\"line\">        fastcgi_buffer_size 16k;</span><br><span class=\"line\">        fastcgi_buffers 4 16k;</span><br><span class=\"line\">        fastcgi_connect_timeout 300;</span><br><span class=\"line\">        fastcgi_send_timeout 300;</span><br><span class=\"line\">        fastcgi_read_timeout 300;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    location ~ /\\.ht &#123;</span><br><span class=\"line\">        deny all;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h2 id=\"二、部署项目\"><a href=\"#二、部署项目\" class=\"headerlink\" title=\"二、部署项目\"></a>二、部署项目</h2><p>这里部署一个微信小程序项目【<a href=\"https://github.com/MakerGYT/cloud-doc\" target=\"_blank\" rel=\"noopener\">云文档</a>】</p>\n<h3 id=\"1-本地测试\"><a href=\"#1-本地测试\" class=\"headerlink\" title=\"1. 本地测试\"></a>1. 本地测试</h3><ul>\n<li>新增网站到vagrant主机<br>在homestead.yaml中新增site:<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">map: cloud-doc.test</span><br><span class=\"line\">      to: /home/vagrant/code/cloud-doc/public</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<p>在主机<code>/etc/hosts</code>后追加：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">192.168.0.100 cloud-doc.test</span><br></pre></td></tr></table></figure></p>\n<p>启动vagrant并登录：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vagrant provision</span><br><span class=\"line\">vagrant up</span><br><span class=\"line\">vagrant ssh</span><br></pre></td></tr></table></figure></p>\n<ul>\n<li>在虚拟主机内完成源码下载，数据库相应工作：<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git clond https://github.com/SmallRuralDog/cloud-doc-server.git /code/cloud-doc</span><br><span class=\"line\">cd /code/cloudoc</span><br><span class=\"line\">unzip cloud_doc_server.zip</span><br><span class=\"line\">mysql -u root -p</span><br><span class=\"line\">mysql&gt; create database cloudoc; #创建数据库</span><br><span class=\"line\">mysql&gt; create user &apos;cloud-doc&apos;@&apos;%&apos; identified by &apos;cloud-doc&apos;;  #创建用户</span><br><span class=\"line\">mysql&gt; grant all on cloudoc.* to  &apos;cloud-doc&apos;@&apos;%&apos;;  #授权</span><br><span class=\"line\">mysql&gt; flush privileges;</span><br><span class=\"line\">mysql&gt; use cloudoc;</span><br><span class=\"line\">mysql&gt; source cloud_doc_server.sql</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<p>修改源码，【<a href=\"https://github.com/SmallRuralDog/cloud-doc-server\" target=\"_blank\" rel=\"noopener\">参考</a>】<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo vim /config/database.php</span><br><span class=\"line\">#采用本地，修改app.php,admin.php中url:</span><br><span class=\"line\">&apos;http://cloud-doc.test&apos;</span><br><span class=\"line\">#修改wx.php</span><br></pre></td></tr></table></figure></p>\n<ul>\n<li>赋予根目录 storage 目录可写权限：<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">chmod -R 777 storage</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<p>在主机访问cloud-doc.test和同局域网下终端访问192.168.100</p>\n<h3 id=\"2-部署上线\"><a href=\"#2-部署上线\" class=\"headerlink\" title=\"2.部署上线\"></a>2.部署上线</h3><p>将修改后的源码传至服务器<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">scp -r -i makergyt.pem cloud-doc root@112.74.41.209:/var/www</span><br></pre></td></tr></table></figure></p>\n<p>在服务器配置数据库、赋予根目录 storage 目录可写权限过程完全一致</p>\n<h3 id=\"3-小程序配置\"><a href=\"#3-小程序配置\" class=\"headerlink\" title=\"3.小程序配置\"></a>3.小程序配置</h3><ul>\n<li>下载源码并修改<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git clone https://github.com/MakerGYT/cloud-doc.git miniprogram</span><br><span class=\"line\">cd miniprogram </span><br><span class=\"line\">sudo vim app.js</span><br><span class=\"line\">#修改请求域名</span><br><span class=\"line\">const HOST = &quot;https://cloud-doc.makergyt.com&quot;;</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<p>同时将此域名在小程序平台开发设置中更新修改</p>\n<h3 id=\"4-测试\"><a href=\"#4-测试\" class=\"headerlink\" title=\"4.测试\"></a>4.测试</h3><p>小程序可正常通过请求api获取文档信息，但是用户无法登录，经检查，提示错误：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Call to undefined function App\\Extend\\WxApp\\mcrypt_module_open()</span><br></pre></td></tr></table></figure></p>\n<p>是因为mcrypt_module_open()函数在7.1中被贬低，将在7.2中被移除，要用openssl_decrypt()函数代替，参考<a href=\"https://blog.csdn.net/haibo_j/article/details/80759706\" target=\"_blank\" rel=\"noopener\">https://blog.csdn.net/haibo_j/article/details/80759706</a> 将<code>app/Extend/WxApp/Prpcrypt.php</code>中第35~42行修改为：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$decrypted = openssl_decrypt($aesCipher, &apos;AES-256-CBC&apos;, $this-&gt;key, OPENSSL_RAW_DATA|OPENSSL_ZERO_PADDING, $aesIV);</span><br></pre></td></tr></table></figure></p>\n<p>不再报错，但仍无法登录，需进一步检查源码</p>\n","site":{"data":{}},"excerpt":"<h2 id=\"一、环境配置过程\"><a href=\"#一、环境配置过程\" class=\"headerlink\" title=\"一、环境配置过程\"></a>一、环境配置过程</h2><h3 id=\"1-开发环境\"><a href=\"#1-开发环境\" class=\"headerlink\" title=\"1.开发环境\"></a>1.开发环境</h3><p><strong>基本环境:</strong></p>\n<p>本地主机：<a href=\"https://www.ubuntu.com//\" target=\"_blank\" rel=\"noopener\"><img src=\"https://img.shields.io/badge/ubuntu-16.04-orange.svg\" alt=\"ubuntu\"></a>  (amd64 8G RAM)<br>","more":"<br>已安装环境：<br><a href=\"https://nodejs.org/zh-cn/\" target=\"_blank\" rel=\"noopener\"><img src=\"https://img.shields.io/badge/npm-6.4.1-orange.png\" alt=\"node\"></a> <a href=\"https://git-scm.com/\" target=\"_blank\" rel=\"noopener\"><img src=\"https://img.shields.io/badge/git-2.7.4-orange.svg\" alt=\"git\"></a><a href=\"http://www.sublimetext.com/\" target=\"_blank\" rel=\"noopener\"><img src=\"https://img.shields.io/badge/sublime-3176-blue.svg\" alt=\"sublime\"></a></p>\n<h4 id=\"1-1-一点认识：\"><a href=\"#1-1-一点认识：\" class=\"headerlink\" title=\"1.1 一点认识：\"></a>1.1 一点认识：</h4><p>开发时会出现本地环境的不确定变数，且一般是唯一的，不利于版本切换。在团队协同中，环境的差异可能导致配合的巨大问题。于是，基于vitual box产生了vagrant,而laravel官方又基于vagrant推出homestead，从而在开发时基于虚拟机工作，本地程序工程映射到虚拟机内，随时可以撤销、共享环境，不会对本地产生影响。这一点认为与python的virtualenv功能类似,也与我《<a href=\"https://blog.makergyt.com/2017/11/19/%E6%9C%AC%E5%9C%B0%E2%80%9C%E6%A8%A1%E6%8B%9F%E2%80%9D%E4%B8%80%E5%8F%B0%E6%9C%8D%E5%8A%A1%E5%99%A8/\">本地“模拟”一台服务器</a>》中的方式类似。</p>\n<h4 id=\"1-2-homestead的安装过程\"><a href=\"#1-2-homestead的安装过程\" class=\"headerlink\" title=\"1.2 homestead的安装过程\"></a>1.2 homestead的安装过程</h4><p>根据其依赖关系，需要依次完成vitualbox、vagrant、homestead的安装与配置，由于ubuntu系统基于Debian GNU/Linux，基本可通过deb安装包进行：</p>\n<ul>\n<li>vitualbox:<a href=\"https://www.virtualbox.org/wiki/Downloads\" target=\"_blank\" rel=\"noopener\">https://www.virtualbox.org/wiki/Downloads</a></li>\n<li><p>vagrant:<a href=\"https://releases.hashicorp.com/vagrant/2.2.2/vagrant_2.2.2_x86_64.deb\" target=\"_blank\" rel=\"noopener\">https://releases.hashicorp.com/vagrant/2.2.2/vagrant_2.2.2_x86_64.deb</a></p>\n<p>刚开始采用大部分教程中的<code>apt-get</code>方式，但到后边发现这样安装的版本是1.8.1，与homestead不匹配(require &gt;=2.1.0)，于是采用官方的deb。然后加入laravel的盒子:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vagrant box add laravel/homestead</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>homestead:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git clone https://github.com/laravel/homestead.git </span><br><span class=\"line\">cd ~/Homestead </span><br><span class=\"line\">git checkout v7.18.0</span><br><span class=\"line\">bash init.sh</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<p>以上是第一次时采用官方的安装文档，但是由于不可避免的网络问题，更重要的是在并不熟悉laravel的情况下，需要将环境过程尽可能简化与透明，于是采用了适用于国情的 Homestead 安装包：<a href=\"http://download.fsdhub.com/lc-homestead-6.1.1-2018090400.zip\" target=\"_blank\" rel=\"noopener\">http://download.fsdhub.com/lc-homestead-6.1.1-2018090400.zip</a> 。在回滚上述环境后，重新开始安装：【<a href=\"https://laravel-china.org/index.php/docs/laravel-development-environment/5.7/development-environment-macos/2901#a3c561\" target=\"_blank\" rel=\"noopener\">参考</a>】<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vagrant box remove laravel/homestead</span><br><span class=\"line\">#完全清理上述环境及文件</span><br><span class=\"line\">wget http://download.fsdhub.com/lc-homestead-6.1.1-2018090400.zip</span><br><span class=\"line\">unzip lc-homestead-6.1.1-2018090400.zip</span><br><span class=\"line\">cd lc-homestead-6.1.1-2018090400</span><br><span class=\"line\">vagrant box add metadata.json</span><br><span class=\"line\">cd ~</span><br><span class=\"line\">git clone https://git.coding.net/summerblue/homestead.git Homestead</span><br><span class=\"line\">cd ~/Homestead</span><br><span class=\"line\">git checkout v7.8.0</span><br><span class=\"line\">bash init.sh</span><br></pre></td></tr></table></figure></p>\n<h4 id=\"1-3-配置homestead-yaml\"><a href=\"#1-3-配置homestead-yaml\" class=\"headerlink\" title=\"1.3 配置homestead.yaml\"></a>1.3 配置homestead.yaml</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">subl ~/Homestead/Homestead.yaml</span><br></pre></td></tr></table></figure>\n<ul>\n<li><p>虚拟机设置：为了便于在同一局域网下在手机端查看效果，这里在配置IP时选择与内网同一网段的，<code>ifconfig</code>查得在192.168.0.104，于是设置为<code>192.168.0.100</code>，其他默认.<br>修改网络设置：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo vim /Homestead/scripts/homestead.rb</span><br><span class=\"line\">#在第20行改为：</span><br><span class=\"line\">config.vm.network :public_network, ip: settings[&quot;ip&quot;] ||= &quot;192.168.0.100&quot;</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>SSH 秘钥登录：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ls -al ~/.ssh</span><br><span class=\"line\">-rw-------  1 makergyt makergyt 1679 Nov 30 23:56 id_rsa</span><br><span class=\"line\">-rw-r--r--  1 makergyt makergyt  406 Nov 30 23:56 id_rsa.pub</span><br><span class=\"line\">#不需要再生成，如没有需ssh-keygen -t rsa -C &quot;email&quot;</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<p>于是补充 <code>-  ~/.ssh/id_rsa.pub</code>到<code>key</code></p>\n<ul>\n<li><p>共享文件夹配置<br>默认后在本地主机上新建code文件夹:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cd ~</span><br><span class=\"line\">mkdir code</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>站点配置：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sites:</span><br><span class=\"line\">    - map: homestead.test</span><br><span class=\"line\">      to: /home/vagrant/Code/Laravel/public</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<p>在主机内将域名与IP绑定(即同DNS的作用):<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo /etc/hosts</span><br><span class=\"line\">#最后一行追加：</span><br><span class=\"line\">192.168.0.100  homestead.test</span><br></pre></td></tr></table></figure></p>\n<ul>\n<li>数据库配置：默认，对应的用户名/密码是<code>homestead/secret</code>,其实可自行在虚拟机命令行新建</li>\n</ul>\n<p>其他均默认</p>\n<h4 id=\"1-4-运行vagrant\"><a href=\"#1-4-运行vagrant\" class=\"headerlink\" title=\"1.4 运行vagrant\"></a>1.4 运行vagrant</h4><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pwd</span><br><span class=\"line\">/home/makergyt/Homestead</span><br><span class=\"line\">vagrant up</span><br><span class=\"line\">#开始一段时间根据配置文件新建主机</span><br><span class=\"line\">#登录</span><br><span class=\"line\">vagrant ssh</span><br><span class=\"line\">#退出</span><br><span class=\"line\">exit</span><br><span class=\"line\">#关闭homestead(相当于虚拟机关机)</span><br><span class=\"line\">vagrant halt</span><br></pre></td></tr></table></figure>\n<h3 id=\"2-生产环境\"><a href=\"#2-生产环境\" class=\"headerlink\" title=\"2.生产环境\"></a>2.生产环境</h3><p><strong>基本环境</strong></p>\n<p>Aliyun ECS：<a href=\"https://www.ubuntu.com//\" target=\"_blank\" rel=\"noopener\"><img src=\"https://img.shields.io/badge/ubuntu-16.04-orange.svg\" alt=\"ubuntu\"></a>  (amd64 1G RAM 1 core CPU)</p>\n<p>已安装环境：<br><a href=\"https://nodejs.org/zh-cn/\" target=\"_blank\" rel=\"noopener\"><img src=\"https://img.shields.io/badge/npm-6.4.1-orange.svg\" alt=\"node\"></a><br><a href=\"https://git-scm.com/\" target=\"_blank\" rel=\"noopener\"><img src=\"https://img.shields.io/badge/git-2.7.4-orange.svg\" alt=\"git\"></a></p>\n<h4 id=\"2-1-一点认识\"><a href=\"#2-1-一点认识\" class=\"headerlink\" title=\"2.1 一点认识\"></a>2.1 一点认识</h4><p>生产环境与开发环境相反，需要非常稳定，部署后一般不变更。首先需要lnmp配置，这里采用针对laravel的脚本，速度很快，然后需要完成ssl证书安装，这里采用certbort</p>\n<h4 id=\"2-2-过程\"><a href=\"#2-2-过程\" class=\"headerlink\" title=\"2.2 过程\"></a>2.2 过程</h4><ul>\n<li><p>密钥连接：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># 赋予权限</span><br><span class=\"line\">chmod 400 xxx.pem</span><br><span class=\"line\"># 删除旧信息</span><br><span class=\"line\">ssh-keygen -f &quot;/home/makergyt/.ssh/known_hosts&quot; -R 112.74.41.209</span><br><span class=\"line\"># 连接 </span><br><span class=\"line\">ssh -i /makergyt.pem root@112.74.41.209</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>脚本安装：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">wget -qO- https://raw.githubusercontent.com/summerblue/laravel-ubuntu-init/master/download.sh - | bash</span><br><span class=\"line\"># 完成后</span><br><span class=\"line\">cd laravel-ubuntu-init</span><br><span class=\"line\">./16.04/nginx_add_site.sh</span><br><span class=\"line\">#项目名即工程文件夹名，会在/var/www下新建</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<p>域名即对应访问此虚拟主机的域名，手头有一台云服务器，一个已经备案的<code>com</code>顶级域名,考虑到今后的项目需求，采取解析不同二级域名至同一ECS IP,然后在ECS中新建相应虚拟主机来绑定二级域名。</p>\n<ul>\n<li>ssl证书安装<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ sudo apt-get update</span><br><span class=\"line\">$ sudo apt-get install software-properties-common</span><br><span class=\"line\">$ sudo add-apt-repository universe</span><br><span class=\"line\">$ sudo add-apt-repository ppa:certbot/certbot</span><br><span class=\"line\">$ sudo apt-get update</span><br><span class=\"line\">$ sudo apt-get install python-certbot-nginx </span><br><span class=\"line\">$ sudo certbot --nginx #这里可检测到已经新建的多个主机并同时安装</span><br><span class=\"line\">$ sudo certbot renew --dry-run #日后更新</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<p>修改nginx配置文件,,开启80(http)强转443(https)：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pwd </span><br><span class=\"line\">/etc/nginx/sites-enabled</span><br><span class=\"line\">sudo vim cloud-doc.conf</span><br></pre></td></tr></table></figure></p>\n<p>文件如下：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">server&#123;</span><br><span class=\"line\">    listen 80;</span><br><span class=\"line\">    server_name cloud-doc.makergyt.com;</span><br><span class=\"line\">    rewrite ^(.*)$ https://$&#123;server_name&#125;$1 permanent; </span><br><span class=\"line\">&#125;</span><br><span class=\"line\">server &#123;</span><br><span class=\"line\">    listen 443;</span><br><span class=\"line\">    server_name cloud-doc.makergyt.com;</span><br><span class=\"line\">    ssl on;</span><br><span class=\"line\">    ssl_certificate   /etc/letsencrypt/live/makergyt.com/fullchain.pem;</span><br><span class=\"line\">    ssl_certificate_key  /etc/letsencrypt/live/makergyt.com/privkey.pem;</span><br><span class=\"line\">    ssl_session_timeout 5m;</span><br><span class=\"line\">    ssl_ciphers ECDHE-RSA-AES128-GCM-SHA256:ECDHE:ECDH:AES:HIGH:!NULL:!aNULL:!MD5:!ADH:!RC4;</span><br><span class=\"line\">    ssl_protocols TLSv1 TLSv1.1 TLSv1.2;</span><br><span class=\"line\">    ssl_prefer_server_ciphers on;</span><br><span class=\"line\">    index index.html index.htm index.php;</span><br><span class=\"line\">    charset utf-8;</span><br><span class=\"line\">    location / &#123;</span><br><span class=\"line\">        root  /var/www/cloud-doc/public;</span><br><span class=\"line\">        try_files $uri $uri/ /index.php?$query_string;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    location = /favicon.ico &#123; access_log off; log_not_found off; &#125;</span><br><span class=\"line\">    location = /robots.txt  &#123; access_log off; log_not_found off; &#125;</span><br><span class=\"line\">    access_log /var/log/nginx/cloud-doc.log;</span><br><span class=\"line\">    error_log /var/log/nginx/cloud-doc-error.log error;</span><br><span class=\"line\">    sendfile off;</span><br><span class=\"line\">    client_max_body_size 100m;</span><br><span class=\"line\">    location ~ \\.php$ &#123;</span><br><span class=\"line\">        root  /var/www/cloud-doc/public;</span><br><span class=\"line\">        fastcgi_split_path_info ^(.+\\.php)(/.+)$;</span><br><span class=\"line\">        fastcgi_pass unix:/var/run/php/php7.2-fpm.sock;</span><br><span class=\"line\">        fastcgi_index index.php;</span><br><span class=\"line\">        include fastcgi_params;</span><br><span class=\"line\">        fastcgi_param SCRIPT_FILENAME $realpath_root$fastcgi_script_name;</span><br><span class=\"line\">        fastcgi_param DOCUMENT_ROOT $realpath_root;</span><br><span class=\"line\">        fastcgi_intercept_errors off;</span><br><span class=\"line\">        fastcgi_buffer_size 16k;</span><br><span class=\"line\">        fastcgi_buffers 4 16k;</span><br><span class=\"line\">        fastcgi_connect_timeout 300;</span><br><span class=\"line\">        fastcgi_send_timeout 300;</span><br><span class=\"line\">        fastcgi_read_timeout 300;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    location ~ /\\.ht &#123;</span><br><span class=\"line\">        deny all;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h2 id=\"二、部署项目\"><a href=\"#二、部署项目\" class=\"headerlink\" title=\"二、部署项目\"></a>二、部署项目</h2><p>这里部署一个微信小程序项目【<a href=\"https://github.com/MakerGYT/cloud-doc\" target=\"_blank\" rel=\"noopener\">云文档</a>】</p>\n<h3 id=\"1-本地测试\"><a href=\"#1-本地测试\" class=\"headerlink\" title=\"1. 本地测试\"></a>1. 本地测试</h3><ul>\n<li>新增网站到vagrant主机<br>在homestead.yaml中新增site:<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">map: cloud-doc.test</span><br><span class=\"line\">      to: /home/vagrant/code/cloud-doc/public</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<p>在主机<code>/etc/hosts</code>后追加：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">192.168.0.100 cloud-doc.test</span><br></pre></td></tr></table></figure></p>\n<p>启动vagrant并登录：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vagrant provision</span><br><span class=\"line\">vagrant up</span><br><span class=\"line\">vagrant ssh</span><br></pre></td></tr></table></figure></p>\n<ul>\n<li>在虚拟主机内完成源码下载，数据库相应工作：<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git clond https://github.com/SmallRuralDog/cloud-doc-server.git /code/cloud-doc</span><br><span class=\"line\">cd /code/cloudoc</span><br><span class=\"line\">unzip cloud_doc_server.zip</span><br><span class=\"line\">mysql -u root -p</span><br><span class=\"line\">mysql&gt; create database cloudoc; #创建数据库</span><br><span class=\"line\">mysql&gt; create user &apos;cloud-doc&apos;@&apos;%&apos; identified by &apos;cloud-doc&apos;;  #创建用户</span><br><span class=\"line\">mysql&gt; grant all on cloudoc.* to  &apos;cloud-doc&apos;@&apos;%&apos;;  #授权</span><br><span class=\"line\">mysql&gt; flush privileges;</span><br><span class=\"line\">mysql&gt; use cloudoc;</span><br><span class=\"line\">mysql&gt; source cloud_doc_server.sql</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<p>修改源码，【<a href=\"https://github.com/SmallRuralDog/cloud-doc-server\" target=\"_blank\" rel=\"noopener\">参考</a>】<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo vim /config/database.php</span><br><span class=\"line\">#采用本地，修改app.php,admin.php中url:</span><br><span class=\"line\">&apos;http://cloud-doc.test&apos;</span><br><span class=\"line\">#修改wx.php</span><br></pre></td></tr></table></figure></p>\n<ul>\n<li>赋予根目录 storage 目录可写权限：<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">chmod -R 777 storage</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<p>在主机访问cloud-doc.test和同局域网下终端访问192.168.100</p>\n<h3 id=\"2-部署上线\"><a href=\"#2-部署上线\" class=\"headerlink\" title=\"2.部署上线\"></a>2.部署上线</h3><p>将修改后的源码传至服务器<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">scp -r -i makergyt.pem cloud-doc root@112.74.41.209:/var/www</span><br></pre></td></tr></table></figure></p>\n<p>在服务器配置数据库、赋予根目录 storage 目录可写权限过程完全一致</p>\n<h3 id=\"3-小程序配置\"><a href=\"#3-小程序配置\" class=\"headerlink\" title=\"3.小程序配置\"></a>3.小程序配置</h3><ul>\n<li>下载源码并修改<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git clone https://github.com/MakerGYT/cloud-doc.git miniprogram</span><br><span class=\"line\">cd miniprogram </span><br><span class=\"line\">sudo vim app.js</span><br><span class=\"line\">#修改请求域名</span><br><span class=\"line\">const HOST = &quot;https://cloud-doc.makergyt.com&quot;;</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<p>同时将此域名在小程序平台开发设置中更新修改</p>\n<h3 id=\"4-测试\"><a href=\"#4-测试\" class=\"headerlink\" title=\"4.测试\"></a>4.测试</h3><p>小程序可正常通过请求api获取文档信息，但是用户无法登录，经检查，提示错误：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Call to undefined function App\\Extend\\WxApp\\mcrypt_module_open()</span><br></pre></td></tr></table></figure></p>\n<p>是因为mcrypt_module_open()函数在7.1中被贬低，将在7.2中被移除，要用openssl_decrypt()函数代替，参考<a href=\"https://blog.csdn.net/haibo_j/article/details/80759706\" target=\"_blank\" rel=\"noopener\">https://blog.csdn.net/haibo_j/article/details/80759706</a> 将<code>app/Extend/WxApp/Prpcrypt.php</code>中第35~42行修改为：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$decrypted = openssl_decrypt($aesCipher, &apos;AES-256-CBC&apos;, $this-&gt;key, OPENSSL_RAW_DATA|OPENSSL_ZERO_PADDING, $aesIV);</span><br></pre></td></tr></table></figure></p>\n<p>不再报错，但仍无法登录，需进一步检查源码</p>"},{"title":"建立个人网站","date":"2017-09-20T20:04:51.000Z","_content":"{% note info %}\n本文概念性内容可能表述不严谨，但不必吹毛求疵，主要以实际操作为主，一些下载资料已附带链接。\n{% endnote %}\n# 1 前言\n\n<!-- more -->\n\n首先，我们为什么要用到服务器。刚开始入门web的同学可能一直沉浸于使用自己的电脑本地调试出各种奇技淫巧而兴奋不已，然而当你想向他人炫耀一番时，你的方式是什么？打个包发过去，她/他可能还在用IE6，然后你的花哨的页面就没有然后了，当然这也得基于知道你网页入口在哪里。这时，服务器会派上用场，它就相当于一个寄存在遥远天边的电脑，与你桌上那台不同的是，每个人只要可以上网就能访问到里面的内容（当然深入了解还需要端口等知识）。那么，怎么访问呢？我们知道，每个网络上的机器都有一个IP地址，就像这样，127.0.0.1（这是电脑本地的IP），我们可以通过浏览器键入IP访问到它的内容。如果它那台主机配置了域名，你现在暂且可以这样理解，域名与IP是一一对应的关系，域名只是为了便于你记忆，就像baidu.com,大多数人肯定不会记住它的IP。不过作为我们这类人来说，IP就可以了，我相信你是可以记住的。域名的话，毕竟考虑国情，你还得经过备案，上传各种资料以及自拍，在你不准备正式对外发布使用之前是没什么必要的。\n<!-- more -->\n还有一种可以实现访问的方式是github,io，这是github推出 的一项免费服务，可以使用例如[https://makergyt.github.io](https://makergyt.github.io)的域名访问到你的内容，网页可以通过它的桌面软件上传，屏蔽了服务器端的那些操作，比较简单。当然这是对于前端同学来讲适用。下面将分别开始这两种方式的实际操作。\n\n# 2 开工\n## 2.1 服务器\n### 2.1.1 准备\n1. 先拥有，确切的说是租用一台云服务器(或者虚拟主机)，网络上有很多服务商，五花八门，国内的有腾讯云，百度云(不是百度网盘！)，国外的有godady，区别是国外的不需要备案，但是速度可能会慢，国内的相反。这里推荐[阿里云](https://promotion.aliyun.com/ntms/yunparter/invite.html?userCode=89lfnf3q)（点击获取代金券），还有[学生优惠](https://promotion.aliyun.com/ntms/act/campus2018.html)，并且持续，关键是服务好。你可以选择时长，环境系统就选``centos7``（linux的一个发行版），不要用winserver,linux操作基础的都可以百度到,地域目前无所谓,时长看自身情况。\n\n2. 完成学生认证后，是直接获取支付宝认证信息，一步完成，就能使用这种优惠，购买时记得选择设置密码而先不是密钥，牢记你的密码。然后你进入管理控制台，就能看到你的服务器信息。\n![点击左侧云服务器ECS实例，进入操作。](http://upload-images.jianshu.io/upload_images/3234038-89e0ec0aeb204589.JPG?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)\n![启动你服务器，运行中](http://upload-images.jianshu.io/upload_images/3234038-c92de9e9d0f7238c.JPG?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)\n\n3. 配置安全组,左侧安全组->配置规则->公网入方向->快速创建规则,端口就先全开了，自定义端口因为我们这里推荐linux系统，填22/22（winserver填3389/3389），授权对象填``0.0.0.0/0``，表示允许任何地方连接你的服务器，先这样设置（一般没人闲的黑学生机）。\n然后就开始ssh配置，这里使用阿里云的[一键部署web环境包](http://pan.baidu.com/s/1geUK7wJ)（密码：h1ac），包含php环境,包含了官方参考文档。\n\n### 2.1.2 安装\n#### 2.1.2.1 材料工具\n[xshell](http://www.netsarang.com/download/down_xfp.html)(一个与linux通信的软件)和[xftp](http://www.netsarang.com/download/down_xfp.html)(一个与服务器进行文件操作的软件)，然后其他的操作文档写的很详细，也可以参照[最新官网文档](http://source.docs.cloudcare.cn/support/tool/web/web_1/)。\n\n#### 2.1.2.2 开始\n{% note info %}\nweb服务器选择Apache就行，因为桌面调试一般也是这样的，免去兼容的操作。Nginx虽然性能好，总有一些新操作，对开发形成难度，建议以后再使用。其他的版本根据你桌面使用的环境，就高不就低。我们的原则是快速入门配置，搭好工具把时间留给学习开发，不要被这些门槛绊住。那些命令行操作慢慢就熟悉了，其实后面使用时只需要知道怎么连接，怎么上传文件即可。\n{% endnote %}\n#### 2.1.2.3 配置web服务器\n如果你是安装了php环境，它会默认安装phpwind(一个开源论坛)和phpmyadmin（一个可以在线访问数据库的工具，留着）,因为访问服务器外网IP时，它是指向phpwind的，所以可以先卸载掉这个东西，直接指向到你的网站根目录alidata/www/,这样以后就很方便的能访问到下面的不同文件夹内容。这里的操作就需要[参考官网文档](http://source.docs.cloudcare.cn/support/tool/web/web_1/)了，也一样很详细。，在修改conf那一步，可参考这里已经测试过的[配置文件](http://pan.baidu.com/s/1skXirtr)（密码a3f1）替换掉``phpwind.conf``\n```js\n<DirectoryMatch \"/alidata/www/(attachment|html|data)\">\n<Files ~ \".php\">\nOrder allow,deny\nDeny from all\n</Files>\n</DirectoryMatch>\n\n<VirtualHost *:80>\n\tDocumentRoot /alidata/www\n\tServerName localhost\n\tServerAlias localhost\n\t<Directory \"/alidata/www\">\n\t    Options Indexes FollowSymLinks\n\t    AllowOverride all\n\t    Order allow,deny\n\t    Allow from all\n\t</Directory>\n\tErrorLog \"/alidata/log/httpd/dx-error.log\"\n\tCustomLog \"/alidata/log/httpd/dx.log\" common\n</VirtualHost>\n```\n### 2.1.3 测试\n好了，现在可以上传几个文件进行测试，浏览器键入IP时如果下面没有index的引导文件，是这样直接显示的，可以写一个简单的index.html上传看下效果，然后使用手机浏览器，QQ/微信内部打开（发个链接给别人，会自动识别）再访问下，保证正常访问到就说明基本的配置已经成功了。由于微信的安全保护，如果是IP或者没有被他收录的域名，是会跳出提示框，不过也不影响继续能访问到。解决这个的方法就是备案，https认证等等一系列证明网站是良好文明的。\n\n![](http://upload-images.jianshu.io/upload_images/3234038-a6dae4a27308a323.JPG?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)\n\n\n## 2.2 github.io\n\n先注册一个自己的账号，用户名很重要，因为稍后生成的链接就是像[makergyt.github.io](https://makergyt.github.io)（makergyt是一个用户名），后期也可以修改，但对应的链接就会失效，需要再次配置。\n有三种方式，使用桌面软件快速构建，使用git命令，使用已经创建好的仓库，这里我们使用第一种。\n\n### 2.2.1 开始\n\n![1.Create a new repository](http://upload-images.jianshu.io/upload_images/3234038-2341fe768acb5fab.JPG?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)\n\n安装软件，复制.git路径\n![2.克隆github上的仓库到本地](http://upload-images.jianshu.io/upload_images/3234038-94900541e70371a6.JPG?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)\n\n![3.项目内容放到该路径下](http://upload-images.jianshu.io/upload_images/3234038-72eb180da889081c.JPG?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)\n\n![4.每次改动后，备注修改内容，然后就可以pull origin](http://upload-images.jianshu.io/upload_images/3234038-372aaf03ea4ece35.JPG?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)\n\n### 2.2.2 测试\n现在可以试着访问github.io了，``用户名.github.io``，因为github托管在国外，可能会比较慢。上述两种建站方式，建议前端开发静态页面可以先使用github.io。\n\n{% note info %}\n实现建站的路有很多条，服务也很多种，但是一路畅通的很少，常常看似简单实际需要别的技术栈。去粗取精，权衡利弊，以上这两种是较为基础的。\n{% endnote %}\n\n# Reference\n\n<small>[1] Github.Websites for you and your projects.[EB/OL].https://pages.github.com .2017.</small>\n\n","source":"_posts/zh-CN/建立个人网站.md","raw":"---\ntitle: 建立个人网站\ndate: 2017-09-21 04:04:51\ntags:\n\t- github\n\t- centos\ncategories: config\n---\n{% note info %}\n本文概念性内容可能表述不严谨，但不必吹毛求疵，主要以实际操作为主，一些下载资料已附带链接。\n{% endnote %}\n# 1 前言\n\n<!-- more -->\n\n首先，我们为什么要用到服务器。刚开始入门web的同学可能一直沉浸于使用自己的电脑本地调试出各种奇技淫巧而兴奋不已，然而当你想向他人炫耀一番时，你的方式是什么？打个包发过去，她/他可能还在用IE6，然后你的花哨的页面就没有然后了，当然这也得基于知道你网页入口在哪里。这时，服务器会派上用场，它就相当于一个寄存在遥远天边的电脑，与你桌上那台不同的是，每个人只要可以上网就能访问到里面的内容（当然深入了解还需要端口等知识）。那么，怎么访问呢？我们知道，每个网络上的机器都有一个IP地址，就像这样，127.0.0.1（这是电脑本地的IP），我们可以通过浏览器键入IP访问到它的内容。如果它那台主机配置了域名，你现在暂且可以这样理解，域名与IP是一一对应的关系，域名只是为了便于你记忆，就像baidu.com,大多数人肯定不会记住它的IP。不过作为我们这类人来说，IP就可以了，我相信你是可以记住的。域名的话，毕竟考虑国情，你还得经过备案，上传各种资料以及自拍，在你不准备正式对外发布使用之前是没什么必要的。\n<!-- more -->\n还有一种可以实现访问的方式是github,io，这是github推出 的一项免费服务，可以使用例如[https://makergyt.github.io](https://makergyt.github.io)的域名访问到你的内容，网页可以通过它的桌面软件上传，屏蔽了服务器端的那些操作，比较简单。当然这是对于前端同学来讲适用。下面将分别开始这两种方式的实际操作。\n\n# 2 开工\n## 2.1 服务器\n### 2.1.1 准备\n1. 先拥有，确切的说是租用一台云服务器(或者虚拟主机)，网络上有很多服务商，五花八门，国内的有腾讯云，百度云(不是百度网盘！)，国外的有godady，区别是国外的不需要备案，但是速度可能会慢，国内的相反。这里推荐[阿里云](https://promotion.aliyun.com/ntms/yunparter/invite.html?userCode=89lfnf3q)（点击获取代金券），还有[学生优惠](https://promotion.aliyun.com/ntms/act/campus2018.html)，并且持续，关键是服务好。你可以选择时长，环境系统就选``centos7``（linux的一个发行版），不要用winserver,linux操作基础的都可以百度到,地域目前无所谓,时长看自身情况。\n\n2. 完成学生认证后，是直接获取支付宝认证信息，一步完成，就能使用这种优惠，购买时记得选择设置密码而先不是密钥，牢记你的密码。然后你进入管理控制台，就能看到你的服务器信息。\n![点击左侧云服务器ECS实例，进入操作。](http://upload-images.jianshu.io/upload_images/3234038-89e0ec0aeb204589.JPG?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)\n![启动你服务器，运行中](http://upload-images.jianshu.io/upload_images/3234038-c92de9e9d0f7238c.JPG?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)\n\n3. 配置安全组,左侧安全组->配置规则->公网入方向->快速创建规则,端口就先全开了，自定义端口因为我们这里推荐linux系统，填22/22（winserver填3389/3389），授权对象填``0.0.0.0/0``，表示允许任何地方连接你的服务器，先这样设置（一般没人闲的黑学生机）。\n然后就开始ssh配置，这里使用阿里云的[一键部署web环境包](http://pan.baidu.com/s/1geUK7wJ)（密码：h1ac），包含php环境,包含了官方参考文档。\n\n### 2.1.2 安装\n#### 2.1.2.1 材料工具\n[xshell](http://www.netsarang.com/download/down_xfp.html)(一个与linux通信的软件)和[xftp](http://www.netsarang.com/download/down_xfp.html)(一个与服务器进行文件操作的软件)，然后其他的操作文档写的很详细，也可以参照[最新官网文档](http://source.docs.cloudcare.cn/support/tool/web/web_1/)。\n\n#### 2.1.2.2 开始\n{% note info %}\nweb服务器选择Apache就行，因为桌面调试一般也是这样的，免去兼容的操作。Nginx虽然性能好，总有一些新操作，对开发形成难度，建议以后再使用。其他的版本根据你桌面使用的环境，就高不就低。我们的原则是快速入门配置，搭好工具把时间留给学习开发，不要被这些门槛绊住。那些命令行操作慢慢就熟悉了，其实后面使用时只需要知道怎么连接，怎么上传文件即可。\n{% endnote %}\n#### 2.1.2.3 配置web服务器\n如果你是安装了php环境，它会默认安装phpwind(一个开源论坛)和phpmyadmin（一个可以在线访问数据库的工具，留着）,因为访问服务器外网IP时，它是指向phpwind的，所以可以先卸载掉这个东西，直接指向到你的网站根目录alidata/www/,这样以后就很方便的能访问到下面的不同文件夹内容。这里的操作就需要[参考官网文档](http://source.docs.cloudcare.cn/support/tool/web/web_1/)了，也一样很详细。，在修改conf那一步，可参考这里已经测试过的[配置文件](http://pan.baidu.com/s/1skXirtr)（密码a3f1）替换掉``phpwind.conf``\n```js\n<DirectoryMatch \"/alidata/www/(attachment|html|data)\">\n<Files ~ \".php\">\nOrder allow,deny\nDeny from all\n</Files>\n</DirectoryMatch>\n\n<VirtualHost *:80>\n\tDocumentRoot /alidata/www\n\tServerName localhost\n\tServerAlias localhost\n\t<Directory \"/alidata/www\">\n\t    Options Indexes FollowSymLinks\n\t    AllowOverride all\n\t    Order allow,deny\n\t    Allow from all\n\t</Directory>\n\tErrorLog \"/alidata/log/httpd/dx-error.log\"\n\tCustomLog \"/alidata/log/httpd/dx.log\" common\n</VirtualHost>\n```\n### 2.1.3 测试\n好了，现在可以上传几个文件进行测试，浏览器键入IP时如果下面没有index的引导文件，是这样直接显示的，可以写一个简单的index.html上传看下效果，然后使用手机浏览器，QQ/微信内部打开（发个链接给别人，会自动识别）再访问下，保证正常访问到就说明基本的配置已经成功了。由于微信的安全保护，如果是IP或者没有被他收录的域名，是会跳出提示框，不过也不影响继续能访问到。解决这个的方法就是备案，https认证等等一系列证明网站是良好文明的。\n\n![](http://upload-images.jianshu.io/upload_images/3234038-a6dae4a27308a323.JPG?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)\n\n\n## 2.2 github.io\n\n先注册一个自己的账号，用户名很重要，因为稍后生成的链接就是像[makergyt.github.io](https://makergyt.github.io)（makergyt是一个用户名），后期也可以修改，但对应的链接就会失效，需要再次配置。\n有三种方式，使用桌面软件快速构建，使用git命令，使用已经创建好的仓库，这里我们使用第一种。\n\n### 2.2.1 开始\n\n![1.Create a new repository](http://upload-images.jianshu.io/upload_images/3234038-2341fe768acb5fab.JPG?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)\n\n安装软件，复制.git路径\n![2.克隆github上的仓库到本地](http://upload-images.jianshu.io/upload_images/3234038-94900541e70371a6.JPG?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)\n\n![3.项目内容放到该路径下](http://upload-images.jianshu.io/upload_images/3234038-72eb180da889081c.JPG?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)\n\n![4.每次改动后，备注修改内容，然后就可以pull origin](http://upload-images.jianshu.io/upload_images/3234038-372aaf03ea4ece35.JPG?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)\n\n### 2.2.2 测试\n现在可以试着访问github.io了，``用户名.github.io``，因为github托管在国外，可能会比较慢。上述两种建站方式，建议前端开发静态页面可以先使用github.io。\n\n{% note info %}\n实现建站的路有很多条，服务也很多种，但是一路畅通的很少，常常看似简单实际需要别的技术栈。去粗取精，权衡利弊，以上这两种是较为基础的。\n{% endnote %}\n\n# Reference\n\n<small>[1] Github.Websites for you and your projects.[EB/OL].https://pages.github.com .2017.</small>\n\n","slug":"建立个人网站","published":1,"lang":"zh-CN","updated":"2019-04-29T01:07:50.660Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjvnq7zbn003e7jjxaikrynpm","content":"<link rel=\"stylesheet\" class=\"aplayer-secondary-style-marker\" href=\"/assets/css/APlayer.min.css\"><script src=\"/assets/js/APlayer.min.js\" class=\"aplayer-secondary-script-marker\"></script><script class=\"meting-secondary-script-marker\" src=\"/assets/js/Meting.min.js\"></script><link rel=\"stylesheet\" type=\"text/css\" href=\"https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css\"><div class=\"note info\">\n            <p>本文概念性内容可能表述不严谨，但不必吹毛求疵，主要以实际操作为主，一些下载资料已附带链接。</p>\n          </div>\n<h1 id=\"1-前言\"><a href=\"#1-前言\" class=\"headerlink\" title=\"1 前言\"></a>1 前言</h1><a id=\"more\"></a>\n<p>首先，我们为什么要用到服务器。刚开始入门web的同学可能一直沉浸于使用自己的电脑本地调试出各种奇技淫巧而兴奋不已，然而当你想向他人炫耀一番时，你的方式是什么？打个包发过去，她/他可能还在用IE6，然后你的花哨的页面就没有然后了，当然这也得基于知道你网页入口在哪里。这时，服务器会派上用场，它就相当于一个寄存在遥远天边的电脑，与你桌上那台不同的是，每个人只要可以上网就能访问到里面的内容（当然深入了解还需要端口等知识）。那么，怎么访问呢？我们知道，每个网络上的机器都有一个IP地址，就像这样，127.0.0.1（这是电脑本地的IP），我们可以通过浏览器键入IP访问到它的内容。如果它那台主机配置了域名，你现在暂且可以这样理解，域名与IP是一一对应的关系，域名只是为了便于你记忆，就像baidu.com,大多数人肯定不会记住它的IP。不过作为我们这类人来说，IP就可以了，我相信你是可以记住的。域名的话，毕竟考虑国情，你还得经过备案，上传各种资料以及自拍，在你不准备正式对外发布使用之前是没什么必要的。<br><!-- more --><br>还有一种可以实现访问的方式是github,io，这是github推出 的一项免费服务，可以使用例如<a href=\"https://makergyt.github.io\" target=\"_blank\" rel=\"noopener\">https://makergyt.github.io</a>的域名访问到你的内容，网页可以通过它的桌面软件上传，屏蔽了服务器端的那些操作，比较简单。当然这是对于前端同学来讲适用。下面将分别开始这两种方式的实际操作。</p>\n<h1 id=\"2-开工\"><a href=\"#2-开工\" class=\"headerlink\" title=\"2 开工\"></a>2 开工</h1><h2 id=\"2-1-服务器\"><a href=\"#2-1-服务器\" class=\"headerlink\" title=\"2.1 服务器\"></a>2.1 服务器</h2><h3 id=\"2-1-1-准备\"><a href=\"#2-1-1-准备\" class=\"headerlink\" title=\"2.1.1 准备\"></a>2.1.1 准备</h3><ol>\n<li><p>先拥有，确切的说是租用一台云服务器(或者虚拟主机)，网络上有很多服务商，五花八门，国内的有腾讯云，百度云(不是百度网盘！)，国外的有godady，区别是国外的不需要备案，但是速度可能会慢，国内的相反。这里推荐<a href=\"https://promotion.aliyun.com/ntms/yunparter/invite.html?userCode=89lfnf3q\" target=\"_blank\" rel=\"noopener\">阿里云</a>（点击获取代金券），还有<a href=\"https://promotion.aliyun.com/ntms/act/campus2018.html\" target=\"_blank\" rel=\"noopener\">学生优惠</a>，并且持续，关键是服务好。你可以选择时长，环境系统就选<code>centos7</code>（linux的一个发行版），不要用winserver,linux操作基础的都可以百度到,地域目前无所谓,时长看自身情况。</p>\n</li>\n<li><p>完成学生认证后，是直接获取支付宝认证信息，一步完成，就能使用这种优惠，购买时记得选择设置密码而先不是密钥，牢记你的密码。然后你进入管理控制台，就能看到你的服务器信息。<br><img src=\"http://upload-images.jianshu.io/upload_images/3234038-89e0ec0aeb204589.JPG?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240\" alt=\"点击左侧云服务器ECS实例，进入操作。\"><br><img src=\"http://upload-images.jianshu.io/upload_images/3234038-c92de9e9d0f7238c.JPG?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240\" alt=\"启动你服务器，运行中\"></p>\n</li>\n<li><p>配置安全组,左侧安全组-&gt;配置规则-&gt;公网入方向-&gt;快速创建规则,端口就先全开了，自定义端口因为我们这里推荐linux系统，填22/22（winserver填3389/3389），授权对象填<code>0.0.0.0/0</code>，表示允许任何地方连接你的服务器，先这样设置（一般没人闲的黑学生机）。<br>然后就开始ssh配置，这里使用阿里云的<a href=\"http://pan.baidu.com/s/1geUK7wJ\" target=\"_blank\" rel=\"noopener\">一键部署web环境包</a>（密码：h1ac），包含php环境,包含了官方参考文档。</p>\n</li>\n</ol>\n<h3 id=\"2-1-2-安装\"><a href=\"#2-1-2-安装\" class=\"headerlink\" title=\"2.1.2 安装\"></a>2.1.2 安装</h3><h4 id=\"2-1-2-1-材料工具\"><a href=\"#2-1-2-1-材料工具\" class=\"headerlink\" title=\"2.1.2.1 材料工具\"></a>2.1.2.1 材料工具</h4><p><a href=\"http://www.netsarang.com/download/down_xfp.html\" target=\"_blank\" rel=\"noopener\">xshell</a>(一个与linux通信的软件)和<a href=\"http://www.netsarang.com/download/down_xfp.html\" target=\"_blank\" rel=\"noopener\">xftp</a>(一个与服务器进行文件操作的软件)，然后其他的操作文档写的很详细，也可以参照<a href=\"http://source.docs.cloudcare.cn/support/tool/web/web_1/\" target=\"_blank\" rel=\"noopener\">最新官网文档</a>。</p>\n<h4 id=\"2-1-2-2-开始\"><a href=\"#2-1-2-2-开始\" class=\"headerlink\" title=\"2.1.2.2 开始\"></a>2.1.2.2 开始</h4><div class=\"note info\">\n            <p>web服务器选择Apache就行，因为桌面调试一般也是这样的，免去兼容的操作。Nginx虽然性能好，总有一些新操作，对开发形成难度，建议以后再使用。其他的版本根据你桌面使用的环境，就高不就低。我们的原则是快速入门配置，搭好工具把时间留给学习开发，不要被这些门槛绊住。那些命令行操作慢慢就熟悉了，其实后面使用时只需要知道怎么连接，怎么上传文件即可。</p>\n          </div>\n<h4 id=\"2-1-2-3-配置web服务器\"><a href=\"#2-1-2-3-配置web服务器\" class=\"headerlink\" title=\"2.1.2.3 配置web服务器\"></a>2.1.2.3 配置web服务器</h4><p>如果你是安装了php环境，它会默认安装phpwind(一个开源论坛)和phpmyadmin（一个可以在线访问数据库的工具，留着）,因为访问服务器外网IP时，它是指向phpwind的，所以可以先卸载掉这个东西，直接指向到你的网站根目录alidata/www/,这样以后就很方便的能访问到下面的不同文件夹内容。这里的操作就需要<a href=\"http://source.docs.cloudcare.cn/support/tool/web/web_1/\" target=\"_blank\" rel=\"noopener\">参考官网文档</a>了，也一样很详细。，在修改conf那一步，可参考这里已经测试过的<a href=\"http://pan.baidu.com/s/1skXirtr\" target=\"_blank\" rel=\"noopener\">配置文件</a>（密码a3f1）替换掉<code>phpwind.conf</code><br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;DirectoryMatch <span class=\"string\">\"/alidata/www/(attachment|html|data)\"</span>&gt;</span><br><span class=\"line\">&lt;Files ~ <span class=\"string\">\".php\"</span>&gt;</span><br><span class=\"line\">Order allow,deny</span><br><span class=\"line\">Deny <span class=\"keyword\">from</span> all</span><br><span class=\"line\">&lt;<span class=\"regexp\">/Files&gt;</span></span><br><span class=\"line\"><span class=\"regexp\">&lt;/</span>DirectoryMatch&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;VirtualHost *:<span class=\"number\">80</span>&gt;</span><br><span class=\"line\">\tDocumentRoot /alidata/www</span><br><span class=\"line\">\tServerName localhost</span><br><span class=\"line\">\tServerAlias localhost</span><br><span class=\"line\">\t&lt;Directory <span class=\"string\">\"/alidata/www\"</span>&gt;</span><br><span class=\"line\">\t    Options Indexes FollowSymLinks</span><br><span class=\"line\">\t    AllowOverride all</span><br><span class=\"line\">\t    Order allow,deny</span><br><span class=\"line\">\t    Allow <span class=\"keyword\">from</span> all</span><br><span class=\"line\">\t&lt;<span class=\"regexp\">/Directory&gt;</span></span><br><span class=\"line\"><span class=\"regexp\">\tErrorLog \"/</span>alidata/log/httpd/dx-error.log<span class=\"string\">\"</span></span><br><span class=\"line\"><span class=\"string\">\tCustomLog \"</span>/alidata/log/httpd/dx.log<span class=\"string\">\" common</span></span><br><span class=\"line\"><span class=\"string\">&lt;/VirtualHost&gt;</span></span><br></pre></td></tr></table></figure></p>\n<h3 id=\"2-1-3-测试\"><a href=\"#2-1-3-测试\" class=\"headerlink\" title=\"2.1.3 测试\"></a>2.1.3 测试</h3><p>好了，现在可以上传几个文件进行测试，浏览器键入IP时如果下面没有index的引导文件，是这样直接显示的，可以写一个简单的index.html上传看下效果，然后使用手机浏览器，QQ/微信内部打开（发个链接给别人，会自动识别）再访问下，保证正常访问到就说明基本的配置已经成功了。由于微信的安全保护，如果是IP或者没有被他收录的域名，是会跳出提示框，不过也不影响继续能访问到。解决这个的方法就是备案，https认证等等一系列证明网站是良好文明的。</p>\n<p><img src=\"http://upload-images.jianshu.io/upload_images/3234038-a6dae4a27308a323.JPG?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240\" alt></p>\n<h2 id=\"2-2-github-io\"><a href=\"#2-2-github-io\" class=\"headerlink\" title=\"2.2 github.io\"></a>2.2 github.io</h2><p>先注册一个自己的账号，用户名很重要，因为稍后生成的链接就是像<a href=\"https://makergyt.github.io\" target=\"_blank\" rel=\"noopener\">makergyt.github.io</a>（makergyt是一个用户名），后期也可以修改，但对应的链接就会失效，需要再次配置。<br>有三种方式，使用桌面软件快速构建，使用git命令，使用已经创建好的仓库，这里我们使用第一种。</p>\n<h3 id=\"2-2-1-开始\"><a href=\"#2-2-1-开始\" class=\"headerlink\" title=\"2.2.1 开始\"></a>2.2.1 开始</h3><p><img src=\"http://upload-images.jianshu.io/upload_images/3234038-2341fe768acb5fab.JPG?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240\" alt=\"1.Create a new repository\"></p>\n<p>安装软件，复制.git路径<br><img src=\"http://upload-images.jianshu.io/upload_images/3234038-94900541e70371a6.JPG?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240\" alt=\"2.克隆github上的仓库到本地\"></p>\n<p><img src=\"http://upload-images.jianshu.io/upload_images/3234038-72eb180da889081c.JPG?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240\" alt=\"3.项目内容放到该路径下\"></p>\n<p><img src=\"http://upload-images.jianshu.io/upload_images/3234038-372aaf03ea4ece35.JPG?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240\" alt=\"4.每次改动后，备注修改内容，然后就可以pull origin\"></p>\n<h3 id=\"2-2-2-测试\"><a href=\"#2-2-2-测试\" class=\"headerlink\" title=\"2.2.2 测试\"></a>2.2.2 测试</h3><p>现在可以试着访问github.io了，<code>用户名.github.io</code>，因为github托管在国外，可能会比较慢。上述两种建站方式，建议前端开发静态页面可以先使用github.io。</p>\n<div class=\"note info\">\n            <p>实现建站的路有很多条，服务也很多种，但是一路畅通的很少，常常看似简单实际需要别的技术栈。去粗取精，权衡利弊，以上这两种是较为基础的。</p>\n          </div>\n<h1 id=\"Reference\"><a href=\"#Reference\" class=\"headerlink\" title=\"Reference\"></a>Reference</h1><p><small>[1] Github.Websites for you and your projects.[EB/OL].<a href=\"https://pages.github.com\" target=\"_blank\" rel=\"noopener\">https://pages.github.com</a> .2017.</small></p>\n","site":{"data":{}},"excerpt":"<div class=\"note info\">\n            <p>本文概念性内容可能表述不严谨，但不必吹毛求疵，主要以实际操作为主，一些下载资料已附带链接。</p>\n          </div>\n<h1 id=\"1-前言\"><a href=\"#1-前言\" class=\"headerlink\" title=\"1 前言\"></a>1 前言</h1>","more":"<p>首先，我们为什么要用到服务器。刚开始入门web的同学可能一直沉浸于使用自己的电脑本地调试出各种奇技淫巧而兴奋不已，然而当你想向他人炫耀一番时，你的方式是什么？打个包发过去，她/他可能还在用IE6，然后你的花哨的页面就没有然后了，当然这也得基于知道你网页入口在哪里。这时，服务器会派上用场，它就相当于一个寄存在遥远天边的电脑，与你桌上那台不同的是，每个人只要可以上网就能访问到里面的内容（当然深入了解还需要端口等知识）。那么，怎么访问呢？我们知道，每个网络上的机器都有一个IP地址，就像这样，127.0.0.1（这是电脑本地的IP），我们可以通过浏览器键入IP访问到它的内容。如果它那台主机配置了域名，你现在暂且可以这样理解，域名与IP是一一对应的关系，域名只是为了便于你记忆，就像baidu.com,大多数人肯定不会记住它的IP。不过作为我们这类人来说，IP就可以了，我相信你是可以记住的。域名的话，毕竟考虑国情，你还得经过备案，上传各种资料以及自拍，在你不准备正式对外发布使用之前是没什么必要的。<br><!-- more --><br>还有一种可以实现访问的方式是github,io，这是github推出 的一项免费服务，可以使用例如<a href=\"https://makergyt.github.io\" target=\"_blank\" rel=\"noopener\">https://makergyt.github.io</a>的域名访问到你的内容，网页可以通过它的桌面软件上传，屏蔽了服务器端的那些操作，比较简单。当然这是对于前端同学来讲适用。下面将分别开始这两种方式的实际操作。</p>\n<h1 id=\"2-开工\"><a href=\"#2-开工\" class=\"headerlink\" title=\"2 开工\"></a>2 开工</h1><h2 id=\"2-1-服务器\"><a href=\"#2-1-服务器\" class=\"headerlink\" title=\"2.1 服务器\"></a>2.1 服务器</h2><h3 id=\"2-1-1-准备\"><a href=\"#2-1-1-准备\" class=\"headerlink\" title=\"2.1.1 准备\"></a>2.1.1 准备</h3><ol>\n<li><p>先拥有，确切的说是租用一台云服务器(或者虚拟主机)，网络上有很多服务商，五花八门，国内的有腾讯云，百度云(不是百度网盘！)，国外的有godady，区别是国外的不需要备案，但是速度可能会慢，国内的相反。这里推荐<a href=\"https://promotion.aliyun.com/ntms/yunparter/invite.html?userCode=89lfnf3q\" target=\"_blank\" rel=\"noopener\">阿里云</a>（点击获取代金券），还有<a href=\"https://promotion.aliyun.com/ntms/act/campus2018.html\" target=\"_blank\" rel=\"noopener\">学生优惠</a>，并且持续，关键是服务好。你可以选择时长，环境系统就选<code>centos7</code>（linux的一个发行版），不要用winserver,linux操作基础的都可以百度到,地域目前无所谓,时长看自身情况。</p>\n</li>\n<li><p>完成学生认证后，是直接获取支付宝认证信息，一步完成，就能使用这种优惠，购买时记得选择设置密码而先不是密钥，牢记你的密码。然后你进入管理控制台，就能看到你的服务器信息。<br><img src=\"http://upload-images.jianshu.io/upload_images/3234038-89e0ec0aeb204589.JPG?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240\" alt=\"点击左侧云服务器ECS实例，进入操作。\"><br><img src=\"http://upload-images.jianshu.io/upload_images/3234038-c92de9e9d0f7238c.JPG?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240\" alt=\"启动你服务器，运行中\"></p>\n</li>\n<li><p>配置安全组,左侧安全组-&gt;配置规则-&gt;公网入方向-&gt;快速创建规则,端口就先全开了，自定义端口因为我们这里推荐linux系统，填22/22（winserver填3389/3389），授权对象填<code>0.0.0.0/0</code>，表示允许任何地方连接你的服务器，先这样设置（一般没人闲的黑学生机）。<br>然后就开始ssh配置，这里使用阿里云的<a href=\"http://pan.baidu.com/s/1geUK7wJ\" target=\"_blank\" rel=\"noopener\">一键部署web环境包</a>（密码：h1ac），包含php环境,包含了官方参考文档。</p>\n</li>\n</ol>\n<h3 id=\"2-1-2-安装\"><a href=\"#2-1-2-安装\" class=\"headerlink\" title=\"2.1.2 安装\"></a>2.1.2 安装</h3><h4 id=\"2-1-2-1-材料工具\"><a href=\"#2-1-2-1-材料工具\" class=\"headerlink\" title=\"2.1.2.1 材料工具\"></a>2.1.2.1 材料工具</h4><p><a href=\"http://www.netsarang.com/download/down_xfp.html\" target=\"_blank\" rel=\"noopener\">xshell</a>(一个与linux通信的软件)和<a href=\"http://www.netsarang.com/download/down_xfp.html\" target=\"_blank\" rel=\"noopener\">xftp</a>(一个与服务器进行文件操作的软件)，然后其他的操作文档写的很详细，也可以参照<a href=\"http://source.docs.cloudcare.cn/support/tool/web/web_1/\" target=\"_blank\" rel=\"noopener\">最新官网文档</a>。</p>\n<h4 id=\"2-1-2-2-开始\"><a href=\"#2-1-2-2-开始\" class=\"headerlink\" title=\"2.1.2.2 开始\"></a>2.1.2.2 开始</h4><div class=\"note info\">\n            <p>web服务器选择Apache就行，因为桌面调试一般也是这样的，免去兼容的操作。Nginx虽然性能好，总有一些新操作，对开发形成难度，建议以后再使用。其他的版本根据你桌面使用的环境，就高不就低。我们的原则是快速入门配置，搭好工具把时间留给学习开发，不要被这些门槛绊住。那些命令行操作慢慢就熟悉了，其实后面使用时只需要知道怎么连接，怎么上传文件即可。</p>\n          </div>\n<h4 id=\"2-1-2-3-配置web服务器\"><a href=\"#2-1-2-3-配置web服务器\" class=\"headerlink\" title=\"2.1.2.3 配置web服务器\"></a>2.1.2.3 配置web服务器</h4><p>如果你是安装了php环境，它会默认安装phpwind(一个开源论坛)和phpmyadmin（一个可以在线访问数据库的工具，留着）,因为访问服务器外网IP时，它是指向phpwind的，所以可以先卸载掉这个东西，直接指向到你的网站根目录alidata/www/,这样以后就很方便的能访问到下面的不同文件夹内容。这里的操作就需要<a href=\"http://source.docs.cloudcare.cn/support/tool/web/web_1/\" target=\"_blank\" rel=\"noopener\">参考官网文档</a>了，也一样很详细。，在修改conf那一步，可参考这里已经测试过的<a href=\"http://pan.baidu.com/s/1skXirtr\" target=\"_blank\" rel=\"noopener\">配置文件</a>（密码a3f1）替换掉<code>phpwind.conf</code><br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;DirectoryMatch <span class=\"string\">\"/alidata/www/(attachment|html|data)\"</span>&gt;</span><br><span class=\"line\">&lt;Files ~ <span class=\"string\">\".php\"</span>&gt;</span><br><span class=\"line\">Order allow,deny</span><br><span class=\"line\">Deny <span class=\"keyword\">from</span> all</span><br><span class=\"line\">&lt;<span class=\"regexp\">/Files&gt;</span></span><br><span class=\"line\"><span class=\"regexp\">&lt;/</span>DirectoryMatch&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;VirtualHost *:<span class=\"number\">80</span>&gt;</span><br><span class=\"line\">\tDocumentRoot /alidata/www</span><br><span class=\"line\">\tServerName localhost</span><br><span class=\"line\">\tServerAlias localhost</span><br><span class=\"line\">\t&lt;Directory <span class=\"string\">\"/alidata/www\"</span>&gt;</span><br><span class=\"line\">\t    Options Indexes FollowSymLinks</span><br><span class=\"line\">\t    AllowOverride all</span><br><span class=\"line\">\t    Order allow,deny</span><br><span class=\"line\">\t    Allow <span class=\"keyword\">from</span> all</span><br><span class=\"line\">\t&lt;<span class=\"regexp\">/Directory&gt;</span></span><br><span class=\"line\"><span class=\"regexp\">\tErrorLog \"/</span>alidata/log/httpd/dx-error.log<span class=\"string\">\"</span></span><br><span class=\"line\"><span class=\"string\">\tCustomLog \"</span>/alidata/log/httpd/dx.log<span class=\"string\">\" common</span></span><br><span class=\"line\"><span class=\"string\">&lt;/VirtualHost&gt;</span></span><br></pre></td></tr></table></figure></p>\n<h3 id=\"2-1-3-测试\"><a href=\"#2-1-3-测试\" class=\"headerlink\" title=\"2.1.3 测试\"></a>2.1.3 测试</h3><p>好了，现在可以上传几个文件进行测试，浏览器键入IP时如果下面没有index的引导文件，是这样直接显示的，可以写一个简单的index.html上传看下效果，然后使用手机浏览器，QQ/微信内部打开（发个链接给别人，会自动识别）再访问下，保证正常访问到就说明基本的配置已经成功了。由于微信的安全保护，如果是IP或者没有被他收录的域名，是会跳出提示框，不过也不影响继续能访问到。解决这个的方法就是备案，https认证等等一系列证明网站是良好文明的。</p>\n<p><img src=\"http://upload-images.jianshu.io/upload_images/3234038-a6dae4a27308a323.JPG?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240\" alt></p>\n<h2 id=\"2-2-github-io\"><a href=\"#2-2-github-io\" class=\"headerlink\" title=\"2.2 github.io\"></a>2.2 github.io</h2><p>先注册一个自己的账号，用户名很重要，因为稍后生成的链接就是像<a href=\"https://makergyt.github.io\" target=\"_blank\" rel=\"noopener\">makergyt.github.io</a>（makergyt是一个用户名），后期也可以修改，但对应的链接就会失效，需要再次配置。<br>有三种方式，使用桌面软件快速构建，使用git命令，使用已经创建好的仓库，这里我们使用第一种。</p>\n<h3 id=\"2-2-1-开始\"><a href=\"#2-2-1-开始\" class=\"headerlink\" title=\"2.2.1 开始\"></a>2.2.1 开始</h3><p><img src=\"http://upload-images.jianshu.io/upload_images/3234038-2341fe768acb5fab.JPG?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240\" alt=\"1.Create a new repository\"></p>\n<p>安装软件，复制.git路径<br><img src=\"http://upload-images.jianshu.io/upload_images/3234038-94900541e70371a6.JPG?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240\" alt=\"2.克隆github上的仓库到本地\"></p>\n<p><img src=\"http://upload-images.jianshu.io/upload_images/3234038-72eb180da889081c.JPG?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240\" alt=\"3.项目内容放到该路径下\"></p>\n<p><img src=\"http://upload-images.jianshu.io/upload_images/3234038-372aaf03ea4ece35.JPG?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240\" alt=\"4.每次改动后，备注修改内容，然后就可以pull origin\"></p>\n<h3 id=\"2-2-2-测试\"><a href=\"#2-2-2-测试\" class=\"headerlink\" title=\"2.2.2 测试\"></a>2.2.2 测试</h3><p>现在可以试着访问github.io了，<code>用户名.github.io</code>，因为github托管在国外，可能会比较慢。上述两种建站方式，建议前端开发静态页面可以先使用github.io。</p>\n<div class=\"note info\">\n            <p>实现建站的路有很多条，服务也很多种，但是一路畅通的很少，常常看似简单实际需要别的技术栈。去粗取精，权衡利弊，以上这两种是较为基础的。</p>\n          </div>\n<h1 id=\"Reference\"><a href=\"#Reference\" class=\"headerlink\" title=\"Reference\"></a>Reference</h1><p><small>[1] Github.Websites for you and your projects.[EB/OL].<a href=\"https://pages.github.com\" target=\"_blank\" rel=\"noopener\">https://pages.github.com</a> .2017.</small></p>"},{"title":"微信小程序资料库需求的实现","date":"2019-04-13T09:14:48.000Z","_content":"\n# 1 云存储\n只提供了上传、下载、删除、临时链接简单的针对性接口，如果实现文件管理，还需要借助云数据库。  \n\n<!-- more -->\n\n# 2 腾讯云COS对象存储\n## 2.1 基本过程\n### 2.1.1 初始化\n\n前端（小程序端）通过wx.reauest向后端(php)发起请求计算签名，后端(php)携带SecretId和SecretKey向官方发起请求获取临时密钥计算出签名返回给前端（小程序端）。小程序端初始化一个cos实例，可以通过getBucket接口获取bucket内的资源信息。\n### 2.1.2 接口调用\n#### 2.1.2.1 调用一次getBucket，获取当前全部object信息（Key,LastModified）\n然而实际并不是这样，接口对单次请求返回的最大条目数量有限制（1000），意味着如果bucket内对象上升到一定数量，需要多次调用此接口，那么就需要判断出何时结束调用，可以通过计数如果本次返回数目小于1000，即可结束。\n这样做后，需要手动对返回对象列表进行处理，因为既包含了所有文件的路径信息，也包含了所有文件夹的信息，需求是按照树型的文件结构展示，就需要将这些条目信息按照多维的数组存储（列表标准化），目前并没有设计出高效的算法。\n##### 优点\n- 减少网络请求\n- 每个对象具有唯一的标志（Key）以及时间信息\n\n##### 缺点\n- 对象数目上升时获取到大量信息（相对当前属于多余信息），不能实现按需加载\n- 数据可能不实时同步\n\n#### 2.1.2.2 按需调用getBucket(通过前缀匹配prefix和定界符delimiter)\n这样做会使请求结果越来越趋近于实际需求，而后一次请求是前一次请求的子集，请求过程中需要记录当前的访问路径信息，以便在下次请求时作为前缀匹配。需要获取到当前对象列表后进行剔除下一级及之后的条目（列表标准化）。最终通过getObjectUrl获取对象信息，目前的API只能获取到文件URL,且此URL由于自带临时签名不能作为唯一标志，除非在上一级getBucket信息时保存下来。\n##### 优点\n- 实现逻辑简单\n- 具备实时性\n\n##### 缺点\n- 多次网络请求，依赖网络环境\n- 请求结果重叠，请求后的数据没有及时利用\n\n为了加强体验，在获取到对象列表后，根据条目的特征匹配对应的图标。\n## 2.2 封装组件\n### 2.2.1 树型组件\n#### 2.2.1.1 过程\n- 参照windows文件管理器，分为顶部地址栏和下方目录栏。组件对外的属性为入口地址，便于实现从特定页到对应资料页。\n- 对属性添加监听器ininView，实现调用组件时即进行首次请求接口事件。\n- 点击栏目后，触发请求接口事件，分别更新地址和目录信息。\n- 由于地址栏目需要支持路径选择，则其字段为数组类型，点击后触发新的请求接口事件。\n- 为了防止快点击和重复点击，添加了事件锁。\n- 顶部地址栏由于无法预计的补充长度，换用scrollView，并设置scroll-into-view为当前地址的最后一项\n\n#### 2.2.1.2 样式问题\n微信对自定义组件有一个特殊要求\n{% note warning %}\n注意：在组件wxss中不应使用ID选择器、属性选择器和标签名选择器。\n{% endnote %}\n这样的要求当然是基于隔离样式、使组件更独立的考虑。于是不能再使用原有页面样式，开发中断，转去调样式。\n### 2.2.2 图标组件\n#### 2.2.2.1 图标来源\n使用[阿里巴巴矢量图标库](https://www.iconfont.cn),图标使用font class方式引入。\n1. 直接挑选合适的图标svg（也可自行设计svg）下载，导入到图标项目内；\n2. 构建完成后下载，使用其中的iconfont.css放入组件的样式文件中\n\n#### 2.2.2.2 图标匹配\n在对列表标准化时直接判断当前类型并写入Type值。\n判断当前类型由于目前图标库覆盖面小，大致是模糊匹配，后续图标库完整后将图标与文件后缀一致化直接匹配。\n\n#### 2.2.2.3 图标色彩问题\n由于使用font class方式，图标默认为黑色，需要按需手动在组件引用处写入color属性内，也可直接固定补充在组件样式内。\n### 2.2.3 组件通信\n#### 2.2.3.1 组件内数据传入页面\n组件获取到文件地址信息后，需要传入页面以进行后续操作（wx.openDocument）。\n在自定义组件的内部添加事件，在事件函数内使用triggerEvent，将需要传出的数据与页面事件bind:event绑定，在页面调用组件时绑定该组件事件，页面事件内即可通过组件事件的触发获取到数据。\n### 2.2.4 文件详情页\n需求：\n- 上传者\n- 修改时间\n- 下载量\n- 大小\n- 评价\n- 下载 :小文件支持下载预览，大文件返回临时外部下载链接\n- 预览打开\n\n## 2.3 总结\n- cos不适合作为当前资料库需求的解决方案，目前github上关于高校课程的资料分享关注度持续上升，正在考虑此方式。\n- 微信小程序原生开发的痛点在于，官方在设计时并没有通盘考虑，而总感觉是打补丁，让本身就需要并行关注多个文件的开发增添了很多考虑。且文档缺乏系统整理，内容详略欠妥，概念缺乏区分，目录内容重复不易查阅，文档系统加载体验也较差。于是便随之衍生多种多样的库，多种多样的商业模式和生态链上下游，当初微信公众号便是如此，似乎有意不去做完善功能，有意在拓展更多业务。孰优孰劣？\n\n# 3 github\n此方式API丰富(官网文档加载龟速)，操作简便且多样化。由于公开，可能面临莫须有的教学资料版权和使用问题。\n对接口调用有限制\n{% note warning %}\nFor unauthenticated requests, the rate limit allows for up to 60 requests per hour. Unauthenticated requests are associated with the originating IP address, and not the user making requests.\n{% endnote %}\n而微信对页面栈也有限制\n{% note warning %} \nThe current page path can only have a maximum of 10 layers.\n{% endnote %}\n这样的话就不便于采用每次根据目录访问接口并navigateTo，解决方案是获取github授权，在小程序端数据直接覆盖更新，设置路径栏，方便自由选择。\n## 3.0 文档加载过慢\n既然\n{% note info no-icon%}\nWe have recently completed a milestone where we were able to drop jQuery as a dependency of the frontend code for GitHub.com. This marks the end of a gradual, years-long transition of increasingly decoupling from jQuery until we were able to completely remove the library. In this post, we will explain a bit of history of how we started depending on jQuery in the first place, how we realized when it was no longer needed, and point out that—instead of replacing it with another library or framework—we were able to achieve everything that we needed using standard browser APIs.\n{% endnote%}\n那么\n![](https://blog-cdn.makergyt.com/static/images/fetch_github.png)\n如何解释，这也正是迟迟无法加载的原因之一。\n## 3.1 授权\ngithub大致有三种授权方式，\n- Basic authoriazition\n直接授权，传入base64编码的账号和密码(登录成功后缓存到本地)参数，下次请求API在header中携带此参数\n- token\n由用户自发生成，同样缓存到本地，下次请求携带\n- oauth2.0\n由于小程序处于较为封闭的环境，而个人账号又不支持webView，因此无法引导用户授权\n\n授权完成后，每小时请求API的次数限制由60升级为5000\n## 3.2 限制\n在所有功能开发完成后，突然发现无法将github的域名加到小程序后台(调试时跳过了域名检查)\n{% note warning %}\n域名必须经过 ICP 备案；\n{% endnote %}\n那么，如果将api接口做转发，这种方式将进一步拉低访问速度，当然可以做缓存，这必然又导致实时性的问题。这样看来，采用本方案优势显得并不大，如果选用国内的码云(coding没有开放接口)，将进一步缩小影响力与使用受众范围。如果用云函数去请求api再下发数据，\n*未完待续*\n\n# Reference\n<small>\n[1] 微信公众平台.小程序开发-云开发-存储API[EB/OL].https://dwz.cn/LAhpCnIf .2019\n[2] 腾讯云.对象存储接口文档[EB/OL].https://cloud.tencent.com/document/product/436/12260 .2019\n[3] 前端[色色].微信小程序——自定义图标组件[EB/OL].https://www.cnblogs.com/sese/p/9765344.html .2018\n[4] Engineering.Removing jQuery from GitHub.com frontend[EB/OL].https://github.blog/2018-09-06-removing-jquery-from-github-frontend/ .2018\n</small>","source":"_posts/zh-CN/微信小程序资料库需求的实现.md","raw":"---\ntitle: 微信小程序资料库需求的实现\ndate: 2019-04-13 17:14:48\ntags:\n- wechat\n\ncategories: record\n---\n\n# 1 云存储\n只提供了上传、下载、删除、临时链接简单的针对性接口，如果实现文件管理，还需要借助云数据库。  \n\n<!-- more -->\n\n# 2 腾讯云COS对象存储\n## 2.1 基本过程\n### 2.1.1 初始化\n\n前端（小程序端）通过wx.reauest向后端(php)发起请求计算签名，后端(php)携带SecretId和SecretKey向官方发起请求获取临时密钥计算出签名返回给前端（小程序端）。小程序端初始化一个cos实例，可以通过getBucket接口获取bucket内的资源信息。\n### 2.1.2 接口调用\n#### 2.1.2.1 调用一次getBucket，获取当前全部object信息（Key,LastModified）\n然而实际并不是这样，接口对单次请求返回的最大条目数量有限制（1000），意味着如果bucket内对象上升到一定数量，需要多次调用此接口，那么就需要判断出何时结束调用，可以通过计数如果本次返回数目小于1000，即可结束。\n这样做后，需要手动对返回对象列表进行处理，因为既包含了所有文件的路径信息，也包含了所有文件夹的信息，需求是按照树型的文件结构展示，就需要将这些条目信息按照多维的数组存储（列表标准化），目前并没有设计出高效的算法。\n##### 优点\n- 减少网络请求\n- 每个对象具有唯一的标志（Key）以及时间信息\n\n##### 缺点\n- 对象数目上升时获取到大量信息（相对当前属于多余信息），不能实现按需加载\n- 数据可能不实时同步\n\n#### 2.1.2.2 按需调用getBucket(通过前缀匹配prefix和定界符delimiter)\n这样做会使请求结果越来越趋近于实际需求，而后一次请求是前一次请求的子集，请求过程中需要记录当前的访问路径信息，以便在下次请求时作为前缀匹配。需要获取到当前对象列表后进行剔除下一级及之后的条目（列表标准化）。最终通过getObjectUrl获取对象信息，目前的API只能获取到文件URL,且此URL由于自带临时签名不能作为唯一标志，除非在上一级getBucket信息时保存下来。\n##### 优点\n- 实现逻辑简单\n- 具备实时性\n\n##### 缺点\n- 多次网络请求，依赖网络环境\n- 请求结果重叠，请求后的数据没有及时利用\n\n为了加强体验，在获取到对象列表后，根据条目的特征匹配对应的图标。\n## 2.2 封装组件\n### 2.2.1 树型组件\n#### 2.2.1.1 过程\n- 参照windows文件管理器，分为顶部地址栏和下方目录栏。组件对外的属性为入口地址，便于实现从特定页到对应资料页。\n- 对属性添加监听器ininView，实现调用组件时即进行首次请求接口事件。\n- 点击栏目后，触发请求接口事件，分别更新地址和目录信息。\n- 由于地址栏目需要支持路径选择，则其字段为数组类型，点击后触发新的请求接口事件。\n- 为了防止快点击和重复点击，添加了事件锁。\n- 顶部地址栏由于无法预计的补充长度，换用scrollView，并设置scroll-into-view为当前地址的最后一项\n\n#### 2.2.1.2 样式问题\n微信对自定义组件有一个特殊要求\n{% note warning %}\n注意：在组件wxss中不应使用ID选择器、属性选择器和标签名选择器。\n{% endnote %}\n这样的要求当然是基于隔离样式、使组件更独立的考虑。于是不能再使用原有页面样式，开发中断，转去调样式。\n### 2.2.2 图标组件\n#### 2.2.2.1 图标来源\n使用[阿里巴巴矢量图标库](https://www.iconfont.cn),图标使用font class方式引入。\n1. 直接挑选合适的图标svg（也可自行设计svg）下载，导入到图标项目内；\n2. 构建完成后下载，使用其中的iconfont.css放入组件的样式文件中\n\n#### 2.2.2.2 图标匹配\n在对列表标准化时直接判断当前类型并写入Type值。\n判断当前类型由于目前图标库覆盖面小，大致是模糊匹配，后续图标库完整后将图标与文件后缀一致化直接匹配。\n\n#### 2.2.2.3 图标色彩问题\n由于使用font class方式，图标默认为黑色，需要按需手动在组件引用处写入color属性内，也可直接固定补充在组件样式内。\n### 2.2.3 组件通信\n#### 2.2.3.1 组件内数据传入页面\n组件获取到文件地址信息后，需要传入页面以进行后续操作（wx.openDocument）。\n在自定义组件的内部添加事件，在事件函数内使用triggerEvent，将需要传出的数据与页面事件bind:event绑定，在页面调用组件时绑定该组件事件，页面事件内即可通过组件事件的触发获取到数据。\n### 2.2.4 文件详情页\n需求：\n- 上传者\n- 修改时间\n- 下载量\n- 大小\n- 评价\n- 下载 :小文件支持下载预览，大文件返回临时外部下载链接\n- 预览打开\n\n## 2.3 总结\n- cos不适合作为当前资料库需求的解决方案，目前github上关于高校课程的资料分享关注度持续上升，正在考虑此方式。\n- 微信小程序原生开发的痛点在于，官方在设计时并没有通盘考虑，而总感觉是打补丁，让本身就需要并行关注多个文件的开发增添了很多考虑。且文档缺乏系统整理，内容详略欠妥，概念缺乏区分，目录内容重复不易查阅，文档系统加载体验也较差。于是便随之衍生多种多样的库，多种多样的商业模式和生态链上下游，当初微信公众号便是如此，似乎有意不去做完善功能，有意在拓展更多业务。孰优孰劣？\n\n# 3 github\n此方式API丰富(官网文档加载龟速)，操作简便且多样化。由于公开，可能面临莫须有的教学资料版权和使用问题。\n对接口调用有限制\n{% note warning %}\nFor unauthenticated requests, the rate limit allows for up to 60 requests per hour. Unauthenticated requests are associated with the originating IP address, and not the user making requests.\n{% endnote %}\n而微信对页面栈也有限制\n{% note warning %} \nThe current page path can only have a maximum of 10 layers.\n{% endnote %}\n这样的话就不便于采用每次根据目录访问接口并navigateTo，解决方案是获取github授权，在小程序端数据直接覆盖更新，设置路径栏，方便自由选择。\n## 3.0 文档加载过慢\n既然\n{% note info no-icon%}\nWe have recently completed a milestone where we were able to drop jQuery as a dependency of the frontend code for GitHub.com. This marks the end of a gradual, years-long transition of increasingly decoupling from jQuery until we were able to completely remove the library. In this post, we will explain a bit of history of how we started depending on jQuery in the first place, how we realized when it was no longer needed, and point out that—instead of replacing it with another library or framework—we were able to achieve everything that we needed using standard browser APIs.\n{% endnote%}\n那么\n![](https://blog-cdn.makergyt.com/static/images/fetch_github.png)\n如何解释，这也正是迟迟无法加载的原因之一。\n## 3.1 授权\ngithub大致有三种授权方式，\n- Basic authoriazition\n直接授权，传入base64编码的账号和密码(登录成功后缓存到本地)参数，下次请求API在header中携带此参数\n- token\n由用户自发生成，同样缓存到本地，下次请求携带\n- oauth2.0\n由于小程序处于较为封闭的环境，而个人账号又不支持webView，因此无法引导用户授权\n\n授权完成后，每小时请求API的次数限制由60升级为5000\n## 3.2 限制\n在所有功能开发完成后，突然发现无法将github的域名加到小程序后台(调试时跳过了域名检查)\n{% note warning %}\n域名必须经过 ICP 备案；\n{% endnote %}\n那么，如果将api接口做转发，这种方式将进一步拉低访问速度，当然可以做缓存，这必然又导致实时性的问题。这样看来，采用本方案优势显得并不大，如果选用国内的码云(coding没有开放接口)，将进一步缩小影响力与使用受众范围。如果用云函数去请求api再下发数据，\n*未完待续*\n\n# Reference\n<small>\n[1] 微信公众平台.小程序开发-云开发-存储API[EB/OL].https://dwz.cn/LAhpCnIf .2019\n[2] 腾讯云.对象存储接口文档[EB/OL].https://cloud.tencent.com/document/product/436/12260 .2019\n[3] 前端[色色].微信小程序——自定义图标组件[EB/OL].https://www.cnblogs.com/sese/p/9765344.html .2018\n[4] Engineering.Removing jQuery from GitHub.com frontend[EB/OL].https://github.blog/2018-09-06-removing-jquery-from-github-frontend/ .2018\n</small>","slug":"微信小程序资料库需求的实现","published":1,"lang":"zh-CN","updated":"2019-04-29T01:07:50.660Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjvnq7zbo003g7jjxgckfnog3","content":"<link rel=\"stylesheet\" class=\"aplayer-secondary-style-marker\" href=\"/assets/css/APlayer.min.css\"><script src=\"/assets/js/APlayer.min.js\" class=\"aplayer-secondary-script-marker\"></script><script class=\"meting-secondary-script-marker\" src=\"/assets/js/Meting.min.js\"></script><link rel=\"stylesheet\" type=\"text/css\" href=\"https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css\"><h1 id=\"1-云存储\"><a href=\"#1-云存储\" class=\"headerlink\" title=\"1 云存储\"></a>1 云存储</h1><p>只提供了上传、下载、删除、临时链接简单的针对性接口，如果实现文件管理，还需要借助云数据库。  </p>\n<a id=\"more\"></a>\n<h1 id=\"2-腾讯云COS对象存储\"><a href=\"#2-腾讯云COS对象存储\" class=\"headerlink\" title=\"2 腾讯云COS对象存储\"></a>2 腾讯云COS对象存储</h1><h2 id=\"2-1-基本过程\"><a href=\"#2-1-基本过程\" class=\"headerlink\" title=\"2.1 基本过程\"></a>2.1 基本过程</h2><h3 id=\"2-1-1-初始化\"><a href=\"#2-1-1-初始化\" class=\"headerlink\" title=\"2.1.1 初始化\"></a>2.1.1 初始化</h3><p>前端（小程序端）通过wx.reauest向后端(php)发起请求计算签名，后端(php)携带SecretId和SecretKey向官方发起请求获取临时密钥计算出签名返回给前端（小程序端）。小程序端初始化一个cos实例，可以通过getBucket接口获取bucket内的资源信息。</p>\n<h3 id=\"2-1-2-接口调用\"><a href=\"#2-1-2-接口调用\" class=\"headerlink\" title=\"2.1.2 接口调用\"></a>2.1.2 接口调用</h3><h4 id=\"2-1-2-1-调用一次getBucket，获取当前全部object信息（Key-LastModified）\"><a href=\"#2-1-2-1-调用一次getBucket，获取当前全部object信息（Key-LastModified）\" class=\"headerlink\" title=\"2.1.2.1 调用一次getBucket，获取当前全部object信息（Key,LastModified）\"></a>2.1.2.1 调用一次getBucket，获取当前全部object信息（Key,LastModified）</h4><p>然而实际并不是这样，接口对单次请求返回的最大条目数量有限制（1000），意味着如果bucket内对象上升到一定数量，需要多次调用此接口，那么就需要判断出何时结束调用，可以通过计数如果本次返回数目小于1000，即可结束。<br>这样做后，需要手动对返回对象列表进行处理，因为既包含了所有文件的路径信息，也包含了所有文件夹的信息，需求是按照树型的文件结构展示，就需要将这些条目信息按照多维的数组存储（列表标准化），目前并没有设计出高效的算法。</p>\n<h5 id=\"优点\"><a href=\"#优点\" class=\"headerlink\" title=\"优点\"></a>优点</h5><ul>\n<li>减少网络请求</li>\n<li>每个对象具有唯一的标志（Key）以及时间信息</li>\n</ul>\n<h5 id=\"缺点\"><a href=\"#缺点\" class=\"headerlink\" title=\"缺点\"></a>缺点</h5><ul>\n<li>对象数目上升时获取到大量信息（相对当前属于多余信息），不能实现按需加载</li>\n<li>数据可能不实时同步</li>\n</ul>\n<h4 id=\"2-1-2-2-按需调用getBucket-通过前缀匹配prefix和定界符delimiter\"><a href=\"#2-1-2-2-按需调用getBucket-通过前缀匹配prefix和定界符delimiter\" class=\"headerlink\" title=\"2.1.2.2 按需调用getBucket(通过前缀匹配prefix和定界符delimiter)\"></a>2.1.2.2 按需调用getBucket(通过前缀匹配prefix和定界符delimiter)</h4><p>这样做会使请求结果越来越趋近于实际需求，而后一次请求是前一次请求的子集，请求过程中需要记录当前的访问路径信息，以便在下次请求时作为前缀匹配。需要获取到当前对象列表后进行剔除下一级及之后的条目（列表标准化）。最终通过getObjectUrl获取对象信息，目前的API只能获取到文件URL,且此URL由于自带临时签名不能作为唯一标志，除非在上一级getBucket信息时保存下来。</p>\n<h5 id=\"优点-1\"><a href=\"#优点-1\" class=\"headerlink\" title=\"优点\"></a>优点</h5><ul>\n<li>实现逻辑简单</li>\n<li>具备实时性</li>\n</ul>\n<h5 id=\"缺点-1\"><a href=\"#缺点-1\" class=\"headerlink\" title=\"缺点\"></a>缺点</h5><ul>\n<li>多次网络请求，依赖网络环境</li>\n<li>请求结果重叠，请求后的数据没有及时利用</li>\n</ul>\n<p>为了加强体验，在获取到对象列表后，根据条目的特征匹配对应的图标。</p>\n<h2 id=\"2-2-封装组件\"><a href=\"#2-2-封装组件\" class=\"headerlink\" title=\"2.2 封装组件\"></a>2.2 封装组件</h2><h3 id=\"2-2-1-树型组件\"><a href=\"#2-2-1-树型组件\" class=\"headerlink\" title=\"2.2.1 树型组件\"></a>2.2.1 树型组件</h3><h4 id=\"2-2-1-1-过程\"><a href=\"#2-2-1-1-过程\" class=\"headerlink\" title=\"2.2.1.1 过程\"></a>2.2.1.1 过程</h4><ul>\n<li>参照windows文件管理器，分为顶部地址栏和下方目录栏。组件对外的属性为入口地址，便于实现从特定页到对应资料页。</li>\n<li>对属性添加监听器ininView，实现调用组件时即进行首次请求接口事件。</li>\n<li>点击栏目后，触发请求接口事件，分别更新地址和目录信息。</li>\n<li>由于地址栏目需要支持路径选择，则其字段为数组类型，点击后触发新的请求接口事件。</li>\n<li>为了防止快点击和重复点击，添加了事件锁。</li>\n<li>顶部地址栏由于无法预计的补充长度，换用scrollView，并设置scroll-into-view为当前地址的最后一项</li>\n</ul>\n<h4 id=\"2-2-1-2-样式问题\"><a href=\"#2-2-1-2-样式问题\" class=\"headerlink\" title=\"2.2.1.2 样式问题\"></a>2.2.1.2 样式问题</h4><p>微信对自定义组件有一个特殊要求<br><div class=\"note warning\">\n            <p>注意：在组件wxss中不应使用ID选择器、属性选择器和标签名选择器。</p>\n          </div><br>这样的要求当然是基于隔离样式、使组件更独立的考虑。于是不能再使用原有页面样式，开发中断，转去调样式。</p>\n<h3 id=\"2-2-2-图标组件\"><a href=\"#2-2-2-图标组件\" class=\"headerlink\" title=\"2.2.2 图标组件\"></a>2.2.2 图标组件</h3><h4 id=\"2-2-2-1-图标来源\"><a href=\"#2-2-2-1-图标来源\" class=\"headerlink\" title=\"2.2.2.1 图标来源\"></a>2.2.2.1 图标来源</h4><p>使用<a href=\"https://www.iconfont.cn\" target=\"_blank\" rel=\"noopener\">阿里巴巴矢量图标库</a>,图标使用font class方式引入。</p>\n<ol>\n<li>直接挑选合适的图标svg（也可自行设计svg）下载，导入到图标项目内；</li>\n<li>构建完成后下载，使用其中的iconfont.css放入组件的样式文件中</li>\n</ol>\n<h4 id=\"2-2-2-2-图标匹配\"><a href=\"#2-2-2-2-图标匹配\" class=\"headerlink\" title=\"2.2.2.2 图标匹配\"></a>2.2.2.2 图标匹配</h4><p>在对列表标准化时直接判断当前类型并写入Type值。<br>判断当前类型由于目前图标库覆盖面小，大致是模糊匹配，后续图标库完整后将图标与文件后缀一致化直接匹配。</p>\n<h4 id=\"2-2-2-3-图标色彩问题\"><a href=\"#2-2-2-3-图标色彩问题\" class=\"headerlink\" title=\"2.2.2.3 图标色彩问题\"></a>2.2.2.3 图标色彩问题</h4><p>由于使用font class方式，图标默认为黑色，需要按需手动在组件引用处写入color属性内，也可直接固定补充在组件样式内。</p>\n<h3 id=\"2-2-3-组件通信\"><a href=\"#2-2-3-组件通信\" class=\"headerlink\" title=\"2.2.3 组件通信\"></a>2.2.3 组件通信</h3><h4 id=\"2-2-3-1-组件内数据传入页面\"><a href=\"#2-2-3-1-组件内数据传入页面\" class=\"headerlink\" title=\"2.2.3.1 组件内数据传入页面\"></a>2.2.3.1 组件内数据传入页面</h4><p>组件获取到文件地址信息后，需要传入页面以进行后续操作（wx.openDocument）。<br>在自定义组件的内部添加事件，在事件函数内使用triggerEvent，将需要传出的数据与页面事件bind:event绑定，在页面调用组件时绑定该组件事件，页面事件内即可通过组件事件的触发获取到数据。</p>\n<h3 id=\"2-2-4-文件详情页\"><a href=\"#2-2-4-文件详情页\" class=\"headerlink\" title=\"2.2.4 文件详情页\"></a>2.2.4 文件详情页</h3><p>需求：</p>\n<ul>\n<li>上传者</li>\n<li>修改时间</li>\n<li>下载量</li>\n<li>大小</li>\n<li>评价</li>\n<li>下载 :小文件支持下载预览，大文件返回临时外部下载链接</li>\n<li>预览打开</li>\n</ul>\n<h2 id=\"2-3-总结\"><a href=\"#2-3-总结\" class=\"headerlink\" title=\"2.3 总结\"></a>2.3 总结</h2><ul>\n<li>cos不适合作为当前资料库需求的解决方案，目前github上关于高校课程的资料分享关注度持续上升，正在考虑此方式。</li>\n<li>微信小程序原生开发的痛点在于，官方在设计时并没有通盘考虑，而总感觉是打补丁，让本身就需要并行关注多个文件的开发增添了很多考虑。且文档缺乏系统整理，内容详略欠妥，概念缺乏区分，目录内容重复不易查阅，文档系统加载体验也较差。于是便随之衍生多种多样的库，多种多样的商业模式和生态链上下游，当初微信公众号便是如此，似乎有意不去做完善功能，有意在拓展更多业务。孰优孰劣？</li>\n</ul>\n<h1 id=\"3-github\"><a href=\"#3-github\" class=\"headerlink\" title=\"3 github\"></a>3 github</h1><p>此方式API丰富(官网文档加载龟速)，操作简便且多样化。由于公开，可能面临莫须有的教学资料版权和使用问题。<br>对接口调用有限制<br><div class=\"note warning\">\n            <p>For unauthenticated requests, the rate limit allows for up to 60 requests per hour. Unauthenticated requests are associated with the originating IP address, and not the user making requests.</p>\n          </div><br>而微信对页面栈也有限制<br><div class=\"note warning\">\n            <p>The current page path can only have a maximum of 10 layers.</p>\n          </div><br>这样的话就不便于采用每次根据目录访问接口并navigateTo，解决方案是获取github授权，在小程序端数据直接覆盖更新，设置路径栏，方便自由选择。</p>\n<h2 id=\"3-0-文档加载过慢\"><a href=\"#3-0-文档加载过慢\" class=\"headerlink\" title=\"3.0 文档加载过慢\"></a>3.0 文档加载过慢</h2><p>既然<br><div class=\"note info no-icon\">\n            <p>We have recently completed a milestone where we were able to drop jQuery as a dependency of the frontend code for GitHub.com. This marks the end of a gradual, years-long transition of increasingly decoupling from jQuery until we were able to completely remove the library. In this post, we will explain a bit of history of how we started depending on jQuery in the first place, how we realized when it was no longer needed, and point out that—instead of replacing it with another library or framework—we were able to achieve everything that we needed using standard browser APIs.</p>\n          </div><br>那么<br><img src=\"https://blog-cdn.makergyt.com/static/images/fetch_github.png\" alt><br>如何解释，这也正是迟迟无法加载的原因之一。</p>\n<h2 id=\"3-1-授权\"><a href=\"#3-1-授权\" class=\"headerlink\" title=\"3.1 授权\"></a>3.1 授权</h2><p>github大致有三种授权方式，</p>\n<ul>\n<li>Basic authoriazition<br>直接授权，传入base64编码的账号和密码(登录成功后缓存到本地)参数，下次请求API在header中携带此参数</li>\n<li>token<br>由用户自发生成，同样缓存到本地，下次请求携带</li>\n<li>oauth2.0<br>由于小程序处于较为封闭的环境，而个人账号又不支持webView，因此无法引导用户授权</li>\n</ul>\n<p>授权完成后，每小时请求API的次数限制由60升级为5000</p>\n<h2 id=\"3-2-限制\"><a href=\"#3-2-限制\" class=\"headerlink\" title=\"3.2 限制\"></a>3.2 限制</h2><p>在所有功能开发完成后，突然发现无法将github的域名加到小程序后台(调试时跳过了域名检查)<br><div class=\"note warning\">\n            <p>域名必须经过 ICP 备案；</p>\n          </div><br>那么，如果将api接口做转发，这种方式将进一步拉低访问速度，当然可以做缓存，这必然又导致实时性的问题。这样看来，采用本方案优势显得并不大，如果选用国内的码云(coding没有开放接口)，将进一步缩小影响力与使用受众范围。如果用云函数去请求api再下发数据，<br><em>未完待续</em></p>\n<h1 id=\"Reference\"><a href=\"#Reference\" class=\"headerlink\" title=\"Reference\"></a>Reference</h1><p><small><br>[1] 微信公众平台.小程序开发-云开发-存储API[EB/OL].<a href=\"https://dwz.cn/LAhpCnIf\" target=\"_blank\" rel=\"noopener\">https://dwz.cn/LAhpCnIf</a> .2019<br>[2] 腾讯云.对象存储接口文档[EB/OL].<a href=\"https://cloud.tencent.com/document/product/436/12260\" target=\"_blank\" rel=\"noopener\">https://cloud.tencent.com/document/product/436/12260</a> .2019<br>[3] 前端[色色].微信小程序——自定义图标组件[EB/OL].<a href=\"https://www.cnblogs.com/sese/p/9765344.html\" target=\"_blank\" rel=\"noopener\">https://www.cnblogs.com/sese/p/9765344.html</a> .2018<br>[4] Engineering.Removing jQuery from GitHub.com frontend[EB/OL].<a href=\"https://github.blog/2018-09-06-removing-jquery-from-github-frontend/\" target=\"_blank\" rel=\"noopener\">https://github.blog/2018-09-06-removing-jquery-from-github-frontend/</a> .2018<br></small></p>\n","site":{"data":{}},"excerpt":"<h1 id=\"1-云存储\"><a href=\"#1-云存储\" class=\"headerlink\" title=\"1 云存储\"></a>1 云存储</h1><p>只提供了上传、下载、删除、临时链接简单的针对性接口，如果实现文件管理，还需要借助云数据库。  </p>","more":"<h1 id=\"2-腾讯云COS对象存储\"><a href=\"#2-腾讯云COS对象存储\" class=\"headerlink\" title=\"2 腾讯云COS对象存储\"></a>2 腾讯云COS对象存储</h1><h2 id=\"2-1-基本过程\"><a href=\"#2-1-基本过程\" class=\"headerlink\" title=\"2.1 基本过程\"></a>2.1 基本过程</h2><h3 id=\"2-1-1-初始化\"><a href=\"#2-1-1-初始化\" class=\"headerlink\" title=\"2.1.1 初始化\"></a>2.1.1 初始化</h3><p>前端（小程序端）通过wx.reauest向后端(php)发起请求计算签名，后端(php)携带SecretId和SecretKey向官方发起请求获取临时密钥计算出签名返回给前端（小程序端）。小程序端初始化一个cos实例，可以通过getBucket接口获取bucket内的资源信息。</p>\n<h3 id=\"2-1-2-接口调用\"><a href=\"#2-1-2-接口调用\" class=\"headerlink\" title=\"2.1.2 接口调用\"></a>2.1.2 接口调用</h3><h4 id=\"2-1-2-1-调用一次getBucket，获取当前全部object信息（Key-LastModified）\"><a href=\"#2-1-2-1-调用一次getBucket，获取当前全部object信息（Key-LastModified）\" class=\"headerlink\" title=\"2.1.2.1 调用一次getBucket，获取当前全部object信息（Key,LastModified）\"></a>2.1.2.1 调用一次getBucket，获取当前全部object信息（Key,LastModified）</h4><p>然而实际并不是这样，接口对单次请求返回的最大条目数量有限制（1000），意味着如果bucket内对象上升到一定数量，需要多次调用此接口，那么就需要判断出何时结束调用，可以通过计数如果本次返回数目小于1000，即可结束。<br>这样做后，需要手动对返回对象列表进行处理，因为既包含了所有文件的路径信息，也包含了所有文件夹的信息，需求是按照树型的文件结构展示，就需要将这些条目信息按照多维的数组存储（列表标准化），目前并没有设计出高效的算法。</p>\n<h5 id=\"优点\"><a href=\"#优点\" class=\"headerlink\" title=\"优点\"></a>优点</h5><ul>\n<li>减少网络请求</li>\n<li>每个对象具有唯一的标志（Key）以及时间信息</li>\n</ul>\n<h5 id=\"缺点\"><a href=\"#缺点\" class=\"headerlink\" title=\"缺点\"></a>缺点</h5><ul>\n<li>对象数目上升时获取到大量信息（相对当前属于多余信息），不能实现按需加载</li>\n<li>数据可能不实时同步</li>\n</ul>\n<h4 id=\"2-1-2-2-按需调用getBucket-通过前缀匹配prefix和定界符delimiter\"><a href=\"#2-1-2-2-按需调用getBucket-通过前缀匹配prefix和定界符delimiter\" class=\"headerlink\" title=\"2.1.2.2 按需调用getBucket(通过前缀匹配prefix和定界符delimiter)\"></a>2.1.2.2 按需调用getBucket(通过前缀匹配prefix和定界符delimiter)</h4><p>这样做会使请求结果越来越趋近于实际需求，而后一次请求是前一次请求的子集，请求过程中需要记录当前的访问路径信息，以便在下次请求时作为前缀匹配。需要获取到当前对象列表后进行剔除下一级及之后的条目（列表标准化）。最终通过getObjectUrl获取对象信息，目前的API只能获取到文件URL,且此URL由于自带临时签名不能作为唯一标志，除非在上一级getBucket信息时保存下来。</p>\n<h5 id=\"优点-1\"><a href=\"#优点-1\" class=\"headerlink\" title=\"优点\"></a>优点</h5><ul>\n<li>实现逻辑简单</li>\n<li>具备实时性</li>\n</ul>\n<h5 id=\"缺点-1\"><a href=\"#缺点-1\" class=\"headerlink\" title=\"缺点\"></a>缺点</h5><ul>\n<li>多次网络请求，依赖网络环境</li>\n<li>请求结果重叠，请求后的数据没有及时利用</li>\n</ul>\n<p>为了加强体验，在获取到对象列表后，根据条目的特征匹配对应的图标。</p>\n<h2 id=\"2-2-封装组件\"><a href=\"#2-2-封装组件\" class=\"headerlink\" title=\"2.2 封装组件\"></a>2.2 封装组件</h2><h3 id=\"2-2-1-树型组件\"><a href=\"#2-2-1-树型组件\" class=\"headerlink\" title=\"2.2.1 树型组件\"></a>2.2.1 树型组件</h3><h4 id=\"2-2-1-1-过程\"><a href=\"#2-2-1-1-过程\" class=\"headerlink\" title=\"2.2.1.1 过程\"></a>2.2.1.1 过程</h4><ul>\n<li>参照windows文件管理器，分为顶部地址栏和下方目录栏。组件对外的属性为入口地址，便于实现从特定页到对应资料页。</li>\n<li>对属性添加监听器ininView，实现调用组件时即进行首次请求接口事件。</li>\n<li>点击栏目后，触发请求接口事件，分别更新地址和目录信息。</li>\n<li>由于地址栏目需要支持路径选择，则其字段为数组类型，点击后触发新的请求接口事件。</li>\n<li>为了防止快点击和重复点击，添加了事件锁。</li>\n<li>顶部地址栏由于无法预计的补充长度，换用scrollView，并设置scroll-into-view为当前地址的最后一项</li>\n</ul>\n<h4 id=\"2-2-1-2-样式问题\"><a href=\"#2-2-1-2-样式问题\" class=\"headerlink\" title=\"2.2.1.2 样式问题\"></a>2.2.1.2 样式问题</h4><p>微信对自定义组件有一个特殊要求<br><div class=\"note warning\">\n            <p>注意：在组件wxss中不应使用ID选择器、属性选择器和标签名选择器。</p>\n          </div><br>这样的要求当然是基于隔离样式、使组件更独立的考虑。于是不能再使用原有页面样式，开发中断，转去调样式。</p>\n<h3 id=\"2-2-2-图标组件\"><a href=\"#2-2-2-图标组件\" class=\"headerlink\" title=\"2.2.2 图标组件\"></a>2.2.2 图标组件</h3><h4 id=\"2-2-2-1-图标来源\"><a href=\"#2-2-2-1-图标来源\" class=\"headerlink\" title=\"2.2.2.1 图标来源\"></a>2.2.2.1 图标来源</h4><p>使用<a href=\"https://www.iconfont.cn\" target=\"_blank\" rel=\"noopener\">阿里巴巴矢量图标库</a>,图标使用font class方式引入。</p>\n<ol>\n<li>直接挑选合适的图标svg（也可自行设计svg）下载，导入到图标项目内；</li>\n<li>构建完成后下载，使用其中的iconfont.css放入组件的样式文件中</li>\n</ol>\n<h4 id=\"2-2-2-2-图标匹配\"><a href=\"#2-2-2-2-图标匹配\" class=\"headerlink\" title=\"2.2.2.2 图标匹配\"></a>2.2.2.2 图标匹配</h4><p>在对列表标准化时直接判断当前类型并写入Type值。<br>判断当前类型由于目前图标库覆盖面小，大致是模糊匹配，后续图标库完整后将图标与文件后缀一致化直接匹配。</p>\n<h4 id=\"2-2-2-3-图标色彩问题\"><a href=\"#2-2-2-3-图标色彩问题\" class=\"headerlink\" title=\"2.2.2.3 图标色彩问题\"></a>2.2.2.3 图标色彩问题</h4><p>由于使用font class方式，图标默认为黑色，需要按需手动在组件引用处写入color属性内，也可直接固定补充在组件样式内。</p>\n<h3 id=\"2-2-3-组件通信\"><a href=\"#2-2-3-组件通信\" class=\"headerlink\" title=\"2.2.3 组件通信\"></a>2.2.3 组件通信</h3><h4 id=\"2-2-3-1-组件内数据传入页面\"><a href=\"#2-2-3-1-组件内数据传入页面\" class=\"headerlink\" title=\"2.2.3.1 组件内数据传入页面\"></a>2.2.3.1 组件内数据传入页面</h4><p>组件获取到文件地址信息后，需要传入页面以进行后续操作（wx.openDocument）。<br>在自定义组件的内部添加事件，在事件函数内使用triggerEvent，将需要传出的数据与页面事件bind:event绑定，在页面调用组件时绑定该组件事件，页面事件内即可通过组件事件的触发获取到数据。</p>\n<h3 id=\"2-2-4-文件详情页\"><a href=\"#2-2-4-文件详情页\" class=\"headerlink\" title=\"2.2.4 文件详情页\"></a>2.2.4 文件详情页</h3><p>需求：</p>\n<ul>\n<li>上传者</li>\n<li>修改时间</li>\n<li>下载量</li>\n<li>大小</li>\n<li>评价</li>\n<li>下载 :小文件支持下载预览，大文件返回临时外部下载链接</li>\n<li>预览打开</li>\n</ul>\n<h2 id=\"2-3-总结\"><a href=\"#2-3-总结\" class=\"headerlink\" title=\"2.3 总结\"></a>2.3 总结</h2><ul>\n<li>cos不适合作为当前资料库需求的解决方案，目前github上关于高校课程的资料分享关注度持续上升，正在考虑此方式。</li>\n<li>微信小程序原生开发的痛点在于，官方在设计时并没有通盘考虑，而总感觉是打补丁，让本身就需要并行关注多个文件的开发增添了很多考虑。且文档缺乏系统整理，内容详略欠妥，概念缺乏区分，目录内容重复不易查阅，文档系统加载体验也较差。于是便随之衍生多种多样的库，多种多样的商业模式和生态链上下游，当初微信公众号便是如此，似乎有意不去做完善功能，有意在拓展更多业务。孰优孰劣？</li>\n</ul>\n<h1 id=\"3-github\"><a href=\"#3-github\" class=\"headerlink\" title=\"3 github\"></a>3 github</h1><p>此方式API丰富(官网文档加载龟速)，操作简便且多样化。由于公开，可能面临莫须有的教学资料版权和使用问题。<br>对接口调用有限制<br><div class=\"note warning\">\n            <p>For unauthenticated requests, the rate limit allows for up to 60 requests per hour. Unauthenticated requests are associated with the originating IP address, and not the user making requests.</p>\n          </div><br>而微信对页面栈也有限制<br><div class=\"note warning\">\n            <p>The current page path can only have a maximum of 10 layers.</p>\n          </div><br>这样的话就不便于采用每次根据目录访问接口并navigateTo，解决方案是获取github授权，在小程序端数据直接覆盖更新，设置路径栏，方便自由选择。</p>\n<h2 id=\"3-0-文档加载过慢\"><a href=\"#3-0-文档加载过慢\" class=\"headerlink\" title=\"3.0 文档加载过慢\"></a>3.0 文档加载过慢</h2><p>既然<br><div class=\"note info no-icon\">\n            <p>We have recently completed a milestone where we were able to drop jQuery as a dependency of the frontend code for GitHub.com. This marks the end of a gradual, years-long transition of increasingly decoupling from jQuery until we were able to completely remove the library. In this post, we will explain a bit of history of how we started depending on jQuery in the first place, how we realized when it was no longer needed, and point out that—instead of replacing it with another library or framework—we were able to achieve everything that we needed using standard browser APIs.</p>\n          </div><br>那么<br><img src=\"https://blog-cdn.makergyt.com/static/images/fetch_github.png\" alt><br>如何解释，这也正是迟迟无法加载的原因之一。</p>\n<h2 id=\"3-1-授权\"><a href=\"#3-1-授权\" class=\"headerlink\" title=\"3.1 授权\"></a>3.1 授权</h2><p>github大致有三种授权方式，</p>\n<ul>\n<li>Basic authoriazition<br>直接授权，传入base64编码的账号和密码(登录成功后缓存到本地)参数，下次请求API在header中携带此参数</li>\n<li>token<br>由用户自发生成，同样缓存到本地，下次请求携带</li>\n<li>oauth2.0<br>由于小程序处于较为封闭的环境，而个人账号又不支持webView，因此无法引导用户授权</li>\n</ul>\n<p>授权完成后，每小时请求API的次数限制由60升级为5000</p>\n<h2 id=\"3-2-限制\"><a href=\"#3-2-限制\" class=\"headerlink\" title=\"3.2 限制\"></a>3.2 限制</h2><p>在所有功能开发完成后，突然发现无法将github的域名加到小程序后台(调试时跳过了域名检查)<br><div class=\"note warning\">\n            <p>域名必须经过 ICP 备案；</p>\n          </div><br>那么，如果将api接口做转发，这种方式将进一步拉低访问速度，当然可以做缓存，这必然又导致实时性的问题。这样看来，采用本方案优势显得并不大，如果选用国内的码云(coding没有开放接口)，将进一步缩小影响力与使用受众范围。如果用云函数去请求api再下发数据，<br><em>未完待续</em></p>\n<h1 id=\"Reference\"><a href=\"#Reference\" class=\"headerlink\" title=\"Reference\"></a>Reference</h1><p><small><br>[1] 微信公众平台.小程序开发-云开发-存储API[EB/OL].<a href=\"https://dwz.cn/LAhpCnIf\" target=\"_blank\" rel=\"noopener\">https://dwz.cn/LAhpCnIf</a> .2019<br>[2] 腾讯云.对象存储接口文档[EB/OL].<a href=\"https://cloud.tencent.com/document/product/436/12260\" target=\"_blank\" rel=\"noopener\">https://cloud.tencent.com/document/product/436/12260</a> .2019<br>[3] 前端[色色].微信小程序——自定义图标组件[EB/OL].<a href=\"https://www.cnblogs.com/sese/p/9765344.html\" target=\"_blank\" rel=\"noopener\">https://www.cnblogs.com/sese/p/9765344.html</a> .2018<br>[4] Engineering.Removing jQuery from GitHub.com frontend[EB/OL].<a href=\"https://github.blog/2018-09-06-removing-jquery-from-github-frontend/\" target=\"_blank\" rel=\"noopener\">https://github.blog/2018-09-06-removing-jquery-from-github-frontend/</a> .2018<br></small></p>"},{"title":"扫描二维码分析","date":"2019-05-11T01:36:17.000Z","_content":"# 0 前言\n{% note info %}\n由于开发过程需要用到扫码登录，关键一环在于手机客户端扫码后，浏览器如何知道扫码成功并执行用户登录逻辑。首先想到的是浏览器渲染二维码后，开启监听服务端，那么基于C/S的架构和http协议，必然要求浏览器不断向服务端发起请求。而客户端扫码后，如何判断回调执行操作，如何保证二维码有效性，于是考虑先对成熟的产品进行剖析。\n{% endnote%}\n<!-- more -->\n# 1 二维码本质\n## 1.1 产生需求\n二维码既然是码，就只是一种信息的编码，与条形码相同，扫码只是机器直接读取信息到机器自己，与人眼看到一串字符没有本质区别。关键在于识别到文本后的操作，这其实是覆盖了用户对目标信息的输入操作。这一点很容易理解，但难以认识到，因为常常会聚焦于它的业务属性，而容易忽略它只是一条文本字符串。一些二维码工具如草料二维码，除了文本和网址,其他提供的媒体类功能已经在固有文本上做了一层处理或是依赖于其自身的业务体系，并没有超出二维码的使用能力。\n\n以网址二维码为例，在没有二维码的情况下，进入一个网址可以直接输入，当然如果要加上扫描进入，完全可以OCR直接扫描URL,但URL长度不固定，形式多样化，OCR端无法做到规范，那么条形码呢，条形码由于只能在横向方位表达信息，需要涵盖的URL越长，条码也就随之增长，不利于传播。而同样的信息编码，二维码在纵向和横向同时表达信息，信息空间利用率高，规范，容易扫描。\n\n二维码只是表明在二维空间上用几何形体来编码信息，常见的二维码是QR Code即Quick Response Code，属于矩阵式二维码，它只是二维码的一种码制，恰如余3码、8421码在BCD码中的范畴。有的QR Code复杂，有的简单,主要是版本不同，由40种尺寸的版本。通过色块的差异，使用0-1二进制编码。\n![](https://coolshell.cn/wp-content/uploads/2013/10/QR-Code-Overview.jpeg)\n\n## 1.2 业务形态：\n- 身份信息验证\n  对用户而言，属于被动读取，如一些移动支付设备、票务验证设备扫描当前要进行业务处理的用户持有的二维码，主要**用户平台读取用户信息**。对用户而言基本上处于无感操作，但其实风险较高，辨识度也不一定好。因而在逐步转为生物识别方案。\n- 关联信息服务\n  对用户而言，属于主动读取，如一些网址类场景的进入，主要用于用户获取二维码存储内容后触发打开网址操作，在一些特定的业务场景中，**扫码后的触发操作**丰富多样。\n\n那么综合看来，扫码登录对用户来说既是属于主动读取，但又是用于平台验证用户信息，需要进一步理清这里边的关系。扫码登录相当于在手机客户端与浏览器页面建立连接关系，这种关系是经由用户授权的。对用户而言，扫码是为了识别当前操作的web环境，而授权则是让web端去读取用户信息。这样看来，这里的扫码主要还是处于关联信息服务这一形态。\n# 2 扫码实现\n以下从用户角度反推技术实现，不一定正确\n## 2.1 系统底层扫码能力\n必然首先要调取摄像头，然后调用识别接口\n## 2.2 App实现扫码\n在手机操作系统之上，运行的App具有调用摄像头的功能，而相机、内置扫码功能均可以识别二维码信息，但只是文本信息，即使是url也并没有直接跳转，同一层次的app具备的扫码功能各不相同，主要集中于扫码界面的不同，扫码后的操作。相同的是，对于url的处理都是基于内置浏览器直接打开.\n测试一条百度的首页二维码，用支付宝微信等业务场景丰富的APP可以直接打开，而场景特定的天猫京东则会提示是否打开，打开会使用手机默认浏览器。百度网盘则直接提示，暂不支持非网盘二维码。这说明，在扫码识别成功后（识别到的必然还是一条文本信息），APP内部的回调机制会判断文本的属性。注意到同样是文本，微信支付宝会在一个特定的页面呈现（调用内置浏览器），而天猫等则会直接在扫码后显示（调用本地页面）。于是猜想，是否前者会将扫码内容上传至服务端后再由服务端处理后后统一下发，这样做就可以实现丰富的扫码场景，这也契合这类app的功能，本地应该不可能将所有的扫码后操作写入回调，根据扫码结果打开特定网页，在该网页执行回调操作\n## 2.3 小程序扫码\n在app之上，小程序提供了调起客户端扫码界面的接口，这一界面与直接使用微信扫码体验一致，然而差异在于接口提供的回调函数，如同一个中间件，在扫码完成后拦截扫码结果后自行处理,而微信扫码则只能被执行其上述的处理逻辑。在实现层面，两种扫码最终都会调用客户端的扫码接口，只需提供一个场景参数来判断后续回调该如何执行即可。\n\n# 3 扫码登录分析\n在app之中，扫码后如何判断当前类型以及后续操作，如果采用本地实现，注意到几乎所有的微信二维码（个人及公众号、）都是微信的域名或者短链开头附带参数的形式，支付宝的二维码会集中到https://qr.alipay.com下\n## 3.1 公众号登录:\n\n{% note info no-icon%}\n由于登录管理业务较为多样，尽量抽取必要的过程,特殊之处是由于上一步已经输入了账号密码，因此服务端知道需要什么样的微信账号扫码才是有效的，相当于做了双向验证。\n{% endnote %}\n### 3.1.1 入口\n```json\nGET https://mp.weixin.qq.com/cgi-bin/bizlogin\n{\n  \"action\": \"validate\",// 账号密码已校验\n  \"lang\": \"zh_CN\",\n  \"account\": \"xxx\",\n  \"token\": \n}\n```\n由此时url可以猜测，这一步的扫码操作只是在获取后续访问用户接口的token。\n\ncookie很长，会存放在Request Cookies中\n\n{% qnimg mp.weixin.cookie.png  %}\n\n### 3.1.2 渲染二维码\n```json\nGET https://mp.weixin.qq.com/cgi-bin/loginqrcode\nContent-Type: image/jpg\n{\n  \"action\": \"getqrcode\",\n  \"param\": \"4300\",\n  \"rd\": \"309\"\n}\n```\n### 3.1.3 二维码文本内容识别：\n>http://mp.weixin.qq.com/wap/loginauthqrcode?action=scan&qrticket=be0271075c87f07664f983b41a1afa\n\n直接浏览器打开不报错，不显示任何内容，猜测做了浏览器环境检测\n可以理解为随后微信调用内置浏览器向此url发送get请求，没有测试使用其他账户扫码的结果，猜测会报失败，那么不同的用户扫码扫到相同结果，但是需要向服务端发送用户信息，用户信息如何发送呢？\n- 微信客户端与会话session\n- 微信客户端解析url后执行补充参数操作\n\n第一种实现的可能性大\n### 3.1.4 请求\n最明显的是几乎每间隔1s，会向发起xhr请求:\n\n{% qnimg mp.weixin.cookie.1.png  %}\n\n```json\nGET https://mp.weixin.qq.com/cgi-bin/loginqrcode\n{\n  \"action\": \"ask\",\n  \"token\": ,\n  \"lang\": \"zh_CN\",\n  \"f\": \"json\",\n  \"ajax\": 1\n}\n// Response\n{\n  \"base_resp\":\n  {\n    \"err_msg\":\"ok\",\n    \"ret\":0\n  },\n  \"status\":0,\n  \"user_category\":0\n}\n```\n在请求多次后，页面提示二维码过期,status为3,停止xhr请求。猜测，在页面渲染出二维码前后,浏览器向服务端轮询，有效期应该是由服务端控制。在扫描成功后，页面提示扫描成功，status为4,继续xhr请求。猜测，此时等待用户授权，浏览器向服务端轮询，授权后的回应由于手速不快，且长时间频繁轮询，导致浏览器卡死，暂时无法看到，但可以猜测到仍然是status的改变，或许是1，再加上token的返回，使得可以进入主页获取信息。用户取消授权，页面仍然继续原先xhr请求，由获取响应猜测，取消授权并没有向服务端发送消息，在二维码有效期内，用户再次扫描授权依然可以登录。\n## 3.2 网页端微信登录\n{% note info no-icon%}\n网页端对登录用户未知\n{% endnote %}\n### 3.2.1 入口\n```json\nGET https://wx.qq.com/\nPOST https://wx.qq.com/cgi-bin/mmwebwx-bin/webwxstatreport\n{\n  \"fun\": \"new\",\n}\n// Resquest payload\n{\n  \"BaseRequest\":\n  {\n    \"Uin\":\"\",\n    \"Sid\":\"\",\n    \"DeviceID\":\"e395927229659859\"\n  },\n  \"Count\":0,\n  \"List\":[]\n}\n// no Response\n```\n加载页面会调用3次POST,不同的是Request payload里的count和List(第一次)，由于后续登录到主页时，依然会调用，猜测这只是此应用的加载框架。\n### 3.2.2 渲染二维码\n```json\nGET https://login.weixin.qq.com/I/YblD1gWXOA==\nContent-Type: image/jpg\n```\n可能https://login.weixin.qq.com/I是二维码接口，后边的``YblD1gWXOA==``应该是作为全局的唯一ID参数传入,但不清楚以``==``结尾的用处\n### 3.2.3 扫码结果\n>https://login.weixin.qq.com/I/YblD1gWXOA==\n\n此结果即为二维码的请求接口，直接打开依然进入到登录页面，inspect提示Please visit on computer browsers，看来对微信以外的浏览器打开此类型链接就会视为电脑端。\n### 3.2.4 请求\n每隔一段时间，浏览器向发起script请求\n```json\nGET https://login.wx.qq.com/cgi-bin/mmwebwx-bin/login\nContent-Type: text/javascript\n{\n  \"loginicon\": true,\n  \"uuid\": \"YblD1gWXOA\",\n  \"tip\": 0,\n  \"r\": \"1526271870\", // 变化\n  \"_\": \"1557546830994\" // 变化\n}\n// Response\nwindow.code=408;\n```\n多次请求后，猜测可能服务端判定二维码过期(最后一次请求没有回应)，页面被重新加载。\n扫码完成后，页面会显示出扫描者的头像，猜测扫描后已经将用户信息发至服务端。\n```js\n// Response\nwindow.code = 201;\nwindow.userAvatar = '...';\n```\n此时浏览器继续script请求,切换用户后，该script\n```js\n// Response\nwindow.code = 400;\n```\n刷新二维码时，产生一个请求\n```json\n// GET https://login.wx.qq.com/jslogin\n{\n  \"appid\": \"wx782c26e4c19acffb\",\n  \"redirect_uri\": \"https://wx.qq.com/cgi-bin/mmwebwx-bin/webwxnewloginpage\",\n  \"fun\": \"new\",\n  \"lang\": \"en_US\",\n  \"_\": \"1557547453965\", // 应该是时间戳\n}\n```\n这可能是用于登录的内部应用，层级和微信开放平台的接入app类似。\n登录后没能捕捉到script请求回应，猜测应该是基于code的改变。\n登录后请求\n```json\n// GET https://wx2.qq.com/cgi-bin/mmwebwx-bin/webwxnewloginpage\n{\n  \"ticket\":\"AxzDrAIOzOY7W8YqIP3jV8au@qrticket_0\n\",\n  \"uuid\":\"YblD1gWXOA==\",\n  \"lang\":\"en_US\",\n  \"scan\":\"1557548341\",  \n}\n```\n增加cookie\n\n{% qnimg mp.weixin.2.png  %}\n\n没有发现登录后获取到的token之类的字段，且请求用户好友时没有携带相应参数，猜测已经直接写入cookie。\n\n## 小结\n综合看来，由于服务端只能被动接受请求后向客户端回应，为了实现向客户端推送扫码结果消息，都是分为两步，渲染出二维码后轮询，扫码后继续轮询，二维码信息有效期均由服务端维护，但未知的是有效期的计算方式：\n- 按两步间隔分别计算\n- 从产生二维码起\n\n第二种的实现可能性大\n## 3.3 goeasy\n### 3.3.1 web待登录端\n#### 3.3.1.1 产生二维码\n{% tabs First unique name %}\n<!-- tab Request-->\nGET http://www.goeasy.io/en/demo/qrcodelogin/qrcode\n{% code %}\n{\n  \"qrCodeUrl\": \"http://hangzhou.goeasy.io/en/demo/qrcodelogin/mobileconfirm?key=1b8a6c12-e696-4b7f-b3e2-0d1ce1b72eb2\"\n}\n{% endcode %}\n<!-- endtab -->\n<!-- tab Response-->\n![](http://www.goeasy.io/en/demo/qrcodelogin/qrcode?qrCodeUrl=http%3A%2F%2Fhangzhou.goeasy.io%2Fen%2Fdemo%2Fqrcodelogin%2Fmobileconfirm%3Fkey%3D97f39297-144f-4485-9662-a163d7af42e2)\n<!-- endtab -->\n{% endtabs %}\n经测试，此接口只是产生二维码，没有任何校验(传参)\nqrCodeUrl为二维码内容，注意到key，这个二维码会将用户引导至该url,内容完全由浏览器生成\n```js\n1. GET http://3hangzhou.goeasy.io/socket.io/\n{\n  \"EIO\":3,\n  \"transport\":\"polling\",\n  \"j\":0,\n  \"t\":\"MgfJnEd\",\n  \"b64\":1, // base64 ?\n}\nResponse\n{\n  \"sid\":\"479511bd-59ee-4355-900d-96c0215bf5e1\", // 请求连接，获取到码\n  \"upgrades\":[\"websocket\"],\n  \"pingInterval\":25000,\n  \"pingTimeout\":20000\n}\n2. GET http://3hangzhou.goeasy.io/socket.io/\n{\n  \"EIO\":3,\n  \"transport\":\"polling\",\n  \"j\":0,\n  \"t\":\"MgfKThp\",\n  \"b64\":1, // base64 ?,\n  \"sid\": \"479511bd-59ee-4355-900d-96c0215bf5e1\" // 将码发上去，试图连接\n}\nResponse\n{\n  \"content\":\"Ok\", // 连接码匹配 ，写入Response Cookies\n  \"sid\":\"73746791-614f-4242-a750-29b2e1d67952\",\n  \"enableSubscribe\":true, // 允许订阅该频道\n  \"enablePublish\":true, // 允许发布信息\n  \"resultCode\":200\n}\n3. GET http://3hangzhou.goeasy.io/socket.io/ 出现两次,位于socket建立前后\n{\n  \"EIO\":3,\n  \"transport\":\"polling\",\n  \"j\":0,\n  \"t\":\"MgfKTjs\",\n  \"b64\":1, // base64 ?,\n  \"sid\": \"479511bd-59ee-4355-900d-96c0215bf5e1\" // sid与上两步相同\n}\n\n4. POST http://3hangzhou.goeasy.io/socket.io/\n{\n  \"EIO\":3,\n  \"transport\":\"polling\",\n  \"j\":0,\n  \"t\":\"MgfKThj\",\n  \"b64\":1, // base64 ?,\n  \"sid\": \"479511bd-59ee-4355-900d-96c0215bf5e1\" // sid与上三步相同\n}\nForm Data\n{\n  \"d\": 224:420[\"authorize\",{ // 应用层级的信息\n    \"appkey\":\"PC-3c1dfc8b03c44aa58b5b601c0fb230bc\",\n    \"userId\":\"anonymous-94019\",\n    \"username\":\"\",\n    \"userData\":\"\",\n    \"startMillis\":1557571737428,\n    \"artifactVersion\":\"0.19.22\",\n    \"otp\":\"Ulm51QzXjVYfdxyHQCFOIg==\",\"\n    manual\":false\n  }] \n}\nResponse\nok // 这一步发生于websocket之后，明显对整个流程是多余的，应该只是用来提供给中后台做数据统计的\n5. socket ws://3hangzhou.goeasy.io/socket.io/\n{\n  \"EIO\":3,\n  \"transport\":\"websocket\",\n  \"sid\": \"479511bd-59ee-4355-900d-96c0215bf5e1\" // sid与上四步相同\n}\nMessages\n↑[\n  \"subscribe\",{\n    \"channel\":\"1b8a6c12-e696-4b7f-b3e2-0d1ce1b72eb2\",// qrcode key\n    \"sid\":\"73746791-614f-4242-a750-29b2e1d67952\" // 第2步Response中的sid\n  }] // 由goeasy.subscribe发起\n↓[{\n    \"content\":\"Ok\",\n    \"channel\":\"1b8a6c12-e696-4b7f-b3e2-0d1ce1b72eb2\", // qrcode key\n    \"resultCode\":200\n  }]\n// allow\n↓[\n  \"message\",{\n    \"i\":\"9d266860744b11e9a0bf77ea08eba6fb\",\n    \"t\":1557620372490,\n    \"n\":\"1b8a6c12-e696-4b7f-b3e2-0d1ce1b72eb2\", // qrcode key\n    \"c\":\"confirm\",\n    \"a\":true\n  }]\n↑[\n  \"ack\",{\n    \"publishGuid\":\"9d266860744b11e9a0bf77ea08eba6fb\" // i\n  }] // i\n// reject\n↓[\n  \"message\",{\n    \"i\":\"44914b60744c11e9b73565a64c922f3d\",\n    \"t\":1557620653375,\n    \"n\":\"1b8a6c12-e696-4b7f-b3e2-0d1ce1b72eb2\", // qrcode key\n    \"c\":\"cancel\",\n    \"a\":true\n  }] \n↑[\n  \"ack\",{\n    \"publishGuid\":\"44914b60744c11e9b73565a64c922f3d\" // i\n  }] \n```\n#### 3.3.1.2 时序\n2 中enableSubscribe和enablePublish响应应该是根据4中的appKey获得的，而appkey是写在页面js中的\n二维码中的key和goeasy.subscribe中的channel是由页面初次加载生成的，服务端channel建立后即返回ok，进入onSuccess\n\n### 3.3.2 验证端\n```js\n1. GET http://www.goeasy.io/en/demo/qrcodelogin/mobileconfirm\n{\n  \"key\": \"1b8a6c12-e696-4b7f-b3e2-0d1ce1b72eb2\"\n}\nResponse\nAllow\nReject\n2. GET http://4hangzhou.goeasy.io/socket.io/\n{\n  \"EIO\":3,\n  \"transport\":\"polling\",\n  \"j\":0,\n  \"t\":\"MgfSseu\",\n  \"b64\":1, \n} \nResponse\n{\n  \"sid\":\"4bce3017-7f51-4095-8b26-966d27f191fe\",\n  \"upgrades\":[\"websocket\"],\n  \"pingInterval\":25000,\n  \"pingTimeout\":20000\n}\n3. GET http://4hangzhou.goeasy.io/socket.io/ //twice\n{\n  \"EIO\":3,\n  \"transport\":\"polling\",\n  \"j\":0,\n  \"t\":\"MgfU9ME\",\n  \"b64\":1, \n  \"sid\": \"4bce3017-7f51-4095-8b26-966d27f191fe\"\n}\n4. POST http://4hangzhou.goeasy.io/socket.io/\n{\n  \"EIO\":3,\n  \"transport\":\"polling\",\n  \"j\":0,\n  \"t\":\"MgfKThj\",\n  \"b64\":1, // base64 ?,\n  \"sid\": \"4bce3017-7f51-4095-8b26-966d27f191fe\"\n}\nForm Data\n{\n  \"d\": 224:420[\"authorize\",{\n    \"appkey\":\"PC-3c1dfc8b03c44aa58b5b601c0fb230bc\",\"userId\":\"anonymous-76117\",\n    \"username\":\"\",\n    \"userData\":\"\",\n    \"startMillis\":1557618692944,\n    \"artifactVersion\":\"0.19.22\",\n    \"otp\":\"Wdjj/rwWobxgJLipKAVwog==\",\"\n    manual\":false}] \n}\nResponse\nok\n5. socket ws://3hangzhou.goeasy.io/socket.io/\n{\n  \"EIO\":3,\n  \"transport\":\"websocket\",\n  \"sid\": \"4bce3017-7f51-4095-8b26-966d27f191fe\"\n}\nMessages\n↓[{\n    \"content\": \"Ok\"\n    \"enablePublish\": true\n    \"enableSubscribe\": true\n    \"resultCode\": 200\n    \"sid\": \"1d9c09df-735c-42f7-b522-b6e37fc5a3fa\"\n  }]\n// allow\n↑[\n  \"publish\",{\n    \"channel\":\"1b8a6c12-e696-4b7f-b3e2-0d1ce1b72eb2\",\n    \"content\": \"confirm\"\n    \"guid\": \"c90451e0-7450-11e9-97a1-5f37f3f5a2a1\" // web端 message i\n    \"retried\": 0\n    \"sid\": \"497dfc4a-bef2-40c5-97cf-816db52f4202\"\n  }]\n↓[{\n  \"content\",\"Ok\"，\n  \"resultCode\": 200\n  }]\n// reject\n↑[\n  \"publish\",{\n    \"channel\":\"1b8a6c12-e696-4b7f-b3e2-0d1ce1b72eb2\",\n    \"content\": \"cancel\"\n    \"guid\": \"44914b60744c11e9b73565a64c922f3d\" // web端 message i\n    \"retried\": 0\n    \"sid\": \"4a66feaf-de7c-451c-8302-552c8dba2471\"\n  }]\n↓[{\n  \"content\",\"Ok\"，\n  \"resultCode\": 200\n  }]\n```\n\n### 3.3.3 综合分析\n\n发布订阅者模式，如何共同管理一个变量，对特定事件的消息做出反馈，同样事先要知道频道名称。发布后相当于建立了一个频道，对扫码来说，\n对调用者而言，只需关注channel和message，websocket如何建立以及隔离对调用者是透明的，实现即用即连。实际上调用者的客户端和服务端都在与同一个websocket server进行会话，会话之前，需要先向官方的管理平台发送建立信息。\n重新加载则视为先断开后连接，关闭选项卡视为断开\n### 3.3.4 缺陷\n- 如果多人扫码，会将多人的授权情况都发到web端，造成混乱。\n- 如果web端二维码发生重载（用户发起），原先二维码并没有马上失效\n### 3.3.5 未解\nkey何时生成及如何生成\n由于无法同时监测所有传送数据，~~大致判断后没有发现sid字段的相互联系~~，sid格式仍是uuid的格式\n由于服务端只提供了java的SDK，没有按照官方的业务测试使用，不清楚之间的部署与调用关系\n由于未实际测试使用socket.io的接口，现已发现以上五次请求均为默认的请求，部分参数包括sid也是socket中自带的。那么该平台又是如何将自己的参数插入的未知\n通过查阅官方文档，服务端在websocket中推送数据时，\n\n|Name|Required|Description|\n|--|--|--|\n|appkey\t|Yes|\tYour app key|\n|channel|Yes|Target channel name|\n|content|Yes|The message you want to publish|\n\n\n![](http://www.goeasy.io/resources/www/images/part0ne2_1_en.gif)\n# 4 扫码登录的解决方案\n## 4.0 技术要点\n扫码的过程是为了引导用户到指定的授权页面，进入这个页面要同时向服务端传送需要授权的web端环境信息（由二维码信息提供），识别当前登录用户，（等同于用户输入账号信息），验证用户权限，（等同于服务端异步处理表单数据），用户授权，（等同于用户输入密码）。服务端就可以确认验证后的用户和将此消息下发至哪个web端。\n~~暂时二维码信息由服务端生成并管理，目前不知道为什么这样做，但觉得好像是对的~~\n### 4.0.1 Polling、Long Polling、WebSocket\n### 4.0.2 socket\n#### 4.0.2.1 socket 连接身份验证\n#### 4.0.2.2 namespace & room\n### 4.0.3 二维码生成\n#### 4.0.3.1 普通二维码\n- 向某个二维码接口请求，Content-Type: image/png，获取到的内容放在<img src=\"\">\n- qrcode.react组件，传入参数直接渲染(cavas绘制)，参数可由客户端直接生成，也可由服务端生成，也可由客户端生成附带其他信息经服务端检测（安全性）后下发\n\n#### 4.0.3.2 带参小程序码\n## 4.1 二维码信息\n由于小程序打不开网页，二维码也就无需管理URL,但为了使得小程序的扫码操作只局限于本应用，应该在二维码上加上域名信息作为判断二维码对小程序的有效性。 \n### 4.1.1 小程序扫码后的回调\n#### 4.1.1.1 普通二维码\n需要在二维码上附加操作类型参数，以便选择回调函数\n#### 4.1.1.2 小程序码\n由于小程序码由页面+参数构成，扫码后直接进入到该页面，执行该页面的逻辑，因而不需要考虑回调操作的选择。\n## 4.2 扫码场景\n### 4.2.1 微信扫小程序码\n扫码后打开小程序,进入小程序的逻辑，集成于小程序扫小程序码的内部。\n### 4.2.2 小程序扫普通二维码\n可以实现，并且支持不授权登录。\n#### 4.2.2.1  设计\n但普通二维码如何避免被使用其他工具扫描泄露key，文本不可避免要被扫描出来，只能进行一步加密操作\n工具扫码大致流程：识别文本－>判别类型，如果是网址直接使用内置浏览器打开\n1. 小程序端识别到UUID，并以此建立socket连接，通知已扫码，(客户端二维码失效，等待授权操作后重新更新）\n2. 将身份信息发至服务端，由服务端调用用户管理接口，进行身份验证，返回登录权限\n3. 根据登录权限，跳转至授权页或者错误页\n   授权页提示信息\n\n\n二维码被扫描的信息是否需要提交，若处在客户端有验证信息情况下需要，其他客户端扫码是无效的，不应对主逻辑产生影响\n保证小程序扫码过程完成，客户端要知道当前的key已经失效（除非被授权），即key的生命期 = 从服务端生成发至客户端开始至被扫码　|| 固定时间有效期, \n扫码完成后，服务端调用用户管理接口，授权完成后，客户端将此key与用户session绑定\n小程序是否有必要加入socket会话中？小程序扫码后直接向服务端发送结果，点击授权也是直接发送结果，似乎不存在从服务器主动下发消息的情况，应该是无状态的扫码，二维码在改变，但小程序只负责扫描。由于小程序打不开网页，二维码也就无需管理URL,但为了使得小程序的扫码操作只局限于本应用，应该在二维码上加上域名信息作为判断二维码对小程序的有效性。  \n\n保证在小程序扫码，只能扫本域内的有效码；\n用别处扫该码，只能扫到密钥文本，或引导到本域内某个地址，提示请使用某某某小程序扫码并附带小程序二维码，那么小程序二维码先得附带URL,扫码回调页面由服务端生成后（由客户端请求时附带操作参数）\n#### 4.2.2.2 权限管理\n权限应该是对接口调取的管理，而不仅是前端页面的显示与隐藏\n用户扫码完成后，由于扫码操作已经产生一次数据上传，完全可以在回调中提示用户权限，但从用户角度，仅仅扫码不应该将用户数据上传，而应该在授权时获取用户同意后再上传判断权限，这样做增加了操作成本，但利于体验。\n### 4.2.3 微信扫普通二维码\n暂时不可实现：可识别信息，但无法携带微信账户信息\n### 4.2.4 小结\n综上，为了提高用户体验，使用第一种方式，微信扫描带参数小程序码，调起小程序至授权页面。当然，这也就天然支持小程序环境直接扫描小程序码，这样就对用户模糊了操作界限。\n## 4.3 监听形态\n### 4.3.1 web轮询\n![](https://images2017.cnblogs.com/blog/1203274/201712/1203274-20171228193850553-540074571.png)\n### 4.3.2 websocket\n\n|eventName|args|ack|remarks|\n|--|--|--|--|\n|listen|channel|join room|client|\n|scan||join room|weapp|\n|auth|userInfo|auth result|weapp|\n|auth|reject|auth result|weapp|\n|expired||leave|client|\n|leave|user|close|client、weapp|\n# 未解\n1. 如何保存chrome devtools 中请求response日志\n\n    勾选preserve log后可以保存networks列表，保证页面被reload后还存在，但是过程中的response已经找不到。\n2. 如何判断出真实的请求时序\n\n# 参考\n[1] 黄聪.如何扩展Chrome DevTools来获取页面请求.https://www.cnblogs.com/huangcong/p/9414479.html [EB/OL] 2018","source":"_posts/zh-CN/扫描二维码分析.md","raw":"---\ntitle: 扫描二维码分析\ndate: 2019-05-11 09:36:17\ntags:\n---\n# 0 前言\n{% note info %}\n由于开发过程需要用到扫码登录，关键一环在于手机客户端扫码后，浏览器如何知道扫码成功并执行用户登录逻辑。首先想到的是浏览器渲染二维码后，开启监听服务端，那么基于C/S的架构和http协议，必然要求浏览器不断向服务端发起请求。而客户端扫码后，如何判断回调执行操作，如何保证二维码有效性，于是考虑先对成熟的产品进行剖析。\n{% endnote%}\n<!-- more -->\n# 1 二维码本质\n## 1.1 产生需求\n二维码既然是码，就只是一种信息的编码，与条形码相同，扫码只是机器直接读取信息到机器自己，与人眼看到一串字符没有本质区别。关键在于识别到文本后的操作，这其实是覆盖了用户对目标信息的输入操作。这一点很容易理解，但难以认识到，因为常常会聚焦于它的业务属性，而容易忽略它只是一条文本字符串。一些二维码工具如草料二维码，除了文本和网址,其他提供的媒体类功能已经在固有文本上做了一层处理或是依赖于其自身的业务体系，并没有超出二维码的使用能力。\n\n以网址二维码为例，在没有二维码的情况下，进入一个网址可以直接输入，当然如果要加上扫描进入，完全可以OCR直接扫描URL,但URL长度不固定，形式多样化，OCR端无法做到规范，那么条形码呢，条形码由于只能在横向方位表达信息，需要涵盖的URL越长，条码也就随之增长，不利于传播。而同样的信息编码，二维码在纵向和横向同时表达信息，信息空间利用率高，规范，容易扫描。\n\n二维码只是表明在二维空间上用几何形体来编码信息，常见的二维码是QR Code即Quick Response Code，属于矩阵式二维码，它只是二维码的一种码制，恰如余3码、8421码在BCD码中的范畴。有的QR Code复杂，有的简单,主要是版本不同，由40种尺寸的版本。通过色块的差异，使用0-1二进制编码。\n![](https://coolshell.cn/wp-content/uploads/2013/10/QR-Code-Overview.jpeg)\n\n## 1.2 业务形态：\n- 身份信息验证\n  对用户而言，属于被动读取，如一些移动支付设备、票务验证设备扫描当前要进行业务处理的用户持有的二维码，主要**用户平台读取用户信息**。对用户而言基本上处于无感操作，但其实风险较高，辨识度也不一定好。因而在逐步转为生物识别方案。\n- 关联信息服务\n  对用户而言，属于主动读取，如一些网址类场景的进入，主要用于用户获取二维码存储内容后触发打开网址操作，在一些特定的业务场景中，**扫码后的触发操作**丰富多样。\n\n那么综合看来，扫码登录对用户来说既是属于主动读取，但又是用于平台验证用户信息，需要进一步理清这里边的关系。扫码登录相当于在手机客户端与浏览器页面建立连接关系，这种关系是经由用户授权的。对用户而言，扫码是为了识别当前操作的web环境，而授权则是让web端去读取用户信息。这样看来，这里的扫码主要还是处于关联信息服务这一形态。\n# 2 扫码实现\n以下从用户角度反推技术实现，不一定正确\n## 2.1 系统底层扫码能力\n必然首先要调取摄像头，然后调用识别接口\n## 2.2 App实现扫码\n在手机操作系统之上，运行的App具有调用摄像头的功能，而相机、内置扫码功能均可以识别二维码信息，但只是文本信息，即使是url也并没有直接跳转，同一层次的app具备的扫码功能各不相同，主要集中于扫码界面的不同，扫码后的操作。相同的是，对于url的处理都是基于内置浏览器直接打开.\n测试一条百度的首页二维码，用支付宝微信等业务场景丰富的APP可以直接打开，而场景特定的天猫京东则会提示是否打开，打开会使用手机默认浏览器。百度网盘则直接提示，暂不支持非网盘二维码。这说明，在扫码识别成功后（识别到的必然还是一条文本信息），APP内部的回调机制会判断文本的属性。注意到同样是文本，微信支付宝会在一个特定的页面呈现（调用内置浏览器），而天猫等则会直接在扫码后显示（调用本地页面）。于是猜想，是否前者会将扫码内容上传至服务端后再由服务端处理后后统一下发，这样做就可以实现丰富的扫码场景，这也契合这类app的功能，本地应该不可能将所有的扫码后操作写入回调，根据扫码结果打开特定网页，在该网页执行回调操作\n## 2.3 小程序扫码\n在app之上，小程序提供了调起客户端扫码界面的接口，这一界面与直接使用微信扫码体验一致，然而差异在于接口提供的回调函数，如同一个中间件，在扫码完成后拦截扫码结果后自行处理,而微信扫码则只能被执行其上述的处理逻辑。在实现层面，两种扫码最终都会调用客户端的扫码接口，只需提供一个场景参数来判断后续回调该如何执行即可。\n\n# 3 扫码登录分析\n在app之中，扫码后如何判断当前类型以及后续操作，如果采用本地实现，注意到几乎所有的微信二维码（个人及公众号、）都是微信的域名或者短链开头附带参数的形式，支付宝的二维码会集中到https://qr.alipay.com下\n## 3.1 公众号登录:\n\n{% note info no-icon%}\n由于登录管理业务较为多样，尽量抽取必要的过程,特殊之处是由于上一步已经输入了账号密码，因此服务端知道需要什么样的微信账号扫码才是有效的，相当于做了双向验证。\n{% endnote %}\n### 3.1.1 入口\n```json\nGET https://mp.weixin.qq.com/cgi-bin/bizlogin\n{\n  \"action\": \"validate\",// 账号密码已校验\n  \"lang\": \"zh_CN\",\n  \"account\": \"xxx\",\n  \"token\": \n}\n```\n由此时url可以猜测，这一步的扫码操作只是在获取后续访问用户接口的token。\n\ncookie很长，会存放在Request Cookies中\n\n{% qnimg mp.weixin.cookie.png  %}\n\n### 3.1.2 渲染二维码\n```json\nGET https://mp.weixin.qq.com/cgi-bin/loginqrcode\nContent-Type: image/jpg\n{\n  \"action\": \"getqrcode\",\n  \"param\": \"4300\",\n  \"rd\": \"309\"\n}\n```\n### 3.1.3 二维码文本内容识别：\n>http://mp.weixin.qq.com/wap/loginauthqrcode?action=scan&qrticket=be0271075c87f07664f983b41a1afa\n\n直接浏览器打开不报错，不显示任何内容，猜测做了浏览器环境检测\n可以理解为随后微信调用内置浏览器向此url发送get请求，没有测试使用其他账户扫码的结果，猜测会报失败，那么不同的用户扫码扫到相同结果，但是需要向服务端发送用户信息，用户信息如何发送呢？\n- 微信客户端与会话session\n- 微信客户端解析url后执行补充参数操作\n\n第一种实现的可能性大\n### 3.1.4 请求\n最明显的是几乎每间隔1s，会向发起xhr请求:\n\n{% qnimg mp.weixin.cookie.1.png  %}\n\n```json\nGET https://mp.weixin.qq.com/cgi-bin/loginqrcode\n{\n  \"action\": \"ask\",\n  \"token\": ,\n  \"lang\": \"zh_CN\",\n  \"f\": \"json\",\n  \"ajax\": 1\n}\n// Response\n{\n  \"base_resp\":\n  {\n    \"err_msg\":\"ok\",\n    \"ret\":0\n  },\n  \"status\":0,\n  \"user_category\":0\n}\n```\n在请求多次后，页面提示二维码过期,status为3,停止xhr请求。猜测，在页面渲染出二维码前后,浏览器向服务端轮询，有效期应该是由服务端控制。在扫描成功后，页面提示扫描成功，status为4,继续xhr请求。猜测，此时等待用户授权，浏览器向服务端轮询，授权后的回应由于手速不快，且长时间频繁轮询，导致浏览器卡死，暂时无法看到，但可以猜测到仍然是status的改变，或许是1，再加上token的返回，使得可以进入主页获取信息。用户取消授权，页面仍然继续原先xhr请求，由获取响应猜测，取消授权并没有向服务端发送消息，在二维码有效期内，用户再次扫描授权依然可以登录。\n## 3.2 网页端微信登录\n{% note info no-icon%}\n网页端对登录用户未知\n{% endnote %}\n### 3.2.1 入口\n```json\nGET https://wx.qq.com/\nPOST https://wx.qq.com/cgi-bin/mmwebwx-bin/webwxstatreport\n{\n  \"fun\": \"new\",\n}\n// Resquest payload\n{\n  \"BaseRequest\":\n  {\n    \"Uin\":\"\",\n    \"Sid\":\"\",\n    \"DeviceID\":\"e395927229659859\"\n  },\n  \"Count\":0,\n  \"List\":[]\n}\n// no Response\n```\n加载页面会调用3次POST,不同的是Request payload里的count和List(第一次)，由于后续登录到主页时，依然会调用，猜测这只是此应用的加载框架。\n### 3.2.2 渲染二维码\n```json\nGET https://login.weixin.qq.com/I/YblD1gWXOA==\nContent-Type: image/jpg\n```\n可能https://login.weixin.qq.com/I是二维码接口，后边的``YblD1gWXOA==``应该是作为全局的唯一ID参数传入,但不清楚以``==``结尾的用处\n### 3.2.3 扫码结果\n>https://login.weixin.qq.com/I/YblD1gWXOA==\n\n此结果即为二维码的请求接口，直接打开依然进入到登录页面，inspect提示Please visit on computer browsers，看来对微信以外的浏览器打开此类型链接就会视为电脑端。\n### 3.2.4 请求\n每隔一段时间，浏览器向发起script请求\n```json\nGET https://login.wx.qq.com/cgi-bin/mmwebwx-bin/login\nContent-Type: text/javascript\n{\n  \"loginicon\": true,\n  \"uuid\": \"YblD1gWXOA\",\n  \"tip\": 0,\n  \"r\": \"1526271870\", // 变化\n  \"_\": \"1557546830994\" // 变化\n}\n// Response\nwindow.code=408;\n```\n多次请求后，猜测可能服务端判定二维码过期(最后一次请求没有回应)，页面被重新加载。\n扫码完成后，页面会显示出扫描者的头像，猜测扫描后已经将用户信息发至服务端。\n```js\n// Response\nwindow.code = 201;\nwindow.userAvatar = '...';\n```\n此时浏览器继续script请求,切换用户后，该script\n```js\n// Response\nwindow.code = 400;\n```\n刷新二维码时，产生一个请求\n```json\n// GET https://login.wx.qq.com/jslogin\n{\n  \"appid\": \"wx782c26e4c19acffb\",\n  \"redirect_uri\": \"https://wx.qq.com/cgi-bin/mmwebwx-bin/webwxnewloginpage\",\n  \"fun\": \"new\",\n  \"lang\": \"en_US\",\n  \"_\": \"1557547453965\", // 应该是时间戳\n}\n```\n这可能是用于登录的内部应用，层级和微信开放平台的接入app类似。\n登录后没能捕捉到script请求回应，猜测应该是基于code的改变。\n登录后请求\n```json\n// GET https://wx2.qq.com/cgi-bin/mmwebwx-bin/webwxnewloginpage\n{\n  \"ticket\":\"AxzDrAIOzOY7W8YqIP3jV8au@qrticket_0\n\",\n  \"uuid\":\"YblD1gWXOA==\",\n  \"lang\":\"en_US\",\n  \"scan\":\"1557548341\",  \n}\n```\n增加cookie\n\n{% qnimg mp.weixin.2.png  %}\n\n没有发现登录后获取到的token之类的字段，且请求用户好友时没有携带相应参数，猜测已经直接写入cookie。\n\n## 小结\n综合看来，由于服务端只能被动接受请求后向客户端回应，为了实现向客户端推送扫码结果消息，都是分为两步，渲染出二维码后轮询，扫码后继续轮询，二维码信息有效期均由服务端维护，但未知的是有效期的计算方式：\n- 按两步间隔分别计算\n- 从产生二维码起\n\n第二种的实现可能性大\n## 3.3 goeasy\n### 3.3.1 web待登录端\n#### 3.3.1.1 产生二维码\n{% tabs First unique name %}\n<!-- tab Request-->\nGET http://www.goeasy.io/en/demo/qrcodelogin/qrcode\n{% code %}\n{\n  \"qrCodeUrl\": \"http://hangzhou.goeasy.io/en/demo/qrcodelogin/mobileconfirm?key=1b8a6c12-e696-4b7f-b3e2-0d1ce1b72eb2\"\n}\n{% endcode %}\n<!-- endtab -->\n<!-- tab Response-->\n![](http://www.goeasy.io/en/demo/qrcodelogin/qrcode?qrCodeUrl=http%3A%2F%2Fhangzhou.goeasy.io%2Fen%2Fdemo%2Fqrcodelogin%2Fmobileconfirm%3Fkey%3D97f39297-144f-4485-9662-a163d7af42e2)\n<!-- endtab -->\n{% endtabs %}\n经测试，此接口只是产生二维码，没有任何校验(传参)\nqrCodeUrl为二维码内容，注意到key，这个二维码会将用户引导至该url,内容完全由浏览器生成\n```js\n1. GET http://3hangzhou.goeasy.io/socket.io/\n{\n  \"EIO\":3,\n  \"transport\":\"polling\",\n  \"j\":0,\n  \"t\":\"MgfJnEd\",\n  \"b64\":1, // base64 ?\n}\nResponse\n{\n  \"sid\":\"479511bd-59ee-4355-900d-96c0215bf5e1\", // 请求连接，获取到码\n  \"upgrades\":[\"websocket\"],\n  \"pingInterval\":25000,\n  \"pingTimeout\":20000\n}\n2. GET http://3hangzhou.goeasy.io/socket.io/\n{\n  \"EIO\":3,\n  \"transport\":\"polling\",\n  \"j\":0,\n  \"t\":\"MgfKThp\",\n  \"b64\":1, // base64 ?,\n  \"sid\": \"479511bd-59ee-4355-900d-96c0215bf5e1\" // 将码发上去，试图连接\n}\nResponse\n{\n  \"content\":\"Ok\", // 连接码匹配 ，写入Response Cookies\n  \"sid\":\"73746791-614f-4242-a750-29b2e1d67952\",\n  \"enableSubscribe\":true, // 允许订阅该频道\n  \"enablePublish\":true, // 允许发布信息\n  \"resultCode\":200\n}\n3. GET http://3hangzhou.goeasy.io/socket.io/ 出现两次,位于socket建立前后\n{\n  \"EIO\":3,\n  \"transport\":\"polling\",\n  \"j\":0,\n  \"t\":\"MgfKTjs\",\n  \"b64\":1, // base64 ?,\n  \"sid\": \"479511bd-59ee-4355-900d-96c0215bf5e1\" // sid与上两步相同\n}\n\n4. POST http://3hangzhou.goeasy.io/socket.io/\n{\n  \"EIO\":3,\n  \"transport\":\"polling\",\n  \"j\":0,\n  \"t\":\"MgfKThj\",\n  \"b64\":1, // base64 ?,\n  \"sid\": \"479511bd-59ee-4355-900d-96c0215bf5e1\" // sid与上三步相同\n}\nForm Data\n{\n  \"d\": 224:420[\"authorize\",{ // 应用层级的信息\n    \"appkey\":\"PC-3c1dfc8b03c44aa58b5b601c0fb230bc\",\n    \"userId\":\"anonymous-94019\",\n    \"username\":\"\",\n    \"userData\":\"\",\n    \"startMillis\":1557571737428,\n    \"artifactVersion\":\"0.19.22\",\n    \"otp\":\"Ulm51QzXjVYfdxyHQCFOIg==\",\"\n    manual\":false\n  }] \n}\nResponse\nok // 这一步发生于websocket之后，明显对整个流程是多余的，应该只是用来提供给中后台做数据统计的\n5. socket ws://3hangzhou.goeasy.io/socket.io/\n{\n  \"EIO\":3,\n  \"transport\":\"websocket\",\n  \"sid\": \"479511bd-59ee-4355-900d-96c0215bf5e1\" // sid与上四步相同\n}\nMessages\n↑[\n  \"subscribe\",{\n    \"channel\":\"1b8a6c12-e696-4b7f-b3e2-0d1ce1b72eb2\",// qrcode key\n    \"sid\":\"73746791-614f-4242-a750-29b2e1d67952\" // 第2步Response中的sid\n  }] // 由goeasy.subscribe发起\n↓[{\n    \"content\":\"Ok\",\n    \"channel\":\"1b8a6c12-e696-4b7f-b3e2-0d1ce1b72eb2\", // qrcode key\n    \"resultCode\":200\n  }]\n// allow\n↓[\n  \"message\",{\n    \"i\":\"9d266860744b11e9a0bf77ea08eba6fb\",\n    \"t\":1557620372490,\n    \"n\":\"1b8a6c12-e696-4b7f-b3e2-0d1ce1b72eb2\", // qrcode key\n    \"c\":\"confirm\",\n    \"a\":true\n  }]\n↑[\n  \"ack\",{\n    \"publishGuid\":\"9d266860744b11e9a0bf77ea08eba6fb\" // i\n  }] // i\n// reject\n↓[\n  \"message\",{\n    \"i\":\"44914b60744c11e9b73565a64c922f3d\",\n    \"t\":1557620653375,\n    \"n\":\"1b8a6c12-e696-4b7f-b3e2-0d1ce1b72eb2\", // qrcode key\n    \"c\":\"cancel\",\n    \"a\":true\n  }] \n↑[\n  \"ack\",{\n    \"publishGuid\":\"44914b60744c11e9b73565a64c922f3d\" // i\n  }] \n```\n#### 3.3.1.2 时序\n2 中enableSubscribe和enablePublish响应应该是根据4中的appKey获得的，而appkey是写在页面js中的\n二维码中的key和goeasy.subscribe中的channel是由页面初次加载生成的，服务端channel建立后即返回ok，进入onSuccess\n\n### 3.3.2 验证端\n```js\n1. GET http://www.goeasy.io/en/demo/qrcodelogin/mobileconfirm\n{\n  \"key\": \"1b8a6c12-e696-4b7f-b3e2-0d1ce1b72eb2\"\n}\nResponse\nAllow\nReject\n2. GET http://4hangzhou.goeasy.io/socket.io/\n{\n  \"EIO\":3,\n  \"transport\":\"polling\",\n  \"j\":0,\n  \"t\":\"MgfSseu\",\n  \"b64\":1, \n} \nResponse\n{\n  \"sid\":\"4bce3017-7f51-4095-8b26-966d27f191fe\",\n  \"upgrades\":[\"websocket\"],\n  \"pingInterval\":25000,\n  \"pingTimeout\":20000\n}\n3. GET http://4hangzhou.goeasy.io/socket.io/ //twice\n{\n  \"EIO\":3,\n  \"transport\":\"polling\",\n  \"j\":0,\n  \"t\":\"MgfU9ME\",\n  \"b64\":1, \n  \"sid\": \"4bce3017-7f51-4095-8b26-966d27f191fe\"\n}\n4. POST http://4hangzhou.goeasy.io/socket.io/\n{\n  \"EIO\":3,\n  \"transport\":\"polling\",\n  \"j\":0,\n  \"t\":\"MgfKThj\",\n  \"b64\":1, // base64 ?,\n  \"sid\": \"4bce3017-7f51-4095-8b26-966d27f191fe\"\n}\nForm Data\n{\n  \"d\": 224:420[\"authorize\",{\n    \"appkey\":\"PC-3c1dfc8b03c44aa58b5b601c0fb230bc\",\"userId\":\"anonymous-76117\",\n    \"username\":\"\",\n    \"userData\":\"\",\n    \"startMillis\":1557618692944,\n    \"artifactVersion\":\"0.19.22\",\n    \"otp\":\"Wdjj/rwWobxgJLipKAVwog==\",\"\n    manual\":false}] \n}\nResponse\nok\n5. socket ws://3hangzhou.goeasy.io/socket.io/\n{\n  \"EIO\":3,\n  \"transport\":\"websocket\",\n  \"sid\": \"4bce3017-7f51-4095-8b26-966d27f191fe\"\n}\nMessages\n↓[{\n    \"content\": \"Ok\"\n    \"enablePublish\": true\n    \"enableSubscribe\": true\n    \"resultCode\": 200\n    \"sid\": \"1d9c09df-735c-42f7-b522-b6e37fc5a3fa\"\n  }]\n// allow\n↑[\n  \"publish\",{\n    \"channel\":\"1b8a6c12-e696-4b7f-b3e2-0d1ce1b72eb2\",\n    \"content\": \"confirm\"\n    \"guid\": \"c90451e0-7450-11e9-97a1-5f37f3f5a2a1\" // web端 message i\n    \"retried\": 0\n    \"sid\": \"497dfc4a-bef2-40c5-97cf-816db52f4202\"\n  }]\n↓[{\n  \"content\",\"Ok\"，\n  \"resultCode\": 200\n  }]\n// reject\n↑[\n  \"publish\",{\n    \"channel\":\"1b8a6c12-e696-4b7f-b3e2-0d1ce1b72eb2\",\n    \"content\": \"cancel\"\n    \"guid\": \"44914b60744c11e9b73565a64c922f3d\" // web端 message i\n    \"retried\": 0\n    \"sid\": \"4a66feaf-de7c-451c-8302-552c8dba2471\"\n  }]\n↓[{\n  \"content\",\"Ok\"，\n  \"resultCode\": 200\n  }]\n```\n\n### 3.3.3 综合分析\n\n发布订阅者模式，如何共同管理一个变量，对特定事件的消息做出反馈，同样事先要知道频道名称。发布后相当于建立了一个频道，对扫码来说，\n对调用者而言，只需关注channel和message，websocket如何建立以及隔离对调用者是透明的，实现即用即连。实际上调用者的客户端和服务端都在与同一个websocket server进行会话，会话之前，需要先向官方的管理平台发送建立信息。\n重新加载则视为先断开后连接，关闭选项卡视为断开\n### 3.3.4 缺陷\n- 如果多人扫码，会将多人的授权情况都发到web端，造成混乱。\n- 如果web端二维码发生重载（用户发起），原先二维码并没有马上失效\n### 3.3.5 未解\nkey何时生成及如何生成\n由于无法同时监测所有传送数据，~~大致判断后没有发现sid字段的相互联系~~，sid格式仍是uuid的格式\n由于服务端只提供了java的SDK，没有按照官方的业务测试使用，不清楚之间的部署与调用关系\n由于未实际测试使用socket.io的接口，现已发现以上五次请求均为默认的请求，部分参数包括sid也是socket中自带的。那么该平台又是如何将自己的参数插入的未知\n通过查阅官方文档，服务端在websocket中推送数据时，\n\n|Name|Required|Description|\n|--|--|--|\n|appkey\t|Yes|\tYour app key|\n|channel|Yes|Target channel name|\n|content|Yes|The message you want to publish|\n\n\n![](http://www.goeasy.io/resources/www/images/part0ne2_1_en.gif)\n# 4 扫码登录的解决方案\n## 4.0 技术要点\n扫码的过程是为了引导用户到指定的授权页面，进入这个页面要同时向服务端传送需要授权的web端环境信息（由二维码信息提供），识别当前登录用户，（等同于用户输入账号信息），验证用户权限，（等同于服务端异步处理表单数据），用户授权，（等同于用户输入密码）。服务端就可以确认验证后的用户和将此消息下发至哪个web端。\n~~暂时二维码信息由服务端生成并管理，目前不知道为什么这样做，但觉得好像是对的~~\n### 4.0.1 Polling、Long Polling、WebSocket\n### 4.0.2 socket\n#### 4.0.2.1 socket 连接身份验证\n#### 4.0.2.2 namespace & room\n### 4.0.3 二维码生成\n#### 4.0.3.1 普通二维码\n- 向某个二维码接口请求，Content-Type: image/png，获取到的内容放在<img src=\"\">\n- qrcode.react组件，传入参数直接渲染(cavas绘制)，参数可由客户端直接生成，也可由服务端生成，也可由客户端生成附带其他信息经服务端检测（安全性）后下发\n\n#### 4.0.3.2 带参小程序码\n## 4.1 二维码信息\n由于小程序打不开网页，二维码也就无需管理URL,但为了使得小程序的扫码操作只局限于本应用，应该在二维码上加上域名信息作为判断二维码对小程序的有效性。 \n### 4.1.1 小程序扫码后的回调\n#### 4.1.1.1 普通二维码\n需要在二维码上附加操作类型参数，以便选择回调函数\n#### 4.1.1.2 小程序码\n由于小程序码由页面+参数构成，扫码后直接进入到该页面，执行该页面的逻辑，因而不需要考虑回调操作的选择。\n## 4.2 扫码场景\n### 4.2.1 微信扫小程序码\n扫码后打开小程序,进入小程序的逻辑，集成于小程序扫小程序码的内部。\n### 4.2.2 小程序扫普通二维码\n可以实现，并且支持不授权登录。\n#### 4.2.2.1  设计\n但普通二维码如何避免被使用其他工具扫描泄露key，文本不可避免要被扫描出来，只能进行一步加密操作\n工具扫码大致流程：识别文本－>判别类型，如果是网址直接使用内置浏览器打开\n1. 小程序端识别到UUID，并以此建立socket连接，通知已扫码，(客户端二维码失效，等待授权操作后重新更新）\n2. 将身份信息发至服务端，由服务端调用用户管理接口，进行身份验证，返回登录权限\n3. 根据登录权限，跳转至授权页或者错误页\n   授权页提示信息\n\n\n二维码被扫描的信息是否需要提交，若处在客户端有验证信息情况下需要，其他客户端扫码是无效的，不应对主逻辑产生影响\n保证小程序扫码过程完成，客户端要知道当前的key已经失效（除非被授权），即key的生命期 = 从服务端生成发至客户端开始至被扫码　|| 固定时间有效期, \n扫码完成后，服务端调用用户管理接口，授权完成后，客户端将此key与用户session绑定\n小程序是否有必要加入socket会话中？小程序扫码后直接向服务端发送结果，点击授权也是直接发送结果，似乎不存在从服务器主动下发消息的情况，应该是无状态的扫码，二维码在改变，但小程序只负责扫描。由于小程序打不开网页，二维码也就无需管理URL,但为了使得小程序的扫码操作只局限于本应用，应该在二维码上加上域名信息作为判断二维码对小程序的有效性。  \n\n保证在小程序扫码，只能扫本域内的有效码；\n用别处扫该码，只能扫到密钥文本，或引导到本域内某个地址，提示请使用某某某小程序扫码并附带小程序二维码，那么小程序二维码先得附带URL,扫码回调页面由服务端生成后（由客户端请求时附带操作参数）\n#### 4.2.2.2 权限管理\n权限应该是对接口调取的管理，而不仅是前端页面的显示与隐藏\n用户扫码完成后，由于扫码操作已经产生一次数据上传，完全可以在回调中提示用户权限，但从用户角度，仅仅扫码不应该将用户数据上传，而应该在授权时获取用户同意后再上传判断权限，这样做增加了操作成本，但利于体验。\n### 4.2.3 微信扫普通二维码\n暂时不可实现：可识别信息，但无法携带微信账户信息\n### 4.2.4 小结\n综上，为了提高用户体验，使用第一种方式，微信扫描带参数小程序码，调起小程序至授权页面。当然，这也就天然支持小程序环境直接扫描小程序码，这样就对用户模糊了操作界限。\n## 4.3 监听形态\n### 4.3.1 web轮询\n![](https://images2017.cnblogs.com/blog/1203274/201712/1203274-20171228193850553-540074571.png)\n### 4.3.2 websocket\n\n|eventName|args|ack|remarks|\n|--|--|--|--|\n|listen|channel|join room|client|\n|scan||join room|weapp|\n|auth|userInfo|auth result|weapp|\n|auth|reject|auth result|weapp|\n|expired||leave|client|\n|leave|user|close|client、weapp|\n# 未解\n1. 如何保存chrome devtools 中请求response日志\n\n    勾选preserve log后可以保存networks列表，保证页面被reload后还存在，但是过程中的response已经找不到。\n2. 如何判断出真实的请求时序\n\n# 参考\n[1] 黄聪.如何扩展Chrome DevTools来获取页面请求.https://www.cnblogs.com/huangcong/p/9414479.html [EB/OL] 2018","slug":"扫描二维码分析","published":1,"lang":"zh-CN","updated":"2019-07-17T08:45:50.471Z","_id":"cjvnq7zen003z7jjxbk30k71a","comments":1,"layout":"post","photos":[],"link":"","content":"<link rel=\"stylesheet\" class=\"aplayer-secondary-style-marker\" href=\"/assets/css/APlayer.min.css\"><script src=\"/assets/js/APlayer.min.js\" class=\"aplayer-secondary-script-marker\"></script><script class=\"meting-secondary-script-marker\" src=\"/assets/js/Meting.min.js\"></script><link rel=\"stylesheet\" type=\"text/css\" href=\"https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css\"><h1 id=\"0-前言\"><a href=\"#0-前言\" class=\"headerlink\" title=\"0 前言\"></a>0 前言</h1><div class=\"note info\">\n            <p>由于开发过程需要用到扫码登录，关键一环在于手机客户端扫码后，浏览器如何知道扫码成功并执行用户登录逻辑。首先想到的是浏览器渲染二维码后，开启监听服务端，那么基于C/S的架构和http协议，必然要求浏览器不断向服务端发起请求。而客户端扫码后，如何判断回调执行操作，如何保证二维码有效性，于是考虑先对成熟的产品进行剖析。</p>\n          </div>\n<a id=\"more\"></a>\n<h1 id=\"1-二维码本质\"><a href=\"#1-二维码本质\" class=\"headerlink\" title=\"1 二维码本质\"></a>1 二维码本质</h1><h2 id=\"1-1-产生需求\"><a href=\"#1-1-产生需求\" class=\"headerlink\" title=\"1.1 产生需求\"></a>1.1 产生需求</h2><p>二维码既然是码，就只是一种信息的编码，与条形码相同，扫码只是机器直接读取信息到机器自己，与人眼看到一串字符没有本质区别。关键在于识别到文本后的操作，这其实是覆盖了用户对目标信息的输入操作。这一点很容易理解，但难以认识到，因为常常会聚焦于它的业务属性，而容易忽略它只是一条文本字符串。一些二维码工具如草料二维码，除了文本和网址,其他提供的媒体类功能已经在固有文本上做了一层处理或是依赖于其自身的业务体系，并没有超出二维码的使用能力。</p>\n<p>以网址二维码为例，在没有二维码的情况下，进入一个网址可以直接输入，当然如果要加上扫描进入，完全可以OCR直接扫描URL,但URL长度不固定，形式多样化，OCR端无法做到规范，那么条形码呢，条形码由于只能在横向方位表达信息，需要涵盖的URL越长，条码也就随之增长，不利于传播。而同样的信息编码，二维码在纵向和横向同时表达信息，信息空间利用率高，规范，容易扫描。</p>\n<p>二维码只是表明在二维空间上用几何形体来编码信息，常见的二维码是QR Code即Quick Response Code，属于矩阵式二维码，它只是二维码的一种码制，恰如余3码、8421码在BCD码中的范畴。有的QR Code复杂，有的简单,主要是版本不同，由40种尺寸的版本。通过色块的差异，使用0-1二进制编码。<br><img src=\"https://coolshell.cn/wp-content/uploads/2013/10/QR-Code-Overview.jpeg\" alt></p>\n<h2 id=\"1-2-业务形态：\"><a href=\"#1-2-业务形态：\" class=\"headerlink\" title=\"1.2 业务形态：\"></a>1.2 业务形态：</h2><ul>\n<li>身份信息验证<br>对用户而言，属于被动读取，如一些移动支付设备、票务验证设备扫描当前要进行业务处理的用户持有的二维码，主要<strong>用户平台读取用户信息</strong>。对用户而言基本上处于无感操作，但其实风险较高，辨识度也不一定好。因而在逐步转为生物识别方案。</li>\n<li>关联信息服务<br>对用户而言，属于主动读取，如一些网址类场景的进入，主要用于用户获取二维码存储内容后触发打开网址操作，在一些特定的业务场景中，<strong>扫码后的触发操作</strong>丰富多样。</li>\n</ul>\n<p>那么综合看来，扫码登录对用户来说既是属于主动读取，但又是用于平台验证用户信息，需要进一步理清这里边的关系。扫码登录相当于在手机客户端与浏览器页面建立连接关系，这种关系是经由用户授权的。对用户而言，扫码是为了识别当前操作的web环境，而授权则是让web端去读取用户信息。这样看来，这里的扫码主要还是处于关联信息服务这一形态。</p>\n<h1 id=\"2-扫码实现\"><a href=\"#2-扫码实现\" class=\"headerlink\" title=\"2 扫码实现\"></a>2 扫码实现</h1><p>以下从用户角度反推技术实现，不一定正确</p>\n<h2 id=\"2-1-系统底层扫码能力\"><a href=\"#2-1-系统底层扫码能力\" class=\"headerlink\" title=\"2.1 系统底层扫码能力\"></a>2.1 系统底层扫码能力</h2><p>必然首先要调取摄像头，然后调用识别接口</p>\n<h2 id=\"2-2-App实现扫码\"><a href=\"#2-2-App实现扫码\" class=\"headerlink\" title=\"2.2 App实现扫码\"></a>2.2 App实现扫码</h2><p>在手机操作系统之上，运行的App具有调用摄像头的功能，而相机、内置扫码功能均可以识别二维码信息，但只是文本信息，即使是url也并没有直接跳转，同一层次的app具备的扫码功能各不相同，主要集中于扫码界面的不同，扫码后的操作。相同的是，对于url的处理都是基于内置浏览器直接打开.<br>测试一条百度的首页二维码，用支付宝微信等业务场景丰富的APP可以直接打开，而场景特定的天猫京东则会提示是否打开，打开会使用手机默认浏览器。百度网盘则直接提示，暂不支持非网盘二维码。这说明，在扫码识别成功后（识别到的必然还是一条文本信息），APP内部的回调机制会判断文本的属性。注意到同样是文本，微信支付宝会在一个特定的页面呈现（调用内置浏览器），而天猫等则会直接在扫码后显示（调用本地页面）。于是猜想，是否前者会将扫码内容上传至服务端后再由服务端处理后后统一下发，这样做就可以实现丰富的扫码场景，这也契合这类app的功能，本地应该不可能将所有的扫码后操作写入回调，根据扫码结果打开特定网页，在该网页执行回调操作</p>\n<h2 id=\"2-3-小程序扫码\"><a href=\"#2-3-小程序扫码\" class=\"headerlink\" title=\"2.3 小程序扫码\"></a>2.3 小程序扫码</h2><p>在app之上，小程序提供了调起客户端扫码界面的接口，这一界面与直接使用微信扫码体验一致，然而差异在于接口提供的回调函数，如同一个中间件，在扫码完成后拦截扫码结果后自行处理,而微信扫码则只能被执行其上述的处理逻辑。在实现层面，两种扫码最终都会调用客户端的扫码接口，只需提供一个场景参数来判断后续回调该如何执行即可。</p>\n<h1 id=\"3-扫码登录分析\"><a href=\"#3-扫码登录分析\" class=\"headerlink\" title=\"3 扫码登录分析\"></a>3 扫码登录分析</h1><p>在app之中，扫码后如何判断当前类型以及后续操作，如果采用本地实现，注意到几乎所有的微信二维码（个人及公众号、）都是微信的域名或者短链开头附带参数的形式，支付宝的二维码会集中到<a href=\"https://qr.alipay.com下\" target=\"_blank\" rel=\"noopener\">https://qr.alipay.com下</a></p>\n<h2 id=\"3-1-公众号登录\"><a href=\"#3-1-公众号登录\" class=\"headerlink\" title=\"3.1 公众号登录:\"></a>3.1 公众号登录:</h2><div class=\"note info no-icon\">\n            <p>由于登录管理业务较为多样，尽量抽取必要的过程,特殊之处是由于上一步已经输入了账号密码，因此服务端知道需要什么样的微信账号扫码才是有效的，相当于做了双向验证。</p>\n          </div>\n<h3 id=\"3-1-1-入口\"><a href=\"#3-1-1-入口\" class=\"headerlink\" title=\"3.1.1 入口\"></a>3.1.1 入口</h3><figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">GET https://mp.weixin.qq.com/cgi-bin/bizlogin</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  \"action\": \"validate\",// 账号密码已校验</span><br><span class=\"line\">  \"lang\": \"zh_CN\",</span><br><span class=\"line\">  \"account\": \"xxx\",</span><br><span class=\"line\">  \"token\": </span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>由此时url可以猜测，这一步的扫码操作只是在获取后续访问用户接口的token。</p>\n<p>cookie很长，会存放在Request Cookies中</p>\n<img src=\"https://blog-cdn.makergyt.com/static/images/mp.weixin.cookie.png\">\n<h3 id=\"3-1-2-渲染二维码\"><a href=\"#3-1-2-渲染二维码\" class=\"headerlink\" title=\"3.1.2 渲染二维码\"></a>3.1.2 渲染二维码</h3><figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">GET https://mp.weixin.qq.com/cgi-bin/loginqrcode</span><br><span class=\"line\">Content-Type: image/jpg</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"attr\">\"action\"</span>: <span class=\"string\">\"getqrcode\"</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"param\"</span>: <span class=\"string\">\"4300\"</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"rd\"</span>: <span class=\"string\">\"309\"</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"3-1-3-二维码文本内容识别：\"><a href=\"#3-1-3-二维码文本内容识别：\" class=\"headerlink\" title=\"3.1.3 二维码文本内容识别：\"></a>3.1.3 二维码文本内容识别：</h3><blockquote>\n<p><a href=\"http://mp.weixin.qq.com/wap/loginauthqrcode?action=scan&amp;qrticket=be0271075c87f07664f983b41a1afa\" target=\"_blank\" rel=\"noopener\">http://mp.weixin.qq.com/wap/loginauthqrcode?action=scan&amp;qrticket=be0271075c87f07664f983b41a1afa</a></p>\n</blockquote>\n<p>直接浏览器打开不报错，不显示任何内容，猜测做了浏览器环境检测<br>可以理解为随后微信调用内置浏览器向此url发送get请求，没有测试使用其他账户扫码的结果，猜测会报失败，那么不同的用户扫码扫到相同结果，但是需要向服务端发送用户信息，用户信息如何发送呢？</p>\n<ul>\n<li>微信客户端与会话session</li>\n<li>微信客户端解析url后执行补充参数操作</li>\n</ul>\n<p>第一种实现的可能性大</p>\n<h3 id=\"3-1-4-请求\"><a href=\"#3-1-4-请求\" class=\"headerlink\" title=\"3.1.4 请求\"></a>3.1.4 请求</h3><p>最明显的是几乎每间隔1s，会向发起xhr请求:</p>\n<img src=\"https://blog-cdn.makergyt.com/static/images/mp.weixin.cookie.1.png\">\n<figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">GET https://mp.weixin.qq.com/cgi-bin/loginqrcode</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"attr\">\"action\"</span>: <span class=\"string\">\"ask\"</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"token\"</span>: ,</span><br><span class=\"line\">  <span class=\"attr\">\"lang\"</span>: <span class=\"string\">\"zh_CN\"</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"f\"</span>: <span class=\"string\">\"json\"</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"ajax\"</span>: <span class=\"number\">1</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\">// Response</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"attr\">\"base_resp\"</span>:</span><br><span class=\"line\">  &#123;</span><br><span class=\"line\">    <span class=\"attr\">\"err_msg\"</span>:<span class=\"string\">\"ok\"</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"ret\"</span>:<span class=\"number\">0</span></span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  <span class=\"attr\">\"status\"</span>:<span class=\"number\">0</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"user_category\"</span>:<span class=\"number\">0</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>在请求多次后，页面提示二维码过期,status为3,停止xhr请求。猜测，在页面渲染出二维码前后,浏览器向服务端轮询，有效期应该是由服务端控制。在扫描成功后，页面提示扫描成功，status为4,继续xhr请求。猜测，此时等待用户授权，浏览器向服务端轮询，授权后的回应由于手速不快，且长时间频繁轮询，导致浏览器卡死，暂时无法看到，但可以猜测到仍然是status的改变，或许是1，再加上token的返回，使得可以进入主页获取信息。用户取消授权，页面仍然继续原先xhr请求，由获取响应猜测，取消授权并没有向服务端发送消息，在二维码有效期内，用户再次扫描授权依然可以登录。</p>\n<h2 id=\"3-2-网页端微信登录\"><a href=\"#3-2-网页端微信登录\" class=\"headerlink\" title=\"3.2 网页端微信登录\"></a>3.2 网页端微信登录</h2><div class=\"note info no-icon\">\n            <p>网页端对登录用户未知</p>\n          </div>\n<h3 id=\"3-2-1-入口\"><a href=\"#3-2-1-入口\" class=\"headerlink\" title=\"3.2.1 入口\"></a>3.2.1 入口</h3><figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">GET https://wx.qq.com/</span><br><span class=\"line\">POST https://wx.qq.com/cgi-bin/mmwebwx-bin/webwxstatreport</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"attr\">\"fun\"</span>: <span class=\"string\">\"new\"</span>,</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">// Resquest payload</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"attr\">\"BaseRequest\"</span>:</span><br><span class=\"line\">  &#123;</span><br><span class=\"line\">    <span class=\"attr\">\"Uin\"</span>:<span class=\"string\">\"\"</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"Sid\"</span>:<span class=\"string\">\"\"</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"DeviceID\"</span>:<span class=\"string\">\"e395927229659859\"</span></span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  <span class=\"attr\">\"Count\"</span>:<span class=\"number\">0</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"List\"</span>:[]</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">// no Response</span><br></pre></td></tr></table></figure>\n<p>加载页面会调用3次POST,不同的是Request payload里的count和List(第一次)，由于后续登录到主页时，依然会调用，猜测这只是此应用的加载框架。</p>\n<h3 id=\"3-2-2-渲染二维码\"><a href=\"#3-2-2-渲染二维码\" class=\"headerlink\" title=\"3.2.2 渲染二维码\"></a>3.2.2 渲染二维码</h3><figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">GET https://login.weixin.qq.com/I/YblD1gWXOA==</span><br><span class=\"line\">Content-Type: image/jpg</span><br></pre></td></tr></table></figure>\n<p>可能<a href=\"https://login.weixin.qq.com/I是二维码接口，后边的``YblD1gWXOA==``应该是作为全局的唯一ID参数传入,但不清楚以``==``结尾的用处\" target=\"_blank\" rel=\"noopener\">https://login.weixin.qq.com/I是二维码接口，后边的``YblD1gWXOA==``应该是作为全局的唯一ID参数传入,但不清楚以``==``结尾的用处</a></p>\n<h3 id=\"3-2-3-扫码结果\"><a href=\"#3-2-3-扫码结果\" class=\"headerlink\" title=\"3.2.3 扫码结果\"></a>3.2.3 扫码结果</h3><blockquote>\n<p><a href=\"https://login.weixin.qq.com/I/YblD1gWXOA==\" target=\"_blank\" rel=\"noopener\">https://login.weixin.qq.com/I/YblD1gWXOA==</a></p>\n</blockquote>\n<p>此结果即为二维码的请求接口，直接打开依然进入到登录页面，inspect提示Please visit on computer browsers，看来对微信以外的浏览器打开此类型链接就会视为电脑端。</p>\n<h3 id=\"3-2-4-请求\"><a href=\"#3-2-4-请求\" class=\"headerlink\" title=\"3.2.4 请求\"></a>3.2.4 请求</h3><p>每隔一段时间，浏览器向发起script请求<br><figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">GET https://login.wx.qq.com/cgi-bin/mmwebwx-bin/login</span><br><span class=\"line\">Content-Type: text/javascript</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"attr\">\"loginicon\"</span>: <span class=\"literal\">true</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"uuid\"</span>: <span class=\"string\">\"YblD1gWXOA\"</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"tip\"</span>: <span class=\"number\">0</span>,</span><br><span class=\"line\">  \"r\": \"1526271870\", // 变化</span><br><span class=\"line\">  \"_\": \"1557546830994\" // 变化</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">// Response</span><br><span class=\"line\">window.code=408;</span><br></pre></td></tr></table></figure></p>\n<p>多次请求后，猜测可能服务端判定二维码过期(最后一次请求没有回应)，页面被重新加载。<br>扫码完成后，页面会显示出扫描者的头像，猜测扫描后已经将用户信息发至服务端。<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// Response</span></span><br><span class=\"line\"><span class=\"built_in\">window</span>.code = <span class=\"number\">201</span>;</span><br><span class=\"line\"><span class=\"built_in\">window</span>.userAvatar = <span class=\"string\">'...'</span>;</span><br></pre></td></tr></table></figure></p>\n<p>此时浏览器继续script请求,切换用户后，该script<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// Response</span></span><br><span class=\"line\"><span class=\"built_in\">window</span>.code = <span class=\"number\">400</span>;</span><br></pre></td></tr></table></figure></p>\n<p>刷新二维码时，产生一个请求<br><figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// GET https://login.wx.qq.com/jslogin</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"attr\">\"appid\"</span>: <span class=\"string\">\"wx782c26e4c19acffb\"</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"redirect_uri\"</span>: <span class=\"string\">\"https://wx.qq.com/cgi-bin/mmwebwx-bin/webwxnewloginpage\"</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"fun\"</span>: <span class=\"string\">\"new\"</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"lang\"</span>: <span class=\"string\">\"en_US\"</span>,</span><br><span class=\"line\">  \"_\": \"1557547453965\", // 应该是时间戳</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p>这可能是用于登录的内部应用，层级和微信开放平台的接入app类似。<br>登录后没能捕捉到script请求回应，猜测应该是基于code的改变。<br>登录后请求<br><figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// GET https://wx2.qq.com/cgi-bin/mmwebwx-bin/webwxnewloginpage</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"attr\">\"ticket\"</span>:<span class=\"string\">\"AxzDrAIOzOY7W8YqIP3jV8au@qrticket_0</span></span><br><span class=\"line\"><span class=\"string\">\"</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"uuid\"</span>:<span class=\"string\">\"YblD1gWXOA==\"</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"lang\"</span>:<span class=\"string\">\"en_US\"</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"scan\"</span>:<span class=\"string\">\"1557548341\"</span>,  </span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p>增加cookie</p>\n<img src=\"https://blog-cdn.makergyt.com/static/images/mp.weixin.2.png\">\n<p>没有发现登录后获取到的token之类的字段，且请求用户好友时没有携带相应参数，猜测已经直接写入cookie。</p>\n<h2 id=\"小结\"><a href=\"#小结\" class=\"headerlink\" title=\"小结\"></a>小结</h2><p>综合看来，由于服务端只能被动接受请求后向客户端回应，为了实现向客户端推送扫码结果消息，都是分为两步，渲染出二维码后轮询，扫码后继续轮询，二维码信息有效期均由服务端维护，但未知的是有效期的计算方式：</p>\n<ul>\n<li>按两步间隔分别计算</li>\n<li>从产生二维码起</li>\n</ul>\n<p>第二种的实现可能性大</p>\n<h2 id=\"3-3-goeasy\"><a href=\"#3-3-goeasy\" class=\"headerlink\" title=\"3.3 goeasy\"></a>3.3 goeasy</h2><h3 id=\"3-3-1-web待登录端\"><a href=\"#3-3-1-web待登录端\" class=\"headerlink\" title=\"3.3.1 web待登录端\"></a>3.3.1 web待登录端</h3><h4 id=\"3-3-1-1-产生二维码\"><a href=\"#3-3-1-1-产生二维码\" class=\"headerlink\" title=\"3.3.1.1 产生二维码\"></a>3.3.1.1 产生二维码</h4><div class=\"tabs\" id=\"first-unique-name\"><ul class=\"nav-tabs\"><li class=\"tab active\"><a href=\"#first-unique-name-1\">Request</a></li><li class=\"tab\"><a href=\"#first-unique-name-2\">Response</a></li></ul><div class=\"tab-content\"><div class=\"tab-pane active\" id=\"first-unique-name-1\"><p>GET <a href=\"http://www.goeasy.io/en/demo/qrcodelogin/qrcode\" target=\"_blank\" rel=\"noopener\">http://www.goeasy.io/en/demo/qrcodelogin/qrcode</a></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  &quot;qrCodeUrl&quot;: &quot;<a href=\"http://hangzhou.goeasy.io/en/demo/qrcodelogin/mobileconfirm?key=1b8a6c12-e696-4b7f-b3e2-0d1ce1b72eb2\" target=\"_blank\" rel=\"noopener\">http://hangzhou.goeasy.io/en/demo/qrcodelogin/mobileconfirm?key=1b8a6c12-e696-4b7f-b3e2-0d1ce1b72eb2</a>&quot;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></div><div class=\"tab-pane\" id=\"first-unique-name-2\"><p><img src=\"http://www.goeasy.io/en/demo/qrcodelogin/qrcode?qrCodeUrl=http%3A%2F%2Fhangzhou.goeasy.io%2Fen%2Fdemo%2Fqrcodelogin%2Fmobileconfirm%3Fkey%3D97f39297-144f-4485-9662-a163d7af42e2\" alt></p></div></div></div>\n<p>经测试，此接口只是产生二维码，没有任何校验(传参)<br>qrCodeUrl为二维码内容，注意到key，这个二维码会将用户引导至该url,内容完全由浏览器生成<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"number\">1.</span> GET http:<span class=\"comment\">//3hangzhou.goeasy.io/socket.io/</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"string\">\"EIO\"</span>:<span class=\"number\">3</span>,</span><br><span class=\"line\">  <span class=\"string\">\"transport\"</span>:<span class=\"string\">\"polling\"</span>,</span><br><span class=\"line\">  <span class=\"string\">\"j\"</span>:<span class=\"number\">0</span>,</span><br><span class=\"line\">  <span class=\"string\">\"t\"</span>:<span class=\"string\">\"MgfJnEd\"</span>,</span><br><span class=\"line\">  <span class=\"string\">\"b64\"</span>:<span class=\"number\">1</span>, <span class=\"comment\">// base64 ?</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\">Response</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"string\">\"sid\"</span>:<span class=\"string\">\"479511bd-59ee-4355-900d-96c0215bf5e1\"</span>, <span class=\"comment\">// 请求连接，获取到码</span></span><br><span class=\"line\">  <span class=\"string\">\"upgrades\"</span>:[<span class=\"string\">\"websocket\"</span>],</span><br><span class=\"line\">  <span class=\"string\">\"pingInterval\"</span>:<span class=\"number\">25000</span>,</span><br><span class=\"line\">  <span class=\"string\">\"pingTimeout\"</span>:<span class=\"number\">20000</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"number\">2.</span> GET http:<span class=\"comment\">//3hangzhou.goeasy.io/socket.io/</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"string\">\"EIO\"</span>:<span class=\"number\">3</span>,</span><br><span class=\"line\">  <span class=\"string\">\"transport\"</span>:<span class=\"string\">\"polling\"</span>,</span><br><span class=\"line\">  <span class=\"string\">\"j\"</span>:<span class=\"number\">0</span>,</span><br><span class=\"line\">  <span class=\"string\">\"t\"</span>:<span class=\"string\">\"MgfKThp\"</span>,</span><br><span class=\"line\">  <span class=\"string\">\"b64\"</span>:<span class=\"number\">1</span>, <span class=\"comment\">// base64 ?,</span></span><br><span class=\"line\">  <span class=\"string\">\"sid\"</span>: <span class=\"string\">\"479511bd-59ee-4355-900d-96c0215bf5e1\"</span> <span class=\"comment\">// 将码发上去，试图连接</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\">Response</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"string\">\"content\"</span>:<span class=\"string\">\"Ok\"</span>, <span class=\"comment\">// 连接码匹配 ，写入Response Cookies</span></span><br><span class=\"line\">  <span class=\"string\">\"sid\"</span>:<span class=\"string\">\"73746791-614f-4242-a750-29b2e1d67952\"</span>,</span><br><span class=\"line\">  <span class=\"string\">\"enableSubscribe\"</span>:<span class=\"literal\">true</span>, <span class=\"comment\">// 允许订阅该频道</span></span><br><span class=\"line\">  <span class=\"string\">\"enablePublish\"</span>:<span class=\"literal\">true</span>, <span class=\"comment\">// 允许发布信息</span></span><br><span class=\"line\">  <span class=\"string\">\"resultCode\"</span>:<span class=\"number\">200</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"number\">3.</span> GET http:<span class=\"comment\">//3hangzhou.goeasy.io/socket.io/ 出现两次,位于socket建立前后</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"string\">\"EIO\"</span>:<span class=\"number\">3</span>,</span><br><span class=\"line\">  <span class=\"string\">\"transport\"</span>:<span class=\"string\">\"polling\"</span>,</span><br><span class=\"line\">  <span class=\"string\">\"j\"</span>:<span class=\"number\">0</span>,</span><br><span class=\"line\">  <span class=\"string\">\"t\"</span>:<span class=\"string\">\"MgfKTjs\"</span>,</span><br><span class=\"line\">  <span class=\"string\">\"b64\"</span>:<span class=\"number\">1</span>, <span class=\"comment\">// base64 ?,</span></span><br><span class=\"line\">  <span class=\"string\">\"sid\"</span>: <span class=\"string\">\"479511bd-59ee-4355-900d-96c0215bf5e1\"</span> <span class=\"comment\">// sid与上两步相同</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"number\">4.</span> POST http:<span class=\"comment\">//3hangzhou.goeasy.io/socket.io/</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"string\">\"EIO\"</span>:<span class=\"number\">3</span>,</span><br><span class=\"line\">  <span class=\"string\">\"transport\"</span>:<span class=\"string\">\"polling\"</span>,</span><br><span class=\"line\">  <span class=\"string\">\"j\"</span>:<span class=\"number\">0</span>,</span><br><span class=\"line\">  <span class=\"string\">\"t\"</span>:<span class=\"string\">\"MgfKThj\"</span>,</span><br><span class=\"line\">  <span class=\"string\">\"b64\"</span>:<span class=\"number\">1</span>, <span class=\"comment\">// base64 ?,</span></span><br><span class=\"line\">  <span class=\"string\">\"sid\"</span>: <span class=\"string\">\"479511bd-59ee-4355-900d-96c0215bf5e1\"</span> <span class=\"comment\">// sid与上三步相同</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\">Form Data</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"string\">\"d\"</span>: <span class=\"number\">224</span>:<span class=\"number\">420</span>[<span class=\"string\">\"authorize\"</span>,&#123; <span class=\"comment\">// 应用层级的信息</span></span><br><span class=\"line\">    <span class=\"string\">\"appkey\"</span>:<span class=\"string\">\"PC-3c1dfc8b03c44aa58b5b601c0fb230bc\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"userId\"</span>:<span class=\"string\">\"anonymous-94019\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"username\"</span>:<span class=\"string\">\"\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"userData\"</span>:<span class=\"string\">\"\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"startMillis\"</span>:<span class=\"number\">1557571737428</span>,</span><br><span class=\"line\">    <span class=\"string\">\"artifactVersion\"</span>:<span class=\"string\">\"0.19.22\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"otp\"</span>:<span class=\"string\">\"Ulm51QzXjVYfdxyHQCFOIg==\"</span>,<span class=\"string\">\"</span></span><br><span class=\"line\"><span class=\"string\">    manual\"</span>:<span class=\"literal\">false</span></span><br><span class=\"line\">  &#125;] </span><br><span class=\"line\">&#125;</span><br><span class=\"line\">Response</span><br><span class=\"line\">ok <span class=\"comment\">// 这一步发生于websocket之后，明显对整个流程是多余的，应该只是用来提供给中后台做数据统计的</span></span><br><span class=\"line\"><span class=\"number\">5.</span> socket ws:<span class=\"comment\">//3hangzhou.goeasy.io/socket.io/</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"string\">\"EIO\"</span>:<span class=\"number\">3</span>,</span><br><span class=\"line\">  <span class=\"string\">\"transport\"</span>:<span class=\"string\">\"websocket\"</span>,</span><br><span class=\"line\">  <span class=\"string\">\"sid\"</span>: <span class=\"string\">\"479511bd-59ee-4355-900d-96c0215bf5e1\"</span> <span class=\"comment\">// sid与上四步相同</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\">Messages</span><br><span class=\"line\">↑[</span><br><span class=\"line\">  <span class=\"string\">\"subscribe\"</span>,&#123;</span><br><span class=\"line\">    <span class=\"string\">\"channel\"</span>:<span class=\"string\">\"1b8a6c12-e696-4b7f-b3e2-0d1ce1b72eb2\"</span>,<span class=\"comment\">// qrcode key</span></span><br><span class=\"line\">    <span class=\"string\">\"sid\"</span>:<span class=\"string\">\"73746791-614f-4242-a750-29b2e1d67952\"</span> <span class=\"comment\">// 第2步Response中的sid</span></span><br><span class=\"line\">  &#125;] <span class=\"comment\">// 由goeasy.subscribe发起</span></span><br><span class=\"line\">↓[&#123;</span><br><span class=\"line\">    <span class=\"string\">\"content\"</span>:<span class=\"string\">\"Ok\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"channel\"</span>:<span class=\"string\">\"1b8a6c12-e696-4b7f-b3e2-0d1ce1b72eb2\"</span>, <span class=\"comment\">// qrcode key</span></span><br><span class=\"line\">    <span class=\"string\">\"resultCode\"</span>:<span class=\"number\">200</span></span><br><span class=\"line\">  &#125;]</span><br><span class=\"line\"><span class=\"comment\">// allow</span></span><br><span class=\"line\">↓[</span><br><span class=\"line\">  <span class=\"string\">\"message\"</span>,&#123;</span><br><span class=\"line\">    <span class=\"string\">\"i\"</span>:<span class=\"string\">\"9d266860744b11e9a0bf77ea08eba6fb\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"t\"</span>:<span class=\"number\">1557620372490</span>,</span><br><span class=\"line\">    <span class=\"string\">\"n\"</span>:<span class=\"string\">\"1b8a6c12-e696-4b7f-b3e2-0d1ce1b72eb2\"</span>, <span class=\"comment\">// qrcode key</span></span><br><span class=\"line\">    <span class=\"string\">\"c\"</span>:<span class=\"string\">\"confirm\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"a\"</span>:<span class=\"literal\">true</span></span><br><span class=\"line\">  &#125;]</span><br><span class=\"line\">↑[</span><br><span class=\"line\">  <span class=\"string\">\"ack\"</span>,&#123;</span><br><span class=\"line\">    <span class=\"string\">\"publishGuid\"</span>:<span class=\"string\">\"9d266860744b11e9a0bf77ea08eba6fb\"</span> <span class=\"comment\">// i</span></span><br><span class=\"line\">  &#125;] <span class=\"comment\">// i</span></span><br><span class=\"line\"><span class=\"comment\">// reject</span></span><br><span class=\"line\">↓[</span><br><span class=\"line\">  <span class=\"string\">\"message\"</span>,&#123;</span><br><span class=\"line\">    <span class=\"string\">\"i\"</span>:<span class=\"string\">\"44914b60744c11e9b73565a64c922f3d\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"t\"</span>:<span class=\"number\">1557620653375</span>,</span><br><span class=\"line\">    <span class=\"string\">\"n\"</span>:<span class=\"string\">\"1b8a6c12-e696-4b7f-b3e2-0d1ce1b72eb2\"</span>, <span class=\"comment\">// qrcode key</span></span><br><span class=\"line\">    <span class=\"string\">\"c\"</span>:<span class=\"string\">\"cancel\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"a\"</span>:<span class=\"literal\">true</span></span><br><span class=\"line\">  &#125;] </span><br><span class=\"line\">↑[</span><br><span class=\"line\">  <span class=\"string\">\"ack\"</span>,&#123;</span><br><span class=\"line\">    <span class=\"string\">\"publishGuid\"</span>:<span class=\"string\">\"44914b60744c11e9b73565a64c922f3d\"</span> <span class=\"comment\">// i</span></span><br><span class=\"line\">  &#125;]</span><br></pre></td></tr></table></figure></p>\n<h4 id=\"3-3-1-2-时序\"><a href=\"#3-3-1-2-时序\" class=\"headerlink\" title=\"3.3.1.2 时序\"></a>3.3.1.2 时序</h4><p>2 中enableSubscribe和enablePublish响应应该是根据4中的appKey获得的，而appkey是写在页面js中的<br>二维码中的key和goeasy.subscribe中的channel是由页面初次加载生成的，服务端channel建立后即返回ok，进入onSuccess</p>\n<h3 id=\"3-3-2-验证端\"><a href=\"#3-3-2-验证端\" class=\"headerlink\" title=\"3.3.2 验证端\"></a>3.3.2 验证端</h3><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"number\">1.</span> GET http:<span class=\"comment\">//www.goeasy.io/en/demo/qrcodelogin/mobileconfirm</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"string\">\"key\"</span>: <span class=\"string\">\"1b8a6c12-e696-4b7f-b3e2-0d1ce1b72eb2\"</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\">Response</span><br><span class=\"line\">Allow</span><br><span class=\"line\">Reject</span><br><span class=\"line\"><span class=\"number\">2.</span> GET http:<span class=\"comment\">//4hangzhou.goeasy.io/socket.io/</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"string\">\"EIO\"</span>:<span class=\"number\">3</span>,</span><br><span class=\"line\">  <span class=\"string\">\"transport\"</span>:<span class=\"string\">\"polling\"</span>,</span><br><span class=\"line\">  <span class=\"string\">\"j\"</span>:<span class=\"number\">0</span>,</span><br><span class=\"line\">  <span class=\"string\">\"t\"</span>:<span class=\"string\">\"MgfSseu\"</span>,</span><br><span class=\"line\">  <span class=\"string\">\"b64\"</span>:<span class=\"number\">1</span>, </span><br><span class=\"line\">&#125; </span><br><span class=\"line\">Response</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"string\">\"sid\"</span>:<span class=\"string\">\"4bce3017-7f51-4095-8b26-966d27f191fe\"</span>,</span><br><span class=\"line\">  <span class=\"string\">\"upgrades\"</span>:[<span class=\"string\">\"websocket\"</span>],</span><br><span class=\"line\">  <span class=\"string\">\"pingInterval\"</span>:<span class=\"number\">25000</span>,</span><br><span class=\"line\">  <span class=\"string\">\"pingTimeout\"</span>:<span class=\"number\">20000</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"number\">3.</span> GET http:<span class=\"comment\">//4hangzhou.goeasy.io/socket.io/ //twice</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"string\">\"EIO\"</span>:<span class=\"number\">3</span>,</span><br><span class=\"line\">  <span class=\"string\">\"transport\"</span>:<span class=\"string\">\"polling\"</span>,</span><br><span class=\"line\">  <span class=\"string\">\"j\"</span>:<span class=\"number\">0</span>,</span><br><span class=\"line\">  <span class=\"string\">\"t\"</span>:<span class=\"string\">\"MgfU9ME\"</span>,</span><br><span class=\"line\">  <span class=\"string\">\"b64\"</span>:<span class=\"number\">1</span>, </span><br><span class=\"line\">  <span class=\"string\">\"sid\"</span>: <span class=\"string\">\"4bce3017-7f51-4095-8b26-966d27f191fe\"</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"number\">4.</span> POST http:<span class=\"comment\">//4hangzhou.goeasy.io/socket.io/</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"string\">\"EIO\"</span>:<span class=\"number\">3</span>,</span><br><span class=\"line\">  <span class=\"string\">\"transport\"</span>:<span class=\"string\">\"polling\"</span>,</span><br><span class=\"line\">  <span class=\"string\">\"j\"</span>:<span class=\"number\">0</span>,</span><br><span class=\"line\">  <span class=\"string\">\"t\"</span>:<span class=\"string\">\"MgfKThj\"</span>,</span><br><span class=\"line\">  <span class=\"string\">\"b64\"</span>:<span class=\"number\">1</span>, <span class=\"comment\">// base64 ?,</span></span><br><span class=\"line\">  <span class=\"string\">\"sid\"</span>: <span class=\"string\">\"4bce3017-7f51-4095-8b26-966d27f191fe\"</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\">Form Data</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"string\">\"d\"</span>: <span class=\"number\">224</span>:<span class=\"number\">420</span>[<span class=\"string\">\"authorize\"</span>,&#123;</span><br><span class=\"line\">    <span class=\"string\">\"appkey\"</span>:<span class=\"string\">\"PC-3c1dfc8b03c44aa58b5b601c0fb230bc\"</span>,<span class=\"string\">\"userId\"</span>:<span class=\"string\">\"anonymous-76117\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"username\"</span>:<span class=\"string\">\"\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"userData\"</span>:<span class=\"string\">\"\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"startMillis\"</span>:<span class=\"number\">1557618692944</span>,</span><br><span class=\"line\">    <span class=\"string\">\"artifactVersion\"</span>:<span class=\"string\">\"0.19.22\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"otp\"</span>:<span class=\"string\">\"Wdjj/rwWobxgJLipKAVwog==\"</span>,<span class=\"string\">\"</span></span><br><span class=\"line\"><span class=\"string\">    manual\"</span>:<span class=\"literal\">false</span>&#125;] </span><br><span class=\"line\">&#125;</span><br><span class=\"line\">Response</span><br><span class=\"line\">ok</span><br><span class=\"line\"><span class=\"number\">5.</span> socket ws:<span class=\"comment\">//3hangzhou.goeasy.io/socket.io/</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"string\">\"EIO\"</span>:<span class=\"number\">3</span>,</span><br><span class=\"line\">  <span class=\"string\">\"transport\"</span>:<span class=\"string\">\"websocket\"</span>,</span><br><span class=\"line\">  <span class=\"string\">\"sid\"</span>: <span class=\"string\">\"4bce3017-7f51-4095-8b26-966d27f191fe\"</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\">Messages</span><br><span class=\"line\">↓[&#123;</span><br><span class=\"line\">    <span class=\"string\">\"content\"</span>: <span class=\"string\">\"Ok\"</span></span><br><span class=\"line\">    <span class=\"string\">\"enablePublish\"</span>: <span class=\"literal\">true</span></span><br><span class=\"line\">    <span class=\"string\">\"enableSubscribe\"</span>: <span class=\"literal\">true</span></span><br><span class=\"line\">    <span class=\"string\">\"resultCode\"</span>: <span class=\"number\">200</span></span><br><span class=\"line\">    <span class=\"string\">\"sid\"</span>: <span class=\"string\">\"1d9c09df-735c-42f7-b522-b6e37fc5a3fa\"</span></span><br><span class=\"line\">  &#125;]</span><br><span class=\"line\"><span class=\"comment\">// allow</span></span><br><span class=\"line\">↑[</span><br><span class=\"line\">  <span class=\"string\">\"publish\"</span>,&#123;</span><br><span class=\"line\">    <span class=\"string\">\"channel\"</span>:<span class=\"string\">\"1b8a6c12-e696-4b7f-b3e2-0d1ce1b72eb2\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"content\"</span>: <span class=\"string\">\"confirm\"</span></span><br><span class=\"line\">    <span class=\"string\">\"guid\"</span>: <span class=\"string\">\"c90451e0-7450-11e9-97a1-5f37f3f5a2a1\"</span> <span class=\"comment\">// web端 message i</span></span><br><span class=\"line\">    <span class=\"string\">\"retried\"</span>: <span class=\"number\">0</span></span><br><span class=\"line\">    <span class=\"string\">\"sid\"</span>: <span class=\"string\">\"497dfc4a-bef2-40c5-97cf-816db52f4202\"</span></span><br><span class=\"line\">  &#125;]</span><br><span class=\"line\">↓[&#123;</span><br><span class=\"line\">  <span class=\"string\">\"content\"</span>,<span class=\"string\">\"Ok\"</span>，</span><br><span class=\"line\">  <span class=\"string\">\"resultCode\"</span>: <span class=\"number\">200</span></span><br><span class=\"line\">  &#125;]</span><br><span class=\"line\"><span class=\"comment\">// reject</span></span><br><span class=\"line\">↑[</span><br><span class=\"line\">  <span class=\"string\">\"publish\"</span>,&#123;</span><br><span class=\"line\">    <span class=\"string\">\"channel\"</span>:<span class=\"string\">\"1b8a6c12-e696-4b7f-b3e2-0d1ce1b72eb2\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"content\"</span>: <span class=\"string\">\"cancel\"</span></span><br><span class=\"line\">    <span class=\"string\">\"guid\"</span>: <span class=\"string\">\"44914b60744c11e9b73565a64c922f3d\"</span> <span class=\"comment\">// web端 message i</span></span><br><span class=\"line\">    <span class=\"string\">\"retried\"</span>: <span class=\"number\">0</span></span><br><span class=\"line\">    <span class=\"string\">\"sid\"</span>: <span class=\"string\">\"4a66feaf-de7c-451c-8302-552c8dba2471\"</span></span><br><span class=\"line\">  &#125;]</span><br><span class=\"line\">↓[&#123;</span><br><span class=\"line\">  <span class=\"string\">\"content\"</span>,<span class=\"string\">\"Ok\"</span>，</span><br><span class=\"line\">  <span class=\"string\">\"resultCode\"</span>: <span class=\"number\">200</span></span><br><span class=\"line\">  &#125;]</span><br></pre></td></tr></table></figure>\n<h3 id=\"3-3-3-综合分析\"><a href=\"#3-3-3-综合分析\" class=\"headerlink\" title=\"3.3.3 综合分析\"></a>3.3.3 综合分析</h3><p>发布订阅者模式，如何共同管理一个变量，对特定事件的消息做出反馈，同样事先要知道频道名称。发布后相当于建立了一个频道，对扫码来说，<br>对调用者而言，只需关注channel和message，websocket如何建立以及隔离对调用者是透明的，实现即用即连。实际上调用者的客户端和服务端都在与同一个websocket server进行会话，会话之前，需要先向官方的管理平台发送建立信息。<br>重新加载则视为先断开后连接，关闭选项卡视为断开</p>\n<h3 id=\"3-3-4-缺陷\"><a href=\"#3-3-4-缺陷\" class=\"headerlink\" title=\"3.3.4 缺陷\"></a>3.3.4 缺陷</h3><ul>\n<li>如果多人扫码，会将多人的授权情况都发到web端，造成混乱。</li>\n<li>如果web端二维码发生重载（用户发起），原先二维码并没有马上失效<h3 id=\"3-3-5-未解\"><a href=\"#3-3-5-未解\" class=\"headerlink\" title=\"3.3.5 未解\"></a>3.3.5 未解</h3>key何时生成及如何生成<br>由于无法同时监测所有传送数据，<del>大致判断后没有发现sid字段的相互联系</del>，sid格式仍是uuid的格式<br>由于服务端只提供了java的SDK，没有按照官方的业务测试使用，不清楚之间的部署与调用关系<br>由于未实际测试使用socket.io的接口，现已发现以上五次请求均为默认的请求，部分参数包括sid也是socket中自带的。那么该平台又是如何将自己的参数插入的未知<br>通过查阅官方文档，服务端在websocket中推送数据时，</li>\n</ul>\n<table>\n<thead>\n<tr>\n<th>Name</th>\n<th>Required</th>\n<th>Description</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>appkey</td>\n<td>Yes</td>\n<td>Your app key</td>\n</tr>\n<tr>\n<td>channel</td>\n<td>Yes</td>\n<td>Target channel name</td>\n</tr>\n<tr>\n<td>content</td>\n<td>Yes</td>\n<td>The message you want to publish</td>\n</tr>\n</tbody>\n</table>\n<p><img src=\"http://www.goeasy.io/resources/www/images/part0ne2_1_en.gif\" alt></p>\n<h1 id=\"4-扫码登录的解决方案\"><a href=\"#4-扫码登录的解决方案\" class=\"headerlink\" title=\"4 扫码登录的解决方案\"></a>4 扫码登录的解决方案</h1><h2 id=\"4-0-技术要点\"><a href=\"#4-0-技术要点\" class=\"headerlink\" title=\"4.0 技术要点\"></a>4.0 技术要点</h2><p>扫码的过程是为了引导用户到指定的授权页面，进入这个页面要同时向服务端传送需要授权的web端环境信息（由二维码信息提供），识别当前登录用户，（等同于用户输入账号信息），验证用户权限，（等同于服务端异步处理表单数据），用户授权，（等同于用户输入密码）。服务端就可以确认验证后的用户和将此消息下发至哪个web端。<br><del>暂时二维码信息由服务端生成并管理，目前不知道为什么这样做，但觉得好像是对的</del></p>\n<h3 id=\"4-0-1-Polling、Long-Polling、WebSocket\"><a href=\"#4-0-1-Polling、Long-Polling、WebSocket\" class=\"headerlink\" title=\"4.0.1 Polling、Long Polling、WebSocket\"></a>4.0.1 Polling、Long Polling、WebSocket</h3><h3 id=\"4-0-2-socket\"><a href=\"#4-0-2-socket\" class=\"headerlink\" title=\"4.0.2 socket\"></a>4.0.2 socket</h3><h4 id=\"4-0-2-1-socket-连接身份验证\"><a href=\"#4-0-2-1-socket-连接身份验证\" class=\"headerlink\" title=\"4.0.2.1 socket 连接身份验证\"></a>4.0.2.1 socket 连接身份验证</h4><h4 id=\"4-0-2-2-namespace-amp-room\"><a href=\"#4-0-2-2-namespace-amp-room\" class=\"headerlink\" title=\"4.0.2.2 namespace &amp; room\"></a>4.0.2.2 namespace &amp; room</h4><h3 id=\"4-0-3-二维码生成\"><a href=\"#4-0-3-二维码生成\" class=\"headerlink\" title=\"4.0.3 二维码生成\"></a>4.0.3 二维码生成</h3><h4 id=\"4-0-3-1-普通二维码\"><a href=\"#4-0-3-1-普通二维码\" class=\"headerlink\" title=\"4.0.3.1 普通二维码\"></a>4.0.3.1 普通二维码</h4><ul>\n<li>向某个二维码接口请求，Content-Type: image/png，获取到的内容放在<img src></li>\n<li>qrcode.react组件，传入参数直接渲染(cavas绘制)，参数可由客户端直接生成，也可由服务端生成，也可由客户端生成附带其他信息经服务端检测（安全性）后下发</li>\n</ul>\n<h4 id=\"4-0-3-2-带参小程序码\"><a href=\"#4-0-3-2-带参小程序码\" class=\"headerlink\" title=\"4.0.3.2 带参小程序码\"></a>4.0.3.2 带参小程序码</h4><h2 id=\"4-1-二维码信息\"><a href=\"#4-1-二维码信息\" class=\"headerlink\" title=\"4.1 二维码信息\"></a>4.1 二维码信息</h2><p>由于小程序打不开网页，二维码也就无需管理URL,但为了使得小程序的扫码操作只局限于本应用，应该在二维码上加上域名信息作为判断二维码对小程序的有效性。 </p>\n<h3 id=\"4-1-1-小程序扫码后的回调\"><a href=\"#4-1-1-小程序扫码后的回调\" class=\"headerlink\" title=\"4.1.1 小程序扫码后的回调\"></a>4.1.1 小程序扫码后的回调</h3><h4 id=\"4-1-1-1-普通二维码\"><a href=\"#4-1-1-1-普通二维码\" class=\"headerlink\" title=\"4.1.1.1 普通二维码\"></a>4.1.1.1 普通二维码</h4><p>需要在二维码上附加操作类型参数，以便选择回调函数</p>\n<h4 id=\"4-1-1-2-小程序码\"><a href=\"#4-1-1-2-小程序码\" class=\"headerlink\" title=\"4.1.1.2 小程序码\"></a>4.1.1.2 小程序码</h4><p>由于小程序码由页面+参数构成，扫码后直接进入到该页面，执行该页面的逻辑，因而不需要考虑回调操作的选择。</p>\n<h2 id=\"4-2-扫码场景\"><a href=\"#4-2-扫码场景\" class=\"headerlink\" title=\"4.2 扫码场景\"></a>4.2 扫码场景</h2><h3 id=\"4-2-1-微信扫小程序码\"><a href=\"#4-2-1-微信扫小程序码\" class=\"headerlink\" title=\"4.2.1 微信扫小程序码\"></a>4.2.1 微信扫小程序码</h3><p>扫码后打开小程序,进入小程序的逻辑，集成于小程序扫小程序码的内部。</p>\n<h3 id=\"4-2-2-小程序扫普通二维码\"><a href=\"#4-2-2-小程序扫普通二维码\" class=\"headerlink\" title=\"4.2.2 小程序扫普通二维码\"></a>4.2.2 小程序扫普通二维码</h3><p>可以实现，并且支持不授权登录。</p>\n<h4 id=\"4-2-2-1-设计\"><a href=\"#4-2-2-1-设计\" class=\"headerlink\" title=\"4.2.2.1  设计\"></a>4.2.2.1  设计</h4><p>但普通二维码如何避免被使用其他工具扫描泄露key，文本不可避免要被扫描出来，只能进行一步加密操作<br>工具扫码大致流程：识别文本－&gt;判别类型，如果是网址直接使用内置浏览器打开</p>\n<ol>\n<li>小程序端识别到UUID，并以此建立socket连接，通知已扫码，(客户端二维码失效，等待授权操作后重新更新）</li>\n<li>将身份信息发至服务端，由服务端调用用户管理接口，进行身份验证，返回登录权限</li>\n<li>根据登录权限，跳转至授权页或者错误页<br>授权页提示信息</li>\n</ol>\n<p>二维码被扫描的信息是否需要提交，若处在客户端有验证信息情况下需要，其他客户端扫码是无效的，不应对主逻辑产生影响<br>保证小程序扫码过程完成，客户端要知道当前的key已经失效（除非被授权），即key的生命期 = 从服务端生成发至客户端开始至被扫码　|| 固定时间有效期,<br>扫码完成后，服务端调用用户管理接口，授权完成后，客户端将此key与用户session绑定<br>小程序是否有必要加入socket会话中？小程序扫码后直接向服务端发送结果，点击授权也是直接发送结果，似乎不存在从服务器主动下发消息的情况，应该是无状态的扫码，二维码在改变，但小程序只负责扫描。由于小程序打不开网页，二维码也就无需管理URL,但为了使得小程序的扫码操作只局限于本应用，应该在二维码上加上域名信息作为判断二维码对小程序的有效性。  </p>\n<p>保证在小程序扫码，只能扫本域内的有效码；<br>用别处扫该码，只能扫到密钥文本，或引导到本域内某个地址，提示请使用某某某小程序扫码并附带小程序二维码，那么小程序二维码先得附带URL,扫码回调页面由服务端生成后（由客户端请求时附带操作参数）</p>\n<h4 id=\"4-2-2-2-权限管理\"><a href=\"#4-2-2-2-权限管理\" class=\"headerlink\" title=\"4.2.2.2 权限管理\"></a>4.2.2.2 权限管理</h4><p>权限应该是对接口调取的管理，而不仅是前端页面的显示与隐藏<br>用户扫码完成后，由于扫码操作已经产生一次数据上传，完全可以在回调中提示用户权限，但从用户角度，仅仅扫码不应该将用户数据上传，而应该在授权时获取用户同意后再上传判断权限，这样做增加了操作成本，但利于体验。</p>\n<h3 id=\"4-2-3-微信扫普通二维码\"><a href=\"#4-2-3-微信扫普通二维码\" class=\"headerlink\" title=\"4.2.3 微信扫普通二维码\"></a>4.2.3 微信扫普通二维码</h3><p>暂时不可实现：可识别信息，但无法携带微信账户信息</p>\n<h3 id=\"4-2-4-小结\"><a href=\"#4-2-4-小结\" class=\"headerlink\" title=\"4.2.4 小结\"></a>4.2.4 小结</h3><p>综上，为了提高用户体验，使用第一种方式，微信扫描带参数小程序码，调起小程序至授权页面。当然，这也就天然支持小程序环境直接扫描小程序码，这样就对用户模糊了操作界限。</p>\n<h2 id=\"4-3-监听形态\"><a href=\"#4-3-监听形态\" class=\"headerlink\" title=\"4.3 监听形态\"></a>4.3 监听形态</h2><h3 id=\"4-3-1-web轮询\"><a href=\"#4-3-1-web轮询\" class=\"headerlink\" title=\"4.3.1 web轮询\"></a>4.3.1 web轮询</h3><p><img src=\"https://images2017.cnblogs.com/blog/1203274/201712/1203274-20171228193850553-540074571.png\" alt></p>\n<h3 id=\"4-3-2-websocket\"><a href=\"#4-3-2-websocket\" class=\"headerlink\" title=\"4.3.2 websocket\"></a>4.3.2 websocket</h3><table>\n<thead>\n<tr>\n<th>eventName</th>\n<th>args</th>\n<th>ack</th>\n<th>remarks</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>listen</td>\n<td>channel</td>\n<td>join room</td>\n<td>client</td>\n</tr>\n<tr>\n<td>scan</td>\n<td></td>\n<td>join room</td>\n<td>weapp</td>\n</tr>\n<tr>\n<td>auth</td>\n<td>userInfo</td>\n<td>auth result</td>\n<td>weapp</td>\n</tr>\n<tr>\n<td>auth</td>\n<td>reject</td>\n<td>auth result</td>\n<td>weapp</td>\n</tr>\n<tr>\n<td>expired</td>\n<td></td>\n<td>leave</td>\n<td>client</td>\n</tr>\n<tr>\n<td>leave</td>\n<td>user</td>\n<td>close</td>\n<td>client、weapp</td>\n</tr>\n</tbody>\n</table>\n<h1 id=\"未解\"><a href=\"#未解\" class=\"headerlink\" title=\"未解\"></a>未解</h1><ol>\n<li><p>如何保存chrome devtools 中请求response日志</p>\n<p> 勾选preserve log后可以保存networks列表，保证页面被reload后还存在，但是过程中的response已经找不到。</p>\n</li>\n<li>如何判断出真实的请求时序</li>\n</ol>\n<h1 id=\"参考\"><a href=\"#参考\" class=\"headerlink\" title=\"参考\"></a>参考</h1><p>[1] 黄聪.如何扩展Chrome DevTools来获取页面请求.<a href=\"https://www.cnblogs.com/huangcong/p/9414479.html\" target=\"_blank\" rel=\"noopener\">https://www.cnblogs.com/huangcong/p/9414479.html</a> [EB/OL] 2018</p>\n","site":{"data":{}},"excerpt":"<h1 id=\"0-前言\"><a href=\"#0-前言\" class=\"headerlink\" title=\"0 前言\"></a>0 前言</h1><div class=\"note info\">\n            <p>由于开发过程需要用到扫码登录，关键一环在于手机客户端扫码后，浏览器如何知道扫码成功并执行用户登录逻辑。首先想到的是浏览器渲染二维码后，开启监听服务端，那么基于C/S的架构和http协议，必然要求浏览器不断向服务端发起请求。而客户端扫码后，如何判断回调执行操作，如何保证二维码有效性，于是考虑先对成熟的产品进行剖析。</p>\n          </div>","more":"<h1 id=\"1-二维码本质\"><a href=\"#1-二维码本质\" class=\"headerlink\" title=\"1 二维码本质\"></a>1 二维码本质</h1><h2 id=\"1-1-产生需求\"><a href=\"#1-1-产生需求\" class=\"headerlink\" title=\"1.1 产生需求\"></a>1.1 产生需求</h2><p>二维码既然是码，就只是一种信息的编码，与条形码相同，扫码只是机器直接读取信息到机器自己，与人眼看到一串字符没有本质区别。关键在于识别到文本后的操作，这其实是覆盖了用户对目标信息的输入操作。这一点很容易理解，但难以认识到，因为常常会聚焦于它的业务属性，而容易忽略它只是一条文本字符串。一些二维码工具如草料二维码，除了文本和网址,其他提供的媒体类功能已经在固有文本上做了一层处理或是依赖于其自身的业务体系，并没有超出二维码的使用能力。</p>\n<p>以网址二维码为例，在没有二维码的情况下，进入一个网址可以直接输入，当然如果要加上扫描进入，完全可以OCR直接扫描URL,但URL长度不固定，形式多样化，OCR端无法做到规范，那么条形码呢，条形码由于只能在横向方位表达信息，需要涵盖的URL越长，条码也就随之增长，不利于传播。而同样的信息编码，二维码在纵向和横向同时表达信息，信息空间利用率高，规范，容易扫描。</p>\n<p>二维码只是表明在二维空间上用几何形体来编码信息，常见的二维码是QR Code即Quick Response Code，属于矩阵式二维码，它只是二维码的一种码制，恰如余3码、8421码在BCD码中的范畴。有的QR Code复杂，有的简单,主要是版本不同，由40种尺寸的版本。通过色块的差异，使用0-1二进制编码。<br><img src=\"https://coolshell.cn/wp-content/uploads/2013/10/QR-Code-Overview.jpeg\" alt></p>\n<h2 id=\"1-2-业务形态：\"><a href=\"#1-2-业务形态：\" class=\"headerlink\" title=\"1.2 业务形态：\"></a>1.2 业务形态：</h2><ul>\n<li>身份信息验证<br>对用户而言，属于被动读取，如一些移动支付设备、票务验证设备扫描当前要进行业务处理的用户持有的二维码，主要<strong>用户平台读取用户信息</strong>。对用户而言基本上处于无感操作，但其实风险较高，辨识度也不一定好。因而在逐步转为生物识别方案。</li>\n<li>关联信息服务<br>对用户而言，属于主动读取，如一些网址类场景的进入，主要用于用户获取二维码存储内容后触发打开网址操作，在一些特定的业务场景中，<strong>扫码后的触发操作</strong>丰富多样。</li>\n</ul>\n<p>那么综合看来，扫码登录对用户来说既是属于主动读取，但又是用于平台验证用户信息，需要进一步理清这里边的关系。扫码登录相当于在手机客户端与浏览器页面建立连接关系，这种关系是经由用户授权的。对用户而言，扫码是为了识别当前操作的web环境，而授权则是让web端去读取用户信息。这样看来，这里的扫码主要还是处于关联信息服务这一形态。</p>\n<h1 id=\"2-扫码实现\"><a href=\"#2-扫码实现\" class=\"headerlink\" title=\"2 扫码实现\"></a>2 扫码实现</h1><p>以下从用户角度反推技术实现，不一定正确</p>\n<h2 id=\"2-1-系统底层扫码能力\"><a href=\"#2-1-系统底层扫码能力\" class=\"headerlink\" title=\"2.1 系统底层扫码能力\"></a>2.1 系统底层扫码能力</h2><p>必然首先要调取摄像头，然后调用识别接口</p>\n<h2 id=\"2-2-App实现扫码\"><a href=\"#2-2-App实现扫码\" class=\"headerlink\" title=\"2.2 App实现扫码\"></a>2.2 App实现扫码</h2><p>在手机操作系统之上，运行的App具有调用摄像头的功能，而相机、内置扫码功能均可以识别二维码信息，但只是文本信息，即使是url也并没有直接跳转，同一层次的app具备的扫码功能各不相同，主要集中于扫码界面的不同，扫码后的操作。相同的是，对于url的处理都是基于内置浏览器直接打开.<br>测试一条百度的首页二维码，用支付宝微信等业务场景丰富的APP可以直接打开，而场景特定的天猫京东则会提示是否打开，打开会使用手机默认浏览器。百度网盘则直接提示，暂不支持非网盘二维码。这说明，在扫码识别成功后（识别到的必然还是一条文本信息），APP内部的回调机制会判断文本的属性。注意到同样是文本，微信支付宝会在一个特定的页面呈现（调用内置浏览器），而天猫等则会直接在扫码后显示（调用本地页面）。于是猜想，是否前者会将扫码内容上传至服务端后再由服务端处理后后统一下发，这样做就可以实现丰富的扫码场景，这也契合这类app的功能，本地应该不可能将所有的扫码后操作写入回调，根据扫码结果打开特定网页，在该网页执行回调操作</p>\n<h2 id=\"2-3-小程序扫码\"><a href=\"#2-3-小程序扫码\" class=\"headerlink\" title=\"2.3 小程序扫码\"></a>2.3 小程序扫码</h2><p>在app之上，小程序提供了调起客户端扫码界面的接口，这一界面与直接使用微信扫码体验一致，然而差异在于接口提供的回调函数，如同一个中间件，在扫码完成后拦截扫码结果后自行处理,而微信扫码则只能被执行其上述的处理逻辑。在实现层面，两种扫码最终都会调用客户端的扫码接口，只需提供一个场景参数来判断后续回调该如何执行即可。</p>\n<h1 id=\"3-扫码登录分析\"><a href=\"#3-扫码登录分析\" class=\"headerlink\" title=\"3 扫码登录分析\"></a>3 扫码登录分析</h1><p>在app之中，扫码后如何判断当前类型以及后续操作，如果采用本地实现，注意到几乎所有的微信二维码（个人及公众号、）都是微信的域名或者短链开头附带参数的形式，支付宝的二维码会集中到<a href=\"https://qr.alipay.com下\" target=\"_blank\" rel=\"noopener\">https://qr.alipay.com下</a></p>\n<h2 id=\"3-1-公众号登录\"><a href=\"#3-1-公众号登录\" class=\"headerlink\" title=\"3.1 公众号登录:\"></a>3.1 公众号登录:</h2><div class=\"note info no-icon\">\n            <p>由于登录管理业务较为多样，尽量抽取必要的过程,特殊之处是由于上一步已经输入了账号密码，因此服务端知道需要什么样的微信账号扫码才是有效的，相当于做了双向验证。</p>\n          </div>\n<h3 id=\"3-1-1-入口\"><a href=\"#3-1-1-入口\" class=\"headerlink\" title=\"3.1.1 入口\"></a>3.1.1 入口</h3><figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">GET https://mp.weixin.qq.com/cgi-bin/bizlogin</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  \"action\": \"validate\",// 账号密码已校验</span><br><span class=\"line\">  \"lang\": \"zh_CN\",</span><br><span class=\"line\">  \"account\": \"xxx\",</span><br><span class=\"line\">  \"token\": </span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>由此时url可以猜测，这一步的扫码操作只是在获取后续访问用户接口的token。</p>\n<p>cookie很长，会存放在Request Cookies中</p>\n<img src=\"https://blog-cdn.makergyt.com/static/images/mp.weixin.cookie.png\">\n<h3 id=\"3-1-2-渲染二维码\"><a href=\"#3-1-2-渲染二维码\" class=\"headerlink\" title=\"3.1.2 渲染二维码\"></a>3.1.2 渲染二维码</h3><figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">GET https://mp.weixin.qq.com/cgi-bin/loginqrcode</span><br><span class=\"line\">Content-Type: image/jpg</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"attr\">\"action\"</span>: <span class=\"string\">\"getqrcode\"</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"param\"</span>: <span class=\"string\">\"4300\"</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"rd\"</span>: <span class=\"string\">\"309\"</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"3-1-3-二维码文本内容识别：\"><a href=\"#3-1-3-二维码文本内容识别：\" class=\"headerlink\" title=\"3.1.3 二维码文本内容识别：\"></a>3.1.3 二维码文本内容识别：</h3><blockquote>\n<p><a href=\"http://mp.weixin.qq.com/wap/loginauthqrcode?action=scan&amp;qrticket=be0271075c87f07664f983b41a1afa\" target=\"_blank\" rel=\"noopener\">http://mp.weixin.qq.com/wap/loginauthqrcode?action=scan&amp;qrticket=be0271075c87f07664f983b41a1afa</a></p>\n</blockquote>\n<p>直接浏览器打开不报错，不显示任何内容，猜测做了浏览器环境检测<br>可以理解为随后微信调用内置浏览器向此url发送get请求，没有测试使用其他账户扫码的结果，猜测会报失败，那么不同的用户扫码扫到相同结果，但是需要向服务端发送用户信息，用户信息如何发送呢？</p>\n<ul>\n<li>微信客户端与会话session</li>\n<li>微信客户端解析url后执行补充参数操作</li>\n</ul>\n<p>第一种实现的可能性大</p>\n<h3 id=\"3-1-4-请求\"><a href=\"#3-1-4-请求\" class=\"headerlink\" title=\"3.1.4 请求\"></a>3.1.4 请求</h3><p>最明显的是几乎每间隔1s，会向发起xhr请求:</p>\n<img src=\"https://blog-cdn.makergyt.com/static/images/mp.weixin.cookie.1.png\">\n<figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">GET https://mp.weixin.qq.com/cgi-bin/loginqrcode</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"attr\">\"action\"</span>: <span class=\"string\">\"ask\"</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"token\"</span>: ,</span><br><span class=\"line\">  <span class=\"attr\">\"lang\"</span>: <span class=\"string\">\"zh_CN\"</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"f\"</span>: <span class=\"string\">\"json\"</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"ajax\"</span>: <span class=\"number\">1</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\">// Response</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"attr\">\"base_resp\"</span>:</span><br><span class=\"line\">  &#123;</span><br><span class=\"line\">    <span class=\"attr\">\"err_msg\"</span>:<span class=\"string\">\"ok\"</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"ret\"</span>:<span class=\"number\">0</span></span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  <span class=\"attr\">\"status\"</span>:<span class=\"number\">0</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"user_category\"</span>:<span class=\"number\">0</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>在请求多次后，页面提示二维码过期,status为3,停止xhr请求。猜测，在页面渲染出二维码前后,浏览器向服务端轮询，有效期应该是由服务端控制。在扫描成功后，页面提示扫描成功，status为4,继续xhr请求。猜测，此时等待用户授权，浏览器向服务端轮询，授权后的回应由于手速不快，且长时间频繁轮询，导致浏览器卡死，暂时无法看到，但可以猜测到仍然是status的改变，或许是1，再加上token的返回，使得可以进入主页获取信息。用户取消授权，页面仍然继续原先xhr请求，由获取响应猜测，取消授权并没有向服务端发送消息，在二维码有效期内，用户再次扫描授权依然可以登录。</p>\n<h2 id=\"3-2-网页端微信登录\"><a href=\"#3-2-网页端微信登录\" class=\"headerlink\" title=\"3.2 网页端微信登录\"></a>3.2 网页端微信登录</h2><div class=\"note info no-icon\">\n            <p>网页端对登录用户未知</p>\n          </div>\n<h3 id=\"3-2-1-入口\"><a href=\"#3-2-1-入口\" class=\"headerlink\" title=\"3.2.1 入口\"></a>3.2.1 入口</h3><figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">GET https://wx.qq.com/</span><br><span class=\"line\">POST https://wx.qq.com/cgi-bin/mmwebwx-bin/webwxstatreport</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"attr\">\"fun\"</span>: <span class=\"string\">\"new\"</span>,</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">// Resquest payload</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"attr\">\"BaseRequest\"</span>:</span><br><span class=\"line\">  &#123;</span><br><span class=\"line\">    <span class=\"attr\">\"Uin\"</span>:<span class=\"string\">\"\"</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"Sid\"</span>:<span class=\"string\">\"\"</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"DeviceID\"</span>:<span class=\"string\">\"e395927229659859\"</span></span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  <span class=\"attr\">\"Count\"</span>:<span class=\"number\">0</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"List\"</span>:[]</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">// no Response</span><br></pre></td></tr></table></figure>\n<p>加载页面会调用3次POST,不同的是Request payload里的count和List(第一次)，由于后续登录到主页时，依然会调用，猜测这只是此应用的加载框架。</p>\n<h3 id=\"3-2-2-渲染二维码\"><a href=\"#3-2-2-渲染二维码\" class=\"headerlink\" title=\"3.2.2 渲染二维码\"></a>3.2.2 渲染二维码</h3><figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">GET https://login.weixin.qq.com/I/YblD1gWXOA==</span><br><span class=\"line\">Content-Type: image/jpg</span><br></pre></td></tr></table></figure>\n<p>可能<a href=\"https://login.weixin.qq.com/I是二维码接口，后边的``YblD1gWXOA==``应该是作为全局的唯一ID参数传入,但不清楚以``==``结尾的用处\" target=\"_blank\" rel=\"noopener\">https://login.weixin.qq.com/I是二维码接口，后边的``YblD1gWXOA==``应该是作为全局的唯一ID参数传入,但不清楚以``==``结尾的用处</a></p>\n<h3 id=\"3-2-3-扫码结果\"><a href=\"#3-2-3-扫码结果\" class=\"headerlink\" title=\"3.2.3 扫码结果\"></a>3.2.3 扫码结果</h3><blockquote>\n<p><a href=\"https://login.weixin.qq.com/I/YblD1gWXOA==\" target=\"_blank\" rel=\"noopener\">https://login.weixin.qq.com/I/YblD1gWXOA==</a></p>\n</blockquote>\n<p>此结果即为二维码的请求接口，直接打开依然进入到登录页面，inspect提示Please visit on computer browsers，看来对微信以外的浏览器打开此类型链接就会视为电脑端。</p>\n<h3 id=\"3-2-4-请求\"><a href=\"#3-2-4-请求\" class=\"headerlink\" title=\"3.2.4 请求\"></a>3.2.4 请求</h3><p>每隔一段时间，浏览器向发起script请求<br><figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">GET https://login.wx.qq.com/cgi-bin/mmwebwx-bin/login</span><br><span class=\"line\">Content-Type: text/javascript</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"attr\">\"loginicon\"</span>: <span class=\"literal\">true</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"uuid\"</span>: <span class=\"string\">\"YblD1gWXOA\"</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"tip\"</span>: <span class=\"number\">0</span>,</span><br><span class=\"line\">  \"r\": \"1526271870\", // 变化</span><br><span class=\"line\">  \"_\": \"1557546830994\" // 变化</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">// Response</span><br><span class=\"line\">window.code=408;</span><br></pre></td></tr></table></figure></p>\n<p>多次请求后，猜测可能服务端判定二维码过期(最后一次请求没有回应)，页面被重新加载。<br>扫码完成后，页面会显示出扫描者的头像，猜测扫描后已经将用户信息发至服务端。<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// Response</span></span><br><span class=\"line\"><span class=\"built_in\">window</span>.code = <span class=\"number\">201</span>;</span><br><span class=\"line\"><span class=\"built_in\">window</span>.userAvatar = <span class=\"string\">'...'</span>;</span><br></pre></td></tr></table></figure></p>\n<p>此时浏览器继续script请求,切换用户后，该script<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// Response</span></span><br><span class=\"line\"><span class=\"built_in\">window</span>.code = <span class=\"number\">400</span>;</span><br></pre></td></tr></table></figure></p>\n<p>刷新二维码时，产生一个请求<br><figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// GET https://login.wx.qq.com/jslogin</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"attr\">\"appid\"</span>: <span class=\"string\">\"wx782c26e4c19acffb\"</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"redirect_uri\"</span>: <span class=\"string\">\"https://wx.qq.com/cgi-bin/mmwebwx-bin/webwxnewloginpage\"</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"fun\"</span>: <span class=\"string\">\"new\"</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"lang\"</span>: <span class=\"string\">\"en_US\"</span>,</span><br><span class=\"line\">  \"_\": \"1557547453965\", // 应该是时间戳</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p>这可能是用于登录的内部应用，层级和微信开放平台的接入app类似。<br>登录后没能捕捉到script请求回应，猜测应该是基于code的改变。<br>登录后请求<br><figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// GET https://wx2.qq.com/cgi-bin/mmwebwx-bin/webwxnewloginpage</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"attr\">\"ticket\"</span>:<span class=\"string\">\"AxzDrAIOzOY7W8YqIP3jV8au@qrticket_0</span></span><br><span class=\"line\"><span class=\"string\">\"</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"uuid\"</span>:<span class=\"string\">\"YblD1gWXOA==\"</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"lang\"</span>:<span class=\"string\">\"en_US\"</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"scan\"</span>:<span class=\"string\">\"1557548341\"</span>,  </span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p>增加cookie</p>\n<img src=\"https://blog-cdn.makergyt.com/static/images/mp.weixin.2.png\">\n<p>没有发现登录后获取到的token之类的字段，且请求用户好友时没有携带相应参数，猜测已经直接写入cookie。</p>\n<h2 id=\"小结\"><a href=\"#小结\" class=\"headerlink\" title=\"小结\"></a>小结</h2><p>综合看来，由于服务端只能被动接受请求后向客户端回应，为了实现向客户端推送扫码结果消息，都是分为两步，渲染出二维码后轮询，扫码后继续轮询，二维码信息有效期均由服务端维护，但未知的是有效期的计算方式：</p>\n<ul>\n<li>按两步间隔分别计算</li>\n<li>从产生二维码起</li>\n</ul>\n<p>第二种的实现可能性大</p>\n<h2 id=\"3-3-goeasy\"><a href=\"#3-3-goeasy\" class=\"headerlink\" title=\"3.3 goeasy\"></a>3.3 goeasy</h2><h3 id=\"3-3-1-web待登录端\"><a href=\"#3-3-1-web待登录端\" class=\"headerlink\" title=\"3.3.1 web待登录端\"></a>3.3.1 web待登录端</h3><h4 id=\"3-3-1-1-产生二维码\"><a href=\"#3-3-1-1-产生二维码\" class=\"headerlink\" title=\"3.3.1.1 产生二维码\"></a>3.3.1.1 产生二维码</h4><div class=\"tabs\" id=\"first-unique-name\"><ul class=\"nav-tabs\"><li class=\"tab active\"><a href=\"#first-unique-name-1\">Request</a></li><li class=\"tab\"><a href=\"#first-unique-name-2\">Response</a></li></ul><div class=\"tab-content\"><div class=\"tab-pane active\" id=\"first-unique-name-1\"><p>GET <a href=\"http://www.goeasy.io/en/demo/qrcodelogin/qrcode\" target=\"_blank\" rel=\"noopener\">http://www.goeasy.io/en/demo/qrcodelogin/qrcode</a></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  &quot;qrCodeUrl&quot;: &quot;<a href=\"http://hangzhou.goeasy.io/en/demo/qrcodelogin/mobileconfirm?key=1b8a6c12-e696-4b7f-b3e2-0d1ce1b72eb2\" target=\"_blank\" rel=\"noopener\">http://hangzhou.goeasy.io/en/demo/qrcodelogin/mobileconfirm?key=1b8a6c12-e696-4b7f-b3e2-0d1ce1b72eb2</a>&quot;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></div><div class=\"tab-pane\" id=\"first-unique-name-2\"><p><img src=\"http://www.goeasy.io/en/demo/qrcodelogin/qrcode?qrCodeUrl=http%3A%2F%2Fhangzhou.goeasy.io%2Fen%2Fdemo%2Fqrcodelogin%2Fmobileconfirm%3Fkey%3D97f39297-144f-4485-9662-a163d7af42e2\" alt></p></div></div></div>\n<p>经测试，此接口只是产生二维码，没有任何校验(传参)<br>qrCodeUrl为二维码内容，注意到key，这个二维码会将用户引导至该url,内容完全由浏览器生成<br><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"number\">1.</span> GET http:<span class=\"comment\">//3hangzhou.goeasy.io/socket.io/</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"string\">\"EIO\"</span>:<span class=\"number\">3</span>,</span><br><span class=\"line\">  <span class=\"string\">\"transport\"</span>:<span class=\"string\">\"polling\"</span>,</span><br><span class=\"line\">  <span class=\"string\">\"j\"</span>:<span class=\"number\">0</span>,</span><br><span class=\"line\">  <span class=\"string\">\"t\"</span>:<span class=\"string\">\"MgfJnEd\"</span>,</span><br><span class=\"line\">  <span class=\"string\">\"b64\"</span>:<span class=\"number\">1</span>, <span class=\"comment\">// base64 ?</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\">Response</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"string\">\"sid\"</span>:<span class=\"string\">\"479511bd-59ee-4355-900d-96c0215bf5e1\"</span>, <span class=\"comment\">// 请求连接，获取到码</span></span><br><span class=\"line\">  <span class=\"string\">\"upgrades\"</span>:[<span class=\"string\">\"websocket\"</span>],</span><br><span class=\"line\">  <span class=\"string\">\"pingInterval\"</span>:<span class=\"number\">25000</span>,</span><br><span class=\"line\">  <span class=\"string\">\"pingTimeout\"</span>:<span class=\"number\">20000</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"number\">2.</span> GET http:<span class=\"comment\">//3hangzhou.goeasy.io/socket.io/</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"string\">\"EIO\"</span>:<span class=\"number\">3</span>,</span><br><span class=\"line\">  <span class=\"string\">\"transport\"</span>:<span class=\"string\">\"polling\"</span>,</span><br><span class=\"line\">  <span class=\"string\">\"j\"</span>:<span class=\"number\">0</span>,</span><br><span class=\"line\">  <span class=\"string\">\"t\"</span>:<span class=\"string\">\"MgfKThp\"</span>,</span><br><span class=\"line\">  <span class=\"string\">\"b64\"</span>:<span class=\"number\">1</span>, <span class=\"comment\">// base64 ?,</span></span><br><span class=\"line\">  <span class=\"string\">\"sid\"</span>: <span class=\"string\">\"479511bd-59ee-4355-900d-96c0215bf5e1\"</span> <span class=\"comment\">// 将码发上去，试图连接</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\">Response</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"string\">\"content\"</span>:<span class=\"string\">\"Ok\"</span>, <span class=\"comment\">// 连接码匹配 ，写入Response Cookies</span></span><br><span class=\"line\">  <span class=\"string\">\"sid\"</span>:<span class=\"string\">\"73746791-614f-4242-a750-29b2e1d67952\"</span>,</span><br><span class=\"line\">  <span class=\"string\">\"enableSubscribe\"</span>:<span class=\"literal\">true</span>, <span class=\"comment\">// 允许订阅该频道</span></span><br><span class=\"line\">  <span class=\"string\">\"enablePublish\"</span>:<span class=\"literal\">true</span>, <span class=\"comment\">// 允许发布信息</span></span><br><span class=\"line\">  <span class=\"string\">\"resultCode\"</span>:<span class=\"number\">200</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"number\">3.</span> GET http:<span class=\"comment\">//3hangzhou.goeasy.io/socket.io/ 出现两次,位于socket建立前后</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"string\">\"EIO\"</span>:<span class=\"number\">3</span>,</span><br><span class=\"line\">  <span class=\"string\">\"transport\"</span>:<span class=\"string\">\"polling\"</span>,</span><br><span class=\"line\">  <span class=\"string\">\"j\"</span>:<span class=\"number\">0</span>,</span><br><span class=\"line\">  <span class=\"string\">\"t\"</span>:<span class=\"string\">\"MgfKTjs\"</span>,</span><br><span class=\"line\">  <span class=\"string\">\"b64\"</span>:<span class=\"number\">1</span>, <span class=\"comment\">// base64 ?,</span></span><br><span class=\"line\">  <span class=\"string\">\"sid\"</span>: <span class=\"string\">\"479511bd-59ee-4355-900d-96c0215bf5e1\"</span> <span class=\"comment\">// sid与上两步相同</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"number\">4.</span> POST http:<span class=\"comment\">//3hangzhou.goeasy.io/socket.io/</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"string\">\"EIO\"</span>:<span class=\"number\">3</span>,</span><br><span class=\"line\">  <span class=\"string\">\"transport\"</span>:<span class=\"string\">\"polling\"</span>,</span><br><span class=\"line\">  <span class=\"string\">\"j\"</span>:<span class=\"number\">0</span>,</span><br><span class=\"line\">  <span class=\"string\">\"t\"</span>:<span class=\"string\">\"MgfKThj\"</span>,</span><br><span class=\"line\">  <span class=\"string\">\"b64\"</span>:<span class=\"number\">1</span>, <span class=\"comment\">// base64 ?,</span></span><br><span class=\"line\">  <span class=\"string\">\"sid\"</span>: <span class=\"string\">\"479511bd-59ee-4355-900d-96c0215bf5e1\"</span> <span class=\"comment\">// sid与上三步相同</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\">Form Data</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"string\">\"d\"</span>: <span class=\"number\">224</span>:<span class=\"number\">420</span>[<span class=\"string\">\"authorize\"</span>,&#123; <span class=\"comment\">// 应用层级的信息</span></span><br><span class=\"line\">    <span class=\"string\">\"appkey\"</span>:<span class=\"string\">\"PC-3c1dfc8b03c44aa58b5b601c0fb230bc\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"userId\"</span>:<span class=\"string\">\"anonymous-94019\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"username\"</span>:<span class=\"string\">\"\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"userData\"</span>:<span class=\"string\">\"\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"startMillis\"</span>:<span class=\"number\">1557571737428</span>,</span><br><span class=\"line\">    <span class=\"string\">\"artifactVersion\"</span>:<span class=\"string\">\"0.19.22\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"otp\"</span>:<span class=\"string\">\"Ulm51QzXjVYfdxyHQCFOIg==\"</span>,<span class=\"string\">\"</span></span><br><span class=\"line\"><span class=\"string\">    manual\"</span>:<span class=\"literal\">false</span></span><br><span class=\"line\">  &#125;] </span><br><span class=\"line\">&#125;</span><br><span class=\"line\">Response</span><br><span class=\"line\">ok <span class=\"comment\">// 这一步发生于websocket之后，明显对整个流程是多余的，应该只是用来提供给中后台做数据统计的</span></span><br><span class=\"line\"><span class=\"number\">5.</span> socket ws:<span class=\"comment\">//3hangzhou.goeasy.io/socket.io/</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"string\">\"EIO\"</span>:<span class=\"number\">3</span>,</span><br><span class=\"line\">  <span class=\"string\">\"transport\"</span>:<span class=\"string\">\"websocket\"</span>,</span><br><span class=\"line\">  <span class=\"string\">\"sid\"</span>: <span class=\"string\">\"479511bd-59ee-4355-900d-96c0215bf5e1\"</span> <span class=\"comment\">// sid与上四步相同</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\">Messages</span><br><span class=\"line\">↑[</span><br><span class=\"line\">  <span class=\"string\">\"subscribe\"</span>,&#123;</span><br><span class=\"line\">    <span class=\"string\">\"channel\"</span>:<span class=\"string\">\"1b8a6c12-e696-4b7f-b3e2-0d1ce1b72eb2\"</span>,<span class=\"comment\">// qrcode key</span></span><br><span class=\"line\">    <span class=\"string\">\"sid\"</span>:<span class=\"string\">\"73746791-614f-4242-a750-29b2e1d67952\"</span> <span class=\"comment\">// 第2步Response中的sid</span></span><br><span class=\"line\">  &#125;] <span class=\"comment\">// 由goeasy.subscribe发起</span></span><br><span class=\"line\">↓[&#123;</span><br><span class=\"line\">    <span class=\"string\">\"content\"</span>:<span class=\"string\">\"Ok\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"channel\"</span>:<span class=\"string\">\"1b8a6c12-e696-4b7f-b3e2-0d1ce1b72eb2\"</span>, <span class=\"comment\">// qrcode key</span></span><br><span class=\"line\">    <span class=\"string\">\"resultCode\"</span>:<span class=\"number\">200</span></span><br><span class=\"line\">  &#125;]</span><br><span class=\"line\"><span class=\"comment\">// allow</span></span><br><span class=\"line\">↓[</span><br><span class=\"line\">  <span class=\"string\">\"message\"</span>,&#123;</span><br><span class=\"line\">    <span class=\"string\">\"i\"</span>:<span class=\"string\">\"9d266860744b11e9a0bf77ea08eba6fb\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"t\"</span>:<span class=\"number\">1557620372490</span>,</span><br><span class=\"line\">    <span class=\"string\">\"n\"</span>:<span class=\"string\">\"1b8a6c12-e696-4b7f-b3e2-0d1ce1b72eb2\"</span>, <span class=\"comment\">// qrcode key</span></span><br><span class=\"line\">    <span class=\"string\">\"c\"</span>:<span class=\"string\">\"confirm\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"a\"</span>:<span class=\"literal\">true</span></span><br><span class=\"line\">  &#125;]</span><br><span class=\"line\">↑[</span><br><span class=\"line\">  <span class=\"string\">\"ack\"</span>,&#123;</span><br><span class=\"line\">    <span class=\"string\">\"publishGuid\"</span>:<span class=\"string\">\"9d266860744b11e9a0bf77ea08eba6fb\"</span> <span class=\"comment\">// i</span></span><br><span class=\"line\">  &#125;] <span class=\"comment\">// i</span></span><br><span class=\"line\"><span class=\"comment\">// reject</span></span><br><span class=\"line\">↓[</span><br><span class=\"line\">  <span class=\"string\">\"message\"</span>,&#123;</span><br><span class=\"line\">    <span class=\"string\">\"i\"</span>:<span class=\"string\">\"44914b60744c11e9b73565a64c922f3d\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"t\"</span>:<span class=\"number\">1557620653375</span>,</span><br><span class=\"line\">    <span class=\"string\">\"n\"</span>:<span class=\"string\">\"1b8a6c12-e696-4b7f-b3e2-0d1ce1b72eb2\"</span>, <span class=\"comment\">// qrcode key</span></span><br><span class=\"line\">    <span class=\"string\">\"c\"</span>:<span class=\"string\">\"cancel\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"a\"</span>:<span class=\"literal\">true</span></span><br><span class=\"line\">  &#125;] </span><br><span class=\"line\">↑[</span><br><span class=\"line\">  <span class=\"string\">\"ack\"</span>,&#123;</span><br><span class=\"line\">    <span class=\"string\">\"publishGuid\"</span>:<span class=\"string\">\"44914b60744c11e9b73565a64c922f3d\"</span> <span class=\"comment\">// i</span></span><br><span class=\"line\">  &#125;]</span><br></pre></td></tr></table></figure></p>\n<h4 id=\"3-3-1-2-时序\"><a href=\"#3-3-1-2-时序\" class=\"headerlink\" title=\"3.3.1.2 时序\"></a>3.3.1.2 时序</h4><p>2 中enableSubscribe和enablePublish响应应该是根据4中的appKey获得的，而appkey是写在页面js中的<br>二维码中的key和goeasy.subscribe中的channel是由页面初次加载生成的，服务端channel建立后即返回ok，进入onSuccess</p>\n<h3 id=\"3-3-2-验证端\"><a href=\"#3-3-2-验证端\" class=\"headerlink\" title=\"3.3.2 验证端\"></a>3.3.2 验证端</h3><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"number\">1.</span> GET http:<span class=\"comment\">//www.goeasy.io/en/demo/qrcodelogin/mobileconfirm</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"string\">\"key\"</span>: <span class=\"string\">\"1b8a6c12-e696-4b7f-b3e2-0d1ce1b72eb2\"</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\">Response</span><br><span class=\"line\">Allow</span><br><span class=\"line\">Reject</span><br><span class=\"line\"><span class=\"number\">2.</span> GET http:<span class=\"comment\">//4hangzhou.goeasy.io/socket.io/</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"string\">\"EIO\"</span>:<span class=\"number\">3</span>,</span><br><span class=\"line\">  <span class=\"string\">\"transport\"</span>:<span class=\"string\">\"polling\"</span>,</span><br><span class=\"line\">  <span class=\"string\">\"j\"</span>:<span class=\"number\">0</span>,</span><br><span class=\"line\">  <span class=\"string\">\"t\"</span>:<span class=\"string\">\"MgfSseu\"</span>,</span><br><span class=\"line\">  <span class=\"string\">\"b64\"</span>:<span class=\"number\">1</span>, </span><br><span class=\"line\">&#125; </span><br><span class=\"line\">Response</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"string\">\"sid\"</span>:<span class=\"string\">\"4bce3017-7f51-4095-8b26-966d27f191fe\"</span>,</span><br><span class=\"line\">  <span class=\"string\">\"upgrades\"</span>:[<span class=\"string\">\"websocket\"</span>],</span><br><span class=\"line\">  <span class=\"string\">\"pingInterval\"</span>:<span class=\"number\">25000</span>,</span><br><span class=\"line\">  <span class=\"string\">\"pingTimeout\"</span>:<span class=\"number\">20000</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"number\">3.</span> GET http:<span class=\"comment\">//4hangzhou.goeasy.io/socket.io/ //twice</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"string\">\"EIO\"</span>:<span class=\"number\">3</span>,</span><br><span class=\"line\">  <span class=\"string\">\"transport\"</span>:<span class=\"string\">\"polling\"</span>,</span><br><span class=\"line\">  <span class=\"string\">\"j\"</span>:<span class=\"number\">0</span>,</span><br><span class=\"line\">  <span class=\"string\">\"t\"</span>:<span class=\"string\">\"MgfU9ME\"</span>,</span><br><span class=\"line\">  <span class=\"string\">\"b64\"</span>:<span class=\"number\">1</span>, </span><br><span class=\"line\">  <span class=\"string\">\"sid\"</span>: <span class=\"string\">\"4bce3017-7f51-4095-8b26-966d27f191fe\"</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"number\">4.</span> POST http:<span class=\"comment\">//4hangzhou.goeasy.io/socket.io/</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"string\">\"EIO\"</span>:<span class=\"number\">3</span>,</span><br><span class=\"line\">  <span class=\"string\">\"transport\"</span>:<span class=\"string\">\"polling\"</span>,</span><br><span class=\"line\">  <span class=\"string\">\"j\"</span>:<span class=\"number\">0</span>,</span><br><span class=\"line\">  <span class=\"string\">\"t\"</span>:<span class=\"string\">\"MgfKThj\"</span>,</span><br><span class=\"line\">  <span class=\"string\">\"b64\"</span>:<span class=\"number\">1</span>, <span class=\"comment\">// base64 ?,</span></span><br><span class=\"line\">  <span class=\"string\">\"sid\"</span>: <span class=\"string\">\"4bce3017-7f51-4095-8b26-966d27f191fe\"</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\">Form Data</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"string\">\"d\"</span>: <span class=\"number\">224</span>:<span class=\"number\">420</span>[<span class=\"string\">\"authorize\"</span>,&#123;</span><br><span class=\"line\">    <span class=\"string\">\"appkey\"</span>:<span class=\"string\">\"PC-3c1dfc8b03c44aa58b5b601c0fb230bc\"</span>,<span class=\"string\">\"userId\"</span>:<span class=\"string\">\"anonymous-76117\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"username\"</span>:<span class=\"string\">\"\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"userData\"</span>:<span class=\"string\">\"\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"startMillis\"</span>:<span class=\"number\">1557618692944</span>,</span><br><span class=\"line\">    <span class=\"string\">\"artifactVersion\"</span>:<span class=\"string\">\"0.19.22\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"otp\"</span>:<span class=\"string\">\"Wdjj/rwWobxgJLipKAVwog==\"</span>,<span class=\"string\">\"</span></span><br><span class=\"line\"><span class=\"string\">    manual\"</span>:<span class=\"literal\">false</span>&#125;] </span><br><span class=\"line\">&#125;</span><br><span class=\"line\">Response</span><br><span class=\"line\">ok</span><br><span class=\"line\"><span class=\"number\">5.</span> socket ws:<span class=\"comment\">//3hangzhou.goeasy.io/socket.io/</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"string\">\"EIO\"</span>:<span class=\"number\">3</span>,</span><br><span class=\"line\">  <span class=\"string\">\"transport\"</span>:<span class=\"string\">\"websocket\"</span>,</span><br><span class=\"line\">  <span class=\"string\">\"sid\"</span>: <span class=\"string\">\"4bce3017-7f51-4095-8b26-966d27f191fe\"</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\">Messages</span><br><span class=\"line\">↓[&#123;</span><br><span class=\"line\">    <span class=\"string\">\"content\"</span>: <span class=\"string\">\"Ok\"</span></span><br><span class=\"line\">    <span class=\"string\">\"enablePublish\"</span>: <span class=\"literal\">true</span></span><br><span class=\"line\">    <span class=\"string\">\"enableSubscribe\"</span>: <span class=\"literal\">true</span></span><br><span class=\"line\">    <span class=\"string\">\"resultCode\"</span>: <span class=\"number\">200</span></span><br><span class=\"line\">    <span class=\"string\">\"sid\"</span>: <span class=\"string\">\"1d9c09df-735c-42f7-b522-b6e37fc5a3fa\"</span></span><br><span class=\"line\">  &#125;]</span><br><span class=\"line\"><span class=\"comment\">// allow</span></span><br><span class=\"line\">↑[</span><br><span class=\"line\">  <span class=\"string\">\"publish\"</span>,&#123;</span><br><span class=\"line\">    <span class=\"string\">\"channel\"</span>:<span class=\"string\">\"1b8a6c12-e696-4b7f-b3e2-0d1ce1b72eb2\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"content\"</span>: <span class=\"string\">\"confirm\"</span></span><br><span class=\"line\">    <span class=\"string\">\"guid\"</span>: <span class=\"string\">\"c90451e0-7450-11e9-97a1-5f37f3f5a2a1\"</span> <span class=\"comment\">// web端 message i</span></span><br><span class=\"line\">    <span class=\"string\">\"retried\"</span>: <span class=\"number\">0</span></span><br><span class=\"line\">    <span class=\"string\">\"sid\"</span>: <span class=\"string\">\"497dfc4a-bef2-40c5-97cf-816db52f4202\"</span></span><br><span class=\"line\">  &#125;]</span><br><span class=\"line\">↓[&#123;</span><br><span class=\"line\">  <span class=\"string\">\"content\"</span>,<span class=\"string\">\"Ok\"</span>，</span><br><span class=\"line\">  <span class=\"string\">\"resultCode\"</span>: <span class=\"number\">200</span></span><br><span class=\"line\">  &#125;]</span><br><span class=\"line\"><span class=\"comment\">// reject</span></span><br><span class=\"line\">↑[</span><br><span class=\"line\">  <span class=\"string\">\"publish\"</span>,&#123;</span><br><span class=\"line\">    <span class=\"string\">\"channel\"</span>:<span class=\"string\">\"1b8a6c12-e696-4b7f-b3e2-0d1ce1b72eb2\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"content\"</span>: <span class=\"string\">\"cancel\"</span></span><br><span class=\"line\">    <span class=\"string\">\"guid\"</span>: <span class=\"string\">\"44914b60744c11e9b73565a64c922f3d\"</span> <span class=\"comment\">// web端 message i</span></span><br><span class=\"line\">    <span class=\"string\">\"retried\"</span>: <span class=\"number\">0</span></span><br><span class=\"line\">    <span class=\"string\">\"sid\"</span>: <span class=\"string\">\"4a66feaf-de7c-451c-8302-552c8dba2471\"</span></span><br><span class=\"line\">  &#125;]</span><br><span class=\"line\">↓[&#123;</span><br><span class=\"line\">  <span class=\"string\">\"content\"</span>,<span class=\"string\">\"Ok\"</span>，</span><br><span class=\"line\">  <span class=\"string\">\"resultCode\"</span>: <span class=\"number\">200</span></span><br><span class=\"line\">  &#125;]</span><br></pre></td></tr></table></figure>\n<h3 id=\"3-3-3-综合分析\"><a href=\"#3-3-3-综合分析\" class=\"headerlink\" title=\"3.3.3 综合分析\"></a>3.3.3 综合分析</h3><p>发布订阅者模式，如何共同管理一个变量，对特定事件的消息做出反馈，同样事先要知道频道名称。发布后相当于建立了一个频道，对扫码来说，<br>对调用者而言，只需关注channel和message，websocket如何建立以及隔离对调用者是透明的，实现即用即连。实际上调用者的客户端和服务端都在与同一个websocket server进行会话，会话之前，需要先向官方的管理平台发送建立信息。<br>重新加载则视为先断开后连接，关闭选项卡视为断开</p>\n<h3 id=\"3-3-4-缺陷\"><a href=\"#3-3-4-缺陷\" class=\"headerlink\" title=\"3.3.4 缺陷\"></a>3.3.4 缺陷</h3><ul>\n<li>如果多人扫码，会将多人的授权情况都发到web端，造成混乱。</li>\n<li>如果web端二维码发生重载（用户发起），原先二维码并没有马上失效<h3 id=\"3-3-5-未解\"><a href=\"#3-3-5-未解\" class=\"headerlink\" title=\"3.3.5 未解\"></a>3.3.5 未解</h3>key何时生成及如何生成<br>由于无法同时监测所有传送数据，<del>大致判断后没有发现sid字段的相互联系</del>，sid格式仍是uuid的格式<br>由于服务端只提供了java的SDK，没有按照官方的业务测试使用，不清楚之间的部署与调用关系<br>由于未实际测试使用socket.io的接口，现已发现以上五次请求均为默认的请求，部分参数包括sid也是socket中自带的。那么该平台又是如何将自己的参数插入的未知<br>通过查阅官方文档，服务端在websocket中推送数据时，</li>\n</ul>\n<table>\n<thead>\n<tr>\n<th>Name</th>\n<th>Required</th>\n<th>Description</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>appkey</td>\n<td>Yes</td>\n<td>Your app key</td>\n</tr>\n<tr>\n<td>channel</td>\n<td>Yes</td>\n<td>Target channel name</td>\n</tr>\n<tr>\n<td>content</td>\n<td>Yes</td>\n<td>The message you want to publish</td>\n</tr>\n</tbody>\n</table>\n<p><img src=\"http://www.goeasy.io/resources/www/images/part0ne2_1_en.gif\" alt></p>\n<h1 id=\"4-扫码登录的解决方案\"><a href=\"#4-扫码登录的解决方案\" class=\"headerlink\" title=\"4 扫码登录的解决方案\"></a>4 扫码登录的解决方案</h1><h2 id=\"4-0-技术要点\"><a href=\"#4-0-技术要点\" class=\"headerlink\" title=\"4.0 技术要点\"></a>4.0 技术要点</h2><p>扫码的过程是为了引导用户到指定的授权页面，进入这个页面要同时向服务端传送需要授权的web端环境信息（由二维码信息提供），识别当前登录用户，（等同于用户输入账号信息），验证用户权限，（等同于服务端异步处理表单数据），用户授权，（等同于用户输入密码）。服务端就可以确认验证后的用户和将此消息下发至哪个web端。<br><del>暂时二维码信息由服务端生成并管理，目前不知道为什么这样做，但觉得好像是对的</del></p>\n<h3 id=\"4-0-1-Polling、Long-Polling、WebSocket\"><a href=\"#4-0-1-Polling、Long-Polling、WebSocket\" class=\"headerlink\" title=\"4.0.1 Polling、Long Polling、WebSocket\"></a>4.0.1 Polling、Long Polling、WebSocket</h3><h3 id=\"4-0-2-socket\"><a href=\"#4-0-2-socket\" class=\"headerlink\" title=\"4.0.2 socket\"></a>4.0.2 socket</h3><h4 id=\"4-0-2-1-socket-连接身份验证\"><a href=\"#4-0-2-1-socket-连接身份验证\" class=\"headerlink\" title=\"4.0.2.1 socket 连接身份验证\"></a>4.0.2.1 socket 连接身份验证</h4><h4 id=\"4-0-2-2-namespace-amp-room\"><a href=\"#4-0-2-2-namespace-amp-room\" class=\"headerlink\" title=\"4.0.2.2 namespace &amp; room\"></a>4.0.2.2 namespace &amp; room</h4><h3 id=\"4-0-3-二维码生成\"><a href=\"#4-0-3-二维码生成\" class=\"headerlink\" title=\"4.0.3 二维码生成\"></a>4.0.3 二维码生成</h3><h4 id=\"4-0-3-1-普通二维码\"><a href=\"#4-0-3-1-普通二维码\" class=\"headerlink\" title=\"4.0.3.1 普通二维码\"></a>4.0.3.1 普通二维码</h4><ul>\n<li>向某个二维码接口请求，Content-Type: image/png，获取到的内容放在<img src></li>\n<li>qrcode.react组件，传入参数直接渲染(cavas绘制)，参数可由客户端直接生成，也可由服务端生成，也可由客户端生成附带其他信息经服务端检测（安全性）后下发</li>\n</ul>\n<h4 id=\"4-0-3-2-带参小程序码\"><a href=\"#4-0-3-2-带参小程序码\" class=\"headerlink\" title=\"4.0.3.2 带参小程序码\"></a>4.0.3.2 带参小程序码</h4><h2 id=\"4-1-二维码信息\"><a href=\"#4-1-二维码信息\" class=\"headerlink\" title=\"4.1 二维码信息\"></a>4.1 二维码信息</h2><p>由于小程序打不开网页，二维码也就无需管理URL,但为了使得小程序的扫码操作只局限于本应用，应该在二维码上加上域名信息作为判断二维码对小程序的有效性。 </p>\n<h3 id=\"4-1-1-小程序扫码后的回调\"><a href=\"#4-1-1-小程序扫码后的回调\" class=\"headerlink\" title=\"4.1.1 小程序扫码后的回调\"></a>4.1.1 小程序扫码后的回调</h3><h4 id=\"4-1-1-1-普通二维码\"><a href=\"#4-1-1-1-普通二维码\" class=\"headerlink\" title=\"4.1.1.1 普通二维码\"></a>4.1.1.1 普通二维码</h4><p>需要在二维码上附加操作类型参数，以便选择回调函数</p>\n<h4 id=\"4-1-1-2-小程序码\"><a href=\"#4-1-1-2-小程序码\" class=\"headerlink\" title=\"4.1.1.2 小程序码\"></a>4.1.1.2 小程序码</h4><p>由于小程序码由页面+参数构成，扫码后直接进入到该页面，执行该页面的逻辑，因而不需要考虑回调操作的选择。</p>\n<h2 id=\"4-2-扫码场景\"><a href=\"#4-2-扫码场景\" class=\"headerlink\" title=\"4.2 扫码场景\"></a>4.2 扫码场景</h2><h3 id=\"4-2-1-微信扫小程序码\"><a href=\"#4-2-1-微信扫小程序码\" class=\"headerlink\" title=\"4.2.1 微信扫小程序码\"></a>4.2.1 微信扫小程序码</h3><p>扫码后打开小程序,进入小程序的逻辑，集成于小程序扫小程序码的内部。</p>\n<h3 id=\"4-2-2-小程序扫普通二维码\"><a href=\"#4-2-2-小程序扫普通二维码\" class=\"headerlink\" title=\"4.2.2 小程序扫普通二维码\"></a>4.2.2 小程序扫普通二维码</h3><p>可以实现，并且支持不授权登录。</p>\n<h4 id=\"4-2-2-1-设计\"><a href=\"#4-2-2-1-设计\" class=\"headerlink\" title=\"4.2.2.1  设计\"></a>4.2.2.1  设计</h4><p>但普通二维码如何避免被使用其他工具扫描泄露key，文本不可避免要被扫描出来，只能进行一步加密操作<br>工具扫码大致流程：识别文本－&gt;判别类型，如果是网址直接使用内置浏览器打开</p>\n<ol>\n<li>小程序端识别到UUID，并以此建立socket连接，通知已扫码，(客户端二维码失效，等待授权操作后重新更新）</li>\n<li>将身份信息发至服务端，由服务端调用用户管理接口，进行身份验证，返回登录权限</li>\n<li>根据登录权限，跳转至授权页或者错误页<br>授权页提示信息</li>\n</ol>\n<p>二维码被扫描的信息是否需要提交，若处在客户端有验证信息情况下需要，其他客户端扫码是无效的，不应对主逻辑产生影响<br>保证小程序扫码过程完成，客户端要知道当前的key已经失效（除非被授权），即key的生命期 = 从服务端生成发至客户端开始至被扫码　|| 固定时间有效期,<br>扫码完成后，服务端调用用户管理接口，授权完成后，客户端将此key与用户session绑定<br>小程序是否有必要加入socket会话中？小程序扫码后直接向服务端发送结果，点击授权也是直接发送结果，似乎不存在从服务器主动下发消息的情况，应该是无状态的扫码，二维码在改变，但小程序只负责扫描。由于小程序打不开网页，二维码也就无需管理URL,但为了使得小程序的扫码操作只局限于本应用，应该在二维码上加上域名信息作为判断二维码对小程序的有效性。  </p>\n<p>保证在小程序扫码，只能扫本域内的有效码；<br>用别处扫该码，只能扫到密钥文本，或引导到本域内某个地址，提示请使用某某某小程序扫码并附带小程序二维码，那么小程序二维码先得附带URL,扫码回调页面由服务端生成后（由客户端请求时附带操作参数）</p>\n<h4 id=\"4-2-2-2-权限管理\"><a href=\"#4-2-2-2-权限管理\" class=\"headerlink\" title=\"4.2.2.2 权限管理\"></a>4.2.2.2 权限管理</h4><p>权限应该是对接口调取的管理，而不仅是前端页面的显示与隐藏<br>用户扫码完成后，由于扫码操作已经产生一次数据上传，完全可以在回调中提示用户权限，但从用户角度，仅仅扫码不应该将用户数据上传，而应该在授权时获取用户同意后再上传判断权限，这样做增加了操作成本，但利于体验。</p>\n<h3 id=\"4-2-3-微信扫普通二维码\"><a href=\"#4-2-3-微信扫普通二维码\" class=\"headerlink\" title=\"4.2.3 微信扫普通二维码\"></a>4.2.3 微信扫普通二维码</h3><p>暂时不可实现：可识别信息，但无法携带微信账户信息</p>\n<h3 id=\"4-2-4-小结\"><a href=\"#4-2-4-小结\" class=\"headerlink\" title=\"4.2.4 小结\"></a>4.2.4 小结</h3><p>综上，为了提高用户体验，使用第一种方式，微信扫描带参数小程序码，调起小程序至授权页面。当然，这也就天然支持小程序环境直接扫描小程序码，这样就对用户模糊了操作界限。</p>\n<h2 id=\"4-3-监听形态\"><a href=\"#4-3-监听形态\" class=\"headerlink\" title=\"4.3 监听形态\"></a>4.3 监听形态</h2><h3 id=\"4-3-1-web轮询\"><a href=\"#4-3-1-web轮询\" class=\"headerlink\" title=\"4.3.1 web轮询\"></a>4.3.1 web轮询</h3><p><img src=\"https://images2017.cnblogs.com/blog/1203274/201712/1203274-20171228193850553-540074571.png\" alt></p>\n<h3 id=\"4-3-2-websocket\"><a href=\"#4-3-2-websocket\" class=\"headerlink\" title=\"4.3.2 websocket\"></a>4.3.2 websocket</h3><table>\n<thead>\n<tr>\n<th>eventName</th>\n<th>args</th>\n<th>ack</th>\n<th>remarks</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>listen</td>\n<td>channel</td>\n<td>join room</td>\n<td>client</td>\n</tr>\n<tr>\n<td>scan</td>\n<td></td>\n<td>join room</td>\n<td>weapp</td>\n</tr>\n<tr>\n<td>auth</td>\n<td>userInfo</td>\n<td>auth result</td>\n<td>weapp</td>\n</tr>\n<tr>\n<td>auth</td>\n<td>reject</td>\n<td>auth result</td>\n<td>weapp</td>\n</tr>\n<tr>\n<td>expired</td>\n<td></td>\n<td>leave</td>\n<td>client</td>\n</tr>\n<tr>\n<td>leave</td>\n<td>user</td>\n<td>close</td>\n<td>client、weapp</td>\n</tr>\n</tbody>\n</table>\n<h1 id=\"未解\"><a href=\"#未解\" class=\"headerlink\" title=\"未解\"></a>未解</h1><ol>\n<li><p>如何保存chrome devtools 中请求response日志</p>\n<p> 勾选preserve log后可以保存networks列表，保证页面被reload后还存在，但是过程中的response已经找不到。</p>\n</li>\n<li>如何判断出真实的请求时序</li>\n</ol>\n<h1 id=\"参考\"><a href=\"#参考\" class=\"headerlink\" title=\"参考\"></a>参考</h1><p>[1] 黄聪.如何扩展Chrome DevTools来获取页面请求.<a href=\"https://www.cnblogs.com/huangcong/p/9414479.html\" target=\"_blank\" rel=\"noopener\">https://www.cnblogs.com/huangcong/p/9414479.html</a> [EB/OL] 2018</p>"},{"title":"持续集成","date":"2019-05-13T07:11:15.000Z","_content":"同一服务器，同时启动多个node应用（pm2），应用使用不同的port(nginx),对应配置多个二级域名(路由控制)并支持https(脚本)\n最终实现与now类似的功能，提交github某个仓库同步触发更新server内对应路径项目覆盖更新，脱敏，对于新的仓库识别后克隆新建,并配置虚拟主机和三级域名\n# 持续集成\n## travis-CI\n需求点在于，想要在短期内看到代码构建及运行在一定环境下的结果，进行初步的测试，部分功能服务必须上线到外网环境才能进行后续开发，这样不是等到最终完成开发采取组织代码合并。这样的测试必然是持续性的，覆盖性的，对于持续集成理论和典型产品travis-CI之前有过听说但一直没有硬性需求，现在看来确实有必要用了。\n那么要实现这样的需求，至少需要支持版本管理，监听提交便拉取克隆，分配干净的运行环境，按需安装软件依赖，执行启动脚本，以及测试和日志。自动化部署则是在测试之后。\n### 起步\n首先看到了大部分指向的https://travis-ci.org， 然后进行了一些操作后，进入文档，当从文档中链接进入操作界面时，被引导至主页，关键是提示没有登录，于是重新登录，进入dashboard后，发现，什么都没了，抬头看一眼网址，发现不对，后缀变成了com,对比发现两个网站https://travis-ci.org，https://travis-ci.com, 一模一样（上当受骗的感觉），但是数据不共享，前者部分链接会引导到后者，如最重要的文档。\n- https://travis-ci.org\n\n{% qnimg travis-ci.org.png  %}\n绑定github账户，可以访问账户下信息，是一种Authorized GitHub Apps，需要分别激活项目，然后监测该仓库的代码提交，自动抓取下来，可以提供一个运行环境，进行测试和构建，与now-cli提供的类似\n{% qnimg travis-ci.org.respositories.png %}\n- https://travis-ci.com\n\n{% qnimg travis-ci.com.png  %}\n\n{% qnimg travis-ci.com.respositories.png %}\n然后进入文档[legacy-services-to-github-apps-migration-guide](https://docs.travis-ci.com/user/migrate/legacy-services-to-github-apps-migration-guide/),看到\n{% note info %}\nAs of May 2, 2018 we are moving toward having repositories integrated via a GitHub App instead of GitHub Services which will no longer be supported by GitHub as of January 31st, 2019.While this process is ongoing, we have been migrating from GitHub services to webhooks on the https://travis-ci.org enabled repositories. The closure of GitHub services will not affect your repositories even if you are currently on .org.\n{% endnote %}\n\n这就促使去了解GitHub Apps和Services的区别，以及为什么会抛弃后者。当然还有一种重要的(自定义的)集成方式webhooks.在github上，\n1. Installed GitHub Apps\nGitHub Apps augment and extend your workflows on GitHub with commercial, open source, and homegrown tools.\n2. Services\nServices are pre-built integrations that perform certain actions when events occur on GitHub.\n{% note danger %}\nNote: GitHub Services have been deprecated. Please contact your integrator for more information on how to migrate or replace a service with webhooks or GitHub Apps.\n{% endnote %}\n这样事情就大致明了了，~~目前网络上相关的介绍还是基于旧的（org）为了逐步提高认知，还是使用原先的这种方式。~~。文档推荐（以及内部链接）是使用com，工具而已，暂时直接体验新模式。\n3. webhooks\nWebhooks allow external services to be notified when certain events happen. When the specified events happen, we’ll send a POST request to each of the URLs you provide. Learn more in our Webhooks Guide.\n代码提交触发对服务端的请求，所以服务端要有一个接收请求的脚本，接收到后再执行本地脚本进行版本更新\n### 使用\n#### 初始化\n\n##### config\n#### 生命周期\n\n# 自动化部署\n## webhooks\n只做一个服务，接受提交的仓库参数后针对性\n或者在每个仓库的Payload URL直接带上参数,\n只能在仓库中分别添加，~~这样其实不需要参数~~\n### error\n传入event.payload.repository.name卡死\n### 重启应用\n- 先查找端口号关闭进程，更新文件后再启动\n- 后台运行，无法看到运行\n- 修改文件自动重启\n\n{% note danger %}\nFatal error: ENOSPC: System limit for number of file watchers reached\n{% endnote %}\n```sh\necho fs.inotify.max_user_watches=524288 | sudo tee -a /etc/sysctl.conf && sudo sysctl -p \nsudo sysctl --system\n```\n获取提交的时间\n- 记录在仓库内某个文件 =>开始提交的本地时间\n每次提交时脚本写到文件里？去了被取出来，是否可以直接读git log\n- github post的消息 =>提交成功的时间\n  可以传入将来执行的脚本参数，但如何传入node服务\n  使用script后，参数无法正常传入，--name无法进入node内部argparse的参数，被视为外部run 的参数，不使用name声明就必填，这样不便于本地调试。加上环境变量？，本地直接node命令,由于使用了nodemon,需要全局安装才能识别，故采用文件记录的方式\n- 在服务端执行脚本时记录在某个文件里 =>重启服务的服务端时间\n  已经产生延迟\n# 多端口多域名服务器\n多个应用使用虚拟主机隔离，将不同的应用目录和访问url绑定，这样配置不同的url,经过域名解析（都还是解析到这一服务器IP）,进入nginx默认配置，监听80端口，负责调度到不同的配置文件下(遍历sites-enabled下的文件server-name？)，同时监听443端口和80端口,80端口做了301重定向后，会以https重新请求进入https的服务器配置，以进入到对应的路径下，获取到证书后返回给浏览器验证，再执行应用内的路由管理。\n在node上，多个应用一般使用端口隔离，使用nginx反向代理到不同的端口 \n## 域名解析\n生成一条新子域名可以添加一条DNS记录，在这里所有的子域名都指向同一IP,故添加泛域名解析至该IP即可\n## 反向代理\n### node服务器\n[node-http-proxy](http://github.com/nodejitsu/node-http-proxy)\n[node-reverse-proxy.js](https://github.com/skx/node-reverse-proxy.js)\n### nginx\n在虚拟主机中，二级域名的请求是由nginx完成的,\n#### 安装nginx\n见[LNMP](https://blog.makergyt.com/en/LNMP/)\n#### 配置虚拟主机\n```sh\n# etc/nginx/conf.d/test.conf\nupstream originalhost {\n  server 127.0.0.1:8080; \n  keepalive 64;\n}\nserver {\n    listen 80;\n    server_name goods.test.makergyt.com;\n    access_log /var/log/nginx/goods.log;\n    location / {\n        proxy_set_header X-Real-IP $remote_addr;\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n        proxy_set_header Host  $http_host;\n        proxy_set_header X-Nginx-Proxy true;\n        proxy_set_header Connection \"\";\n        proxy_pass      http://originalhost;\n    }\n}\n```\n#### https\n如果URL前为https,浏览器向服务器端口443，服务器下发ssl_certificate,证书文件由http服务器读取（nginx或node），\n##### node\n```js\n'use strict';\n\nvar https = require('https');\nvar server = https.createServer({\n  key: require('fs').readFileSync('./privkey.pem')\n, cert: require('fs').readFileSync('./fullchain.pem')\n}, function (req, res) {\n  res.end(\"Hello, World!\");\n}).listen(443, function () {\n  console.log('Listening on', this.address());\n})\n```\n##### nginx\n先监听80再监听443端口重定向，读取pem\n```sh\nlisten              443 ssl;\nserver_name         www.example.com;\nssl_certificate     www.example.com.crt;\nssl_certificate_key www.example.com.key;\nssl_protocols       TLSv1 TLSv1.1 TLSv1.2;\nssl_ciphers         HIGH:!aNULL:!MD5;\n```\n## ssl\n### prove control of the domain\n- Provisioning a DNS record under domain\n- Provisioning an HTTP resource under a well-known URI on domain\n\n不管是申请还是续期，只要是通配符证书，只能采用 dns-01 的方式校验申请者的域名，也就是说 certbot 操作者必须手动添加 DNS TXT 记录。\n### CA (Certificate Authority)\n#### 付费\n#### 免费\n##### Let’s Encrypt\n\n### 证书签发工具\n#### 第三方平台\n阿里云、腾讯云等机构提供证书申请服务,申请好后自行下载，依然在调取CA的接口\n#### ACME Client (Automatic Certificate Management Environment)\n客户端可能会检测服务器内已部署的虚拟主机配置以便下载到相应位置。\n- 实现不需要ssh登录到服务器内部配置，随机生成域名前缀或者根据上传的项目名称参数而触发申请证书、配置nginx和重启流程。\n- 泛域名解析后，nginx先进行分配？直接解析至某个应用服务器下，再由应用服务器进行反向代理\n\n申请免费证书再下载到服务器上，也可以直接使用cert工具完成申请和下发，可以对目前的所有域名直接使用一套密钥，但一旦新增就需要再次执行添加，修改nginx配置。\n##### certbot \n>If you want to obtain a wildcard certificate using Let's Encrypt's new ACMEv2 server, you'll also need to use one of Certbot's DNS plugins. \n官方没有阿里云的插件,\n- [第三方](https://github.com/ywdblog/certbot-letencrypt-wildcardcertificates-alydns-au)\n- 手动，不能自动更新DNS\nAvailable [install_certbot.sh](https://github.com/MakerGYT/ubuntu-sh/blob/master/install_certbot.sh)\n##### acme.sh\n{% note danger %}\nInvalid response from https://test.makergyt.com/.well-known/acme-challenge/ajDvnOpG0Gv-iHDyYlaVcBrej3-ONLsJu43bIaJYWns\n{% endnote %}\n### 证书内容\n#### pem\n#### crt & key\ncrt公钥\n\n## 多进程管理\n### PM2 启动\n```sh\npm2 start apps.json\n# apps.json\n{\n  \"apps\":[\n  {\n    \"name\":\"app1\",\n    \"cwd\":\"/project/app1/\",\n    \"max_memory_restart\":\"1024M\",\n    \"log_date_format\":\"YYYY-MM-DD HH:mm:ss SSS\",\n    \"script\":\"/project/app1.js\",\n    \"env\":{\n        \"http_proxy\":\"http://10.12.xxx.xxx:xxxx\"\n    }\n  },]\n}\n```\n## 动态域名\n### 域名生成\n### 域名解析\n\n为固定域名添加泛解析，将所有动态的域名请求都发到同一个服务上，再分发\n# 自动化构建\n## cloud studio(半自动化预览)\n## heroku\n## now.sh\n由本地提交触发（now.json,或cli）后构建\n## circleci\n可以直接拉取构建\n# Reference\n[1] UYOU.Nginx反向代理：实现node.js多虚拟主机.https://www.imooc.com/article/34904 [EB/OL] 2018\n[2] fairysoftware.基于nodejs实现一台服务器多个https域名（多个SSL证书、nodejs ssl 多域名.http://www.fairysoftware.com/nodejs_ssl_https.html [EB/OL] 2018\n[3] 阮一峰.持续集成服务 Travis CI 教程.http://www.ruanyifeng.com/blog/2017/12/travis_ci_tutorial.html [EB/OL] 2017\n[4] huzhuolei.通过 Certbot 申请泛域名 HTTPS 证书及配置自动更新.https://www.jianshu.com/p/034b891cf395 [EB/OL] 2019\n[5] ISRG.Let's Encrypt Documentation.https://letsencrypt.org/docs/ [EB/OL] \n[6] 飞奔的萝卜.申请Let's Encrypt通配符HTTPS证书.https://my.oschina.net/kimver/blog/1634575 [EB/OL] 2018\n[7] Igor Sysoev.Configuring HTTPS servers.http://nginx.org/en/docs/http/configuring_https_servers.html [EB/OL]","source":"_drafts/持续集成.md","raw":"---\ntitle: 持续集成\ndate: 2019-05-13 15:11:15\ntags:\n---\n同一服务器，同时启动多个node应用（pm2），应用使用不同的port(nginx),对应配置多个二级域名(路由控制)并支持https(脚本)\n最终实现与now类似的功能，提交github某个仓库同步触发更新server内对应路径项目覆盖更新，脱敏，对于新的仓库识别后克隆新建,并配置虚拟主机和三级域名\n# 持续集成\n## travis-CI\n需求点在于，想要在短期内看到代码构建及运行在一定环境下的结果，进行初步的测试，部分功能服务必须上线到外网环境才能进行后续开发，这样不是等到最终完成开发采取组织代码合并。这样的测试必然是持续性的，覆盖性的，对于持续集成理论和典型产品travis-CI之前有过听说但一直没有硬性需求，现在看来确实有必要用了。\n那么要实现这样的需求，至少需要支持版本管理，监听提交便拉取克隆，分配干净的运行环境，按需安装软件依赖，执行启动脚本，以及测试和日志。自动化部署则是在测试之后。\n### 起步\n首先看到了大部分指向的https://travis-ci.org， 然后进行了一些操作后，进入文档，当从文档中链接进入操作界面时，被引导至主页，关键是提示没有登录，于是重新登录，进入dashboard后，发现，什么都没了，抬头看一眼网址，发现不对，后缀变成了com,对比发现两个网站https://travis-ci.org，https://travis-ci.com, 一模一样（上当受骗的感觉），但是数据不共享，前者部分链接会引导到后者，如最重要的文档。\n- https://travis-ci.org\n\n{% qnimg travis-ci.org.png  %}\n绑定github账户，可以访问账户下信息，是一种Authorized GitHub Apps，需要分别激活项目，然后监测该仓库的代码提交，自动抓取下来，可以提供一个运行环境，进行测试和构建，与now-cli提供的类似\n{% qnimg travis-ci.org.respositories.png %}\n- https://travis-ci.com\n\n{% qnimg travis-ci.com.png  %}\n\n{% qnimg travis-ci.com.respositories.png %}\n然后进入文档[legacy-services-to-github-apps-migration-guide](https://docs.travis-ci.com/user/migrate/legacy-services-to-github-apps-migration-guide/),看到\n{% note info %}\nAs of May 2, 2018 we are moving toward having repositories integrated via a GitHub App instead of GitHub Services which will no longer be supported by GitHub as of January 31st, 2019.While this process is ongoing, we have been migrating from GitHub services to webhooks on the https://travis-ci.org enabled repositories. The closure of GitHub services will not affect your repositories even if you are currently on .org.\n{% endnote %}\n\n这就促使去了解GitHub Apps和Services的区别，以及为什么会抛弃后者。当然还有一种重要的(自定义的)集成方式webhooks.在github上，\n1. Installed GitHub Apps\nGitHub Apps augment and extend your workflows on GitHub with commercial, open source, and homegrown tools.\n2. Services\nServices are pre-built integrations that perform certain actions when events occur on GitHub.\n{% note danger %}\nNote: GitHub Services have been deprecated. Please contact your integrator for more information on how to migrate or replace a service with webhooks or GitHub Apps.\n{% endnote %}\n这样事情就大致明了了，~~目前网络上相关的介绍还是基于旧的（org）为了逐步提高认知，还是使用原先的这种方式。~~。文档推荐（以及内部链接）是使用com，工具而已，暂时直接体验新模式。\n3. webhooks\nWebhooks allow external services to be notified when certain events happen. When the specified events happen, we’ll send a POST request to each of the URLs you provide. Learn more in our Webhooks Guide.\n代码提交触发对服务端的请求，所以服务端要有一个接收请求的脚本，接收到后再执行本地脚本进行版本更新\n### 使用\n#### 初始化\n\n##### config\n#### 生命周期\n\n# 自动化部署\n## webhooks\n只做一个服务，接受提交的仓库参数后针对性\n或者在每个仓库的Payload URL直接带上参数,\n只能在仓库中分别添加，~~这样其实不需要参数~~\n### error\n传入event.payload.repository.name卡死\n### 重启应用\n- 先查找端口号关闭进程，更新文件后再启动\n- 后台运行，无法看到运行\n- 修改文件自动重启\n\n{% note danger %}\nFatal error: ENOSPC: System limit for number of file watchers reached\n{% endnote %}\n```sh\necho fs.inotify.max_user_watches=524288 | sudo tee -a /etc/sysctl.conf && sudo sysctl -p \nsudo sysctl --system\n```\n获取提交的时间\n- 记录在仓库内某个文件 =>开始提交的本地时间\n每次提交时脚本写到文件里？去了被取出来，是否可以直接读git log\n- github post的消息 =>提交成功的时间\n  可以传入将来执行的脚本参数，但如何传入node服务\n  使用script后，参数无法正常传入，--name无法进入node内部argparse的参数，被视为外部run 的参数，不使用name声明就必填，这样不便于本地调试。加上环境变量？，本地直接node命令,由于使用了nodemon,需要全局安装才能识别，故采用文件记录的方式\n- 在服务端执行脚本时记录在某个文件里 =>重启服务的服务端时间\n  已经产生延迟\n# 多端口多域名服务器\n多个应用使用虚拟主机隔离，将不同的应用目录和访问url绑定，这样配置不同的url,经过域名解析（都还是解析到这一服务器IP）,进入nginx默认配置，监听80端口，负责调度到不同的配置文件下(遍历sites-enabled下的文件server-name？)，同时监听443端口和80端口,80端口做了301重定向后，会以https重新请求进入https的服务器配置，以进入到对应的路径下，获取到证书后返回给浏览器验证，再执行应用内的路由管理。\n在node上，多个应用一般使用端口隔离，使用nginx反向代理到不同的端口 \n## 域名解析\n生成一条新子域名可以添加一条DNS记录，在这里所有的子域名都指向同一IP,故添加泛域名解析至该IP即可\n## 反向代理\n### node服务器\n[node-http-proxy](http://github.com/nodejitsu/node-http-proxy)\n[node-reverse-proxy.js](https://github.com/skx/node-reverse-proxy.js)\n### nginx\n在虚拟主机中，二级域名的请求是由nginx完成的,\n#### 安装nginx\n见[LNMP](https://blog.makergyt.com/en/LNMP/)\n#### 配置虚拟主机\n```sh\n# etc/nginx/conf.d/test.conf\nupstream originalhost {\n  server 127.0.0.1:8080; \n  keepalive 64;\n}\nserver {\n    listen 80;\n    server_name goods.test.makergyt.com;\n    access_log /var/log/nginx/goods.log;\n    location / {\n        proxy_set_header X-Real-IP $remote_addr;\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n        proxy_set_header Host  $http_host;\n        proxy_set_header X-Nginx-Proxy true;\n        proxy_set_header Connection \"\";\n        proxy_pass      http://originalhost;\n    }\n}\n```\n#### https\n如果URL前为https,浏览器向服务器端口443，服务器下发ssl_certificate,证书文件由http服务器读取（nginx或node），\n##### node\n```js\n'use strict';\n\nvar https = require('https');\nvar server = https.createServer({\n  key: require('fs').readFileSync('./privkey.pem')\n, cert: require('fs').readFileSync('./fullchain.pem')\n}, function (req, res) {\n  res.end(\"Hello, World!\");\n}).listen(443, function () {\n  console.log('Listening on', this.address());\n})\n```\n##### nginx\n先监听80再监听443端口重定向，读取pem\n```sh\nlisten              443 ssl;\nserver_name         www.example.com;\nssl_certificate     www.example.com.crt;\nssl_certificate_key www.example.com.key;\nssl_protocols       TLSv1 TLSv1.1 TLSv1.2;\nssl_ciphers         HIGH:!aNULL:!MD5;\n```\n## ssl\n### prove control of the domain\n- Provisioning a DNS record under domain\n- Provisioning an HTTP resource under a well-known URI on domain\n\n不管是申请还是续期，只要是通配符证书，只能采用 dns-01 的方式校验申请者的域名，也就是说 certbot 操作者必须手动添加 DNS TXT 记录。\n### CA (Certificate Authority)\n#### 付费\n#### 免费\n##### Let’s Encrypt\n\n### 证书签发工具\n#### 第三方平台\n阿里云、腾讯云等机构提供证书申请服务,申请好后自行下载，依然在调取CA的接口\n#### ACME Client (Automatic Certificate Management Environment)\n客户端可能会检测服务器内已部署的虚拟主机配置以便下载到相应位置。\n- 实现不需要ssh登录到服务器内部配置，随机生成域名前缀或者根据上传的项目名称参数而触发申请证书、配置nginx和重启流程。\n- 泛域名解析后，nginx先进行分配？直接解析至某个应用服务器下，再由应用服务器进行反向代理\n\n申请免费证书再下载到服务器上，也可以直接使用cert工具完成申请和下发，可以对目前的所有域名直接使用一套密钥，但一旦新增就需要再次执行添加，修改nginx配置。\n##### certbot \n>If you want to obtain a wildcard certificate using Let's Encrypt's new ACMEv2 server, you'll also need to use one of Certbot's DNS plugins. \n官方没有阿里云的插件,\n- [第三方](https://github.com/ywdblog/certbot-letencrypt-wildcardcertificates-alydns-au)\n- 手动，不能自动更新DNS\nAvailable [install_certbot.sh](https://github.com/MakerGYT/ubuntu-sh/blob/master/install_certbot.sh)\n##### acme.sh\n{% note danger %}\nInvalid response from https://test.makergyt.com/.well-known/acme-challenge/ajDvnOpG0Gv-iHDyYlaVcBrej3-ONLsJu43bIaJYWns\n{% endnote %}\n### 证书内容\n#### pem\n#### crt & key\ncrt公钥\n\n## 多进程管理\n### PM2 启动\n```sh\npm2 start apps.json\n# apps.json\n{\n  \"apps\":[\n  {\n    \"name\":\"app1\",\n    \"cwd\":\"/project/app1/\",\n    \"max_memory_restart\":\"1024M\",\n    \"log_date_format\":\"YYYY-MM-DD HH:mm:ss SSS\",\n    \"script\":\"/project/app1.js\",\n    \"env\":{\n        \"http_proxy\":\"http://10.12.xxx.xxx:xxxx\"\n    }\n  },]\n}\n```\n## 动态域名\n### 域名生成\n### 域名解析\n\n为固定域名添加泛解析，将所有动态的域名请求都发到同一个服务上，再分发\n# 自动化构建\n## cloud studio(半自动化预览)\n## heroku\n## now.sh\n由本地提交触发（now.json,或cli）后构建\n## circleci\n可以直接拉取构建\n# Reference\n[1] UYOU.Nginx反向代理：实现node.js多虚拟主机.https://www.imooc.com/article/34904 [EB/OL] 2018\n[2] fairysoftware.基于nodejs实现一台服务器多个https域名（多个SSL证书、nodejs ssl 多域名.http://www.fairysoftware.com/nodejs_ssl_https.html [EB/OL] 2018\n[3] 阮一峰.持续集成服务 Travis CI 教程.http://www.ruanyifeng.com/blog/2017/12/travis_ci_tutorial.html [EB/OL] 2017\n[4] huzhuolei.通过 Certbot 申请泛域名 HTTPS 证书及配置自动更新.https://www.jianshu.com/p/034b891cf395 [EB/OL] 2019\n[5] ISRG.Let's Encrypt Documentation.https://letsencrypt.org/docs/ [EB/OL] \n[6] 飞奔的萝卜.申请Let's Encrypt通配符HTTPS证书.https://my.oschina.net/kimver/blog/1634575 [EB/OL] 2018\n[7] Igor Sysoev.Configuring HTTPS servers.http://nginx.org/en/docs/http/configuring_https_servers.html [EB/OL]","slug":"持续集成","published":0,"updated":"2019-07-17T08:44:45.601Z","_id":"cjy70294100001njxinfobnzv","comments":1,"layout":"post","photos":[],"link":"","content":"<link rel=\"stylesheet\" class=\"aplayer-secondary-style-marker\" href=\"/assets/css/APlayer.min.css\"><script src=\"/assets/js/APlayer.min.js\" class=\"aplayer-secondary-script-marker\"></script><script class=\"meting-secondary-script-marker\" src=\"/assets/js/Meting.min.js\"></script><link rel=\"stylesheet\" type=\"text/css\" href=\"https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css\"><p>同一服务器，同时启动多个node应用（pm2），应用使用不同的port(nginx),对应配置多个二级域名(路由控制)并支持https(脚本)<br>最终实现与now类似的功能，提交github某个仓库同步触发更新server内对应路径项目覆盖更新，脱敏，对于新的仓库识别后克隆新建,并配置虚拟主机和三级域名</p>\n<h1 id=\"持续集成\"><a href=\"#持续集成\" class=\"headerlink\" title=\"持续集成\"></a>持续集成</h1><h2 id=\"travis-CI\"><a href=\"#travis-CI\" class=\"headerlink\" title=\"travis-CI\"></a>travis-CI</h2><p>需求点在于，想要在短期内看到代码构建及运行在一定环境下的结果，进行初步的测试，部分功能服务必须上线到外网环境才能进行后续开发，这样不是等到最终完成开发采取组织代码合并。这样的测试必然是持续性的，覆盖性的，对于持续集成理论和典型产品travis-CI之前有过听说但一直没有硬性需求，现在看来确实有必要用了。<br>那么要实现这样的需求，至少需要支持版本管理，监听提交便拉取克隆，分配干净的运行环境，按需安装软件依赖，执行启动脚本，以及测试和日志。自动化部署则是在测试之后。</p>\n<h3 id=\"起步\"><a href=\"#起步\" class=\"headerlink\" title=\"起步\"></a>起步</h3><p>首先看到了大部分指向的<a href=\"https://travis-ci.org，\" target=\"_blank\" rel=\"noopener\">https://travis-ci.org，</a> 然后进行了一些操作后，进入文档，当从文档中链接进入操作界面时，被引导至主页，关键是提示没有登录，于是重新登录，进入dashboard后，发现，什么都没了，抬头看一眼网址，发现不对，后缀变成了com,对比发现两个网站<a href=\"https://travis-ci.org，https://travis-ci.com\" target=\"_blank\" rel=\"noopener\">https://travis-ci.org，https://travis-ci.com</a>, 一模一样（上当受骗的感觉），但是数据不共享，前者部分链接会引导到后者，如最重要的文档。</p>\n<ul>\n<li><a href=\"https://travis-ci.org\" target=\"_blank\" rel=\"noopener\">https://travis-ci.org</a></li>\n</ul>\n<img src=\"https://blog-cdn.makergyt.com/static/images/travis-ci.org.png\">\n<p>绑定github账户，可以访问账户下信息，是一种Authorized GitHub Apps，需要分别激活项目，然后监测该仓库的代码提交，自动抓取下来，可以提供一个运行环境，进行测试和构建，与now-cli提供的类似<br><img src=\"https://blog-cdn.makergyt.com/static/images/travis-ci.org.respositories.png\"></p>\n<ul>\n<li><a href=\"https://travis-ci.com\" target=\"_blank\" rel=\"noopener\">https://travis-ci.com</a></li>\n</ul>\n<img src=\"https://blog-cdn.makergyt.com/static/images/travis-ci.com.png\">\n<img src=\"https://blog-cdn.makergyt.com/static/images/travis-ci.com.respositories.png\">\n<p>然后进入文档<a href=\"https://docs.travis-ci.com/user/migrate/legacy-services-to-github-apps-migration-guide/\" target=\"_blank\" rel=\"noopener\">legacy-services-to-github-apps-migration-guide</a>,看到<br><div class=\"note info\">\n            <p>As of May 2, 2018 we are moving toward having repositories integrated via a GitHub App instead of GitHub Services which will no longer be supported by GitHub as of January 31st, 2019.While this process is ongoing, we have been migrating from GitHub services to webhooks on the <a href=\"https://travis-ci.org\" target=\"_blank\" rel=\"noopener\">https://travis-ci.org</a> enabled repositories. The closure of GitHub services will not affect your repositories even if you are currently on .org.</p>\n          </div></p>\n<p>这就促使去了解GitHub Apps和Services的区别，以及为什么会抛弃后者。当然还有一种重要的(自定义的)集成方式webhooks.在github上，</p>\n<ol>\n<li>Installed GitHub Apps<br>GitHub Apps augment and extend your workflows on GitHub with commercial, open source, and homegrown tools.</li>\n<li>Services<br>Services are pre-built integrations that perform certain actions when events occur on GitHub.<div class=\"note danger\">\n            <p>Note: GitHub Services have been deprecated. Please contact your integrator for more information on how to migrate or replace a service with webhooks or GitHub Apps.</p>\n          </div>\n这样事情就大致明了了，<del>目前网络上相关的介绍还是基于旧的（org）为了逐步提高认知，还是使用原先的这种方式。</del>。文档推荐（以及内部链接）是使用com，工具而已，暂时直接体验新模式。</li>\n<li>webhooks<br>Webhooks allow external services to be notified when certain events happen. When the specified events happen, we’ll send a POST request to each of the URLs you provide. Learn more in our Webhooks Guide.<br>代码提交触发对服务端的请求，所以服务端要有一个接收请求的脚本，接收到后再执行本地脚本进行版本更新<h3 id=\"使用\"><a href=\"#使用\" class=\"headerlink\" title=\"使用\"></a>使用</h3><h4 id=\"初始化\"><a href=\"#初始化\" class=\"headerlink\" title=\"初始化\"></a>初始化</h4></li>\n</ol>\n<h5 id=\"config\"><a href=\"#config\" class=\"headerlink\" title=\"config\"></a>config</h5><h4 id=\"生命周期\"><a href=\"#生命周期\" class=\"headerlink\" title=\"生命周期\"></a>生命周期</h4><h1 id=\"自动化部署\"><a href=\"#自动化部署\" class=\"headerlink\" title=\"自动化部署\"></a>自动化部署</h1><h2 id=\"webhooks\"><a href=\"#webhooks\" class=\"headerlink\" title=\"webhooks\"></a>webhooks</h2><p>只做一个服务，接受提交的仓库参数后针对性<br>或者在每个仓库的Payload URL直接带上参数,<br>只能在仓库中分别添加，<del>这样其实不需要参数</del></p>\n<h3 id=\"error\"><a href=\"#error\" class=\"headerlink\" title=\"error\"></a>error</h3><p>传入event.payload.repository.name卡死</p>\n<h3 id=\"重启应用\"><a href=\"#重启应用\" class=\"headerlink\" title=\"重启应用\"></a>重启应用</h3><ul>\n<li>先查找端口号关闭进程，更新文件后再启动</li>\n<li>后台运行，无法看到运行</li>\n<li>修改文件自动重启</li>\n</ul>\n<div class=\"note danger\">\n            <p>Fatal error: ENOSPC: System limit for number of file watchers reached</p>\n          </div>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">echo</span> fs.inotify.max_user_watches=524288 | sudo tee -a /etc/sysctl.conf &amp;&amp; sudo sysctl -p </span><br><span class=\"line\">sudo sysctl --system</span><br></pre></td></tr></table></figure>\n<p>获取提交的时间</p>\n<ul>\n<li>记录在仓库内某个文件 =&gt;开始提交的本地时间<br>每次提交时脚本写到文件里？去了被取出来，是否可以直接读git log</li>\n<li>github post的消息 =&gt;提交成功的时间<br>可以传入将来执行的脚本参数，但如何传入node服务<br>使用script后，参数无法正常传入，–name无法进入node内部argparse的参数，被视为外部run 的参数，不使用name声明就必填，这样不便于本地调试。加上环境变量？，本地直接node命令,由于使用了nodemon,需要全局安装才能识别，故采用文件记录的方式</li>\n<li>在服务端执行脚本时记录在某个文件里 =&gt;重启服务的服务端时间<br>已经产生延迟<h1 id=\"多端口多域名服务器\"><a href=\"#多端口多域名服务器\" class=\"headerlink\" title=\"多端口多域名服务器\"></a>多端口多域名服务器</h1>多个应用使用虚拟主机隔离，将不同的应用目录和访问url绑定，这样配置不同的url,经过域名解析（都还是解析到这一服务器IP）,进入nginx默认配置，监听80端口，负责调度到不同的配置文件下(遍历sites-enabled下的文件server-name？)，同时监听443端口和80端口,80端口做了301重定向后，会以https重新请求进入https的服务器配置，以进入到对应的路径下，获取到证书后返回给浏览器验证，再执行应用内的路由管理。<br>在node上，多个应用一般使用端口隔离，使用nginx反向代理到不同的端口 <h2 id=\"域名解析\"><a href=\"#域名解析\" class=\"headerlink\" title=\"域名解析\"></a>域名解析</h2>生成一条新子域名可以添加一条DNS记录，在这里所有的子域名都指向同一IP,故添加泛域名解析至该IP即可<h2 id=\"反向代理\"><a href=\"#反向代理\" class=\"headerlink\" title=\"反向代理\"></a>反向代理</h2><h3 id=\"node服务器\"><a href=\"#node服务器\" class=\"headerlink\" title=\"node服务器\"></a>node服务器</h3><a href=\"http://github.com/nodejitsu/node-http-proxy\" target=\"_blank\" rel=\"noopener\">node-http-proxy</a><br><a href=\"https://github.com/skx/node-reverse-proxy.js\" target=\"_blank\" rel=\"noopener\">node-reverse-proxy.js</a><h3 id=\"nginx\"><a href=\"#nginx\" class=\"headerlink\" title=\"nginx\"></a>nginx</h3>在虚拟主机中，二级域名的请求是由nginx完成的,<h4 id=\"安装nginx\"><a href=\"#安装nginx\" class=\"headerlink\" title=\"安装nginx\"></a>安装nginx</h4>见<a href=\"https://blog.makergyt.com/en/LNMP/\">LNMP</a><h4 id=\"配置虚拟主机\"><a href=\"#配置虚拟主机\" class=\"headerlink\" title=\"配置虚拟主机\"></a>配置虚拟主机</h4><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># etc/nginx/conf.d/test.conf</span></span><br><span class=\"line\">upstream originalhost &#123;</span><br><span class=\"line\">  server 127.0.0.1:8080; </span><br><span class=\"line\">  keepalive 64;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">server &#123;</span><br><span class=\"line\">    listen 80;</span><br><span class=\"line\">    server_name goods.test.makergyt.com;</span><br><span class=\"line\">    access_log /var/<span class=\"built_in\">log</span>/nginx/goods.log;</span><br><span class=\"line\">    location / &#123;</span><br><span class=\"line\">        proxy_set_header X-Real-IP <span class=\"variable\">$remote_addr</span>;</span><br><span class=\"line\">        proxy_set_header X-Forwarded-For <span class=\"variable\">$proxy_add_x_forwarded_for</span>;</span><br><span class=\"line\">        proxy_set_header Host  <span class=\"variable\">$http_host</span>;</span><br><span class=\"line\">        proxy_set_header X-Nginx-Proxy <span class=\"literal\">true</span>;</span><br><span class=\"line\">        proxy_set_header Connection <span class=\"string\">\"\"</span>;</span><br><span class=\"line\">        proxy_pass      http://originalhost;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<h4 id=\"https\"><a href=\"#https\" class=\"headerlink\" title=\"https\"></a>https</h4><p>如果URL前为https,浏览器向服务器端口443，服务器下发ssl_certificate,证书文件由http服务器读取（nginx或node），</p>\n<h5 id=\"node\"><a href=\"#node\" class=\"headerlink\" title=\"node\"></a>node</h5><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">'use strict'</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">var</span> https = <span class=\"built_in\">require</span>(<span class=\"string\">'https'</span>);</span><br><span class=\"line\"><span class=\"keyword\">var</span> server = https.createServer(&#123;</span><br><span class=\"line\">  key: <span class=\"built_in\">require</span>(<span class=\"string\">'fs'</span>).readFileSync(<span class=\"string\">'./privkey.pem'</span>)</span><br><span class=\"line\">, <span class=\"attr\">cert</span>: <span class=\"built_in\">require</span>(<span class=\"string\">'fs'</span>).readFileSync(<span class=\"string\">'./fullchain.pem'</span>)</span><br><span class=\"line\">&#125;, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">req, res</span>) </span>&#123;</span><br><span class=\"line\">  res.end(<span class=\"string\">\"Hello, World!\"</span>);</span><br><span class=\"line\">&#125;).listen(<span class=\"number\">443</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">  <span class=\"built_in\">console</span>.log(<span class=\"string\">'Listening on'</span>, <span class=\"keyword\">this</span>.address());</span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure>\n<h5 id=\"nginx-1\"><a href=\"#nginx-1\" class=\"headerlink\" title=\"nginx\"></a>nginx</h5><p>先监听80再监听443端口重定向，读取pem<br><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">listen              443 ssl;</span><br><span class=\"line\">server_name         www.example.com;</span><br><span class=\"line\">ssl_certificate     www.example.com.crt;</span><br><span class=\"line\">ssl_certificate_key www.example.com.key;</span><br><span class=\"line\">ssl_protocols       TLSv1 TLSv1.1 TLSv1.2;</span><br><span class=\"line\">ssl_ciphers         HIGH:!aNULL:!MD5;</span><br></pre></td></tr></table></figure></p>\n<h2 id=\"ssl\"><a href=\"#ssl\" class=\"headerlink\" title=\"ssl\"></a>ssl</h2><h3 id=\"prove-control-of-the-domain\"><a href=\"#prove-control-of-the-domain\" class=\"headerlink\" title=\"prove control of the domain\"></a>prove control of the domain</h3><ul>\n<li>Provisioning a DNS record under domain</li>\n<li>Provisioning an HTTP resource under a well-known URI on domain</li>\n</ul>\n<p>不管是申请还是续期，只要是通配符证书，只能采用 dns-01 的方式校验申请者的域名，也就是说 certbot 操作者必须手动添加 DNS TXT 记录。</p>\n<h3 id=\"CA-Certificate-Authority\"><a href=\"#CA-Certificate-Authority\" class=\"headerlink\" title=\"CA (Certificate Authority)\"></a>CA (Certificate Authority)</h3><h4 id=\"付费\"><a href=\"#付费\" class=\"headerlink\" title=\"付费\"></a>付费</h4><h4 id=\"免费\"><a href=\"#免费\" class=\"headerlink\" title=\"免费\"></a>免费</h4><h5 id=\"Let’s-Encrypt\"><a href=\"#Let’s-Encrypt\" class=\"headerlink\" title=\"Let’s Encrypt\"></a>Let’s Encrypt</h5><h3 id=\"证书签发工具\"><a href=\"#证书签发工具\" class=\"headerlink\" title=\"证书签发工具\"></a>证书签发工具</h3><h4 id=\"第三方平台\"><a href=\"#第三方平台\" class=\"headerlink\" title=\"第三方平台\"></a>第三方平台</h4><p>阿里云、腾讯云等机构提供证书申请服务,申请好后自行下载，依然在调取CA的接口</p>\n<h4 id=\"ACME-Client-Automatic-Certificate-Management-Environment\"><a href=\"#ACME-Client-Automatic-Certificate-Management-Environment\" class=\"headerlink\" title=\"ACME Client (Automatic Certificate Management Environment)\"></a>ACME Client (Automatic Certificate Management Environment)</h4><p>客户端可能会检测服务器内已部署的虚拟主机配置以便下载到相应位置。</p>\n<ul>\n<li>实现不需要ssh登录到服务器内部配置，随机生成域名前缀或者根据上传的项目名称参数而触发申请证书、配置nginx和重启流程。</li>\n<li>泛域名解析后，nginx先进行分配？直接解析至某个应用服务器下，再由应用服务器进行反向代理</li>\n</ul>\n<p>申请免费证书再下载到服务器上，也可以直接使用cert工具完成申请和下发，可以对目前的所有域名直接使用一套密钥，但一旦新增就需要再次执行添加，修改nginx配置。</p>\n<h5 id=\"certbot\"><a href=\"#certbot\" class=\"headerlink\" title=\"certbot\"></a>certbot</h5><blockquote>\n<p>If you want to obtain a wildcard certificate using Let’s Encrypt’s new ACMEv2 server, you’ll also need to use one of Certbot’s DNS plugins.<br>官方没有阿里云的插件,</p>\n<ul>\n<li><a href=\"https://github.com/ywdblog/certbot-letencrypt-wildcardcertificates-alydns-au\" target=\"_blank\" rel=\"noopener\">第三方</a></li>\n<li>手动，不能自动更新DNS<br>Available <a href=\"https://github.com/MakerGYT/ubuntu-sh/blob/master/install_certbot.sh\" target=\"_blank\" rel=\"noopener\">install_certbot.sh</a></li>\n</ul>\n</blockquote>\n<h5 id=\"acme-sh\"><a href=\"#acme-sh\" class=\"headerlink\" title=\"acme.sh\"></a>acme.sh</h5><div class=\"note danger\">\n            <p>Invalid response from <a href=\"https://test.makergyt.com/.well-known/acme-challenge/ajDvnOpG0Gv-iHDyYlaVcBrej3-ONLsJu43bIaJYWns\" target=\"_blank\" rel=\"noopener\">https://test.makergyt.com/.well-known/acme-challenge/ajDvnOpG0Gv-iHDyYlaVcBrej3-ONLsJu43bIaJYWns</a></p>\n          </div>\n<h3 id=\"证书内容\"><a href=\"#证书内容\" class=\"headerlink\" title=\"证书内容\"></a>证书内容</h3><h4 id=\"pem\"><a href=\"#pem\" class=\"headerlink\" title=\"pem\"></a>pem</h4><h4 id=\"crt-amp-key\"><a href=\"#crt-amp-key\" class=\"headerlink\" title=\"crt &amp; key\"></a>crt &amp; key</h4><p>crt公钥</p>\n<h2 id=\"多进程管理\"><a href=\"#多进程管理\" class=\"headerlink\" title=\"多进程管理\"></a>多进程管理</h2><h3 id=\"PM2-启动\"><a href=\"#PM2-启动\" class=\"headerlink\" title=\"PM2 启动\"></a>PM2 启动</h3><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pm2 start apps.json</span><br><span class=\"line\"><span class=\"comment\"># apps.json</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"string\">\"apps\"</span>:[</span><br><span class=\"line\">  &#123;</span><br><span class=\"line\">    <span class=\"string\">\"name\"</span>:<span class=\"string\">\"app1\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"cwd\"</span>:<span class=\"string\">\"/project/app1/\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"max_memory_restart\"</span>:<span class=\"string\">\"1024M\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"log_date_format\"</span>:<span class=\"string\">\"YYYY-MM-DD HH:mm:ss SSS\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"script\"</span>:<span class=\"string\">\"/project/app1.js\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"env\"</span>:&#123;</span><br><span class=\"line\">        <span class=\"string\">\"http_proxy\"</span>:<span class=\"string\">\"http://10.12.xxx.xxx:xxxx\"</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;,]</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h2 id=\"动态域名\"><a href=\"#动态域名\" class=\"headerlink\" title=\"动态域名\"></a>动态域名</h2><h3 id=\"域名生成\"><a href=\"#域名生成\" class=\"headerlink\" title=\"域名生成\"></a>域名生成</h3><h3 id=\"域名解析-1\"><a href=\"#域名解析-1\" class=\"headerlink\" title=\"域名解析\"></a>域名解析</h3><p>为固定域名添加泛解析，将所有动态的域名请求都发到同一个服务上，再分发</p>\n<h1 id=\"自动化构建\"><a href=\"#自动化构建\" class=\"headerlink\" title=\"自动化构建\"></a>自动化构建</h1><h2 id=\"cloud-studio-半自动化预览\"><a href=\"#cloud-studio-半自动化预览\" class=\"headerlink\" title=\"cloud studio(半自动化预览)\"></a>cloud studio(半自动化预览)</h2><h2 id=\"heroku\"><a href=\"#heroku\" class=\"headerlink\" title=\"heroku\"></a>heroku</h2><h2 id=\"now-sh\"><a href=\"#now-sh\" class=\"headerlink\" title=\"now.sh\"></a>now.sh</h2><p>由本地提交触发（now.json,或cli）后构建</p>\n<h2 id=\"circleci\"><a href=\"#circleci\" class=\"headerlink\" title=\"circleci\"></a>circleci</h2><p>可以直接拉取构建</p>\n<h1 id=\"Reference\"><a href=\"#Reference\" class=\"headerlink\" title=\"Reference\"></a>Reference</h1><p>[1] UYOU.Nginx反向代理：实现node.js多虚拟主机.<a href=\"https://www.imooc.com/article/34904\" target=\"_blank\" rel=\"noopener\">https://www.imooc.com/article/34904</a> [EB/OL] 2018<br>[2] fairysoftware.基于nodejs实现一台服务器多个https域名（多个SSL证书、nodejs ssl 多域名.<a href=\"http://www.fairysoftware.com/nodejs_ssl_https.html\" target=\"_blank\" rel=\"noopener\">http://www.fairysoftware.com/nodejs_ssl_https.html</a> [EB/OL] 2018<br>[3] 阮一峰.持续集成服务 Travis CI 教程.<a href=\"http://www.ruanyifeng.com/blog/2017/12/travis_ci_tutorial.html\" target=\"_blank\" rel=\"noopener\">http://www.ruanyifeng.com/blog/2017/12/travis_ci_tutorial.html</a> [EB/OL] 2017<br>[4] huzhuolei.通过 Certbot 申请泛域名 HTTPS 证书及配置自动更新.<a href=\"https://www.jianshu.com/p/034b891cf395\" target=\"_blank\" rel=\"noopener\">https://www.jianshu.com/p/034b891cf395</a> [EB/OL] 2019<br>[5] ISRG.Let’s Encrypt Documentation.<a href=\"https://letsencrypt.org/docs/\" target=\"_blank\" rel=\"noopener\">https://letsencrypt.org/docs/</a> [EB/OL]<br>[6] 飞奔的萝卜.申请Let’s Encrypt通配符HTTPS证书.<a href=\"https://my.oschina.net/kimver/blog/1634575\" target=\"_blank\" rel=\"noopener\">https://my.oschina.net/kimver/blog/1634575</a> [EB/OL] 2018<br>[7] Igor Sysoev.Configuring HTTPS servers.<a href=\"http://nginx.org/en/docs/http/configuring_https_servers.html\" target=\"_blank\" rel=\"noopener\">http://nginx.org/en/docs/http/configuring_https_servers.html</a> [EB/OL]</p>\n","site":{"data":{}},"excerpt":"","more":"<p>同一服务器，同时启动多个node应用（pm2），应用使用不同的port(nginx),对应配置多个二级域名(路由控制)并支持https(脚本)<br>最终实现与now类似的功能，提交github某个仓库同步触发更新server内对应路径项目覆盖更新，脱敏，对于新的仓库识别后克隆新建,并配置虚拟主机和三级域名</p>\n<h1 id=\"持续集成\"><a href=\"#持续集成\" class=\"headerlink\" title=\"持续集成\"></a>持续集成</h1><h2 id=\"travis-CI\"><a href=\"#travis-CI\" class=\"headerlink\" title=\"travis-CI\"></a>travis-CI</h2><p>需求点在于，想要在短期内看到代码构建及运行在一定环境下的结果，进行初步的测试，部分功能服务必须上线到外网环境才能进行后续开发，这样不是等到最终完成开发采取组织代码合并。这样的测试必然是持续性的，覆盖性的，对于持续集成理论和典型产品travis-CI之前有过听说但一直没有硬性需求，现在看来确实有必要用了。<br>那么要实现这样的需求，至少需要支持版本管理，监听提交便拉取克隆，分配干净的运行环境，按需安装软件依赖，执行启动脚本，以及测试和日志。自动化部署则是在测试之后。</p>\n<h3 id=\"起步\"><a href=\"#起步\" class=\"headerlink\" title=\"起步\"></a>起步</h3><p>首先看到了大部分指向的<a href=\"https://travis-ci.org，\" target=\"_blank\" rel=\"noopener\">https://travis-ci.org，</a> 然后进行了一些操作后，进入文档，当从文档中链接进入操作界面时，被引导至主页，关键是提示没有登录，于是重新登录，进入dashboard后，发现，什么都没了，抬头看一眼网址，发现不对，后缀变成了com,对比发现两个网站<a href=\"https://travis-ci.org，https://travis-ci.com\" target=\"_blank\" rel=\"noopener\">https://travis-ci.org，https://travis-ci.com</a>, 一模一样（上当受骗的感觉），但是数据不共享，前者部分链接会引导到后者，如最重要的文档。</p>\n<ul>\n<li><a href=\"https://travis-ci.org\" target=\"_blank\" rel=\"noopener\">https://travis-ci.org</a></li>\n</ul>\n<img src=\"https://blog-cdn.makergyt.com/static/images/travis-ci.org.png\">\n<p>绑定github账户，可以访问账户下信息，是一种Authorized GitHub Apps，需要分别激活项目，然后监测该仓库的代码提交，自动抓取下来，可以提供一个运行环境，进行测试和构建，与now-cli提供的类似<br><img src=\"https://blog-cdn.makergyt.com/static/images/travis-ci.org.respositories.png\"></p>\n<ul>\n<li><a href=\"https://travis-ci.com\" target=\"_blank\" rel=\"noopener\">https://travis-ci.com</a></li>\n</ul>\n<img src=\"https://blog-cdn.makergyt.com/static/images/travis-ci.com.png\">\n<img src=\"https://blog-cdn.makergyt.com/static/images/travis-ci.com.respositories.png\">\n<p>然后进入文档<a href=\"https://docs.travis-ci.com/user/migrate/legacy-services-to-github-apps-migration-guide/\" target=\"_blank\" rel=\"noopener\">legacy-services-to-github-apps-migration-guide</a>,看到<br><div class=\"note info\">\n            <p>As of May 2, 2018 we are moving toward having repositories integrated via a GitHub App instead of GitHub Services which will no longer be supported by GitHub as of January 31st, 2019.While this process is ongoing, we have been migrating from GitHub services to webhooks on the <a href=\"https://travis-ci.org\" target=\"_blank\" rel=\"noopener\">https://travis-ci.org</a> enabled repositories. The closure of GitHub services will not affect your repositories even if you are currently on .org.</p>\n          </div></p>\n<p>这就促使去了解GitHub Apps和Services的区别，以及为什么会抛弃后者。当然还有一种重要的(自定义的)集成方式webhooks.在github上，</p>\n<ol>\n<li>Installed GitHub Apps<br>GitHub Apps augment and extend your workflows on GitHub with commercial, open source, and homegrown tools.</li>\n<li>Services<br>Services are pre-built integrations that perform certain actions when events occur on GitHub.<div class=\"note danger\">\n            <p>Note: GitHub Services have been deprecated. Please contact your integrator for more information on how to migrate or replace a service with webhooks or GitHub Apps.</p>\n          </div>\n这样事情就大致明了了，<del>目前网络上相关的介绍还是基于旧的（org）为了逐步提高认知，还是使用原先的这种方式。</del>。文档推荐（以及内部链接）是使用com，工具而已，暂时直接体验新模式。</li>\n<li>webhooks<br>Webhooks allow external services to be notified when certain events happen. When the specified events happen, we’ll send a POST request to each of the URLs you provide. Learn more in our Webhooks Guide.<br>代码提交触发对服务端的请求，所以服务端要有一个接收请求的脚本，接收到后再执行本地脚本进行版本更新<h3 id=\"使用\"><a href=\"#使用\" class=\"headerlink\" title=\"使用\"></a>使用</h3><h4 id=\"初始化\"><a href=\"#初始化\" class=\"headerlink\" title=\"初始化\"></a>初始化</h4></li>\n</ol>\n<h5 id=\"config\"><a href=\"#config\" class=\"headerlink\" title=\"config\"></a>config</h5><h4 id=\"生命周期\"><a href=\"#生命周期\" class=\"headerlink\" title=\"生命周期\"></a>生命周期</h4><h1 id=\"自动化部署\"><a href=\"#自动化部署\" class=\"headerlink\" title=\"自动化部署\"></a>自动化部署</h1><h2 id=\"webhooks\"><a href=\"#webhooks\" class=\"headerlink\" title=\"webhooks\"></a>webhooks</h2><p>只做一个服务，接受提交的仓库参数后针对性<br>或者在每个仓库的Payload URL直接带上参数,<br>只能在仓库中分别添加，<del>这样其实不需要参数</del></p>\n<h3 id=\"error\"><a href=\"#error\" class=\"headerlink\" title=\"error\"></a>error</h3><p>传入event.payload.repository.name卡死</p>\n<h3 id=\"重启应用\"><a href=\"#重启应用\" class=\"headerlink\" title=\"重启应用\"></a>重启应用</h3><ul>\n<li>先查找端口号关闭进程，更新文件后再启动</li>\n<li>后台运行，无法看到运行</li>\n<li>修改文件自动重启</li>\n</ul>\n<div class=\"note danger\">\n            <p>Fatal error: ENOSPC: System limit for number of file watchers reached</p>\n          </div>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">echo</span> fs.inotify.max_user_watches=524288 | sudo tee -a /etc/sysctl.conf &amp;&amp; sudo sysctl -p </span><br><span class=\"line\">sudo sysctl --system</span><br></pre></td></tr></table></figure>\n<p>获取提交的时间</p>\n<ul>\n<li>记录在仓库内某个文件 =&gt;开始提交的本地时间<br>每次提交时脚本写到文件里？去了被取出来，是否可以直接读git log</li>\n<li>github post的消息 =&gt;提交成功的时间<br>可以传入将来执行的脚本参数，但如何传入node服务<br>使用script后，参数无法正常传入，–name无法进入node内部argparse的参数，被视为外部run 的参数，不使用name声明就必填，这样不便于本地调试。加上环境变量？，本地直接node命令,由于使用了nodemon,需要全局安装才能识别，故采用文件记录的方式</li>\n<li>在服务端执行脚本时记录在某个文件里 =&gt;重启服务的服务端时间<br>已经产生延迟<h1 id=\"多端口多域名服务器\"><a href=\"#多端口多域名服务器\" class=\"headerlink\" title=\"多端口多域名服务器\"></a>多端口多域名服务器</h1>多个应用使用虚拟主机隔离，将不同的应用目录和访问url绑定，这样配置不同的url,经过域名解析（都还是解析到这一服务器IP）,进入nginx默认配置，监听80端口，负责调度到不同的配置文件下(遍历sites-enabled下的文件server-name？)，同时监听443端口和80端口,80端口做了301重定向后，会以https重新请求进入https的服务器配置，以进入到对应的路径下，获取到证书后返回给浏览器验证，再执行应用内的路由管理。<br>在node上，多个应用一般使用端口隔离，使用nginx反向代理到不同的端口 <h2 id=\"域名解析\"><a href=\"#域名解析\" class=\"headerlink\" title=\"域名解析\"></a>域名解析</h2>生成一条新子域名可以添加一条DNS记录，在这里所有的子域名都指向同一IP,故添加泛域名解析至该IP即可<h2 id=\"反向代理\"><a href=\"#反向代理\" class=\"headerlink\" title=\"反向代理\"></a>反向代理</h2><h3 id=\"node服务器\"><a href=\"#node服务器\" class=\"headerlink\" title=\"node服务器\"></a>node服务器</h3><a href=\"http://github.com/nodejitsu/node-http-proxy\" target=\"_blank\" rel=\"noopener\">node-http-proxy</a><br><a href=\"https://github.com/skx/node-reverse-proxy.js\" target=\"_blank\" rel=\"noopener\">node-reverse-proxy.js</a><h3 id=\"nginx\"><a href=\"#nginx\" class=\"headerlink\" title=\"nginx\"></a>nginx</h3>在虚拟主机中，二级域名的请求是由nginx完成的,<h4 id=\"安装nginx\"><a href=\"#安装nginx\" class=\"headerlink\" title=\"安装nginx\"></a>安装nginx</h4>见<a href=\"https://blog.makergyt.com/en/LNMP/\">LNMP</a><h4 id=\"配置虚拟主机\"><a href=\"#配置虚拟主机\" class=\"headerlink\" title=\"配置虚拟主机\"></a>配置虚拟主机</h4><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># etc/nginx/conf.d/test.conf</span></span><br><span class=\"line\">upstream originalhost &#123;</span><br><span class=\"line\">  server 127.0.0.1:8080; </span><br><span class=\"line\">  keepalive 64;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">server &#123;</span><br><span class=\"line\">    listen 80;</span><br><span class=\"line\">    server_name goods.test.makergyt.com;</span><br><span class=\"line\">    access_log /var/<span class=\"built_in\">log</span>/nginx/goods.log;</span><br><span class=\"line\">    location / &#123;</span><br><span class=\"line\">        proxy_set_header X-Real-IP <span class=\"variable\">$remote_addr</span>;</span><br><span class=\"line\">        proxy_set_header X-Forwarded-For <span class=\"variable\">$proxy_add_x_forwarded_for</span>;</span><br><span class=\"line\">        proxy_set_header Host  <span class=\"variable\">$http_host</span>;</span><br><span class=\"line\">        proxy_set_header X-Nginx-Proxy <span class=\"literal\">true</span>;</span><br><span class=\"line\">        proxy_set_header Connection <span class=\"string\">\"\"</span>;</span><br><span class=\"line\">        proxy_pass      http://originalhost;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<h4 id=\"https\"><a href=\"#https\" class=\"headerlink\" title=\"https\"></a>https</h4><p>如果URL前为https,浏览器向服务器端口443，服务器下发ssl_certificate,证书文件由http服务器读取（nginx或node），</p>\n<h5 id=\"node\"><a href=\"#node\" class=\"headerlink\" title=\"node\"></a>node</h5><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">'use strict'</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">var</span> https = <span class=\"built_in\">require</span>(<span class=\"string\">'https'</span>);</span><br><span class=\"line\"><span class=\"keyword\">var</span> server = https.createServer(&#123;</span><br><span class=\"line\">  key: <span class=\"built_in\">require</span>(<span class=\"string\">'fs'</span>).readFileSync(<span class=\"string\">'./privkey.pem'</span>)</span><br><span class=\"line\">, <span class=\"attr\">cert</span>: <span class=\"built_in\">require</span>(<span class=\"string\">'fs'</span>).readFileSync(<span class=\"string\">'./fullchain.pem'</span>)</span><br><span class=\"line\">&#125;, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">req, res</span>) </span>&#123;</span><br><span class=\"line\">  res.end(<span class=\"string\">\"Hello, World!\"</span>);</span><br><span class=\"line\">&#125;).listen(<span class=\"number\">443</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">  <span class=\"built_in\">console</span>.log(<span class=\"string\">'Listening on'</span>, <span class=\"keyword\">this</span>.address());</span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure>\n<h5 id=\"nginx-1\"><a href=\"#nginx-1\" class=\"headerlink\" title=\"nginx\"></a>nginx</h5><p>先监听80再监听443端口重定向，读取pem<br><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">listen              443 ssl;</span><br><span class=\"line\">server_name         www.example.com;</span><br><span class=\"line\">ssl_certificate     www.example.com.crt;</span><br><span class=\"line\">ssl_certificate_key www.example.com.key;</span><br><span class=\"line\">ssl_protocols       TLSv1 TLSv1.1 TLSv1.2;</span><br><span class=\"line\">ssl_ciphers         HIGH:!aNULL:!MD5;</span><br></pre></td></tr></table></figure></p>\n<h2 id=\"ssl\"><a href=\"#ssl\" class=\"headerlink\" title=\"ssl\"></a>ssl</h2><h3 id=\"prove-control-of-the-domain\"><a href=\"#prove-control-of-the-domain\" class=\"headerlink\" title=\"prove control of the domain\"></a>prove control of the domain</h3><ul>\n<li>Provisioning a DNS record under domain</li>\n<li>Provisioning an HTTP resource under a well-known URI on domain</li>\n</ul>\n<p>不管是申请还是续期，只要是通配符证书，只能采用 dns-01 的方式校验申请者的域名，也就是说 certbot 操作者必须手动添加 DNS TXT 记录。</p>\n<h3 id=\"CA-Certificate-Authority\"><a href=\"#CA-Certificate-Authority\" class=\"headerlink\" title=\"CA (Certificate Authority)\"></a>CA (Certificate Authority)</h3><h4 id=\"付费\"><a href=\"#付费\" class=\"headerlink\" title=\"付费\"></a>付费</h4><h4 id=\"免费\"><a href=\"#免费\" class=\"headerlink\" title=\"免费\"></a>免费</h4><h5 id=\"Let’s-Encrypt\"><a href=\"#Let’s-Encrypt\" class=\"headerlink\" title=\"Let’s Encrypt\"></a>Let’s Encrypt</h5><h3 id=\"证书签发工具\"><a href=\"#证书签发工具\" class=\"headerlink\" title=\"证书签发工具\"></a>证书签发工具</h3><h4 id=\"第三方平台\"><a href=\"#第三方平台\" class=\"headerlink\" title=\"第三方平台\"></a>第三方平台</h4><p>阿里云、腾讯云等机构提供证书申请服务,申请好后自行下载，依然在调取CA的接口</p>\n<h4 id=\"ACME-Client-Automatic-Certificate-Management-Environment\"><a href=\"#ACME-Client-Automatic-Certificate-Management-Environment\" class=\"headerlink\" title=\"ACME Client (Automatic Certificate Management Environment)\"></a>ACME Client (Automatic Certificate Management Environment)</h4><p>客户端可能会检测服务器内已部署的虚拟主机配置以便下载到相应位置。</p>\n<ul>\n<li>实现不需要ssh登录到服务器内部配置，随机生成域名前缀或者根据上传的项目名称参数而触发申请证书、配置nginx和重启流程。</li>\n<li>泛域名解析后，nginx先进行分配？直接解析至某个应用服务器下，再由应用服务器进行反向代理</li>\n</ul>\n<p>申请免费证书再下载到服务器上，也可以直接使用cert工具完成申请和下发，可以对目前的所有域名直接使用一套密钥，但一旦新增就需要再次执行添加，修改nginx配置。</p>\n<h5 id=\"certbot\"><a href=\"#certbot\" class=\"headerlink\" title=\"certbot\"></a>certbot</h5><blockquote>\n<p>If you want to obtain a wildcard certificate using Let’s Encrypt’s new ACMEv2 server, you’ll also need to use one of Certbot’s DNS plugins.<br>官方没有阿里云的插件,</p>\n<ul>\n<li><a href=\"https://github.com/ywdblog/certbot-letencrypt-wildcardcertificates-alydns-au\" target=\"_blank\" rel=\"noopener\">第三方</a></li>\n<li>手动，不能自动更新DNS<br>Available <a href=\"https://github.com/MakerGYT/ubuntu-sh/blob/master/install_certbot.sh\" target=\"_blank\" rel=\"noopener\">install_certbot.sh</a></li>\n</ul>\n</blockquote>\n<h5 id=\"acme-sh\"><a href=\"#acme-sh\" class=\"headerlink\" title=\"acme.sh\"></a>acme.sh</h5><div class=\"note danger\">\n            <p>Invalid response from <a href=\"https://test.makergyt.com/.well-known/acme-challenge/ajDvnOpG0Gv-iHDyYlaVcBrej3-ONLsJu43bIaJYWns\" target=\"_blank\" rel=\"noopener\">https://test.makergyt.com/.well-known/acme-challenge/ajDvnOpG0Gv-iHDyYlaVcBrej3-ONLsJu43bIaJYWns</a></p>\n          </div>\n<h3 id=\"证书内容\"><a href=\"#证书内容\" class=\"headerlink\" title=\"证书内容\"></a>证书内容</h3><h4 id=\"pem\"><a href=\"#pem\" class=\"headerlink\" title=\"pem\"></a>pem</h4><h4 id=\"crt-amp-key\"><a href=\"#crt-amp-key\" class=\"headerlink\" title=\"crt &amp; key\"></a>crt &amp; key</h4><p>crt公钥</p>\n<h2 id=\"多进程管理\"><a href=\"#多进程管理\" class=\"headerlink\" title=\"多进程管理\"></a>多进程管理</h2><h3 id=\"PM2-启动\"><a href=\"#PM2-启动\" class=\"headerlink\" title=\"PM2 启动\"></a>PM2 启动</h3><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pm2 start apps.json</span><br><span class=\"line\"><span class=\"comment\"># apps.json</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"string\">\"apps\"</span>:[</span><br><span class=\"line\">  &#123;</span><br><span class=\"line\">    <span class=\"string\">\"name\"</span>:<span class=\"string\">\"app1\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"cwd\"</span>:<span class=\"string\">\"/project/app1/\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"max_memory_restart\"</span>:<span class=\"string\">\"1024M\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"log_date_format\"</span>:<span class=\"string\">\"YYYY-MM-DD HH:mm:ss SSS\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"script\"</span>:<span class=\"string\">\"/project/app1.js\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"env\"</span>:&#123;</span><br><span class=\"line\">        <span class=\"string\">\"http_proxy\"</span>:<span class=\"string\">\"http://10.12.xxx.xxx:xxxx\"</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;,]</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h2 id=\"动态域名\"><a href=\"#动态域名\" class=\"headerlink\" title=\"动态域名\"></a>动态域名</h2><h3 id=\"域名生成\"><a href=\"#域名生成\" class=\"headerlink\" title=\"域名生成\"></a>域名生成</h3><h3 id=\"域名解析-1\"><a href=\"#域名解析-1\" class=\"headerlink\" title=\"域名解析\"></a>域名解析</h3><p>为固定域名添加泛解析，将所有动态的域名请求都发到同一个服务上，再分发</p>\n<h1 id=\"自动化构建\"><a href=\"#自动化构建\" class=\"headerlink\" title=\"自动化构建\"></a>自动化构建</h1><h2 id=\"cloud-studio-半自动化预览\"><a href=\"#cloud-studio-半自动化预览\" class=\"headerlink\" title=\"cloud studio(半自动化预览)\"></a>cloud studio(半自动化预览)</h2><h2 id=\"heroku\"><a href=\"#heroku\" class=\"headerlink\" title=\"heroku\"></a>heroku</h2><h2 id=\"now-sh\"><a href=\"#now-sh\" class=\"headerlink\" title=\"now.sh\"></a>now.sh</h2><p>由本地提交触发（now.json,或cli）后构建</p>\n<h2 id=\"circleci\"><a href=\"#circleci\" class=\"headerlink\" title=\"circleci\"></a>circleci</h2><p>可以直接拉取构建</p>\n<h1 id=\"Reference\"><a href=\"#Reference\" class=\"headerlink\" title=\"Reference\"></a>Reference</h1><p>[1] UYOU.Nginx反向代理：实现node.js多虚拟主机.<a href=\"https://www.imooc.com/article/34904\" target=\"_blank\" rel=\"noopener\">https://www.imooc.com/article/34904</a> [EB/OL] 2018<br>[2] fairysoftware.基于nodejs实现一台服务器多个https域名（多个SSL证书、nodejs ssl 多域名.<a href=\"http://www.fairysoftware.com/nodejs_ssl_https.html\" target=\"_blank\" rel=\"noopener\">http://www.fairysoftware.com/nodejs_ssl_https.html</a> [EB/OL] 2018<br>[3] 阮一峰.持续集成服务 Travis CI 教程.<a href=\"http://www.ruanyifeng.com/blog/2017/12/travis_ci_tutorial.html\" target=\"_blank\" rel=\"noopener\">http://www.ruanyifeng.com/blog/2017/12/travis_ci_tutorial.html</a> [EB/OL] 2017<br>[4] huzhuolei.通过 Certbot 申请泛域名 HTTPS 证书及配置自动更新.<a href=\"https://www.jianshu.com/p/034b891cf395\" target=\"_blank\" rel=\"noopener\">https://www.jianshu.com/p/034b891cf395</a> [EB/OL] 2019<br>[5] ISRG.Let’s Encrypt Documentation.<a href=\"https://letsencrypt.org/docs/\" target=\"_blank\" rel=\"noopener\">https://letsencrypt.org/docs/</a> [EB/OL]<br>[6] 飞奔的萝卜.申请Let’s Encrypt通配符HTTPS证书.<a href=\"https://my.oschina.net/kimver/blog/1634575\" target=\"_blank\" rel=\"noopener\">https://my.oschina.net/kimver/blog/1634575</a> [EB/OL] 2018<br>[7] Igor Sysoev.Configuring HTTPS servers.<a href=\"http://nginx.org/en/docs/http/configuring_https_servers.html\" target=\"_blank\" rel=\"noopener\">http://nginx.org/en/docs/http/configuring_https_servers.html</a> [EB/OL]</p>\n"},{"title":"谈谈CSDN","date":"2019-05-13T08:22:52.000Z","_content":"{% note info %}\n最近CSDN被同行segmentfault CEO“旗帜鲜明的抵制”，但由于技术圈子的狭窄和无力(大部分都是打工的)，没有像之前的[版权事件](https://www.vcg.com/)调动起相干者和不相干者的情绪，现在看来最终没有掀起多大的波澜。\n{% endnote %}\n\n<!-- more -->\n\n刚开始接触互联网时，资料教程还是基于百度产品，如知道、百科、贴吧、经验等，那时的普通用户有一定参与度。后来经过百度搜索相关主题，得到一些博客文章。使用flash的新浪博客受到欢迎，干干净净，一些高手持续输出高质量内容，网易博客的内容也时常能搜到，CSDN还不怎么热闹，版面丑陋的博客园也足够满足写作者的需求。wordpress才发布不久，个人博客基本进不了搜索引擎。当时挺看好CSDN，它在构建一个基本完整的IT技术生态社区,至少比同期的开源中国要体验好。\n\n但是，\n\n在CSDN上下载，总会有种担心上当的感觉，模式决定了内容质量，有的只是一个文本，里边写着百度云链接或者其他社交平台，高明一点的会打包成压缩文件。很多介绍华丽的内容其实一文不值，下载量多但是没有评论，即便有评论也是骂声居多。一些黑产也趁势而上。\n\n不知百度给了CSDN多少流量扶持，当然羊毛出在羊身上，现在的CSDN上，尽管加了广告拦截插件，但是依然乱七八糟。在整个页面上，推荐的文章条目与作者原文分庭抗礼，如果刚进入页面，会提示阅读更多。MD,都进来了，肯定是要看原文的，这样的结果是，作者的原文只占据页面很小的一部分，依然被一堆只是某个字段相似的推荐文章充斥着版面，为了提升点击率和广告曝光率不择手段。有时百度某个标题，会在抓取的概要中欣喜的看到是想要的，但打开发现，ctrl F后作者全文根本没有概要中的任何字段，而是在推荐的文章概要中，那么继续进入，同样的继续这个逻辑。这种神一般的操作跟之前爆出的刷广告流量代码如出一辙。至少现在审查代码，还是会发现一堆不明所以的注释懒得删。\n\n缺乏审查，标题党越来越多，直线向百家号看齐，很多文章里面只有一条链接，但更多的是博主的转来转去，markdown被渲染的面目全非。\n\n{% qnimg csdn.png %}\n\n有理由预测，CSDN这样下去，如同兔子尾巴。在国内，很多互联网产品在使用上都是以免费的形态呈现给用户，但终究是趋利的，我们不能以传统商业中的顾客角色去要求它们满足某种期望。对其运营者而言，这便涉及到商业模式和价值观导向的问题，也即发展战略的问题。毕竟产品怎么样，用户说了算。","source":"_posts/zh-CN/谈谈CSDN.md","raw":"---\ntitle: 谈谈CSDN\ndate: 2019-05-13 16:22:52\ntags:\n---\n{% note info %}\n最近CSDN被同行segmentfault CEO“旗帜鲜明的抵制”，但由于技术圈子的狭窄和无力(大部分都是打工的)，没有像之前的[版权事件](https://www.vcg.com/)调动起相干者和不相干者的情绪，现在看来最终没有掀起多大的波澜。\n{% endnote %}\n\n<!-- more -->\n\n刚开始接触互联网时，资料教程还是基于百度产品，如知道、百科、贴吧、经验等，那时的普通用户有一定参与度。后来经过百度搜索相关主题，得到一些博客文章。使用flash的新浪博客受到欢迎，干干净净，一些高手持续输出高质量内容，网易博客的内容也时常能搜到，CSDN还不怎么热闹，版面丑陋的博客园也足够满足写作者的需求。wordpress才发布不久，个人博客基本进不了搜索引擎。当时挺看好CSDN，它在构建一个基本完整的IT技术生态社区,至少比同期的开源中国要体验好。\n\n但是，\n\n在CSDN上下载，总会有种担心上当的感觉，模式决定了内容质量，有的只是一个文本，里边写着百度云链接或者其他社交平台，高明一点的会打包成压缩文件。很多介绍华丽的内容其实一文不值，下载量多但是没有评论，即便有评论也是骂声居多。一些黑产也趁势而上。\n\n不知百度给了CSDN多少流量扶持，当然羊毛出在羊身上，现在的CSDN上，尽管加了广告拦截插件，但是依然乱七八糟。在整个页面上，推荐的文章条目与作者原文分庭抗礼，如果刚进入页面，会提示阅读更多。MD,都进来了，肯定是要看原文的，这样的结果是，作者的原文只占据页面很小的一部分，依然被一堆只是某个字段相似的推荐文章充斥着版面，为了提升点击率和广告曝光率不择手段。有时百度某个标题，会在抓取的概要中欣喜的看到是想要的，但打开发现，ctrl F后作者全文根本没有概要中的任何字段，而是在推荐的文章概要中，那么继续进入，同样的继续这个逻辑。这种神一般的操作跟之前爆出的刷广告流量代码如出一辙。至少现在审查代码，还是会发现一堆不明所以的注释懒得删。\n\n缺乏审查，标题党越来越多，直线向百家号看齐，很多文章里面只有一条链接，但更多的是博主的转来转去，markdown被渲染的面目全非。\n\n{% qnimg csdn.png %}\n\n有理由预测，CSDN这样下去，如同兔子尾巴。在国内，很多互联网产品在使用上都是以免费的形态呈现给用户，但终究是趋利的，我们不能以传统商业中的顾客角色去要求它们满足某种期望。对其运营者而言，这便涉及到商业模式和价值观导向的问题，也即发展战略的问题。毕竟产品怎么样，用户说了算。","slug":"谈谈CSDN","published":1,"lang":"zh-CN","updated":"2019-07-21T06:22:12.341Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjycl43r10001jrjxj7vi8gb7","content":"<link rel=\"stylesheet\" class=\"aplayer-secondary-style-marker\" href=\"/assets/css/APlayer.min.css\"><script src=\"/assets/js/APlayer.min.js\" class=\"aplayer-secondary-script-marker\"></script><script class=\"meting-secondary-script-marker\" src=\"/assets/js/Meting.min.js\"></script><link rel=\"stylesheet\" type=\"text/css\" href=\"https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css\"><div class=\"note info\">\n            <p>最近CSDN被同行segmentfault CEO“旗帜鲜明的抵制”，但由于技术圈子的狭窄和无力(大部分都是打工的)，没有像之前的<a href=\"https://www.vcg.com/\" target=\"_blank\" rel=\"noopener\">版权事件</a>调动起相干者和不相干者的情绪，现在看来最终没有掀起多大的波澜。</p>\n          </div>\n<a id=\"more\"></a>\n<p>刚开始接触互联网时，资料教程还是基于百度产品，如知道、百科、贴吧、经验等，那时的普通用户有一定参与度。后来经过百度搜索相关主题，得到一些博客文章。使用flash的新浪博客受到欢迎，干干净净，一些高手持续输出高质量内容，网易博客的内容也时常能搜到，CSDN还不怎么热闹，版面丑陋的博客园也足够满足写作者的需求。wordpress才发布不久，个人博客基本进不了搜索引擎。当时挺看好CSDN，它在构建一个基本完整的IT技术生态社区,至少比同期的开源中国要体验好。</p>\n<p>但是，</p>\n<p>在CSDN上下载，总会有种担心上当的感觉，模式决定了内容质量，有的只是一个文本，里边写着百度云链接或者其他社交平台，高明一点的会打包成压缩文件。很多介绍华丽的内容其实一文不值，下载量多但是没有评论，即便有评论也是骂声居多。一些黑产也趁势而上。</p>\n<p>不知百度给了CSDN多少流量扶持，当然羊毛出在羊身上，现在的CSDN上，尽管加了广告拦截插件，但是依然乱七八糟。在整个页面上，推荐的文章条目与作者原文分庭抗礼，如果刚进入页面，会提示阅读更多。MD,都进来了，肯定是要看原文的，这样的结果是，作者的原文只占据页面很小的一部分，依然被一堆只是某个字段相似的推荐文章充斥着版面，为了提升点击率和广告曝光率不择手段。有时百度某个标题，会在抓取的概要中欣喜的看到是想要的，但打开发现，ctrl F后作者全文根本没有概要中的任何字段，而是在推荐的文章概要中，那么继续进入，同样的继续这个逻辑。这种神一般的操作跟之前爆出的刷广告流量代码如出一辙。至少现在审查代码，还是会发现一堆不明所以的注释懒得删。</p>\n<p>缺乏审查，标题党越来越多，直线向百家号看齐，很多文章里面只有一条链接，但更多的是博主的转来转去，markdown被渲染的面目全非。</p>\n<img src=\"https://blog-cdn.makergyt.com/static/images/csdn.png\">\n<p>有理由预测，CSDN这样下去，如同兔子尾巴。在国内，很多互联网产品在使用上都是以免费的形态呈现给用户，但终究是趋利的，我们不能以传统商业中的顾客角色去要求它们满足某种期望。对其运营者而言，这便涉及到商业模式和价值观导向的问题，也即发展战略的问题。毕竟产品怎么样，用户说了算。</p>\n","site":{"data":{}},"excerpt":"<div class=\"note info\">\n            <p>最近CSDN被同行segmentfault CEO“旗帜鲜明的抵制”，但由于技术圈子的狭窄和无力(大部分都是打工的)，没有像之前的<a href=\"https://www.vcg.com/\" target=\"_blank\" rel=\"noopener\">版权事件</a>调动起相干者和不相干者的情绪，现在看来最终没有掀起多大的波澜。</p>\n          </div>","more":"<p>刚开始接触互联网时，资料教程还是基于百度产品，如知道、百科、贴吧、经验等，那时的普通用户有一定参与度。后来经过百度搜索相关主题，得到一些博客文章。使用flash的新浪博客受到欢迎，干干净净，一些高手持续输出高质量内容，网易博客的内容也时常能搜到，CSDN还不怎么热闹，版面丑陋的博客园也足够满足写作者的需求。wordpress才发布不久，个人博客基本进不了搜索引擎。当时挺看好CSDN，它在构建一个基本完整的IT技术生态社区,至少比同期的开源中国要体验好。</p>\n<p>但是，</p>\n<p>在CSDN上下载，总会有种担心上当的感觉，模式决定了内容质量，有的只是一个文本，里边写着百度云链接或者其他社交平台，高明一点的会打包成压缩文件。很多介绍华丽的内容其实一文不值，下载量多但是没有评论，即便有评论也是骂声居多。一些黑产也趁势而上。</p>\n<p>不知百度给了CSDN多少流量扶持，当然羊毛出在羊身上，现在的CSDN上，尽管加了广告拦截插件，但是依然乱七八糟。在整个页面上，推荐的文章条目与作者原文分庭抗礼，如果刚进入页面，会提示阅读更多。MD,都进来了，肯定是要看原文的，这样的结果是，作者的原文只占据页面很小的一部分，依然被一堆只是某个字段相似的推荐文章充斥着版面，为了提升点击率和广告曝光率不择手段。有时百度某个标题，会在抓取的概要中欣喜的看到是想要的，但打开发现，ctrl F后作者全文根本没有概要中的任何字段，而是在推荐的文章概要中，那么继续进入，同样的继续这个逻辑。这种神一般的操作跟之前爆出的刷广告流量代码如出一辙。至少现在审查代码，还是会发现一堆不明所以的注释懒得删。</p>\n<p>缺乏审查，标题党越来越多，直线向百家号看齐，很多文章里面只有一条链接，但更多的是博主的转来转去，markdown被渲染的面目全非。</p>\n<img src=\"https://blog-cdn.makergyt.com/static/images/csdn.png\">\n<p>有理由预测，CSDN这样下去，如同兔子尾巴。在国内，很多互联网产品在使用上都是以免费的形态呈现给用户，但终究是趋利的，我们不能以传统商业中的顾客角色去要求它们满足某种期望。对其运营者而言，这便涉及到商业模式和价值观导向的问题，也即发展战略的问题。毕竟产品怎么样，用户说了算。</p>"},{"title":"【译】TensorFLow1.3文档中文翻译之1.0.0安装","date":"2017-10-14T04:11:06.000Z","_content":"\n{% note info %}\n中文社区并没有及时做到更新，于是边翻译边学习，发现效果很显著，会强迫自己去确保理解了每一部分，以前是常常会跳过。\n{% endnote %}\n\n下面的引导解释了如何安装让你可以使用Python写程序的一个TensorFlow的版本\n\n<!-- more -->\n# 1 在ubuntu上安装\n这份引导解释了如何在Ubuntu上安装TensorFlow。这些说明可能在其它Linux版本上也能工作，但是我们目前仅仅在Ubuntu14.04或者之上的版本上（我们也只支持）测试了它们。\n# 2 选择安装哪个Tesorflow版本\n你必须选择下面的一种来安装：\n- 仅支持CPU。如果你的系统没有NVIDIA® GPU，你只能安装这个版本。注意这个版本更容易去安装（5~10分钟之内），所以即便你有NVIDIA® GPU，我们仍然推荐先安装这个版本。\n- 支持GPU。TensorFlow程序在GPU上比在CPU上运行起来明显要快。因此，如果你的系统有符合下面提到要求的NVIDIA® GPU并且你需要运行更具有良好表现的应用，你终究要安装这个版本。\n\n**运行带有GPU支持的TensorFlowN对VIDIA®的要求**\n如果你正在安装支持GPU的TensorFlow使用引导中描述的架构，下面的NVIDIA软件必须安装到你的系统上：\n- CUDA® Toolkit 8.0.对于细节参考英伟达的文档。确保你按照英伟达文档添加相应的Cuda路径到LD_LIBRARY_PATH环境变量里与CUDA Toolkit 8.0关联的英伟达驱动\n- cuDNN v6.对于细节参考英伟达的文档。确保你按照英伟达文档添加相应的Cuda路径到CUDA_HOME环境变量里\n- CUDA计算性能3.0及以上的显卡。参考英伟达文档列出的支持的显卡。\n- libcupti-dev库，它是英伟达CUDA配置工具接口。这个库提供了先进的<em>仿真</em>支持，按照下面的命令：\n\n```sh\nsudo apt-get install libcupti-dev\n```\n\n如果你是使用前面列举先前的包，请更新到特定的版本。如果没有更新，你还可以运行支持GPU的TensorFlow，不过仅限于做下面：\n- 按照从源码安装的文档安装。\n- 安装或至少更新到下面版本的英伟达：\n  - CUDA toolkit 8.0及以上\n  - cuDNN v3 及以上\n  - CUDA计算性能3.0及以上的显卡\n\n# 3 选择如何去安装\n\n你必须掌握如何安装TensorFlow的机制。下面列出了支持的选择:\n- virtualenv\n- “本地”的pip\n- Docker\n- Anaconda\n- 从源码安装，在单独的引导中有注明\n\n<strong>我们推荐这种virtualenv安装。</strong>virtualenv是一个虚拟的与其他平台隔离的Python系统，在同一个机器上不会妨碍和被影响其他的Python程序。在virtualenv安装过程中，你将不仅安装TensorFlow还有它的依赖项。（这事实上相当容易）开始用TensorFlow工作时，你仅需激活这个虚拟环境。总而言之，virtualenv提供了一个安全可靠的安装运行TensorFlow的机制。\n\n本地的pip直接在你的系统上安装而不进行任何的包含系统。对于想要在一个多用户系统上让所有人都可以获得TensorFlow的系统管理员，我们推荐这种本地pip安装方式。由于本地的pip安装不是隔离在一个单独的容器中，它可能会加入一些基于Python的安装项到你的系统中。不过，如果你理解了pip和你的Python环境，本地安装仅需要一个命令。\n\nDocker将TensorFlow与在你的机器上与预先的包完全隔离开。Docker包含了TensorFlow和所有它的依赖项。注意Docker镜像可能非常大（有成百上千兆）。如果你正准备将TensorFlow合并到已经使用Docker的更大的应用架构里，你可以选择这种Docker安装方式。\n\n在Anconda中，你可以使用conda（译者注：一个包管理器）创建一个虚拟环境。然而，用Anaconda的话，我们推荐<code>pip install</code>命令，而不是<code>conda install</code>命令。\n\n{% note warning %}\n**注意** :conda包是社区支持的，不是官方支持。那就是说，TensorFlow团队没有测试也没有包含上conda包。使用该包的风险要由你承担。\n{% endnote %}\n\n## 3.1 用vitualenv安装\n\n采取下面的步骤来使用vitualenv安装TensorFlow：\n1. 键入下面任一指令来安装pip和virtualenv(译者注：对应不同的python版本,2.7或3.x):\n\n```sh\nsudo apt-get install python-pip python-dev python-virtualenv # for Python 2.7`\nsudo apt-get install python3-pip python3-dev python-virtualenv # for Python 3.n`\n```\n2. 键入下面的指令创建一个virtualenv环境：\n\n```sh\nvirtualenv --system-site-packages <em>targetDirectory</em> # for Python 2.7\nvirtualenv --system-site-packages -p python3 <em>targetDirectory</em> # for Python 3.n\n```\n\n``targetDirectory``指明了virtualenv树的顶部。我们的介绍会设定``targetDirectory``是``～/tensorflow``,你也可以自己选择任何目录。\n\n3. 键入下面的指令来激活virtualenv环境：\n\n```bash\nsource ~/tensorflow/bin/activate # bash, sh, ksh, or zsh\nsource ~/tensorflow/bin/activate.csh # csh or tcsh\n```\n\n资源符前面会变成这样的提示：\n``(tensorflow)$``\n4. 确保pip8.0以上已经安装：\n\n```sh\n(tensorflow)$ easy_install -U pip\n```\n5. 键入下面任一指令在激活的virtualenv环境中安装TensorFlow:\n\n```sh\n(tensorflow)$ pip install --upgrade tensorflow # for Python 2.7\n(tensorflow)$ pip3 install --upgrade tensorflow # for Python 3.n\n(tensorflow)$ pip install --upgrade tensorflow-gpu # for Python 2.7 and GPU\n(tensorflow)$ pip3 install --upgrade tensorflow-gpu # for Python 3.n and GPU\n```\n6. 可选）如果步骤4失败（可能是因为低于8.1版本的pip），按下面格式键入指令在激活的virtualenv环境中安装TensorFlow：\n\n```sh\n(tensorflow)$ pip install --upgrade tfBinaryURL # Python 2.7\n(tensorflow)$ pip3 install --upgrade tfBinaryURL # Python 3.n\n```\n\n``tfBinaryURL``定义了TensorFlow Python包的URL。根据操作系统，Python版本和GPU支持选择合适的``tfBinaryURL``值。在这里为你系统找合适的``tfBinaryURL``值。例如，如果你是为Linux,Python 3.4 并且支持GPU,键入下列命令在激活的virtualenv环境中安装TensorFlow：\n```sh\n(tensorflow)$ pip3 install --upgrade\nhttps://storage.googleapis.com/tensorflow/linux/cpu/tensorflow-1.3.0-cp34-cp34m-linux_x86_64.whl\n```\n如果安装遇到问题，参考常见安装问题\n# 4 下一步\n在安装完TensorFlow后，验证安装。\n注意每当你使用TensorFlow的时候你必须激活virtual环境。如果该环境当时没有激活，调用下面的指令：\n```sh\nsource ~/tensorflow/bin/activate # bash, sh, ksh, or zsh\nsource ~/tensorflow/bin/activate.csh # csh or tcsh\n```\n当该环境激活时，你可以从这个shell中运行TensorFlow程序。你的提示将变成下面这样证明tensorflow环境已经激活：\n```sh\n(tensorflow)$\n```\n当你使用完TensorFlow后，调用下面的``deactivate``函数来停止环境:\n```sh\n(tensorflow)$ deactivate\n```\n提示符会翻转成默认的（在``PS1``环境变量里定义的）。\n# 5 卸载TensorFlow\n要卸载TensorFLow的话，移除你创建的树。例如：\n```sh\nrm -r targetDirectory\n```\n\n<em>未完待续</em>\n\n# Reference\n\n<small>[1] Google.tensorflow[EB/OL].https://tensorflow.google.cn .2017.</small>","source":"_posts/zh-CN/【译]】TensorFLow1-3之1-0-0安装.md","raw":"---\ntitle: 【译】TensorFLow1.3文档中文翻译之1.0.0安装\ndate: 2017-10-14 12:11:06\ntags:\n\t- tensorflow\ncategories: translate\n---\n\n{% note info %}\n中文社区并没有及时做到更新，于是边翻译边学习，发现效果很显著，会强迫自己去确保理解了每一部分，以前是常常会跳过。\n{% endnote %}\n\n下面的引导解释了如何安装让你可以使用Python写程序的一个TensorFlow的版本\n\n<!-- more -->\n# 1 在ubuntu上安装\n这份引导解释了如何在Ubuntu上安装TensorFlow。这些说明可能在其它Linux版本上也能工作，但是我们目前仅仅在Ubuntu14.04或者之上的版本上（我们也只支持）测试了它们。\n# 2 选择安装哪个Tesorflow版本\n你必须选择下面的一种来安装：\n- 仅支持CPU。如果你的系统没有NVIDIA® GPU，你只能安装这个版本。注意这个版本更容易去安装（5~10分钟之内），所以即便你有NVIDIA® GPU，我们仍然推荐先安装这个版本。\n- 支持GPU。TensorFlow程序在GPU上比在CPU上运行起来明显要快。因此，如果你的系统有符合下面提到要求的NVIDIA® GPU并且你需要运行更具有良好表现的应用，你终究要安装这个版本。\n\n**运行带有GPU支持的TensorFlowN对VIDIA®的要求**\n如果你正在安装支持GPU的TensorFlow使用引导中描述的架构，下面的NVIDIA软件必须安装到你的系统上：\n- CUDA® Toolkit 8.0.对于细节参考英伟达的文档。确保你按照英伟达文档添加相应的Cuda路径到LD_LIBRARY_PATH环境变量里与CUDA Toolkit 8.0关联的英伟达驱动\n- cuDNN v6.对于细节参考英伟达的文档。确保你按照英伟达文档添加相应的Cuda路径到CUDA_HOME环境变量里\n- CUDA计算性能3.0及以上的显卡。参考英伟达文档列出的支持的显卡。\n- libcupti-dev库，它是英伟达CUDA配置工具接口。这个库提供了先进的<em>仿真</em>支持，按照下面的命令：\n\n```sh\nsudo apt-get install libcupti-dev\n```\n\n如果你是使用前面列举先前的包，请更新到特定的版本。如果没有更新，你还可以运行支持GPU的TensorFlow，不过仅限于做下面：\n- 按照从源码安装的文档安装。\n- 安装或至少更新到下面版本的英伟达：\n  - CUDA toolkit 8.0及以上\n  - cuDNN v3 及以上\n  - CUDA计算性能3.0及以上的显卡\n\n# 3 选择如何去安装\n\n你必须掌握如何安装TensorFlow的机制。下面列出了支持的选择:\n- virtualenv\n- “本地”的pip\n- Docker\n- Anaconda\n- 从源码安装，在单独的引导中有注明\n\n<strong>我们推荐这种virtualenv安装。</strong>virtualenv是一个虚拟的与其他平台隔离的Python系统，在同一个机器上不会妨碍和被影响其他的Python程序。在virtualenv安装过程中，你将不仅安装TensorFlow还有它的依赖项。（这事实上相当容易）开始用TensorFlow工作时，你仅需激活这个虚拟环境。总而言之，virtualenv提供了一个安全可靠的安装运行TensorFlow的机制。\n\n本地的pip直接在你的系统上安装而不进行任何的包含系统。对于想要在一个多用户系统上让所有人都可以获得TensorFlow的系统管理员，我们推荐这种本地pip安装方式。由于本地的pip安装不是隔离在一个单独的容器中，它可能会加入一些基于Python的安装项到你的系统中。不过，如果你理解了pip和你的Python环境，本地安装仅需要一个命令。\n\nDocker将TensorFlow与在你的机器上与预先的包完全隔离开。Docker包含了TensorFlow和所有它的依赖项。注意Docker镜像可能非常大（有成百上千兆）。如果你正准备将TensorFlow合并到已经使用Docker的更大的应用架构里，你可以选择这种Docker安装方式。\n\n在Anconda中，你可以使用conda（译者注：一个包管理器）创建一个虚拟环境。然而，用Anaconda的话，我们推荐<code>pip install</code>命令，而不是<code>conda install</code>命令。\n\n{% note warning %}\n**注意** :conda包是社区支持的，不是官方支持。那就是说，TensorFlow团队没有测试也没有包含上conda包。使用该包的风险要由你承担。\n{% endnote %}\n\n## 3.1 用vitualenv安装\n\n采取下面的步骤来使用vitualenv安装TensorFlow：\n1. 键入下面任一指令来安装pip和virtualenv(译者注：对应不同的python版本,2.7或3.x):\n\n```sh\nsudo apt-get install python-pip python-dev python-virtualenv # for Python 2.7`\nsudo apt-get install python3-pip python3-dev python-virtualenv # for Python 3.n`\n```\n2. 键入下面的指令创建一个virtualenv环境：\n\n```sh\nvirtualenv --system-site-packages <em>targetDirectory</em> # for Python 2.7\nvirtualenv --system-site-packages -p python3 <em>targetDirectory</em> # for Python 3.n\n```\n\n``targetDirectory``指明了virtualenv树的顶部。我们的介绍会设定``targetDirectory``是``～/tensorflow``,你也可以自己选择任何目录。\n\n3. 键入下面的指令来激活virtualenv环境：\n\n```bash\nsource ~/tensorflow/bin/activate # bash, sh, ksh, or zsh\nsource ~/tensorflow/bin/activate.csh # csh or tcsh\n```\n\n资源符前面会变成这样的提示：\n``(tensorflow)$``\n4. 确保pip8.0以上已经安装：\n\n```sh\n(tensorflow)$ easy_install -U pip\n```\n5. 键入下面任一指令在激活的virtualenv环境中安装TensorFlow:\n\n```sh\n(tensorflow)$ pip install --upgrade tensorflow # for Python 2.7\n(tensorflow)$ pip3 install --upgrade tensorflow # for Python 3.n\n(tensorflow)$ pip install --upgrade tensorflow-gpu # for Python 2.7 and GPU\n(tensorflow)$ pip3 install --upgrade tensorflow-gpu # for Python 3.n and GPU\n```\n6. 可选）如果步骤4失败（可能是因为低于8.1版本的pip），按下面格式键入指令在激活的virtualenv环境中安装TensorFlow：\n\n```sh\n(tensorflow)$ pip install --upgrade tfBinaryURL # Python 2.7\n(tensorflow)$ pip3 install --upgrade tfBinaryURL # Python 3.n\n```\n\n``tfBinaryURL``定义了TensorFlow Python包的URL。根据操作系统，Python版本和GPU支持选择合适的``tfBinaryURL``值。在这里为你系统找合适的``tfBinaryURL``值。例如，如果你是为Linux,Python 3.4 并且支持GPU,键入下列命令在激活的virtualenv环境中安装TensorFlow：\n```sh\n(tensorflow)$ pip3 install --upgrade\nhttps://storage.googleapis.com/tensorflow/linux/cpu/tensorflow-1.3.0-cp34-cp34m-linux_x86_64.whl\n```\n如果安装遇到问题，参考常见安装问题\n# 4 下一步\n在安装完TensorFlow后，验证安装。\n注意每当你使用TensorFlow的时候你必须激活virtual环境。如果该环境当时没有激活，调用下面的指令：\n```sh\nsource ~/tensorflow/bin/activate # bash, sh, ksh, or zsh\nsource ~/tensorflow/bin/activate.csh # csh or tcsh\n```\n当该环境激活时，你可以从这个shell中运行TensorFlow程序。你的提示将变成下面这样证明tensorflow环境已经激活：\n```sh\n(tensorflow)$\n```\n当你使用完TensorFlow后，调用下面的``deactivate``函数来停止环境:\n```sh\n(tensorflow)$ deactivate\n```\n提示符会翻转成默认的（在``PS1``环境变量里定义的）。\n# 5 卸载TensorFlow\n要卸载TensorFLow的话，移除你创建的树。例如：\n```sh\nrm -r targetDirectory\n```\n\n<em>未完待续</em>\n\n# Reference\n\n<small>[1] Google.tensorflow[EB/OL].https://tensorflow.google.cn .2017.</small>","slug":"【译]】TensorFLow1-3之1-0-0安装","published":1,"lang":"zh-CN","updated":"2019-07-21T06:35:04.834Z","_id":"cjycl5i840004jrjx355dbsx2","comments":1,"layout":"post","photos":[],"link":"","content":"<link rel=\"stylesheet\" class=\"aplayer-secondary-style-marker\" href=\"/assets/css/APlayer.min.css\"><script src=\"/assets/js/APlayer.min.js\" class=\"aplayer-secondary-script-marker\"></script><script class=\"meting-secondary-script-marker\" src=\"/assets/js/Meting.min.js\"></script><link rel=\"stylesheet\" type=\"text/css\" href=\"https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css\"><div class=\"note info\">\n            <p>中文社区并没有及时做到更新，于是边翻译边学习，发现效果很显著，会强迫自己去确保理解了每一部分，以前是常常会跳过。</p>\n          </div>\n<p>下面的引导解释了如何安装让你可以使用Python写程序的一个TensorFlow的版本</p>\n<a id=\"more\"></a>\n<h1 id=\"1-在ubuntu上安装\"><a href=\"#1-在ubuntu上安装\" class=\"headerlink\" title=\"1 在ubuntu上安装\"></a>1 在ubuntu上安装</h1><p>这份引导解释了如何在Ubuntu上安装TensorFlow。这些说明可能在其它Linux版本上也能工作，但是我们目前仅仅在Ubuntu14.04或者之上的版本上（我们也只支持）测试了它们。</p>\n<h1 id=\"2-选择安装哪个Tesorflow版本\"><a href=\"#2-选择安装哪个Tesorflow版本\" class=\"headerlink\" title=\"2 选择安装哪个Tesorflow版本\"></a>2 选择安装哪个Tesorflow版本</h1><p>你必须选择下面的一种来安装：</p>\n<ul>\n<li>仅支持CPU。如果你的系统没有NVIDIA® GPU，你只能安装这个版本。注意这个版本更容易去安装（5~10分钟之内），所以即便你有NVIDIA® GPU，我们仍然推荐先安装这个版本。</li>\n<li>支持GPU。TensorFlow程序在GPU上比在CPU上运行起来明显要快。因此，如果你的系统有符合下面提到要求的NVIDIA® GPU并且你需要运行更具有良好表现的应用，你终究要安装这个版本。</li>\n</ul>\n<p><strong>运行带有GPU支持的TensorFlowN对VIDIA®的要求</strong><br>如果你正在安装支持GPU的TensorFlow使用引导中描述的架构，下面的NVIDIA软件必须安装到你的系统上：</p>\n<ul>\n<li>CUDA® Toolkit 8.0.对于细节参考英伟达的文档。确保你按照英伟达文档添加相应的Cuda路径到LD_LIBRARY_PATH环境变量里与CUDA Toolkit 8.0关联的英伟达驱动</li>\n<li>cuDNN v6.对于细节参考英伟达的文档。确保你按照英伟达文档添加相应的Cuda路径到CUDA_HOME环境变量里</li>\n<li>CUDA计算性能3.0及以上的显卡。参考英伟达文档列出的支持的显卡。</li>\n<li>libcupti-dev库，它是英伟达CUDA配置工具接口。这个库提供了先进的<em>仿真</em>支持，按照下面的命令：</li>\n</ul>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo apt-get install libcupti-dev</span><br></pre></td></tr></table></figure>\n<p>如果你是使用前面列举先前的包，请更新到特定的版本。如果没有更新，你还可以运行支持GPU的TensorFlow，不过仅限于做下面：</p>\n<ul>\n<li>按照从源码安装的文档安装。</li>\n<li>安装或至少更新到下面版本的英伟达：<ul>\n<li>CUDA toolkit 8.0及以上</li>\n<li>cuDNN v3 及以上</li>\n<li>CUDA计算性能3.0及以上的显卡</li>\n</ul>\n</li>\n</ul>\n<h1 id=\"3-选择如何去安装\"><a href=\"#3-选择如何去安装\" class=\"headerlink\" title=\"3 选择如何去安装\"></a>3 选择如何去安装</h1><p>你必须掌握如何安装TensorFlow的机制。下面列出了支持的选择:</p>\n<ul>\n<li>virtualenv</li>\n<li>“本地”的pip</li>\n<li>Docker</li>\n<li>Anaconda</li>\n<li>从源码安装，在单独的引导中有注明</li>\n</ul>\n<p><strong>我们推荐这种virtualenv安装。</strong>virtualenv是一个虚拟的与其他平台隔离的Python系统，在同一个机器上不会妨碍和被影响其他的Python程序。在virtualenv安装过程中，你将不仅安装TensorFlow还有它的依赖项。（这事实上相当容易）开始用TensorFlow工作时，你仅需激活这个虚拟环境。总而言之，virtualenv提供了一个安全可靠的安装运行TensorFlow的机制。</p>\n<p>本地的pip直接在你的系统上安装而不进行任何的包含系统。对于想要在一个多用户系统上让所有人都可以获得TensorFlow的系统管理员，我们推荐这种本地pip安装方式。由于本地的pip安装不是隔离在一个单独的容器中，它可能会加入一些基于Python的安装项到你的系统中。不过，如果你理解了pip和你的Python环境，本地安装仅需要一个命令。</p>\n<p>Docker将TensorFlow与在你的机器上与预先的包完全隔离开。Docker包含了TensorFlow和所有它的依赖项。注意Docker镜像可能非常大（有成百上千兆）。如果你正准备将TensorFlow合并到已经使用Docker的更大的应用架构里，你可以选择这种Docker安装方式。</p>\n<p>在Anconda中，你可以使用conda（译者注：一个包管理器）创建一个虚拟环境。然而，用Anaconda的话，我们推荐<code>pip install</code>命令，而不是<code>conda install</code>命令。</p>\n<div class=\"note warning\">\n            <p><strong>注意</strong> :conda包是社区支持的，不是官方支持。那就是说，TensorFlow团队没有测试也没有包含上conda包。使用该包的风险要由你承担。</p>\n          </div>\n<h2 id=\"3-1-用vitualenv安装\"><a href=\"#3-1-用vitualenv安装\" class=\"headerlink\" title=\"3.1 用vitualenv安装\"></a>3.1 用vitualenv安装</h2><p>采取下面的步骤来使用vitualenv安装TensorFlow：</p>\n<ol>\n<li>键入下面任一指令来安装pip和virtualenv(译者注：对应不同的python版本,2.7或3.x):</li>\n</ol>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo apt-get install python-pip python-dev python-virtualenv <span class=\"comment\"># for Python 2.7`</span></span><br><span class=\"line\">sudo apt-get install python3-pip python3-dev python-virtualenv <span class=\"comment\"># for Python 3.n`</span></span><br></pre></td></tr></table></figure>\n<ol start=\"2\">\n<li>键入下面的指令创建一个virtualenv环境：</li>\n</ol>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">virtualenv --system-site-packages &lt;em&gt;targetDirectory&lt;/em&gt; <span class=\"comment\"># for Python 2.7</span></span><br><span class=\"line\">virtualenv --system-site-packages -p python3 &lt;em&gt;targetDirectory&lt;/em&gt; <span class=\"comment\"># for Python 3.n</span></span><br></pre></td></tr></table></figure>\n<p><code>targetDirectory</code>指明了virtualenv树的顶部。我们的介绍会设定<code>targetDirectory</code>是<code>～/tensorflow</code>,你也可以自己选择任何目录。</p>\n<ol start=\"3\">\n<li>键入下面的指令来激活virtualenv环境：</li>\n</ol>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">source</span> ~/tensorflow/bin/activate <span class=\"comment\"># bash, sh, ksh, or zsh</span></span><br><span class=\"line\"><span class=\"built_in\">source</span> ~/tensorflow/bin/activate.csh <span class=\"comment\"># csh or tcsh</span></span><br></pre></td></tr></table></figure>\n<p>资源符前面会变成这样的提示：<br><code>(tensorflow)$</code></p>\n<ol start=\"4\">\n<li>确保pip8.0以上已经安装：</li>\n</ol>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">(tensorflow)$ easy_install -U pip</span><br></pre></td></tr></table></figure>\n<ol start=\"5\">\n<li>键入下面任一指令在激活的virtualenv环境中安装TensorFlow:</li>\n</ol>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">(tensorflow)$ pip install --upgrade tensorflow <span class=\"comment\"># for Python 2.7</span></span><br><span class=\"line\">(tensorflow)$ pip3 install --upgrade tensorflow <span class=\"comment\"># for Python 3.n</span></span><br><span class=\"line\">(tensorflow)$ pip install --upgrade tensorflow-gpu <span class=\"comment\"># for Python 2.7 and GPU</span></span><br><span class=\"line\">(tensorflow)$ pip3 install --upgrade tensorflow-gpu <span class=\"comment\"># for Python 3.n and GPU</span></span><br></pre></td></tr></table></figure>\n<ol start=\"6\">\n<li>可选）如果步骤4失败（可能是因为低于8.1版本的pip），按下面格式键入指令在激活的virtualenv环境中安装TensorFlow：</li>\n</ol>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">(tensorflow)$ pip install --upgrade tfBinaryURL <span class=\"comment\"># Python 2.7</span></span><br><span class=\"line\">(tensorflow)$ pip3 install --upgrade tfBinaryURL <span class=\"comment\"># Python 3.n</span></span><br></pre></td></tr></table></figure>\n<p><code>tfBinaryURL</code>定义了TensorFlow Python包的URL。根据操作系统，Python版本和GPU支持选择合适的<code>tfBinaryURL</code>值。在这里为你系统找合适的<code>tfBinaryURL</code>值。例如，如果你是为Linux,Python 3.4 并且支持GPU,键入下列命令在激活的virtualenv环境中安装TensorFlow：<br><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">(tensorflow)$ pip3 install --upgrade</span><br><span class=\"line\">https://storage.googleapis.com/tensorflow/linux/cpu/tensorflow-1.3.0-cp34-cp34m-linux_x86_64.whl</span><br></pre></td></tr></table></figure></p>\n<p>如果安装遇到问题，参考常见安装问题</p>\n<h1 id=\"4-下一步\"><a href=\"#4-下一步\" class=\"headerlink\" title=\"4 下一步\"></a>4 下一步</h1><p>在安装完TensorFlow后，验证安装。<br>注意每当你使用TensorFlow的时候你必须激活virtual环境。如果该环境当时没有激活，调用下面的指令：<br><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">source</span> ~/tensorflow/bin/activate <span class=\"comment\"># bash, sh, ksh, or zsh</span></span><br><span class=\"line\"><span class=\"built_in\">source</span> ~/tensorflow/bin/activate.csh <span class=\"comment\"># csh or tcsh</span></span><br></pre></td></tr></table></figure></p>\n<p>当该环境激活时，你可以从这个shell中运行TensorFlow程序。你的提示将变成下面这样证明tensorflow环境已经激活：<br><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">(tensorflow)$</span><br></pre></td></tr></table></figure></p>\n<p>当你使用完TensorFlow后，调用下面的<code>deactivate</code>函数来停止环境:<br><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">(tensorflow)$ deactivate</span><br></pre></td></tr></table></figure></p>\n<p>提示符会翻转成默认的（在<code>PS1</code>环境变量里定义的）。</p>\n<h1 id=\"5-卸载TensorFlow\"><a href=\"#5-卸载TensorFlow\" class=\"headerlink\" title=\"5 卸载TensorFlow\"></a>5 卸载TensorFlow</h1><p>要卸载TensorFLow的话，移除你创建的树。例如：<br><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">rm -r targetDirectory</span><br></pre></td></tr></table></figure></p>\n<p><em>未完待续</em></p>\n<h1 id=\"Reference\"><a href=\"#Reference\" class=\"headerlink\" title=\"Reference\"></a>Reference</h1><p><small>[1] Google.tensorflow[EB/OL].<a href=\"https://tensorflow.google.cn\" target=\"_blank\" rel=\"noopener\">https://tensorflow.google.cn</a> .2017.</small></p>\n","site":{"data":{}},"excerpt":"<div class=\"note info\">\n            <p>中文社区并没有及时做到更新，于是边翻译边学习，发现效果很显著，会强迫自己去确保理解了每一部分，以前是常常会跳过。</p>\n          </div>\n<p>下面的引导解释了如何安装让你可以使用Python写程序的一个TensorFlow的版本</p>","more":"<h1 id=\"1-在ubuntu上安装\"><a href=\"#1-在ubuntu上安装\" class=\"headerlink\" title=\"1 在ubuntu上安装\"></a>1 在ubuntu上安装</h1><p>这份引导解释了如何在Ubuntu上安装TensorFlow。这些说明可能在其它Linux版本上也能工作，但是我们目前仅仅在Ubuntu14.04或者之上的版本上（我们也只支持）测试了它们。</p>\n<h1 id=\"2-选择安装哪个Tesorflow版本\"><a href=\"#2-选择安装哪个Tesorflow版本\" class=\"headerlink\" title=\"2 选择安装哪个Tesorflow版本\"></a>2 选择安装哪个Tesorflow版本</h1><p>你必须选择下面的一种来安装：</p>\n<ul>\n<li>仅支持CPU。如果你的系统没有NVIDIA® GPU，你只能安装这个版本。注意这个版本更容易去安装（5~10分钟之内），所以即便你有NVIDIA® GPU，我们仍然推荐先安装这个版本。</li>\n<li>支持GPU。TensorFlow程序在GPU上比在CPU上运行起来明显要快。因此，如果你的系统有符合下面提到要求的NVIDIA® GPU并且你需要运行更具有良好表现的应用，你终究要安装这个版本。</li>\n</ul>\n<p><strong>运行带有GPU支持的TensorFlowN对VIDIA®的要求</strong><br>如果你正在安装支持GPU的TensorFlow使用引导中描述的架构，下面的NVIDIA软件必须安装到你的系统上：</p>\n<ul>\n<li>CUDA® Toolkit 8.0.对于细节参考英伟达的文档。确保你按照英伟达文档添加相应的Cuda路径到LD_LIBRARY_PATH环境变量里与CUDA Toolkit 8.0关联的英伟达驱动</li>\n<li>cuDNN v6.对于细节参考英伟达的文档。确保你按照英伟达文档添加相应的Cuda路径到CUDA_HOME环境变量里</li>\n<li>CUDA计算性能3.0及以上的显卡。参考英伟达文档列出的支持的显卡。</li>\n<li>libcupti-dev库，它是英伟达CUDA配置工具接口。这个库提供了先进的<em>仿真</em>支持，按照下面的命令：</li>\n</ul>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo apt-get install libcupti-dev</span><br></pre></td></tr></table></figure>\n<p>如果你是使用前面列举先前的包，请更新到特定的版本。如果没有更新，你还可以运行支持GPU的TensorFlow，不过仅限于做下面：</p>\n<ul>\n<li>按照从源码安装的文档安装。</li>\n<li>安装或至少更新到下面版本的英伟达：<ul>\n<li>CUDA toolkit 8.0及以上</li>\n<li>cuDNN v3 及以上</li>\n<li>CUDA计算性能3.0及以上的显卡</li>\n</ul>\n</li>\n</ul>\n<h1 id=\"3-选择如何去安装\"><a href=\"#3-选择如何去安装\" class=\"headerlink\" title=\"3 选择如何去安装\"></a>3 选择如何去安装</h1><p>你必须掌握如何安装TensorFlow的机制。下面列出了支持的选择:</p>\n<ul>\n<li>virtualenv</li>\n<li>“本地”的pip</li>\n<li>Docker</li>\n<li>Anaconda</li>\n<li>从源码安装，在单独的引导中有注明</li>\n</ul>\n<p><strong>我们推荐这种virtualenv安装。</strong>virtualenv是一个虚拟的与其他平台隔离的Python系统，在同一个机器上不会妨碍和被影响其他的Python程序。在virtualenv安装过程中，你将不仅安装TensorFlow还有它的依赖项。（这事实上相当容易）开始用TensorFlow工作时，你仅需激活这个虚拟环境。总而言之，virtualenv提供了一个安全可靠的安装运行TensorFlow的机制。</p>\n<p>本地的pip直接在你的系统上安装而不进行任何的包含系统。对于想要在一个多用户系统上让所有人都可以获得TensorFlow的系统管理员，我们推荐这种本地pip安装方式。由于本地的pip安装不是隔离在一个单独的容器中，它可能会加入一些基于Python的安装项到你的系统中。不过，如果你理解了pip和你的Python环境，本地安装仅需要一个命令。</p>\n<p>Docker将TensorFlow与在你的机器上与预先的包完全隔离开。Docker包含了TensorFlow和所有它的依赖项。注意Docker镜像可能非常大（有成百上千兆）。如果你正准备将TensorFlow合并到已经使用Docker的更大的应用架构里，你可以选择这种Docker安装方式。</p>\n<p>在Anconda中，你可以使用conda（译者注：一个包管理器）创建一个虚拟环境。然而，用Anaconda的话，我们推荐<code>pip install</code>命令，而不是<code>conda install</code>命令。</p>\n<div class=\"note warning\">\n            <p><strong>注意</strong> :conda包是社区支持的，不是官方支持。那就是说，TensorFlow团队没有测试也没有包含上conda包。使用该包的风险要由你承担。</p>\n          </div>\n<h2 id=\"3-1-用vitualenv安装\"><a href=\"#3-1-用vitualenv安装\" class=\"headerlink\" title=\"3.1 用vitualenv安装\"></a>3.1 用vitualenv安装</h2><p>采取下面的步骤来使用vitualenv安装TensorFlow：</p>\n<ol>\n<li>键入下面任一指令来安装pip和virtualenv(译者注：对应不同的python版本,2.7或3.x):</li>\n</ol>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo apt-get install python-pip python-dev python-virtualenv <span class=\"comment\"># for Python 2.7`</span></span><br><span class=\"line\">sudo apt-get install python3-pip python3-dev python-virtualenv <span class=\"comment\"># for Python 3.n`</span></span><br></pre></td></tr></table></figure>\n<ol start=\"2\">\n<li>键入下面的指令创建一个virtualenv环境：</li>\n</ol>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">virtualenv --system-site-packages &lt;em&gt;targetDirectory&lt;/em&gt; <span class=\"comment\"># for Python 2.7</span></span><br><span class=\"line\">virtualenv --system-site-packages -p python3 &lt;em&gt;targetDirectory&lt;/em&gt; <span class=\"comment\"># for Python 3.n</span></span><br></pre></td></tr></table></figure>\n<p><code>targetDirectory</code>指明了virtualenv树的顶部。我们的介绍会设定<code>targetDirectory</code>是<code>～/tensorflow</code>,你也可以自己选择任何目录。</p>\n<ol start=\"3\">\n<li>键入下面的指令来激活virtualenv环境：</li>\n</ol>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">source</span> ~/tensorflow/bin/activate <span class=\"comment\"># bash, sh, ksh, or zsh</span></span><br><span class=\"line\"><span class=\"built_in\">source</span> ~/tensorflow/bin/activate.csh <span class=\"comment\"># csh or tcsh</span></span><br></pre></td></tr></table></figure>\n<p>资源符前面会变成这样的提示：<br><code>(tensorflow)$</code></p>\n<ol start=\"4\">\n<li>确保pip8.0以上已经安装：</li>\n</ol>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">(tensorflow)$ easy_install -U pip</span><br></pre></td></tr></table></figure>\n<ol start=\"5\">\n<li>键入下面任一指令在激活的virtualenv环境中安装TensorFlow:</li>\n</ol>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">(tensorflow)$ pip install --upgrade tensorflow <span class=\"comment\"># for Python 2.7</span></span><br><span class=\"line\">(tensorflow)$ pip3 install --upgrade tensorflow <span class=\"comment\"># for Python 3.n</span></span><br><span class=\"line\">(tensorflow)$ pip install --upgrade tensorflow-gpu <span class=\"comment\"># for Python 2.7 and GPU</span></span><br><span class=\"line\">(tensorflow)$ pip3 install --upgrade tensorflow-gpu <span class=\"comment\"># for Python 3.n and GPU</span></span><br></pre></td></tr></table></figure>\n<ol start=\"6\">\n<li>可选）如果步骤4失败（可能是因为低于8.1版本的pip），按下面格式键入指令在激活的virtualenv环境中安装TensorFlow：</li>\n</ol>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">(tensorflow)$ pip install --upgrade tfBinaryURL <span class=\"comment\"># Python 2.7</span></span><br><span class=\"line\">(tensorflow)$ pip3 install --upgrade tfBinaryURL <span class=\"comment\"># Python 3.n</span></span><br></pre></td></tr></table></figure>\n<p><code>tfBinaryURL</code>定义了TensorFlow Python包的URL。根据操作系统，Python版本和GPU支持选择合适的<code>tfBinaryURL</code>值。在这里为你系统找合适的<code>tfBinaryURL</code>值。例如，如果你是为Linux,Python 3.4 并且支持GPU,键入下列命令在激活的virtualenv环境中安装TensorFlow：<br><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">(tensorflow)$ pip3 install --upgrade</span><br><span class=\"line\">https://storage.googleapis.com/tensorflow/linux/cpu/tensorflow-1.3.0-cp34-cp34m-linux_x86_64.whl</span><br></pre></td></tr></table></figure></p>\n<p>如果安装遇到问题，参考常见安装问题</p>\n<h1 id=\"4-下一步\"><a href=\"#4-下一步\" class=\"headerlink\" title=\"4 下一步\"></a>4 下一步</h1><p>在安装完TensorFlow后，验证安装。<br>注意每当你使用TensorFlow的时候你必须激活virtual环境。如果该环境当时没有激活，调用下面的指令：<br><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">source</span> ~/tensorflow/bin/activate <span class=\"comment\"># bash, sh, ksh, or zsh</span></span><br><span class=\"line\"><span class=\"built_in\">source</span> ~/tensorflow/bin/activate.csh <span class=\"comment\"># csh or tcsh</span></span><br></pre></td></tr></table></figure></p>\n<p>当该环境激活时，你可以从这个shell中运行TensorFlow程序。你的提示将变成下面这样证明tensorflow环境已经激活：<br><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">(tensorflow)$</span><br></pre></td></tr></table></figure></p>\n<p>当你使用完TensorFlow后，调用下面的<code>deactivate</code>函数来停止环境:<br><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">(tensorflow)$ deactivate</span><br></pre></td></tr></table></figure></p>\n<p>提示符会翻转成默认的（在<code>PS1</code>环境变量里定义的）。</p>\n<h1 id=\"5-卸载TensorFlow\"><a href=\"#5-卸载TensorFlow\" class=\"headerlink\" title=\"5 卸载TensorFlow\"></a>5 卸载TensorFlow</h1><p>要卸载TensorFLow的话，移除你创建的树。例如：<br><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">rm -r targetDirectory</span><br></pre></td></tr></table></figure></p>\n<p><em>未完待续</em></p>\n<h1 id=\"Reference\"><a href=\"#Reference\" class=\"headerlink\" title=\"Reference\"></a>Reference</h1><p><small>[1] Google.tensorflow[EB/OL].<a href=\"https://tensorflow.google.cn\" target=\"_blank\" rel=\"noopener\">https://tensorflow.google.cn</a> .2017.</small></p>"},{"title":"【译】Node.js框架:最适合web和应用程序开发的10个框架","date":"2018-05-08T13:43:18.000Z","_content":"{% note info no-icon %}\n原文:https://noeticforce.com/best-nodejs-frameworks-for-web-and-app-development\n作者:Noetic Sunil\n{% endnote %}\n<!-- more -->\n在浏览器以外运行JavaScript对于JavaScript爱好者来说非常神奇，同时也肯定是Web应用程序开发界最受欢迎的进步之一。全球各地的开发者全力接纳了Node.js。\n\n对于新手来说，Node.js是允许在浏览器之外服务器上运行JavaScript代码的一种JavaScript。它基于谷歌Chrome的V8虚拟引擎建立的，这一引擎用于在Chrome浏览器中支持JavaScript。\n\nNode.js逐渐普及是因为它可以只使用JavaScript就可以建立大规模、实时性、可扩展的移动和Web应用程序。\n\n随着Node.js生态系统的发展，框架也开始着手加快工作流程。有许多的Node.js框架，允许构建实时的端到端网络应用，而无需任何其他第三方Web服务器、应用服务器、工具和技术。\n\n什么样的框架符合要求呢？\n\n通用性的Node框架就像Express，Koa 和Hapi更加灵活，让你做你想要的一切，最大限度的满足开发需求。但是，在最初需要投入更多的努力，更加依靠开发者作出正确的决策。\n\n而另一方面，像Mean.io，Meteor, Derby和Mojito，有自己的标准结构和技术体系，灵活性较差。然而这些框架不会给开发者太多做错误决策的空间。\n\n让我们来看看目前可用的最好、最强大的Node.js框架，并帮助建立实时的、各种规模和复杂性的可扩展 Web 应用程序。\n# 1 Node.js Express\n对于一个已经在使用Node.js的开发人员来说，Express 或者\"Node.js express\"并不是一个新鲜事。Express框架提供了对Node.js原生API比较好的封装，从而使开发者更加容易地使用Node.js。\n\nExpress 框架提供了用来开发强壮的 Web 移动应用，以及 API 的所有功能。并且开发人员还能够方便地为它开发插件和扩展，从而增加 Express 的能力。下面列出了一些 Express 提供的基本的功\n能：\n1. 可以和任何的第三方数据库进行通讯；\n2. 可以使用任何的用户认证方式；\n3. 可以使用任何符合 Express 接口定义的模板引擎；\n4. 可以按照需要定义工程目录。\n\n通过使用 Node.js Express，可以使用更少的代码来实现功能。至少通过使用 Node.js Express，可以实现中间件来响应 http 请求，可以定义路由表来定义对不同请求的响应函数，还可以使用模板引擎来输出 html 页面。\n\n对于一个 Node.js 开发新手来说，Express 还提供了如下的好处：\n1. Express 的学习曲线并不陡峭，可以很快上手；\n2. Express 有非常庞大的社区，和组织良好的文档，新手可以很容易得到所需要的一切。Express \n根据 MIT 协议进行开源，目前 StrongLoop 对它提供支持。\n\n可以通过 Express 的官方网站 expressjs.com 获得更多的信息。\n# 2 Sails.js (Node.js mvc)\nSail 作为一个非常稳固的 Node.js 框架，提供了建立任何规模的 web 应用所需要的所有功能。\n\nSail.js 在底层使用了 Express 框架来提供对 http 请求的处理，同时使用 Socket.IO 框架来处WebSocket 请求。同时作为一个前端应用开发框架，它允许开发人员选择其熟悉的技术来开发应用。\n\n同时 Sail.js 也通过 waterline 框架实现了 ORM 功能。通过这个功能，应用程序可以在不进行大的修改的前提下，就可以从一个后端数据库，切换到另外一个后端数据库（也可以是一个 NoSQL 数据库）。\n\nSail 特别适合用来开发对数据的实时更新有较高要求的应用，比如多人棋类游戏，单页 Web 应用等等。如果对 Ruby, Django或者Zend有一定的了解，那么将非常容易理解 Sail 中的概念。\n\n简单来说，Sail.js 既给开发者提供了一个优秀的 MVC 框架，也提供了一定的灵活性，让开发者可以自主选择前端开发方式和后端的数据库。 Sail.js 是由 Mike McNeil 创建的，现在由 Treeline and balderdash 提供支持。Sail.js 在 MIT 协议下开源。\n\n关于 Sail，可以通过官方网站[sailsjs.org](sailsjs.org)来了解更多内容。\n# 3 KOA\nKOA 是 Node.js mvc 框架的后起之秀，在 2013 第四个季度才发布了第一个版本。开发 KOA 的人员基本来自 Express 开发团队，TJ Holowaychuk 是 KOA 开发团队的领导者。虽然 KOA 大部分开发人员来自 Express，但是他们使用了完全不同的技术来开发 KOA，并且 KOA 正成为 Express 一个强有力的竞争对手。\n\nKOA 框架的核心是 ES6 的 generator。KOA 使用 generator 来实现中间件的流程控制，使用try/catch 来增强异常处理，同时在 KOA 框架中你再也看不到复杂的 callback 回调了。\n\nKOA 框架本身非常小，只打包了一些必要的功能，但是它本身通过良好的模块化组织，让开发人员可以按照自己的想法来实现一个扩展性非常好的应用。\n\n许多 JavaScript/Node.js 的忠实开发者都开始选择使用 KOA 来开发新的项目，因为 KOA 提供了更多的灵活性开发应用程序。\n\n可以通过[koajs.com](koajs.com)获取更多的信息。\n# 4 Meteor\nMeteor 框架是 Node.js 上最出色的全栈框架。项目在 GitHub 上有 28K+的赞，拥有大量的自定义包，庞大的社区支持，非常好的教程和文档。在这个领域 Meteor 毫无疑问是王者，可以用它构建纯Javascript 的实时 Web 和手机应用。\n\nMeteor 最优秀的部分是，无论是服务器端的数据库访问，业务逻辑实现，还是客户端的展示，所有的流程都是无缝连接，开箱即用。整个框架使用统一的 API，Meteor API 同时适用于客户端和服务器端。\n\n它使用的 DDP 协议可以在后端连接简单的数据库服务、企业数据仓库、甚至 IOT 传感器。\n\nMeteor 带有自己默认的栈，但又有足够的灵活性，可以选择自己的技术方案。如果不需要尝试其他的框架或者没有其他的条件限制，可以直接使用默认配置，进行快速地应用开发。\n\nMeteor 拥有专业化的开发团队，顶级风投的大量资金支持，这都让 Meteor 能够时刻保持业界领先。\n\n可以通过 meteor.com 网站进一步了解 Meteor。\n# 5 Derby.js\nDerby.JS 跟它的直接竞争对手 Meteor、Mean.io、以及 Mojito 一样，也是一个全栈框架。它运行在 Node.js+ mongo + Redis 的上层。Derby 主要部分是一个叫做 Racer 的数据同步引擎，它能够让数据在数据库、服务器和浏览器之间的同步变得轻而易举。\n\nRacer 的确能够让基于 Derby 框架的应用运行地更快，无论是在浏览器端还是服务器端，对于单页面应用来说，它都是一个完美的选择方案。Derby 经常被用来和业界领先的 Meteor 进行比较，Meteor 项目已经开发了一段很长时间，因而能够提供更多的开箱即用的功能，使得在更短时间内开发复杂的 Web 应用变得更加容易。\n\n而 Derby 更适合于需要更快运行速度的应用，并且它的模块化方式能够让应用更灵活，更容易扩展。Derby 最近的发展有些缓慢，但它并没有出局，仍有改写 Node.js 全栈框架游戏规则的潜力。\n\n可以通过[derbyjs.com](derbyjs.com)网站进一步了解 Derby。\n# 6 Flatiron.js (Node.js MVC 框架)\nFlatiron 框架背后的核心思想是能使用它所提供的组件以及一些第三方库构建自己的全栈框架。很酷不是吗？我个人十分的喜欢这种方式。然而，这带来的是更高的复杂度，并有可能会被使用错误组件的开发者搞得一团糟。\n\n它可以称之为一个由多个相互独立的组件松散地组建起来的全栈 MVC 框架。Flatiron 框架支持Director，一个从头到脚都使用 JavaScript 搭建起来的，并不需要任何依赖项的 URL 路由组件。通过一个叫 Plates 的模板引擎，Flatiron 能够支持模版语言，然而数据管理是通过 json 实现的，并能与任何一种数据库一起使用。Flatiron 现在由 Nodejitsu 以及其他的社区成员在进行维护，并做的相当不错，是一个不那么流行却值得一看的框架。\n\n可以在[flatironjs.org](flatironjs.org)上获得更多信息。\n# 7 Hapi\nHapi 是为数不多的不依赖于 Express 的 Node.js 框架，现在甚至已经完全独立于 Express 了。在最近一段时间中，很多开发者选择了 Hapi 而非 Express，这使得它或多或少变为了 Express 的竞争对手。\n\nHapi 在众多 nodejs 的框架中并非一个老牌选手，然而它却成功的在这当中创造了自己的一个生态圈。Hapi 致力于完全的分离 node HTTP 服务器、路由以及业务逻辑，并更多的聚焦于如何尽可能的通过配置而非代码来控制东西。\n\nHapi 最初是由 Eran Hammer 以及在 Walmart labs 的团队为了工作需要开发的。其后便以极快的速度受到了欢迎，现在已在 MIT 许可下成为一个开源的框架，能够免费的被下载和使用。\n\n迪士尼、雅虎、Pebble、beats 音乐以及 Walmart 这样的公司都在使用 HAPI 作为他们旗下一个或多个项目的网络应用框架，它的影响力便可见一斑了。\n\n可以在[hapijs.com](hapijs.com)上找到更多关于 Hapi 的信息。\n# 8 Mean.IO\nMean 是 Mongo DB，Express，Angular 和 Node.js 捆绑在一起的组合。基本上说只要有它，就拥有了数据库层，服务器端和网页前端的整套工具，足以开发所有类型的现代网络应用。\n\nMean 是一个完整独立的包，它涵盖了应用开发的所有方面。尤其适合于那些需要快速开始开发的人。它内置多种技术而且在联合使用时非常好。可以用于创建任意大小和复杂度的应用。\n\n使用 Mean，开发者可以避免经历混合和匹配不同的技术栈。通过 mean 栈，可以减少安装和配置 MongoDB，Express，Angular 和 Node.js 需要的时间。Mean.io 的另一个巨大好处就是所有的栈都使用 JavaScript，服务器端 Express 对 MongoDB 的访问(json)和通多 Angular 从 Node.js 到客户端。\n\n通过[mean.io](mean.io)了解更多 Mean.io 的相关信息。\n\n还有一个名为 mean.js 的 mean 分支也相当流行\n# 9 Mojito\nMojito 由 Yahoo 开发并迅速取得成功。然而很快又带着关于框架的空前的成功坐到了冷板凳，就像 Meteor 和 Mean stack 那样。\n\nMojito 同样是一个 MVC 应用框架，非常适合于创建基于 HTML5，JavaScript 和 CSS3 的高性能的网络和手机应用。Mojito 的根本目标是提供一个框架，该框架用于构建标准的基于跨平台的应用。使之可以同时运行在客户端和服务器端，并实现高性能。\n\n可以在 Yahoo 开发者网页—— mojito 获得更多信息。\n# 10 Socket Stream\nSocketStream 是一个有趣的框架，专注于客户端和服务端数据的快速同步，它致力于前后端数据的实时更新。\n\n它最大的特点是不严格要求你使用指定的客户端技术，也不限定数据库的 ORM。我趋向于将它和有同样功能的兄弟项目 Sail.js 做比较，它更适合做单页 Web 应用，多用户游戏，聊天客户端，网络应用，交易平台以及所有的需要将数据从服务端实时推送到客户端的应用。\n\n服务端和客户端使用 JSON 来传输数据，比较理想的是使用 websockets 在服务端事件发生时自动将数据推送到客户端，Socket stream 是由 Owen Barnes 创建，现在由 Paul Jensen 和团队维护，他们的工作让这个框架得到了应有的荣耀。\n\nSocketStream framework 在最近几月获得了很好的发展，未来一片光明。\n\ncketStream 信息请浏览 github 上的 socketstream。\n\n优秀框架还有：total.js, Geddy.JS, Locomotive, compound 和 Restify。\n# 11 结论\nWeb 和应用开发的变化是非常快速的，开发人员正在转向快速致力于快速、纯净的项目交付框架。\n\n使用 Node.js 框架的最大优势是提供了高层级结构的盒子，可以关注扩展应用程序而不用在构建和定义基础上消耗精力。\n\n框架提供了多样的特性，工作在不同的底层，试图解决构建实时的常见问题，并解决了可伸缩的和复杂的 Web 应用程序在速度上的问题。在这篇文章里讨论的框架是目前市场上最好的 Node.js 框架。","source":"_posts/zh-CN/【译]】Node.js 框架：最适合 web 和应用程序开发的 10 个框架.md","raw":"---\ntitle: 【译】Node.js框架:最适合web和应用程序开发的10个框架\ndate: 2018-05-08 21:43:18\ntags:\n  - Node.js\ncategories: translate\n---\n{% note info no-icon %}\n原文:https://noeticforce.com/best-nodejs-frameworks-for-web-and-app-development\n作者:Noetic Sunil\n{% endnote %}\n<!-- more -->\n在浏览器以外运行JavaScript对于JavaScript爱好者来说非常神奇，同时也肯定是Web应用程序开发界最受欢迎的进步之一。全球各地的开发者全力接纳了Node.js。\n\n对于新手来说，Node.js是允许在浏览器之外服务器上运行JavaScript代码的一种JavaScript。它基于谷歌Chrome的V8虚拟引擎建立的，这一引擎用于在Chrome浏览器中支持JavaScript。\n\nNode.js逐渐普及是因为它可以只使用JavaScript就可以建立大规模、实时性、可扩展的移动和Web应用程序。\n\n随着Node.js生态系统的发展，框架也开始着手加快工作流程。有许多的Node.js框架，允许构建实时的端到端网络应用，而无需任何其他第三方Web服务器、应用服务器、工具和技术。\n\n什么样的框架符合要求呢？\n\n通用性的Node框架就像Express，Koa 和Hapi更加灵活，让你做你想要的一切，最大限度的满足开发需求。但是，在最初需要投入更多的努力，更加依靠开发者作出正确的决策。\n\n而另一方面，像Mean.io，Meteor, Derby和Mojito，有自己的标准结构和技术体系，灵活性较差。然而这些框架不会给开发者太多做错误决策的空间。\n\n让我们来看看目前可用的最好、最强大的Node.js框架，并帮助建立实时的、各种规模和复杂性的可扩展 Web 应用程序。\n# 1 Node.js Express\n对于一个已经在使用Node.js的开发人员来说，Express 或者\"Node.js express\"并不是一个新鲜事。Express框架提供了对Node.js原生API比较好的封装，从而使开发者更加容易地使用Node.js。\n\nExpress 框架提供了用来开发强壮的 Web 移动应用，以及 API 的所有功能。并且开发人员还能够方便地为它开发插件和扩展，从而增加 Express 的能力。下面列出了一些 Express 提供的基本的功\n能：\n1. 可以和任何的第三方数据库进行通讯；\n2. 可以使用任何的用户认证方式；\n3. 可以使用任何符合 Express 接口定义的模板引擎；\n4. 可以按照需要定义工程目录。\n\n通过使用 Node.js Express，可以使用更少的代码来实现功能。至少通过使用 Node.js Express，可以实现中间件来响应 http 请求，可以定义路由表来定义对不同请求的响应函数，还可以使用模板引擎来输出 html 页面。\n\n对于一个 Node.js 开发新手来说，Express 还提供了如下的好处：\n1. Express 的学习曲线并不陡峭，可以很快上手；\n2. Express 有非常庞大的社区，和组织良好的文档，新手可以很容易得到所需要的一切。Express \n根据 MIT 协议进行开源，目前 StrongLoop 对它提供支持。\n\n可以通过 Express 的官方网站 expressjs.com 获得更多的信息。\n# 2 Sails.js (Node.js mvc)\nSail 作为一个非常稳固的 Node.js 框架，提供了建立任何规模的 web 应用所需要的所有功能。\n\nSail.js 在底层使用了 Express 框架来提供对 http 请求的处理，同时使用 Socket.IO 框架来处WebSocket 请求。同时作为一个前端应用开发框架，它允许开发人员选择其熟悉的技术来开发应用。\n\n同时 Sail.js 也通过 waterline 框架实现了 ORM 功能。通过这个功能，应用程序可以在不进行大的修改的前提下，就可以从一个后端数据库，切换到另外一个后端数据库（也可以是一个 NoSQL 数据库）。\n\nSail 特别适合用来开发对数据的实时更新有较高要求的应用，比如多人棋类游戏，单页 Web 应用等等。如果对 Ruby, Django或者Zend有一定的了解，那么将非常容易理解 Sail 中的概念。\n\n简单来说，Sail.js 既给开发者提供了一个优秀的 MVC 框架，也提供了一定的灵活性，让开发者可以自主选择前端开发方式和后端的数据库。 Sail.js 是由 Mike McNeil 创建的，现在由 Treeline and balderdash 提供支持。Sail.js 在 MIT 协议下开源。\n\n关于 Sail，可以通过官方网站[sailsjs.org](sailsjs.org)来了解更多内容。\n# 3 KOA\nKOA 是 Node.js mvc 框架的后起之秀，在 2013 第四个季度才发布了第一个版本。开发 KOA 的人员基本来自 Express 开发团队，TJ Holowaychuk 是 KOA 开发团队的领导者。虽然 KOA 大部分开发人员来自 Express，但是他们使用了完全不同的技术来开发 KOA，并且 KOA 正成为 Express 一个强有力的竞争对手。\n\nKOA 框架的核心是 ES6 的 generator。KOA 使用 generator 来实现中间件的流程控制，使用try/catch 来增强异常处理，同时在 KOA 框架中你再也看不到复杂的 callback 回调了。\n\nKOA 框架本身非常小，只打包了一些必要的功能，但是它本身通过良好的模块化组织，让开发人员可以按照自己的想法来实现一个扩展性非常好的应用。\n\n许多 JavaScript/Node.js 的忠实开发者都开始选择使用 KOA 来开发新的项目，因为 KOA 提供了更多的灵活性开发应用程序。\n\n可以通过[koajs.com](koajs.com)获取更多的信息。\n# 4 Meteor\nMeteor 框架是 Node.js 上最出色的全栈框架。项目在 GitHub 上有 28K+的赞，拥有大量的自定义包，庞大的社区支持，非常好的教程和文档。在这个领域 Meteor 毫无疑问是王者，可以用它构建纯Javascript 的实时 Web 和手机应用。\n\nMeteor 最优秀的部分是，无论是服务器端的数据库访问，业务逻辑实现，还是客户端的展示，所有的流程都是无缝连接，开箱即用。整个框架使用统一的 API，Meteor API 同时适用于客户端和服务器端。\n\n它使用的 DDP 协议可以在后端连接简单的数据库服务、企业数据仓库、甚至 IOT 传感器。\n\nMeteor 带有自己默认的栈，但又有足够的灵活性，可以选择自己的技术方案。如果不需要尝试其他的框架或者没有其他的条件限制，可以直接使用默认配置，进行快速地应用开发。\n\nMeteor 拥有专业化的开发团队，顶级风投的大量资金支持，这都让 Meteor 能够时刻保持业界领先。\n\n可以通过 meteor.com 网站进一步了解 Meteor。\n# 5 Derby.js\nDerby.JS 跟它的直接竞争对手 Meteor、Mean.io、以及 Mojito 一样，也是一个全栈框架。它运行在 Node.js+ mongo + Redis 的上层。Derby 主要部分是一个叫做 Racer 的数据同步引擎，它能够让数据在数据库、服务器和浏览器之间的同步变得轻而易举。\n\nRacer 的确能够让基于 Derby 框架的应用运行地更快，无论是在浏览器端还是服务器端，对于单页面应用来说，它都是一个完美的选择方案。Derby 经常被用来和业界领先的 Meteor 进行比较，Meteor 项目已经开发了一段很长时间，因而能够提供更多的开箱即用的功能，使得在更短时间内开发复杂的 Web 应用变得更加容易。\n\n而 Derby 更适合于需要更快运行速度的应用，并且它的模块化方式能够让应用更灵活，更容易扩展。Derby 最近的发展有些缓慢，但它并没有出局，仍有改写 Node.js 全栈框架游戏规则的潜力。\n\n可以通过[derbyjs.com](derbyjs.com)网站进一步了解 Derby。\n# 6 Flatiron.js (Node.js MVC 框架)\nFlatiron 框架背后的核心思想是能使用它所提供的组件以及一些第三方库构建自己的全栈框架。很酷不是吗？我个人十分的喜欢这种方式。然而，这带来的是更高的复杂度，并有可能会被使用错误组件的开发者搞得一团糟。\n\n它可以称之为一个由多个相互独立的组件松散地组建起来的全栈 MVC 框架。Flatiron 框架支持Director，一个从头到脚都使用 JavaScript 搭建起来的，并不需要任何依赖项的 URL 路由组件。通过一个叫 Plates 的模板引擎，Flatiron 能够支持模版语言，然而数据管理是通过 json 实现的，并能与任何一种数据库一起使用。Flatiron 现在由 Nodejitsu 以及其他的社区成员在进行维护，并做的相当不错，是一个不那么流行却值得一看的框架。\n\n可以在[flatironjs.org](flatironjs.org)上获得更多信息。\n# 7 Hapi\nHapi 是为数不多的不依赖于 Express 的 Node.js 框架，现在甚至已经完全独立于 Express 了。在最近一段时间中，很多开发者选择了 Hapi 而非 Express，这使得它或多或少变为了 Express 的竞争对手。\n\nHapi 在众多 nodejs 的框架中并非一个老牌选手，然而它却成功的在这当中创造了自己的一个生态圈。Hapi 致力于完全的分离 node HTTP 服务器、路由以及业务逻辑，并更多的聚焦于如何尽可能的通过配置而非代码来控制东西。\n\nHapi 最初是由 Eran Hammer 以及在 Walmart labs 的团队为了工作需要开发的。其后便以极快的速度受到了欢迎，现在已在 MIT 许可下成为一个开源的框架，能够免费的被下载和使用。\n\n迪士尼、雅虎、Pebble、beats 音乐以及 Walmart 这样的公司都在使用 HAPI 作为他们旗下一个或多个项目的网络应用框架，它的影响力便可见一斑了。\n\n可以在[hapijs.com](hapijs.com)上找到更多关于 Hapi 的信息。\n# 8 Mean.IO\nMean 是 Mongo DB，Express，Angular 和 Node.js 捆绑在一起的组合。基本上说只要有它，就拥有了数据库层，服务器端和网页前端的整套工具，足以开发所有类型的现代网络应用。\n\nMean 是一个完整独立的包，它涵盖了应用开发的所有方面。尤其适合于那些需要快速开始开发的人。它内置多种技术而且在联合使用时非常好。可以用于创建任意大小和复杂度的应用。\n\n使用 Mean，开发者可以避免经历混合和匹配不同的技术栈。通过 mean 栈，可以减少安装和配置 MongoDB，Express，Angular 和 Node.js 需要的时间。Mean.io 的另一个巨大好处就是所有的栈都使用 JavaScript，服务器端 Express 对 MongoDB 的访问(json)和通多 Angular 从 Node.js 到客户端。\n\n通过[mean.io](mean.io)了解更多 Mean.io 的相关信息。\n\n还有一个名为 mean.js 的 mean 分支也相当流行\n# 9 Mojito\nMojito 由 Yahoo 开发并迅速取得成功。然而很快又带着关于框架的空前的成功坐到了冷板凳，就像 Meteor 和 Mean stack 那样。\n\nMojito 同样是一个 MVC 应用框架，非常适合于创建基于 HTML5，JavaScript 和 CSS3 的高性能的网络和手机应用。Mojito 的根本目标是提供一个框架，该框架用于构建标准的基于跨平台的应用。使之可以同时运行在客户端和服务器端，并实现高性能。\n\n可以在 Yahoo 开发者网页—— mojito 获得更多信息。\n# 10 Socket Stream\nSocketStream 是一个有趣的框架，专注于客户端和服务端数据的快速同步，它致力于前后端数据的实时更新。\n\n它最大的特点是不严格要求你使用指定的客户端技术，也不限定数据库的 ORM。我趋向于将它和有同样功能的兄弟项目 Sail.js 做比较，它更适合做单页 Web 应用，多用户游戏，聊天客户端，网络应用，交易平台以及所有的需要将数据从服务端实时推送到客户端的应用。\n\n服务端和客户端使用 JSON 来传输数据，比较理想的是使用 websockets 在服务端事件发生时自动将数据推送到客户端，Socket stream 是由 Owen Barnes 创建，现在由 Paul Jensen 和团队维护，他们的工作让这个框架得到了应有的荣耀。\n\nSocketStream framework 在最近几月获得了很好的发展，未来一片光明。\n\ncketStream 信息请浏览 github 上的 socketstream。\n\n优秀框架还有：total.js, Geddy.JS, Locomotive, compound 和 Restify。\n# 11 结论\nWeb 和应用开发的变化是非常快速的，开发人员正在转向快速致力于快速、纯净的项目交付框架。\n\n使用 Node.js 框架的最大优势是提供了高层级结构的盒子，可以关注扩展应用程序而不用在构建和定义基础上消耗精力。\n\n框架提供了多样的特性，工作在不同的底层，试图解决构建实时的常见问题，并解决了可伸缩的和复杂的 Web 应用程序在速度上的问题。在这篇文章里讨论的框架是目前市场上最好的 Node.js 框架。","slug":"【译]】Node.js 框架：最适合 web 和应用程序开发的 10 个框架","published":1,"lang":"zh-CN","updated":"2019-07-21T06:52:17.317Z","_id":"cjycl6ghn0000syjx7tl3ysvn","comments":1,"layout":"post","photos":[],"link":"","content":"<link rel=\"stylesheet\" class=\"aplayer-secondary-style-marker\" href=\"/assets/css/APlayer.min.css\"><script src=\"/assets/js/APlayer.min.js\" class=\"aplayer-secondary-script-marker\"></script><script class=\"meting-secondary-script-marker\" src=\"/assets/js/Meting.min.js\"></script><link rel=\"stylesheet\" type=\"text/css\" href=\"https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css\"><div class=\"note info no-icon\">\n            <p>原文:<a href=\"https://noeticforce.com/best-nodejs-frameworks-for-web-and-app-development\" target=\"_blank\" rel=\"noopener\">https://noeticforce.com/best-nodejs-frameworks-for-web-and-app-development</a><br>作者:Noetic Sunil</p>\n          </div>\n<a id=\"more\"></a>\n<p>在浏览器以外运行JavaScript对于JavaScript爱好者来说非常神奇，同时也肯定是Web应用程序开发界最受欢迎的进步之一。全球各地的开发者全力接纳了Node.js。</p>\n<p>对于新手来说，Node.js是允许在浏览器之外服务器上运行JavaScript代码的一种JavaScript。它基于谷歌Chrome的V8虚拟引擎建立的，这一引擎用于在Chrome浏览器中支持JavaScript。</p>\n<p>Node.js逐渐普及是因为它可以只使用JavaScript就可以建立大规模、实时性、可扩展的移动和Web应用程序。</p>\n<p>随着Node.js生态系统的发展，框架也开始着手加快工作流程。有许多的Node.js框架，允许构建实时的端到端网络应用，而无需任何其他第三方Web服务器、应用服务器、工具和技术。</p>\n<p>什么样的框架符合要求呢？</p>\n<p>通用性的Node框架就像Express，Koa 和Hapi更加灵活，让你做你想要的一切，最大限度的满足开发需求。但是，在最初需要投入更多的努力，更加依靠开发者作出正确的决策。</p>\n<p>而另一方面，像Mean.io，Meteor, Derby和Mojito，有自己的标准结构和技术体系，灵活性较差。然而这些框架不会给开发者太多做错误决策的空间。</p>\n<p>让我们来看看目前可用的最好、最强大的Node.js框架，并帮助建立实时的、各种规模和复杂性的可扩展 Web 应用程序。</p>\n<h1 id=\"1-Node-js-Express\"><a href=\"#1-Node-js-Express\" class=\"headerlink\" title=\"1 Node.js Express\"></a>1 Node.js Express</h1><p>对于一个已经在使用Node.js的开发人员来说，Express 或者”Node.js express”并不是一个新鲜事。Express框架提供了对Node.js原生API比较好的封装，从而使开发者更加容易地使用Node.js。</p>\n<p>Express 框架提供了用来开发强壮的 Web 移动应用，以及 API 的所有功能。并且开发人员还能够方便地为它开发插件和扩展，从而增加 Express 的能力。下面列出了一些 Express 提供的基本的功<br>能：</p>\n<ol>\n<li>可以和任何的第三方数据库进行通讯；</li>\n<li>可以使用任何的用户认证方式；</li>\n<li>可以使用任何符合 Express 接口定义的模板引擎；</li>\n<li>可以按照需要定义工程目录。</li>\n</ol>\n<p>通过使用 Node.js Express，可以使用更少的代码来实现功能。至少通过使用 Node.js Express，可以实现中间件来响应 http 请求，可以定义路由表来定义对不同请求的响应函数，还可以使用模板引擎来输出 html 页面。</p>\n<p>对于一个 Node.js 开发新手来说，Express 还提供了如下的好处：</p>\n<ol>\n<li>Express 的学习曲线并不陡峭，可以很快上手；</li>\n<li>Express 有非常庞大的社区，和组织良好的文档，新手可以很容易得到所需要的一切。Express<br>根据 MIT 协议进行开源，目前 StrongLoop 对它提供支持。</li>\n</ol>\n<p>可以通过 Express 的官方网站 expressjs.com 获得更多的信息。</p>\n<h1 id=\"2-Sails-js-Node-js-mvc\"><a href=\"#2-Sails-js-Node-js-mvc\" class=\"headerlink\" title=\"2 Sails.js (Node.js mvc)\"></a>2 Sails.js (Node.js mvc)</h1><p>Sail 作为一个非常稳固的 Node.js 框架，提供了建立任何规模的 web 应用所需要的所有功能。</p>\n<p>Sail.js 在底层使用了 Express 框架来提供对 http 请求的处理，同时使用 Socket.IO 框架来处WebSocket 请求。同时作为一个前端应用开发框架，它允许开发人员选择其熟悉的技术来开发应用。</p>\n<p>同时 Sail.js 也通过 waterline 框架实现了 ORM 功能。通过这个功能，应用程序可以在不进行大的修改的前提下，就可以从一个后端数据库，切换到另外一个后端数据库（也可以是一个 NoSQL 数据库）。</p>\n<p>Sail 特别适合用来开发对数据的实时更新有较高要求的应用，比如多人棋类游戏，单页 Web 应用等等。如果对 Ruby, Django或者Zend有一定的了解，那么将非常容易理解 Sail 中的概念。</p>\n<p>简单来说，Sail.js 既给开发者提供了一个优秀的 MVC 框架，也提供了一定的灵活性，让开发者可以自主选择前端开发方式和后端的数据库。 Sail.js 是由 Mike McNeil 创建的，现在由 Treeline and balderdash 提供支持。Sail.js 在 MIT 协议下开源。</p>\n<p>关于 Sail，可以通过官方网站<a href=\"sailsjs.org\">sailsjs.org</a>来了解更多内容。</p>\n<h1 id=\"3-KOA\"><a href=\"#3-KOA\" class=\"headerlink\" title=\"3 KOA\"></a>3 KOA</h1><p>KOA 是 Node.js mvc 框架的后起之秀，在 2013 第四个季度才发布了第一个版本。开发 KOA 的人员基本来自 Express 开发团队，TJ Holowaychuk 是 KOA 开发团队的领导者。虽然 KOA 大部分开发人员来自 Express，但是他们使用了完全不同的技术来开发 KOA，并且 KOA 正成为 Express 一个强有力的竞争对手。</p>\n<p>KOA 框架的核心是 ES6 的 generator。KOA 使用 generator 来实现中间件的流程控制，使用try/catch 来增强异常处理，同时在 KOA 框架中你再也看不到复杂的 callback 回调了。</p>\n<p>KOA 框架本身非常小，只打包了一些必要的功能，但是它本身通过良好的模块化组织，让开发人员可以按照自己的想法来实现一个扩展性非常好的应用。</p>\n<p>许多 JavaScript/Node.js 的忠实开发者都开始选择使用 KOA 来开发新的项目，因为 KOA 提供了更多的灵活性开发应用程序。</p>\n<p>可以通过<a href=\"koajs.com\">koajs.com</a>获取更多的信息。</p>\n<h1 id=\"4-Meteor\"><a href=\"#4-Meteor\" class=\"headerlink\" title=\"4 Meteor\"></a>4 Meteor</h1><p>Meteor 框架是 Node.js 上最出色的全栈框架。项目在 GitHub 上有 28K+的赞，拥有大量的自定义包，庞大的社区支持，非常好的教程和文档。在这个领域 Meteor 毫无疑问是王者，可以用它构建纯Javascript 的实时 Web 和手机应用。</p>\n<p>Meteor 最优秀的部分是，无论是服务器端的数据库访问，业务逻辑实现，还是客户端的展示，所有的流程都是无缝连接，开箱即用。整个框架使用统一的 API，Meteor API 同时适用于客户端和服务器端。</p>\n<p>它使用的 DDP 协议可以在后端连接简单的数据库服务、企业数据仓库、甚至 IOT 传感器。</p>\n<p>Meteor 带有自己默认的栈，但又有足够的灵活性，可以选择自己的技术方案。如果不需要尝试其他的框架或者没有其他的条件限制，可以直接使用默认配置，进行快速地应用开发。</p>\n<p>Meteor 拥有专业化的开发团队，顶级风投的大量资金支持，这都让 Meteor 能够时刻保持业界领先。</p>\n<p>可以通过 meteor.com 网站进一步了解 Meteor。</p>\n<h1 id=\"5-Derby-js\"><a href=\"#5-Derby-js\" class=\"headerlink\" title=\"5 Derby.js\"></a>5 Derby.js</h1><p>Derby.JS 跟它的直接竞争对手 Meteor、Mean.io、以及 Mojito 一样，也是一个全栈框架。它运行在 Node.js+ mongo + Redis 的上层。Derby 主要部分是一个叫做 Racer 的数据同步引擎，它能够让数据在数据库、服务器和浏览器之间的同步变得轻而易举。</p>\n<p>Racer 的确能够让基于 Derby 框架的应用运行地更快，无论是在浏览器端还是服务器端，对于单页面应用来说，它都是一个完美的选择方案。Derby 经常被用来和业界领先的 Meteor 进行比较，Meteor 项目已经开发了一段很长时间，因而能够提供更多的开箱即用的功能，使得在更短时间内开发复杂的 Web 应用变得更加容易。</p>\n<p>而 Derby 更适合于需要更快运行速度的应用，并且它的模块化方式能够让应用更灵活，更容易扩展。Derby 最近的发展有些缓慢，但它并没有出局，仍有改写 Node.js 全栈框架游戏规则的潜力。</p>\n<p>可以通过<a href=\"derbyjs.com\">derbyjs.com</a>网站进一步了解 Derby。</p>\n<h1 id=\"6-Flatiron-js-Node-js-MVC-框架\"><a href=\"#6-Flatiron-js-Node-js-MVC-框架\" class=\"headerlink\" title=\"6 Flatiron.js (Node.js MVC 框架)\"></a>6 Flatiron.js (Node.js MVC 框架)</h1><p>Flatiron 框架背后的核心思想是能使用它所提供的组件以及一些第三方库构建自己的全栈框架。很酷不是吗？我个人十分的喜欢这种方式。然而，这带来的是更高的复杂度，并有可能会被使用错误组件的开发者搞得一团糟。</p>\n<p>它可以称之为一个由多个相互独立的组件松散地组建起来的全栈 MVC 框架。Flatiron 框架支持Director，一个从头到脚都使用 JavaScript 搭建起来的，并不需要任何依赖项的 URL 路由组件。通过一个叫 Plates 的模板引擎，Flatiron 能够支持模版语言，然而数据管理是通过 json 实现的，并能与任何一种数据库一起使用。Flatiron 现在由 Nodejitsu 以及其他的社区成员在进行维护，并做的相当不错，是一个不那么流行却值得一看的框架。</p>\n<p>可以在<a href=\"flatironjs.org\">flatironjs.org</a>上获得更多信息。</p>\n<h1 id=\"7-Hapi\"><a href=\"#7-Hapi\" class=\"headerlink\" title=\"7 Hapi\"></a>7 Hapi</h1><p>Hapi 是为数不多的不依赖于 Express 的 Node.js 框架，现在甚至已经完全独立于 Express 了。在最近一段时间中，很多开发者选择了 Hapi 而非 Express，这使得它或多或少变为了 Express 的竞争对手。</p>\n<p>Hapi 在众多 nodejs 的框架中并非一个老牌选手，然而它却成功的在这当中创造了自己的一个生态圈。Hapi 致力于完全的分离 node HTTP 服务器、路由以及业务逻辑，并更多的聚焦于如何尽可能的通过配置而非代码来控制东西。</p>\n<p>Hapi 最初是由 Eran Hammer 以及在 Walmart labs 的团队为了工作需要开发的。其后便以极快的速度受到了欢迎，现在已在 MIT 许可下成为一个开源的框架，能够免费的被下载和使用。</p>\n<p>迪士尼、雅虎、Pebble、beats 音乐以及 Walmart 这样的公司都在使用 HAPI 作为他们旗下一个或多个项目的网络应用框架，它的影响力便可见一斑了。</p>\n<p>可以在<a href=\"hapijs.com\">hapijs.com</a>上找到更多关于 Hapi 的信息。</p>\n<h1 id=\"8-Mean-IO\"><a href=\"#8-Mean-IO\" class=\"headerlink\" title=\"8 Mean.IO\"></a>8 Mean.IO</h1><p>Mean 是 Mongo DB，Express，Angular 和 Node.js 捆绑在一起的组合。基本上说只要有它，就拥有了数据库层，服务器端和网页前端的整套工具，足以开发所有类型的现代网络应用。</p>\n<p>Mean 是一个完整独立的包，它涵盖了应用开发的所有方面。尤其适合于那些需要快速开始开发的人。它内置多种技术而且在联合使用时非常好。可以用于创建任意大小和复杂度的应用。</p>\n<p>使用 Mean，开发者可以避免经历混合和匹配不同的技术栈。通过 mean 栈，可以减少安装和配置 MongoDB，Express，Angular 和 Node.js 需要的时间。Mean.io 的另一个巨大好处就是所有的栈都使用 JavaScript，服务器端 Express 对 MongoDB 的访问(json)和通多 Angular 从 Node.js 到客户端。</p>\n<p>通过<a href=\"mean.io\">mean.io</a>了解更多 Mean.io 的相关信息。</p>\n<p>还有一个名为 mean.js 的 mean 分支也相当流行</p>\n<h1 id=\"9-Mojito\"><a href=\"#9-Mojito\" class=\"headerlink\" title=\"9 Mojito\"></a>9 Mojito</h1><p>Mojito 由 Yahoo 开发并迅速取得成功。然而很快又带着关于框架的空前的成功坐到了冷板凳，就像 Meteor 和 Mean stack 那样。</p>\n<p>Mojito 同样是一个 MVC 应用框架，非常适合于创建基于 HTML5，JavaScript 和 CSS3 的高性能的网络和手机应用。Mojito 的根本目标是提供一个框架，该框架用于构建标准的基于跨平台的应用。使之可以同时运行在客户端和服务器端，并实现高性能。</p>\n<p>可以在 Yahoo 开发者网页—— mojito 获得更多信息。</p>\n<h1 id=\"10-Socket-Stream\"><a href=\"#10-Socket-Stream\" class=\"headerlink\" title=\"10 Socket Stream\"></a>10 Socket Stream</h1><p>SocketStream 是一个有趣的框架，专注于客户端和服务端数据的快速同步，它致力于前后端数据的实时更新。</p>\n<p>它最大的特点是不严格要求你使用指定的客户端技术，也不限定数据库的 ORM。我趋向于将它和有同样功能的兄弟项目 Sail.js 做比较，它更适合做单页 Web 应用，多用户游戏，聊天客户端，网络应用，交易平台以及所有的需要将数据从服务端实时推送到客户端的应用。</p>\n<p>服务端和客户端使用 JSON 来传输数据，比较理想的是使用 websockets 在服务端事件发生时自动将数据推送到客户端，Socket stream 是由 Owen Barnes 创建，现在由 Paul Jensen 和团队维护，他们的工作让这个框架得到了应有的荣耀。</p>\n<p>SocketStream framework 在最近几月获得了很好的发展，未来一片光明。</p>\n<p>cketStream 信息请浏览 github 上的 socketstream。</p>\n<p>优秀框架还有：total.js, Geddy.JS, Locomotive, compound 和 Restify。</p>\n<h1 id=\"11-结论\"><a href=\"#11-结论\" class=\"headerlink\" title=\"11 结论\"></a>11 结论</h1><p>Web 和应用开发的变化是非常快速的，开发人员正在转向快速致力于快速、纯净的项目交付框架。</p>\n<p>使用 Node.js 框架的最大优势是提供了高层级结构的盒子，可以关注扩展应用程序而不用在构建和定义基础上消耗精力。</p>\n<p>框架提供了多样的特性，工作在不同的底层，试图解决构建实时的常见问题，并解决了可伸缩的和复杂的 Web 应用程序在速度上的问题。在这篇文章里讨论的框架是目前市场上最好的 Node.js 框架。</p>\n","site":{"data":{}},"excerpt":"<div class=\"note info no-icon\">\n            <p>原文:<a href=\"https://noeticforce.com/best-nodejs-frameworks-for-web-and-app-development\" target=\"_blank\" rel=\"noopener\">https://noeticforce.com/best-nodejs-frameworks-for-web-and-app-development</a><br>作者:Noetic Sunil</p>\n          </div>","more":"<p>在浏览器以外运行JavaScript对于JavaScript爱好者来说非常神奇，同时也肯定是Web应用程序开发界最受欢迎的进步之一。全球各地的开发者全力接纳了Node.js。</p>\n<p>对于新手来说，Node.js是允许在浏览器之外服务器上运行JavaScript代码的一种JavaScript。它基于谷歌Chrome的V8虚拟引擎建立的，这一引擎用于在Chrome浏览器中支持JavaScript。</p>\n<p>Node.js逐渐普及是因为它可以只使用JavaScript就可以建立大规模、实时性、可扩展的移动和Web应用程序。</p>\n<p>随着Node.js生态系统的发展，框架也开始着手加快工作流程。有许多的Node.js框架，允许构建实时的端到端网络应用，而无需任何其他第三方Web服务器、应用服务器、工具和技术。</p>\n<p>什么样的框架符合要求呢？</p>\n<p>通用性的Node框架就像Express，Koa 和Hapi更加灵活，让你做你想要的一切，最大限度的满足开发需求。但是，在最初需要投入更多的努力，更加依靠开发者作出正确的决策。</p>\n<p>而另一方面，像Mean.io，Meteor, Derby和Mojito，有自己的标准结构和技术体系，灵活性较差。然而这些框架不会给开发者太多做错误决策的空间。</p>\n<p>让我们来看看目前可用的最好、最强大的Node.js框架，并帮助建立实时的、各种规模和复杂性的可扩展 Web 应用程序。</p>\n<h1 id=\"1-Node-js-Express\"><a href=\"#1-Node-js-Express\" class=\"headerlink\" title=\"1 Node.js Express\"></a>1 Node.js Express</h1><p>对于一个已经在使用Node.js的开发人员来说，Express 或者”Node.js express”并不是一个新鲜事。Express框架提供了对Node.js原生API比较好的封装，从而使开发者更加容易地使用Node.js。</p>\n<p>Express 框架提供了用来开发强壮的 Web 移动应用，以及 API 的所有功能。并且开发人员还能够方便地为它开发插件和扩展，从而增加 Express 的能力。下面列出了一些 Express 提供的基本的功<br>能：</p>\n<ol>\n<li>可以和任何的第三方数据库进行通讯；</li>\n<li>可以使用任何的用户认证方式；</li>\n<li>可以使用任何符合 Express 接口定义的模板引擎；</li>\n<li>可以按照需要定义工程目录。</li>\n</ol>\n<p>通过使用 Node.js Express，可以使用更少的代码来实现功能。至少通过使用 Node.js Express，可以实现中间件来响应 http 请求，可以定义路由表来定义对不同请求的响应函数，还可以使用模板引擎来输出 html 页面。</p>\n<p>对于一个 Node.js 开发新手来说，Express 还提供了如下的好处：</p>\n<ol>\n<li>Express 的学习曲线并不陡峭，可以很快上手；</li>\n<li>Express 有非常庞大的社区，和组织良好的文档，新手可以很容易得到所需要的一切。Express<br>根据 MIT 协议进行开源，目前 StrongLoop 对它提供支持。</li>\n</ol>\n<p>可以通过 Express 的官方网站 expressjs.com 获得更多的信息。</p>\n<h1 id=\"2-Sails-js-Node-js-mvc\"><a href=\"#2-Sails-js-Node-js-mvc\" class=\"headerlink\" title=\"2 Sails.js (Node.js mvc)\"></a>2 Sails.js (Node.js mvc)</h1><p>Sail 作为一个非常稳固的 Node.js 框架，提供了建立任何规模的 web 应用所需要的所有功能。</p>\n<p>Sail.js 在底层使用了 Express 框架来提供对 http 请求的处理，同时使用 Socket.IO 框架来处WebSocket 请求。同时作为一个前端应用开发框架，它允许开发人员选择其熟悉的技术来开发应用。</p>\n<p>同时 Sail.js 也通过 waterline 框架实现了 ORM 功能。通过这个功能，应用程序可以在不进行大的修改的前提下，就可以从一个后端数据库，切换到另外一个后端数据库（也可以是一个 NoSQL 数据库）。</p>\n<p>Sail 特别适合用来开发对数据的实时更新有较高要求的应用，比如多人棋类游戏，单页 Web 应用等等。如果对 Ruby, Django或者Zend有一定的了解，那么将非常容易理解 Sail 中的概念。</p>\n<p>简单来说，Sail.js 既给开发者提供了一个优秀的 MVC 框架，也提供了一定的灵活性，让开发者可以自主选择前端开发方式和后端的数据库。 Sail.js 是由 Mike McNeil 创建的，现在由 Treeline and balderdash 提供支持。Sail.js 在 MIT 协议下开源。</p>\n<p>关于 Sail，可以通过官方网站<a href=\"sailsjs.org\">sailsjs.org</a>来了解更多内容。</p>\n<h1 id=\"3-KOA\"><a href=\"#3-KOA\" class=\"headerlink\" title=\"3 KOA\"></a>3 KOA</h1><p>KOA 是 Node.js mvc 框架的后起之秀，在 2013 第四个季度才发布了第一个版本。开发 KOA 的人员基本来自 Express 开发团队，TJ Holowaychuk 是 KOA 开发团队的领导者。虽然 KOA 大部分开发人员来自 Express，但是他们使用了完全不同的技术来开发 KOA，并且 KOA 正成为 Express 一个强有力的竞争对手。</p>\n<p>KOA 框架的核心是 ES6 的 generator。KOA 使用 generator 来实现中间件的流程控制，使用try/catch 来增强异常处理，同时在 KOA 框架中你再也看不到复杂的 callback 回调了。</p>\n<p>KOA 框架本身非常小，只打包了一些必要的功能，但是它本身通过良好的模块化组织，让开发人员可以按照自己的想法来实现一个扩展性非常好的应用。</p>\n<p>许多 JavaScript/Node.js 的忠实开发者都开始选择使用 KOA 来开发新的项目，因为 KOA 提供了更多的灵活性开发应用程序。</p>\n<p>可以通过<a href=\"koajs.com\">koajs.com</a>获取更多的信息。</p>\n<h1 id=\"4-Meteor\"><a href=\"#4-Meteor\" class=\"headerlink\" title=\"4 Meteor\"></a>4 Meteor</h1><p>Meteor 框架是 Node.js 上最出色的全栈框架。项目在 GitHub 上有 28K+的赞，拥有大量的自定义包，庞大的社区支持，非常好的教程和文档。在这个领域 Meteor 毫无疑问是王者，可以用它构建纯Javascript 的实时 Web 和手机应用。</p>\n<p>Meteor 最优秀的部分是，无论是服务器端的数据库访问，业务逻辑实现，还是客户端的展示，所有的流程都是无缝连接，开箱即用。整个框架使用统一的 API，Meteor API 同时适用于客户端和服务器端。</p>\n<p>它使用的 DDP 协议可以在后端连接简单的数据库服务、企业数据仓库、甚至 IOT 传感器。</p>\n<p>Meteor 带有自己默认的栈，但又有足够的灵活性，可以选择自己的技术方案。如果不需要尝试其他的框架或者没有其他的条件限制，可以直接使用默认配置，进行快速地应用开发。</p>\n<p>Meteor 拥有专业化的开发团队，顶级风投的大量资金支持，这都让 Meteor 能够时刻保持业界领先。</p>\n<p>可以通过 meteor.com 网站进一步了解 Meteor。</p>\n<h1 id=\"5-Derby-js\"><a href=\"#5-Derby-js\" class=\"headerlink\" title=\"5 Derby.js\"></a>5 Derby.js</h1><p>Derby.JS 跟它的直接竞争对手 Meteor、Mean.io、以及 Mojito 一样，也是一个全栈框架。它运行在 Node.js+ mongo + Redis 的上层。Derby 主要部分是一个叫做 Racer 的数据同步引擎，它能够让数据在数据库、服务器和浏览器之间的同步变得轻而易举。</p>\n<p>Racer 的确能够让基于 Derby 框架的应用运行地更快，无论是在浏览器端还是服务器端，对于单页面应用来说，它都是一个完美的选择方案。Derby 经常被用来和业界领先的 Meteor 进行比较，Meteor 项目已经开发了一段很长时间，因而能够提供更多的开箱即用的功能，使得在更短时间内开发复杂的 Web 应用变得更加容易。</p>\n<p>而 Derby 更适合于需要更快运行速度的应用，并且它的模块化方式能够让应用更灵活，更容易扩展。Derby 最近的发展有些缓慢，但它并没有出局，仍有改写 Node.js 全栈框架游戏规则的潜力。</p>\n<p>可以通过<a href=\"derbyjs.com\">derbyjs.com</a>网站进一步了解 Derby。</p>\n<h1 id=\"6-Flatiron-js-Node-js-MVC-框架\"><a href=\"#6-Flatiron-js-Node-js-MVC-框架\" class=\"headerlink\" title=\"6 Flatiron.js (Node.js MVC 框架)\"></a>6 Flatiron.js (Node.js MVC 框架)</h1><p>Flatiron 框架背后的核心思想是能使用它所提供的组件以及一些第三方库构建自己的全栈框架。很酷不是吗？我个人十分的喜欢这种方式。然而，这带来的是更高的复杂度，并有可能会被使用错误组件的开发者搞得一团糟。</p>\n<p>它可以称之为一个由多个相互独立的组件松散地组建起来的全栈 MVC 框架。Flatiron 框架支持Director，一个从头到脚都使用 JavaScript 搭建起来的，并不需要任何依赖项的 URL 路由组件。通过一个叫 Plates 的模板引擎，Flatiron 能够支持模版语言，然而数据管理是通过 json 实现的，并能与任何一种数据库一起使用。Flatiron 现在由 Nodejitsu 以及其他的社区成员在进行维护，并做的相当不错，是一个不那么流行却值得一看的框架。</p>\n<p>可以在<a href=\"flatironjs.org\">flatironjs.org</a>上获得更多信息。</p>\n<h1 id=\"7-Hapi\"><a href=\"#7-Hapi\" class=\"headerlink\" title=\"7 Hapi\"></a>7 Hapi</h1><p>Hapi 是为数不多的不依赖于 Express 的 Node.js 框架，现在甚至已经完全独立于 Express 了。在最近一段时间中，很多开发者选择了 Hapi 而非 Express，这使得它或多或少变为了 Express 的竞争对手。</p>\n<p>Hapi 在众多 nodejs 的框架中并非一个老牌选手，然而它却成功的在这当中创造了自己的一个生态圈。Hapi 致力于完全的分离 node HTTP 服务器、路由以及业务逻辑，并更多的聚焦于如何尽可能的通过配置而非代码来控制东西。</p>\n<p>Hapi 最初是由 Eran Hammer 以及在 Walmart labs 的团队为了工作需要开发的。其后便以极快的速度受到了欢迎，现在已在 MIT 许可下成为一个开源的框架，能够免费的被下载和使用。</p>\n<p>迪士尼、雅虎、Pebble、beats 音乐以及 Walmart 这样的公司都在使用 HAPI 作为他们旗下一个或多个项目的网络应用框架，它的影响力便可见一斑了。</p>\n<p>可以在<a href=\"hapijs.com\">hapijs.com</a>上找到更多关于 Hapi 的信息。</p>\n<h1 id=\"8-Mean-IO\"><a href=\"#8-Mean-IO\" class=\"headerlink\" title=\"8 Mean.IO\"></a>8 Mean.IO</h1><p>Mean 是 Mongo DB，Express，Angular 和 Node.js 捆绑在一起的组合。基本上说只要有它，就拥有了数据库层，服务器端和网页前端的整套工具，足以开发所有类型的现代网络应用。</p>\n<p>Mean 是一个完整独立的包，它涵盖了应用开发的所有方面。尤其适合于那些需要快速开始开发的人。它内置多种技术而且在联合使用时非常好。可以用于创建任意大小和复杂度的应用。</p>\n<p>使用 Mean，开发者可以避免经历混合和匹配不同的技术栈。通过 mean 栈，可以减少安装和配置 MongoDB，Express，Angular 和 Node.js 需要的时间。Mean.io 的另一个巨大好处就是所有的栈都使用 JavaScript，服务器端 Express 对 MongoDB 的访问(json)和通多 Angular 从 Node.js 到客户端。</p>\n<p>通过<a href=\"mean.io\">mean.io</a>了解更多 Mean.io 的相关信息。</p>\n<p>还有一个名为 mean.js 的 mean 分支也相当流行</p>\n<h1 id=\"9-Mojito\"><a href=\"#9-Mojito\" class=\"headerlink\" title=\"9 Mojito\"></a>9 Mojito</h1><p>Mojito 由 Yahoo 开发并迅速取得成功。然而很快又带着关于框架的空前的成功坐到了冷板凳，就像 Meteor 和 Mean stack 那样。</p>\n<p>Mojito 同样是一个 MVC 应用框架，非常适合于创建基于 HTML5，JavaScript 和 CSS3 的高性能的网络和手机应用。Mojito 的根本目标是提供一个框架，该框架用于构建标准的基于跨平台的应用。使之可以同时运行在客户端和服务器端，并实现高性能。</p>\n<p>可以在 Yahoo 开发者网页—— mojito 获得更多信息。</p>\n<h1 id=\"10-Socket-Stream\"><a href=\"#10-Socket-Stream\" class=\"headerlink\" title=\"10 Socket Stream\"></a>10 Socket Stream</h1><p>SocketStream 是一个有趣的框架，专注于客户端和服务端数据的快速同步，它致力于前后端数据的实时更新。</p>\n<p>它最大的特点是不严格要求你使用指定的客户端技术，也不限定数据库的 ORM。我趋向于将它和有同样功能的兄弟项目 Sail.js 做比较，它更适合做单页 Web 应用，多用户游戏，聊天客户端，网络应用，交易平台以及所有的需要将数据从服务端实时推送到客户端的应用。</p>\n<p>服务端和客户端使用 JSON 来传输数据，比较理想的是使用 websockets 在服务端事件发生时自动将数据推送到客户端，Socket stream 是由 Owen Barnes 创建，现在由 Paul Jensen 和团队维护，他们的工作让这个框架得到了应有的荣耀。</p>\n<p>SocketStream framework 在最近几月获得了很好的发展，未来一片光明。</p>\n<p>cketStream 信息请浏览 github 上的 socketstream。</p>\n<p>优秀框架还有：total.js, Geddy.JS, Locomotive, compound 和 Restify。</p>\n<h1 id=\"11-结论\"><a href=\"#11-结论\" class=\"headerlink\" title=\"11 结论\"></a>11 结论</h1><p>Web 和应用开发的变化是非常快速的，开发人员正在转向快速致力于快速、纯净的项目交付框架。</p>\n<p>使用 Node.js 框架的最大优势是提供了高层级结构的盒子，可以关注扩展应用程序而不用在构建和定义基础上消耗精力。</p>\n<p>框架提供了多样的特性，工作在不同的底层，试图解决构建实时的常见问题，并解决了可伸缩的和复杂的 Web 应用程序在速度上的问题。在这篇文章里讨论的框架是目前市场上最好的 Node.js 框架。</p>"},{"title":"读《中国社会各阶层分析》","date":"2019-04-03T12:44:59.000Z","_content":"{% note info no-icon %}\n先是在毛选中读到了毛泽东的《中国社会各阶级的分析》，而后在整理旧书时翻到了一本几年前淘下的梁晓声的《中国社会各阶层分析》。起初并无意去对比，只是前后时间上的机缘巧合，不由得引起思考。\n{% endnote %}\n<!-- more -->\n梁晓声作为后学，以此为题，显然有效仿与“更新”之意。『文章合为时而著』，在新千年之际，面对迅猛改革与变迁中的中国社会，面对未知的前景，人们无不有憧憬、期待，当然也会有悲观的论调。在阶级消失，出现阶层这一分化形态的过程中，梁晓声因时制宜地对社会现状做出分析。当然，更多是以随笔、杂文的形式，旁征博引，观点不是很集中，案例却写得十分生动。，更多是对现状的描摹。从蕴含的个人情感上看，前半部分对当前以及未来保持着乐观的态度，站位正直，至少不做否定；而后续部分则对部分阶层表达了批判以及对社会问题的忧虑，分析有理有据。\n\n世纪之交，计划体系赶不上市场变化，但总有精明的人肆意游走在两者之间，疯狂套现。\n\n如今，常常听到阶层固化的说法，人们彼此之间缺乏安全感与信任度，在法律的效力还远低于理想状态时，个体事务由于一两个匪夷所思的曝点上升为公众焦点事件，弱者不再无力，借助道德批判成功调起公众情绪。更具体的说，是某个阶层，往往处于经济的中下等，借宣扬正义大幅度宣泄压抑与不满，想着对立的人群，在公共声音的庇护下，不加调查的口诛笔伐。而当事件缓落，无力者依旧无力，变化的只是一两个资本势力。","source":"_drafts/读《中国社会各阶层分析》.md","raw":"---\ntitle: 读《中国社会各阶层分析》\ndate: 2019-04-03 20:44:59\ntags:\ncategories: book\n---\n{% note info no-icon %}\n先是在毛选中读到了毛泽东的《中国社会各阶级的分析》，而后在整理旧书时翻到了一本几年前淘下的梁晓声的《中国社会各阶层分析》。起初并无意去对比，只是前后时间上的机缘巧合，不由得引起思考。\n{% endnote %}\n<!-- more -->\n梁晓声作为后学，以此为题，显然有效仿与“更新”之意。『文章合为时而著』，在新千年之际，面对迅猛改革与变迁中的中国社会，面对未知的前景，人们无不有憧憬、期待，当然也会有悲观的论调。在阶级消失，出现阶层这一分化形态的过程中，梁晓声因时制宜地对社会现状做出分析。当然，更多是以随笔、杂文的形式，旁征博引，观点不是很集中，案例却写得十分生动。，更多是对现状的描摹。从蕴含的个人情感上看，前半部分对当前以及未来保持着乐观的态度，站位正直，至少不做否定；而后续部分则对部分阶层表达了批判以及对社会问题的忧虑，分析有理有据。\n\n世纪之交，计划体系赶不上市场变化，但总有精明的人肆意游走在两者之间，疯狂套现。\n\n如今，常常听到阶层固化的说法，人们彼此之间缺乏安全感与信任度，在法律的效力还远低于理想状态时，个体事务由于一两个匪夷所思的曝点上升为公众焦点事件，弱者不再无力，借助道德批判成功调起公众情绪。更具体的说，是某个阶层，往往处于经济的中下等，借宣扬正义大幅度宣泄压抑与不满，想着对立的人群，在公共声音的庇护下，不加调查的口诛笔伐。而当事件缓落，无力者依旧无力，变化的只是一两个资本势力。","slug":"读《中国社会各阶层分析》","published":0,"updated":"2019-07-21T07:28:34.912Z","_id":"cjyclxmvj0009lejxsfxi03si","comments":1,"layout":"post","photos":[],"link":"","content":"<link rel=\"stylesheet\" class=\"aplayer-secondary-style-marker\" href=\"/assets/css/APlayer.min.css\"><script src=\"/assets/js/APlayer.min.js\" class=\"aplayer-secondary-script-marker\"></script><script class=\"meting-secondary-script-marker\" src=\"/assets/js/Meting.min.js\"></script><link rel=\"stylesheet\" type=\"text/css\" href=\"https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css\"><div class=\"note info no-icon\">\n            <p>先是在毛选中读到了毛泽东的《中国社会各阶级的分析》，而后在整理旧书时翻到了一本几年前淘下的梁晓声的《中国社会各阶层分析》。起初并无意去对比，只是前后时间上的机缘巧合，不由得引起思考。</p>\n          </div>\n<a id=\"more\"></a>\n<p>梁晓声作为后学，以此为题，显然有效仿与“更新”之意。『文章合为时而著』，在新千年之际，面对迅猛改革与变迁中的中国社会，面对未知的前景，人们无不有憧憬、期待，当然也会有悲观的论调。在阶级消失，出现阶层这一分化形态的过程中，梁晓声因时制宜地对社会现状做出分析。当然，更多是以随笔、杂文的形式，旁征博引，观点不是很集中，案例却写得十分生动。，更多是对现状的描摹。从蕴含的个人情感上看，前半部分对当前以及未来保持着乐观的态度，站位正直，至少不做否定；而后续部分则对部分阶层表达了批判以及对社会问题的忧虑，分析有理有据。</p>\n<p>世纪之交，计划体系赶不上市场变化，但总有精明的人肆意游走在两者之间，疯狂套现。</p>\n<p>如今，常常听到阶层固化的说法，人们彼此之间缺乏安全感与信任度，在法律的效力还远低于理想状态时，个体事务由于一两个匪夷所思的曝点上升为公众焦点事件，弱者不再无力，借助道德批判成功调起公众情绪。更具体的说，是某个阶层，往往处于经济的中下等，借宣扬正义大幅度宣泄压抑与不满，想着对立的人群，在公共声音的庇护下，不加调查的口诛笔伐。而当事件缓落，无力者依旧无力，变化的只是一两个资本势力。</p>\n","site":{"data":{}},"excerpt":"<div class=\"note info no-icon\">\n            <p>先是在毛选中读到了毛泽东的《中国社会各阶级的分析》，而后在整理旧书时翻到了一本几年前淘下的梁晓声的《中国社会各阶层分析》。起初并无意去对比，只是前后时间上的机缘巧合，不由得引起思考。</p>\n          </div>","more":"<p>梁晓声作为后学，以此为题，显然有效仿与“更新”之意。『文章合为时而著』，在新千年之际，面对迅猛改革与变迁中的中国社会，面对未知的前景，人们无不有憧憬、期待，当然也会有悲观的论调。在阶级消失，出现阶层这一分化形态的过程中，梁晓声因时制宜地对社会现状做出分析。当然，更多是以随笔、杂文的形式，旁征博引，观点不是很集中，案例却写得十分生动。，更多是对现状的描摹。从蕴含的个人情感上看，前半部分对当前以及未来保持着乐观的态度，站位正直，至少不做否定；而后续部分则对部分阶层表达了批判以及对社会问题的忧虑，分析有理有据。</p>\n<p>世纪之交，计划体系赶不上市场变化，但总有精明的人肆意游走在两者之间，疯狂套现。</p>\n<p>如今，常常听到阶层固化的说法，人们彼此之间缺乏安全感与信任度，在法律的效力还远低于理想状态时，个体事务由于一两个匪夷所思的曝点上升为公众焦点事件，弱者不再无力，借助道德批判成功调起公众情绪。更具体的说，是某个阶层，往往处于经济的中下等，借宣扬正义大幅度宣泄压抑与不满，想着对立的人群，在公共声音的庇护下，不加调查的口诛笔伐。而当事件缓落，无力者依旧无力，变化的只是一两个资本势力。</p>"},{"title":"观《野梨树》","date":"2018-12-25T14:01:52.000Z","_content":"{% note info no-icon %}\n野梨树 Ahlat Agaci 2018\n导演: 努里·比格·锡兰 \n编剧: 阿克·阿克苏 / 埃布鲁·锡兰 / 努里·比格·锡兰 \n主演: 岛吾·德米尔考\nIMDb: [https://www.imdb.com/title/tt6628102/](https://www.imdb.com/title/tt6628102/)\n{% endnote %}\n# 1 几处对话\n# 1.1 与意中人对话 \n1. 读书的作用\n2. 女性\n3. 人与命运\n# 1.2 与作家对话\n1. 写作的目的\n2. 对名家的特立独行的质疑\n# 1.3 与伊玛目对话\n1. 宗教作用\n2. 改革派与保守派\n# 1.4 出版后与母亲对话\n# 1.5 重回乡下与父亲对话\n# 整体评价\n形色凄神寒骨，基调悄怆幽邃","source":"_drafts/观《野梨树》.md","raw":"---\ntitle: 观《野梨树》\ndate: 2018-12-25 22:01:52\ntags:\n- 电影\n---\n{% note info no-icon %}\n野梨树 Ahlat Agaci 2018\n导演: 努里·比格·锡兰 \n编剧: 阿克·阿克苏 / 埃布鲁·锡兰 / 努里·比格·锡兰 \n主演: 岛吾·德米尔考\nIMDb: [https://www.imdb.com/title/tt6628102/](https://www.imdb.com/title/tt6628102/)\n{% endnote %}\n# 1 几处对话\n# 1.1 与意中人对话 \n1. 读书的作用\n2. 女性\n3. 人与命运\n# 1.2 与作家对话\n1. 写作的目的\n2. 对名家的特立独行的质疑\n# 1.3 与伊玛目对话\n1. 宗教作用\n2. 改革派与保守派\n# 1.4 出版后与母亲对话\n# 1.5 重回乡下与父亲对话\n# 整体评价\n形色凄神寒骨，基调悄怆幽邃","slug":"观《野梨树》","published":0,"updated":"2019-07-21T07:38:43.069Z","_id":"cjycn4yuy000elejxy86nq7ne","comments":1,"layout":"post","photos":[],"link":"","content":"<link rel=\"stylesheet\" class=\"aplayer-secondary-style-marker\" href=\"/assets/css/APlayer.min.css\"><script src=\"/assets/js/APlayer.min.js\" class=\"aplayer-secondary-script-marker\"></script><script class=\"meting-secondary-script-marker\" src=\"/assets/js/Meting.min.js\"></script><link rel=\"stylesheet\" type=\"text/css\" href=\"https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css\"><div class=\"note info no-icon\">\n            <p>野梨树 Ahlat Agaci 2018<br>导演: 努里·比格·锡兰<br>编剧: 阿克·阿克苏 / 埃布鲁·锡兰 / 努里·比格·锡兰<br>主演: 岛吾·德米尔考<br>IMDb: <a href=\"https://www.imdb.com/title/tt6628102/\" target=\"_blank\" rel=\"noopener\">https://www.imdb.com/title/tt6628102/</a></p>\n          </div>\n<h1 id=\"1-几处对话\"><a href=\"#1-几处对话\" class=\"headerlink\" title=\"1 几处对话\"></a>1 几处对话</h1><h1 id=\"1-1-与意中人对话\"><a href=\"#1-1-与意中人对话\" class=\"headerlink\" title=\"1.1 与意中人对话\"></a>1.1 与意中人对话</h1><ol>\n<li>读书的作用</li>\n<li>女性</li>\n<li>人与命运<h1 id=\"1-2-与作家对话\"><a href=\"#1-2-与作家对话\" class=\"headerlink\" title=\"1.2 与作家对话\"></a>1.2 与作家对话</h1></li>\n<li>写作的目的</li>\n<li>对名家的特立独行的质疑<h1 id=\"1-3-与伊玛目对话\"><a href=\"#1-3-与伊玛目对话\" class=\"headerlink\" title=\"1.3 与伊玛目对话\"></a>1.3 与伊玛目对话</h1></li>\n<li>宗教作用</li>\n<li>改革派与保守派<h1 id=\"1-4-出版后与母亲对话\"><a href=\"#1-4-出版后与母亲对话\" class=\"headerlink\" title=\"1.4 出版后与母亲对话\"></a>1.4 出版后与母亲对话</h1><h1 id=\"1-5-重回乡下与父亲对话\"><a href=\"#1-5-重回乡下与父亲对话\" class=\"headerlink\" title=\"1.5 重回乡下与父亲对话\"></a>1.5 重回乡下与父亲对话</h1><h1 id=\"整体评价\"><a href=\"#整体评价\" class=\"headerlink\" title=\"整体评价\"></a>整体评价</h1>形色凄神寒骨，基调悄怆幽邃</li>\n</ol>\n","site":{"data":{}},"excerpt":"","more":"<div class=\"note info no-icon\">\n            <p>野梨树 Ahlat Agaci 2018<br>导演: 努里·比格·锡兰<br>编剧: 阿克·阿克苏 / 埃布鲁·锡兰 / 努里·比格·锡兰<br>主演: 岛吾·德米尔考<br>IMDb: <a href=\"https://www.imdb.com/title/tt6628102/\" target=\"_blank\" rel=\"noopener\">https://www.imdb.com/title/tt6628102/</a></p>\n          </div>\n<h1 id=\"1-几处对话\"><a href=\"#1-几处对话\" class=\"headerlink\" title=\"1 几处对话\"></a>1 几处对话</h1><h1 id=\"1-1-与意中人对话\"><a href=\"#1-1-与意中人对话\" class=\"headerlink\" title=\"1.1 与意中人对话\"></a>1.1 与意中人对话</h1><ol>\n<li>读书的作用</li>\n<li>女性</li>\n<li>人与命运<h1 id=\"1-2-与作家对话\"><a href=\"#1-2-与作家对话\" class=\"headerlink\" title=\"1.2 与作家对话\"></a>1.2 与作家对话</h1></li>\n<li>写作的目的</li>\n<li>对名家的特立独行的质疑<h1 id=\"1-3-与伊玛目对话\"><a href=\"#1-3-与伊玛目对话\" class=\"headerlink\" title=\"1.3 与伊玛目对话\"></a>1.3 与伊玛目对话</h1></li>\n<li>宗教作用</li>\n<li>改革派与保守派<h1 id=\"1-4-出版后与母亲对话\"><a href=\"#1-4-出版后与母亲对话\" class=\"headerlink\" title=\"1.4 出版后与母亲对话\"></a>1.4 出版后与母亲对话</h1><h1 id=\"1-5-重回乡下与父亲对话\"><a href=\"#1-5-重回乡下与父亲对话\" class=\"headerlink\" title=\"1.5 重回乡下与父亲对话\"></a>1.5 重回乡下与父亲对话</h1><h1 id=\"整体评价\"><a href=\"#整体评价\" class=\"headerlink\" title=\"整体评价\"></a>整体评价</h1>形色凄神寒骨，基调悄怆幽邃</li>\n</ol>\n"},{"title":"观《康熙王朝》","date":"2019-07-20T04:01:52.000Z","_content":"{% note info no-icon %}\n康熙王朝 (2001)\n导演: 陈家林 / 刘大印\n编剧: 朱苏进 / 胡建新 / 二月河\n主演: 斯琴高娃 / 陈道明 \n{% endnote %}","source":"_drafts/观《康熙王朝》.md","raw":"---\ntitle: 观《康熙王朝》\ndate: 2019-7-20 12:01:52\ntags:\ncategories: tv\n---\n{% note info no-icon %}\n康熙王朝 (2001)\n导演: 陈家林 / 刘大印\n编剧: 朱苏进 / 胡建新 / 二月河\n主演: 斯琴高娃 / 陈道明 \n{% endnote %}","slug":"观《康熙王朝》","published":0,"updated":"2019-07-21T07:42:19.242Z","_id":"cjycnhn2s000jlejx6ldqgg3q","comments":1,"layout":"post","photos":[],"link":"","content":"<link rel=\"stylesheet\" class=\"aplayer-secondary-style-marker\" href=\"/assets/css/APlayer.min.css\"><script src=\"/assets/js/APlayer.min.js\" class=\"aplayer-secondary-script-marker\"></script><script class=\"meting-secondary-script-marker\" src=\"/assets/js/Meting.min.js\"></script><link rel=\"stylesheet\" type=\"text/css\" href=\"https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css\"><div class=\"note info no-icon\">\n            <p>康熙王朝 (2001)<br>导演: 陈家林 / 刘大印<br>编剧: 朱苏进 / 胡建新 / 二月河<br>主演: 斯琴高娃 / 陈道明 </p>\n          </div>","site":{"data":{}},"excerpt":"","more":"<div class=\"note info no-icon\">\n            <p>康熙王朝 (2001)<br>导演: 陈家林 / 刘大印<br>编剧: 朱苏进 / 胡建新 / 二月河<br>主演: 斯琴高娃 / 陈道明 </p>\n          </div>"},{"title":"Egg 渐进式开发","date":"2019-01-08T09:49:57.000Z","_content":"1. 工程内调用\n2. 插件\n3. 发包\n4. 沉淀框架","source":"_posts/zh-CN/Egg 渐进式开发.md","raw":"---\ntitle: Egg 渐进式开发\ndate: 2019-01-08 17:49:57\ntags: \n - egg\n - node\ncategories: learn\n---\n1. 工程内调用\n2. 插件\n3. 发包\n4. 沉淀框架","slug":"Egg 渐进式开发","published":1,"lang":"zh-CN","updated":"2019-07-22T13:20:51.165Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjylkt0qn0000tpjxn6s3we5m","content":"<link rel=\"stylesheet\" class=\"aplayer-secondary-style-marker\" href=\"/assets/css/APlayer.min.css\"><script src=\"/assets/js/APlayer.min.js\" class=\"aplayer-secondary-script-marker\"></script><script class=\"meting-secondary-script-marker\" src=\"/assets/js/Meting.min.js\"></script><link rel=\"stylesheet\" type=\"text/css\" href=\"https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css\"><ol>\n<li>工程内调用</li>\n<li>插件</li>\n<li>发包</li>\n<li>沉淀框架</li>\n</ol>\n","site":{"data":{}},"excerpt":"","more":"<ol>\n<li>工程内调用</li>\n<li>插件</li>\n<li>发包</li>\n<li>沉淀框架</li>\n</ol>\n"}],"PostAsset":[],"PostCategory":[{"post_id":"cjvnq7z9g00067jjx8u2o6jts","category_id":"cjvnq7z9m00087jjxnlcmp7uq","_id":"cjvnq7z9w000j7jjxe6ruqqpf"},{"post_id":"cjvnq7z9r000c7jjxig9cxpox","category_id":"cjvnq7z9m00087jjxnlcmp7uq","_id":"cjvnq7z9y000m7jjxw33kizvc"},{"post_id":"cjvnq7z9l00077jjxitq0pswn","category_id":"cjvnq7z9m00087jjxnlcmp7uq","_id":"cjvnq7z9z000p7jjxx449vbz4"},{"post_id":"cjvnq7z9p000a7jjxcbsnk49n","category_id":"cjvnq7z9w000i7jjxe936yk72","_id":"cjvnq7za2000v7jjxuic07vwz"},{"post_id":"cjvnq7z9y000o7jjxy9fiodyr","category_id":"cjvnq7z9w000i7jjxe936yk72","_id":"cjvnq7za500107jjxin83ta5h"},{"post_id":"cjvnq7za0000s7jjxc5dz9ged","category_id":"cjvnq7z9w000i7jjxe936yk72","_id":"cjvnq7za600127jjx2bsw3r9m"},{"post_id":"cjvnq7z9u000g7jjxxhy4qom1","category_id":"cjvnq7z9z000q7jjxwg2q6zo1","_id":"cjvnq7za700167jjxciagyb3z"},{"post_id":"cjvnq7z9v000h7jjxrt7dzw3j","category_id":"cjvnq7z9w000i7jjxe936yk72","_id":"cjvnq7za900197jjxof8qp0wq"},{"post_id":"cjvnq7za3000z7jjx13n1mssd","category_id":"cjvnq7za9001b7jjx7g6wzl1q","_id":"cjvnq7zaf001n7jjxs1z9z46d"},{"post_id":"cjvnq7za500117jjxe51lnp6q","category_id":"cjvnq7zac001i7jjxpf5eb23a","_id":"cjvnq7zaj001t7jjx2qj40k16"},{"post_id":"cjvnq7zah001q7jjx7501p30y","category_id":"cjvnq7za9001b7jjx7g6wzl1q","_id":"cjvnq7zam001z7jjxqgbcqvm4"},{"post_id":"cjvnq7za700157jjxv5ojnavh","category_id":"cjvnq7zag001o7jjxtkwq38cp","_id":"cjvnq7zan00237jjxg61emw1a"},{"post_id":"cjvnq7zai001s7jjxxpu65iok","category_id":"cjvnq7z9m00087jjxnlcmp7uq","_id":"cjvnq7zap00267jjxjezajayu"},{"post_id":"cjvnq7zak001w7jjx73yz3kmh","category_id":"cjvnq7za9001b7jjx7g6wzl1q","_id":"cjvnq7zaq002a7jjx45y5457e"},{"post_id":"cjvnq7za9001c7jjx9arxv6sv","category_id":"cjvnq7zac001i7jjxpf5eb23a","_id":"cjvnq7zas002e7jjxp9hxijvz"},{"post_id":"cjvnq7zal001y7jjxsghabvc6","category_id":"cjvnq7za9001b7jjx7g6wzl1q","_id":"cjvnq7zau002g7jjxlx597rlt"},{"post_id":"cjvnq7zaa001f7jjx9fhmuvxd","category_id":"cjvnq7zam00207jjxpoy0cq0l","_id":"cjvnq7zaw002j7jjxlg6jc2ed"},{"post_id":"cjvnq7zao00257jjxhq2paeg9","category_id":"cjvnq7za9001b7jjx7g6wzl1q","_id":"cjvnq7zax002m7jjxouuqi8m7"},{"post_id":"cjvnq7zap00297jjxeb95frtk","category_id":"cjvnq7zam00207jjxpoy0cq0l","_id":"cjvnq7zaz002p7jjxdu3q546r"},{"post_id":"cjvnq7zaf001m7jjxutkct1v5","category_id":"cjvnq7zam00207jjxpoy0cq0l","_id":"cjvnq7zb0002s7jjxopbgeiiy"},{"post_id":"cjvnq7zar002d7jjxtkusqr78","category_id":"cjvnq7za9001b7jjx7g6wzl1q","_id":"cjvnq7zb3002w7jjxryls6u46"},{"post_id":"cjvnq7zat002f7jjxgkpi0zt6","category_id":"cjvnq7za9001b7jjx7g6wzl1q","_id":"cjvnq7zb4002y7jjx82hrobid"},{"post_id":"cjvnq7zav002i7jjxh7qsh9xm","category_id":"cjvnq7za9001b7jjx7g6wzl1q","_id":"cjvnq7zb400307jjx7bxlmv39"},{"post_id":"cjvnq7zay002o7jjxhovgcem6","category_id":"cjvnq7zb1002u7jjxsegcznvf","_id":"cjvnq7zb500327jjxsox13x10"},{"post_id":"cjvnq7zbk003a7jjxyojyiuds","category_id":"cjvnq7z9m00087jjxnlcmp7uq","_id":"cjvnq7zbn003f7jjxe7573loc"},{"post_id":"cjvnq7zbl003b7jjxtnt12sti","category_id":"cjvnq7z9z000q7jjxwg2q6zo1","_id":"cjvnq7zbp003h7jjxxg95lbd8"},{"post_id":"cjvnq7zbm003d7jjx4l1s0ooe","category_id":"cjvnq7za9001b7jjx7g6wzl1q","_id":"cjvnq7zbq003k7jjxbl6e4ioz"},{"post_id":"cjvnq7zbn003e7jjxaikrynpm","category_id":"cjvnq7z9m00087jjxnlcmp7uq","_id":"cjvnq7zbr003m7jjx1krb3q2j"},{"post_id":"cjvnq7zbo003g7jjxgckfnog3","category_id":"cjvnq7za9001b7jjx7g6wzl1q","_id":"cjvnq7zbr003o7jjxhm8xkn8h"},{"post_id":"cjycl5i840004jrjx355dbsx2","category_id":"cjvnq7za600137jjx2kdq1qzu","_id":"cjycl5i880006jrjxm8yrvcp2"},{"post_id":"cjycl6ghn0000syjx7tl3ysvn","category_id":"cjvnq7za600137jjx2kdq1qzu","_id":"cjycldbfo0001lejxga96mhml"},{"post_id":"cjyclxmvj0009lejxsfxi03si","category_id":"cjvnq7zac001i7jjxpf5eb23a","_id":"cjycmcihh000dlejx9kkdicwj"},{"post_id":"cjycnhn2s000jlejx6ldqgg3q","category_id":"cjvnq7zag001o7jjxtkwq38cp","_id":"cjycnkrk6000mlejx3i60j0jx"},{"post_id":"cjylkt0qn0000tpjxn6s3we5m","category_id":"cjylkt0qv0001tpjxsa9byoj1","_id":"cjylkt0r30005tpjx5guh9y2h"}],"PostTag":[{"post_id":"cjvnq7z9g00067jjx8u2o6jts","tag_id":"cjvnq7z9o00097jjxki3wp5xb","_id":"cjvnq7z9t000f7jjxxmdifycn"},{"post_id":"cjvnq7z9p000a7jjxcbsnk49n","tag_id":"cjvnq7z9s000e7jjxdqz10vsx","_id":"cjvnq7z9y000n7jjx29whqisu"},{"post_id":"cjvnq7z9r000c7jjxig9cxpox","tag_id":"cjvnq7z9x000k7jjx0utf6x88","_id":"cjvnq7za1000t7jjxfo8y99i1"},{"post_id":"cjvnq7z9y000o7jjxy9fiodyr","tag_id":"cjvnq7z9o00097jjxki3wp5xb","_id":"cjvnq7za2000w7jjxht04t6cy"},{"post_id":"cjvnq7z9u000g7jjxxhy4qom1","tag_id":"cjvnq7z9x000k7jjx0utf6x88","_id":"cjvnq7za700177jjxelw9kd2h"},{"post_id":"cjvnq7z9u000g7jjxxhy4qom1","tag_id":"cjvnq7za3000y7jjxteovaejd","_id":"cjvnq7za9001a7jjxhrnonhm0"},{"post_id":"cjvnq7z9v000h7jjxrt7dzw3j","tag_id":"cjvnq7za600147jjx0t3itp8e","_id":"cjvnq7zaa001e7jjxq7s5j2yh"},{"post_id":"cjvnq7za0000s7jjxc5dz9ged","tag_id":"cjvnq7zaa001d7jjxb1ww4www","_id":"cjvnq7zae001l7jjxsnzvrxv2"},{"post_id":"cjvnq7za3000z7jjx13n1mssd","tag_id":"cjvnq7zaa001d7jjxb1ww4www","_id":"cjvnq7zal001x7jjxax18anm4"},{"post_id":"cjvnq7zac001h7jjxczrpkvbv","tag_id":"cjvnq7zaj001v7jjxeoqku2wu","_id":"cjvnq7zao00247jjxmih4u3dj"},{"post_id":"cjvnq7zal001y7jjxsghabvc6","tag_id":"cjvnq7zaa001d7jjxb1ww4www","_id":"cjvnq7zap00277jjx21hxeip6"},{"post_id":"cjvnq7zah001q7jjx7501p30y","tag_id":"cjvnq7zan00217jjx2ls5v5od","_id":"cjvnq7zar002c7jjxszf8od8q"},{"post_id":"cjvnq7zai001s7jjxxpu65iok","tag_id":"cjvnq7zaq002b7jjxa7lbye7c","_id":"cjvnq7zaw002k7jjx0we11ici"},{"post_id":"cjvnq7zak001w7jjx73yz3kmh","tag_id":"cjvnq7zav002h7jjxvbb8iopy","_id":"cjvnq7zaz002q7jjxxx10mqq2"},{"post_id":"cjvnq7zan00227jjxfv2l5adt","tag_id":"cjvnq7zan00217jjx2ls5v5od","_id":"cjvnq7zb4002x7jjx95i9wr5y"},{"post_id":"cjvnq7zao00257jjxhq2paeg9","tag_id":"cjvnq7zb1002t7jjxcut9sdfk","_id":"cjvnq7zb500317jjxb3rw0w0u"},{"post_id":"cjvnq7zat002f7jjxgkpi0zt6","tag_id":"cjvnq7zb4002z7jjxk6h436ch","_id":"cjvnq7zb500347jjx6jrhcqle"},{"post_id":"cjvnq7zav002i7jjxh7qsh9xm","tag_id":"cjvnq7zb500337jjxiht56luf","_id":"cjvnq7zb500367jjxyl6ymuxk"},{"post_id":"cjvnq7zaw002l7jjx5uzwi4br","tag_id":"cjvnq7zb500357jjxm8vm7qfj","_id":"cjvnq7zb600387jjxrneu1fuz"},{"post_id":"cjvnq7zbo003g7jjxgckfnog3","tag_id":"cjvnq7zan00217jjx2ls5v5od","_id":"cjvnq7zbr003l7jjxwxs52s33"},{"post_id":"cjvnq7zbk003a7jjxyojyiuds","tag_id":"cjvnq7zbl003c7jjxr2ut8186","_id":"cjvnq7zbr003p7jjxmjdjijy8"},{"post_id":"cjvnq7zbk003a7jjxyojyiuds","tag_id":"cjvnq7zav002h7jjxvbb8iopy","_id":"cjvnq7zbr003q7jjx49qb6xn6"},{"post_id":"cjvnq7zbk003a7jjxyojyiuds","tag_id":"cjvnq7zbp003i7jjx5sqdy3tl","_id":"cjvnq7zbs003s7jjxyz30jett"},{"post_id":"cjvnq7zbl003b7jjxtnt12sti","tag_id":"cjvnq7zbr003n7jjx19ixcu3r","_id":"cjvnq7zbs003t7jjxzdupi5hu"},{"post_id":"cjvnq7zbm003d7jjx4l1s0ooe","tag_id":"cjvnq7zav002h7jjxvbb8iopy","_id":"cjvnq7zbt003v7jjxrva75t15"},{"post_id":"cjvnq7zbm003d7jjx4l1s0ooe","tag_id":"cjvnq7zbs003r7jjxrgiih9sv","_id":"cjvnq7zbt003w7jjx9h0disc2"},{"post_id":"cjvnq7zbn003e7jjxaikrynpm","tag_id":"cjvnq7zbs003u7jjxavla5pvi","_id":"cjvnq7zbt003x7jjxpieutw5g"},{"post_id":"cjvnq7zbn003e7jjxaikrynpm","tag_id":"cjvnq7zb4002z7jjxk6h436ch","_id":"cjvnq7zbt003y7jjx4t8n4064"},{"post_id":"cjycl5i840004jrjx355dbsx2","tag_id":"cjvnq7zad001j7jjxp9erk447","_id":"cjycl5i870005jrjxqui4yprl"},{"post_id":"cjycl6ghn0000syjx7tl3ysvn","tag_id":"cjycl6ghs0001syjxqw9wevxc","_id":"cjycldbfo0000lejxr2w63wd2"},{"post_id":"cjvnq7zb2002v7jjxuxfl34fw","tag_id":"cjvnq7zb500377jjx8xlqaxbu","_id":"cjyclqwfu0007lejxikvs263o"},{"post_id":"cjycn4yuy000elejxy86nq7ne","tag_id":"cjvnq7zb500357jjxm8vm7qfj","_id":"cjycndxr4000ilejxzxhln5rr"},{"post_id":"cjylkt0qn0000tpjxn6s3we5m","tag_id":"cjylkt0r20002tpjxtjalcjq7","_id":"cjylkt0r30003tpjx5w211rg4"},{"post_id":"cjylkt0qn0000tpjxn6s3we5m","tag_id":"cjvnq7z9x000k7jjx0utf6x88","_id":"cjylkt0r30004tpjxowkk42a5"}],"Tag":[{"name":"markdown","_id":"cjvnq7z9o00097jjxki3wp5xb"},{"name":"git","_id":"cjvnq7z9s000e7jjxdqz10vsx"},{"name":"node","_id":"cjvnq7z9x000k7jjx0utf6x88"},{"name":"koa","_id":"cjvnq7za3000y7jjxteovaejd"},{"name":"ssh","_id":"cjvnq7za600147jjx0t3itp8e"},{"name":"linux","_id":"cjvnq7zaa001d7jjxb1ww4www"},{"name":"tensorflow","_id":"cjvnq7zad001j7jjxp9erk447"},{"name":"随想","_id":"cjvnq7zaj001v7jjxeoqku2wu"},{"name":"wechat","_id":"cjvnq7zan00217jjx2ls5v5od"},{"name":"matlab","_id":"cjvnq7zaq002b7jjxa7lbye7c"},{"name":"php","_id":"cjvnq7zav002h7jjxvbb8iopy"},{"name":"微信","_id":"cjvnq7zb1002t7jjxcut9sdfk"},{"name":"centos","_id":"cjvnq7zb4002z7jjxk6h436ch"},{"name":"shadowsocks","_id":"cjvnq7zb500337jjxiht56luf"},{"name":"电影","_id":"cjvnq7zb500357jjxm8vm7qfj"},{"name":"面试","_id":"cjvnq7zb500377jjx8xlqaxbu"},{"name":"nginx","_id":"cjvnq7zbl003c7jjxr2ut8186"},{"name":"mysql","_id":"cjvnq7zbp003i7jjx5sqdy3tl"},{"name":"python","_id":"cjvnq7zbr003n7jjx19ixcu3r"},{"name":"Laravel","_id":"cjvnq7zbs003r7jjxrgiih9sv"},{"name":"github","_id":"cjvnq7zbs003u7jjxavla5pvi"},{"name":"Node.js","_id":"cjycl6ghs0001syjxqw9wevxc"},{"name":"egg","_id":"cjylkt0r20002tpjxtjalcjq7"}]}}