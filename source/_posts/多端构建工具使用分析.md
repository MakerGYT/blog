---
title: 多端构建工具使用分析
date: 2019-04-15 16:47:43
tags:
---
{% note info %}
在传统web开发中，一般要做到跨平台（内置浏览器）和跨端（PC和移动）的兼容，即要适应差异，对用户提供一致的产品体验。响应式布局便是典型的开发需求，但这根本是基于业务和内容层面的，我们使用的这套前端技术之所以能在不同平台和不同端畅通无阻，是由于他们都遵循了W3C的规范，而使得开发者只需重点关注于业务层面的整合和复用，即从编程思想去思考。W3C规范抹平技术在端运行的差异，给开发者保留灵活性，这样的默契可以说是比较好的开发过程。
{% endnote%}
<!-- more -->
要实现跨平台，一般会提供一个虚拟的适配层来抹去底层差异，而在上层面向开发者是一致的编码规范。对于开发者来说，一般是先进行一端的开发，积累业务的处理经验采取开发其他端，在其他端构建完成后，再去构思统一的逻辑、架构、接口，进一步降低差异而趋于“同化”。这是一个循序渐进，螺旋式上升的过程。
# 两个目标
## 1. 能使用现有的框架技术开发
### 1.1 新造一个框架,提供类DSL
基于Vue的：
- mpvue
- wepy

### 1.2 静态编译
使用工具把代码语法分析一遍，把其中的JSX部分和逻辑部分抽取出来，分别生成小程序的模板和 Page 定义。
基于React的:
- Taro

只是用了React的写法，运行时没有React的存在。
### 1.3 实现一个小程序端的渲染器
基于React：
- Remax

## 2. 一次编码，多端运行
## 3. 其他目标
支持现代开发流程
- webpack
- css modules
- css预编译
- typescript
- npm
# taro
环境：ubuntu
- 构建极慢，每次都重新构建
- 对热重载支持不足，保存后报错component不存在，又需要重新构建，官方命令不加--watch时不会监听文件变化，然而并非如此
- 对第三方样式支持不开放

# cmljs
# uniapp
# kbone
支持：
- 微信小程序
- Web

好的解决方案，其实无需花里胡哨，也无需真的run anywhere,因为在众多个性之上提取共性，必然意味着优秀个性的牺牲和兼容成本的提高，常常顾此失彼（比如用性能换取兼容性，用开发构建时间换取运行时间）也不利于方案的进一步优化。只需要
- 坦诚的开放原理，承认自己的缺陷
- 正确定位自己的角色
- 遵循原有的或一般性的原则，不做过多开发限制